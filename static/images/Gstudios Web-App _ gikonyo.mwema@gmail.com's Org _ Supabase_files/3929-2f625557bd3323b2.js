"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3929],{64559:function(e,o,t){t.d(o,{$9:function(){return c},FQ:function(){return d},X8:function(){return r}});var n=t(52322),i=t(17172),s=t(95492),a=t(32079),l=t(70847);let r=()=>(0,n.jsxs)(s.bZ,{variant:"warning",children:[(0,n.jsx)(l.aN,{}),(0,n.jsx)(s.Cd,{children:"Direct database access is only available via IPv6-compatible networks."}),(0,n.jsxs)(s.X,{className:"space-y-3",children:[(0,n.jsx)("p",{children:"We strongly recommend using connection pooling to connect to your database because it's compatible with both IPv4 and IPv6 networks. You'll only need to change the connection credentials that you're using in your application to the pooler's connection credentials."}),(0,n.jsx)(a.z,{asChild:!0,type:"default",icon:(0,n.jsx)(i.Z,{}),children:(0,n.jsx)("a",{href:"https://github.com/orgs/supabase/discussions/17817",target:"_blank",rel:"noreferrer",children:"Learn more"})})]})]}),c=()=>(0,n.jsxs)(s.bZ,{variant:"default",children:[(0,n.jsx)(s.Cd,{children:"Direct database connections are recommended if you're connecting with session mode."}),(0,n.jsxs)(s.X,{className:"space-y-3",children:[(0,n.jsx)("p",{children:"If you are not connecting to the database from serverless environments, we strongly recommend you connect to the database directly instead of using connection pooling for lower latency."}),(0,n.jsx)("p",{children:"Since your project has the IPv4 add on, you are not required to use the connection pooler even if your network only supports IPv4."}),(0,n.jsx)(a.z,{asChild:!0,type:"default",icon:(0,n.jsx)(i.Z,{}),children:(0,n.jsx)("a",{href:"https://supabase.com/docs/guides/database/connecting-to-postgres#connection-pooler",target:"_blank",rel:"noreferrer",children:"Learn more"})})]})]}),d=()=>(0,n.jsxs)(s.bZ,{variant:"warning",children:[(0,n.jsx)(l.aN,{}),(0,n.jsx)(s.Cd,{children:"You are not yet in Transaction mode."}),(0,n.jsxs)(s.X,{className:"space-y-3",children:[(0,n.jsxs)("p",{children:["You need to set your ",(0,n.jsx)("span",{className:"text-foreground",children:"Pool Mode"})," to"," ",(0,n.jsx)("span",{className:"text-foreground",children:"Transaction"})," in the"," ",(0,n.jsx)("span",{className:"text-foreground",children:"Connection pooling configuration"})," section below in order to use transaction mode on port 6543."]}),(0,n.jsxs)("p",{children:["Otherwise, port 6543 will continue to connect in"," ",(0,n.jsx)("span",{className:"text-foreground",children:"Session"})," mode."]})]})]})},55442:function(e,o,t){t.d(o,{c:function(){return U}});var n=t(52322),i=t(99959),s=t(5632),a=t(2784),l=t(34750),r=t(27570),c=t(56006),d=t(37962),u=t(64306),p=t(41679),v=t(74091),h=t(92575),m=t(69923),x=t(14528),f=t(82667),g=t(28020),j=t(17172),b=t(78232),w=t(9109),N=t(57519),y=t(54383),_=t(32079),S=t(9015),C=t(95392),A=t(750),I=t(55283),P=t(2322),E=t(64559),R=t(22379),k=t(13911);let T=[{id:"uri",label:"URI"},{id:"psql",label:"PSQL"},{id:"golang",label:"Golang"},{id:"jdbc",label:"JDBC"},{id:"dotnet",label:".NET"},{id:"nodejs",label:"Nodejs"},{id:"php",label:"PHP"},{id:"python",label:"Python"}],U=e=>{var o,t,U;let{appearance:D}=e,Z=(0,s.useRouter)(),F=(0,i.Mk)(),O=(0,x.Vm)(),{ref:q,connectionString:W}=(0,i.UO)(),L=(0,N.mM)(),H=(0,w.TF)(),{project:M,isLoading:B}=(0,r.d2)(),z=(0,a.useRef)(null),[V,Y]=(0,a.useState)("transaction"),[Q,X]=(0,a.useState)("uri"),{data:G,isSuccess:J}=(0,v.Y)({projectRef:q}),K=null==G?void 0:G.find(e=>e.identifier===H.selectedDatabaseId),$=null==K?void 0:K.pool_mode,{data:ee,error:eo,isLoading:et,isError:en,isSuccess:ei}=(0,h.b)({projectRef:q}),es=(null!=ee?ee:[]).find(e=>e.identifier===H.selectedDatabaseId),{data:ea,isSuccess:el}=(0,m.F)({projectRef:q}),{ipv4:er}=(0,l.OP)(null!==(o=null==ea?void 0:ea.selected_addons)&&void 0!==o?o:[]),ec=(0,f.Ff)(es||{db_user:"",db_host:"",db_port:"",db_name:""},["db_host","db_name","db_port","db_user","inserted_at"]),ed=(null==M?void 0:M.restUrl)!==void 0&&null!==(U=new URL(null!==(t=null==M?void 0:M.restUrl)&&void 0!==t?t:"").hostname.split(".").pop())&&void 0!==U?U:"co",eu=e=>{var o;let t=null===(o=T.find(o=>o.id===e))||void 0===o?void 0:o.label;g.Z.sendEvent({category:"settings",action:"copy_connection_string",label:t||""},F,Z)},ep=J&&void 0!==K?(0,k.xI)(ec,K,{projectRef:q,usePoolerConnection:L.usePoolerConnection}):{uri:"",psql:"",golang:"",jdbc:"",dotnet:"",nodejs:"",php:"",python:""},ev=J&&void 0!==K?(0,k.Ak)(null==K?void 0:K.connectionString):"com",eh=J&&void 0!==K?(0,k.a4)(null==K?void 0:K.connectionString,{selectedTab:Q,usePoolerConnection:L.usePoolerConnection,ref:q,cloudProvider:B?"":(null==O?void 0:O.cloud_provider)||"",region:B?"":(null==O?void 0:O.region)||"",tld:L.usePoolerConnection?ev:ed,portNumber:L.usePoolerConnection?"transaction"===V?null==K?void 0:K.db_port.toString():"5432":ec.db_port.toString()}):[];return(0,a.useEffect)(()=>{if(void 0!==W&&void 0!==z.current){var e;H.setSelectedDatabaseId(W),null===(e=z.current)||void 0===e||e.scrollIntoView({block:"center",behavior:"smooth"})}},[W]),(0,a.useEffect)(()=>{(null==K?void 0:K.pool_mode)==="session"&&Y(K.pool_mode)},[null==K?void 0:K.pool_mode]),(0,n.jsx)("div",{id:"connection-string",className:"w-full",children:(0,n.jsxs)(u.Z,{className:(0,y.cn)("!m-0 [&>div:nth-child(1)]:!border-0 [&>div:nth-child(1)]:!p-0","minimal"===D&&"border-0 shadow-none bg-transparent"),titleClasses:(0,y.cn)("minimal"===D&&"bg-transparent"),title:(0,n.jsxs)("div",{ref:z,className:(0,y.cn)("w-full flex flex-col","default"===D?"pt-4":"pt-0"),children:[(0,n.jsxs)("div",{className:(0,y.cn)("flex items-center justify-between mb-2","default"===D&&"px-6"),children:["default"===D&&(0,n.jsx)("h5",{className:"mb-0",children:"Connection string"},"panel-title"),(0,n.jsxs)("div",{className:(0,y.cn)("flex items-center gap-x-2 ml-auto","minimal"===D?"absolute -top-1 right-0":""),children:[(0,n.jsx)(d.Z,{}),(0,n.jsx)(_.z,{asChild:!0,type:"default",icon:(0,n.jsx)(j.Z,{strokeWidth:1.5}),children:(0,n.jsx)("a",{target:"_blank",href:"https://supabase.com/docs/guides/database/connecting-to-postgres",children:"Documentation"})})]})]}),(0,n.jsx)(S.Z,{type:"underlined",size:"tiny",activeId:Q,baseClassNames:(0,y.cn)("!space-y-0 px-6 -mb-[1px]","minimal"===D&&"-mt-1 px-0"),onChange:X,children:T.map(e=>(0,n.jsx)(S.Z.Panel,{id:e.id,label:e.label},e.id))}),(0,n.jsx)(C.Z,{})]}),children:[(0,n.jsxs)(u.Z.Content,{className:"minimal"===D&&"px-0",children:[et&&(0,n.jsx)(p.Z,{className:"h-8 w-full"}),en&&(0,n.jsx)(c.Z,{error:eo,subject:"Failed to retrieve database settings"}),ei&&(0,n.jsxs)("div",{className:"flex flex-col gap-y-4 pt-2",children:[(0,n.jsx)(R.K,{id:"connection-string",checked:L.usePoolerConnection,poolingMode:V,onCheckedChange:L.setUsePoolerConnection,onSelectPoolingMode:Y}),"session"===$&&"transaction"===V&&(0,n.jsx)(E.FQ,{}),el&&"session"===V&&void 0!==er&&L.usePoolerConnection&&(0,n.jsx)(E.$9,{}),void 0===er&&!L.usePoolerConnection&&(0,n.jsx)(E.X8,{}),(0,n.jsx)(A.Z,{copy:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100",value:"transaction"===V?ep[Q]:ep[Q].replace("6543","5432"),onCopy:()=>eu(Q)})]})]}),eh.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.Z,{}),(0,n.jsxs)(u.Z.Content,{className:(0,y.cn)("!py-3 space-y-2","minimal"===D&&"px-0"),children:[(0,n.jsxs)(I.zF,{children:[(0,n.jsx)(I.wy,{className:"group [&[data-state=open]>div>svg]:!-rotate-180",children:(0,n.jsxs)("div",{className:"flex items-center gap-x-2 w-full",children:[(0,n.jsx)("p",{className:"text-xs text-foreground-light group-hover:text-foreground transition",children:"How to connect to a different database or switch to another user"}),(0,n.jsx)(b.Z,{className:"transition-transform duration-200",strokeWidth:1.5,size:14})]})}),(0,n.jsx)(I.Fw,{className:"my-2",children:(0,n.jsxs)("div",{className:"text-foreground-light",children:[(0,n.jsxs)("p",{className:"text-xs",children:["You can use the following URI format to switch to a different database or user",L.usePoolerConnection?" when using connection pooling":"","."]}),(0,n.jsx)("p",{className:"text-sm tracking-tight text-foreground-lighter",children:eh.map((e,o)=>e.tooltip?(0,n.jsxs)(P.u,{children:[(0,n.jsx)(P.aJ,{asChild:!0,children:(0,n.jsx)("span",{className:"text-foreground text-xs font-mono",children:e.value})}),(0,n.jsx)(P._v,{side:"bottom",children:e.tooltip})]},"syntax-".concat(o)):(0,n.jsx)("span",{className:"text-xs font-mono",children:e.value},"syntax-".concat(o)))})]})})]}),"python"===Q&&(0,n.jsxs)(I.zF,{children:[(0,n.jsx)(I.wy,{className:"group [&[data-state=open]>div>svg]:!-rotate-180",children:(0,n.jsxs)("div",{className:"flex items-center gap-x-2 w-full",children:[(0,n.jsx)("p",{className:"text-xs text-foreground-light group-hover:text-foreground transition",children:"Connecting to SQL Alchemy"}),(0,n.jsx)(b.Z,{className:"transition-transform duration-200",strokeWidth:1.5,size:14})]})}),(0,n.jsx)(I.Fw,{className:"my-2",children:(0,n.jsxs)("div",{className:"text-foreground-light text-xs grid gap-2",children:[(0,n.jsxs)("p",{children:["Please use ",(0,n.jsx)("code",{children:"postgresql://"})," instead of ",(0,n.jsx)("code",{children:"postgres://"})," as your dialect when connecting via SQLAlchemy."]}),(0,n.jsxs)("p",{children:["Example:",(0,n.jsx)("code",{children:'create_engine("postgresql+psycopg2://...")'})]}),(0,n.jsx)("p",{className:"text-sm font-mono tracking-tight text-foreground-lighter"})]})})]})]})]})]})})}},13911:function(e,o,t){t.d(o,{Ak:function(){return d},a4:function(){return c},xI:function(){return n}});let n=(e,o,t)=>{let n=o.connectionString.includes("options=reference"),{usePoolerConnection:i,projectRef:s}=t,a=i?o.db_user:e.db_user,l=i?null==o?void 0:o.db_port:e.db_port,r=i?o.db_host:e.db_host,c=i?null==o?void 0:o.db_name:e.db_name,d="[YOUR-PASSWORD]",u=i&&n,p=i?null==o?void 0:o.connectionString:"postgresql://".concat(a,":").concat(d,"@")+"".concat(r,":").concat(l)+"/".concat(c),v="user=".concat(a," password=").concat(d," host=").concat(r," port=").concat(l," dbname=").concat(c).concat(u?" options=reference=".concat(s):"");return{psql:n?'psql "postgresql://'.concat(a,":").concat(d,"@").concat(r,":").concat(l,"/").concat(c).concat(i?"?options=reference%3D".concat(s):"",'"'):"psql -h ".concat(r," -p ")+"".concat(l," -d ").concat(c," ")+"-U ".concat(a),uri:p,golang:v,jdbc:"jdbc:postgresql://".concat(r,":").concat(l,"/").concat(c,"?user=").concat(a,"&password=").concat(d).concat(u?"&options=reference%3D".concat(s):""),dotnet:"User Id=".concat(a,";Password=").concat(d,";Server=").concat(r,";Port=").concat(l,";Database=").concat(c,";").concat(u?"Options='reference=".concat(s,"'"):""),nodejs:p,php:v,python:v}},i="Database user (e.g postgres)",s="Database password",a="Database name (e.g postgres)",l="Project's reference ID",r="Port number (Use 5432 if using prepared statements)",c=(e,o)=>{let{selectedTab:t,usePoolerConnection:n,ref:c,cloudProvider:d,region:u,tld:p,portNumber:v}=o,h=e.includes("options=reference"),m=[{value:d.toLocaleLowerCase(),tooltip:"Cloud provider"},{value:"-0-",tooltip:void 0},{value:u,tooltip:"Project's region"},{value:".pooler.supabase.".concat(p),tooltip:void 0}],x=[{value:"db.",tooltip:void 0},{value:c,tooltip:l},{value:".supabase.".concat(p),tooltip:void 0}];return"uri"===t||"nodejs"===t?h?[{value:"postgres://",tooltip:void 0},{value:"[user]",tooltip:i},{value:":",tooltip:void 0},{value:"[password]",tooltip:s},{value:"@",tooltip:void 0},...n?m:x,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:a},...n?[{value:"?options=reference%3D",tooltip:void 0},{value:c,tooltip:l}]:[]]:[{value:"postgres://",tooltip:void 0},{value:"[user]",tooltip:i},...n?[{value:".",tooltip:void 0},{value:c,tooltip:l}]:[],{value:":",tooltip:void 0},{value:"[password]",tooltip:s},{value:"@",tooltip:void 0},...n?m:x,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:a}]:"psql"===t?h?[{value:'psql "postgresql://',tooltip:void 0},{value:"[user]",tooltip:i},{value:":",tooltip:void 0},{value:"[password]",tooltip:s},{value:"@",tooltip:void 0},...n?m:x,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:a},...n?[{value:"?options=reference%3D",tooltip:void 0},{value:c,tooltip:l}]:[]]:[{value:"psql -h ",tooltip:void 0},...n?m:x,{value:" -p ",tooltip:void 0},{value:v,tooltip:r},{value:" -d ",tooltip:void 0},{value:"[db-name]",tooltip:a},{value:" -U ",tooltip:void 0},{value:"[user]",tooltip:i},...n?[{value:".",tooltip:void 0},{value:c,tooltip:l}]:[]]:"golang"===t||"php"===t||"python"===t?h?[{value:"user=",tooltip:void 0},{value:"[user]",tooltip:i},{value:" password=",tooltip:void 0},{value:"[password]",tooltip:s},{value:" host=",tooltip:void 0},...n?m:x,{value:" port=",tooltip:void 0},{value:v,tooltip:r},{value:" dbname=",tooltip:void 0},{value:"[db-name]",tooltip:a},...n?[{value:" options=reference=",tooltip:void 0},{value:c,tooltip:l}]:[]]:[{value:"user=",tooltip:void 0},{value:"[user]",tooltip:i},...n?[{value:".",tooltip:void 0},{value:c,tooltip:l}]:[],{value:" password=",tooltip:void 0},{value:"[password]",tooltip:s},{value:" host=",tooltip:void 0},...n?m:x,{value:" port=",tooltip:void 0},{value:v,tooltip:r},{value:" dbname=",tooltip:void 0},{value:"[db-name]",tooltip:a}]:"jdbc"===t?h?[{value:"jdbc:postgresql://",tooltip:void 0},...n?m:x,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:a},{value:"?user=",tooltip:void 0},{value:"[user]",tooltip:i},{value:"&password=",tooltip:void 0},{value:"[password]",tooltip:s},...n?[{value:"&options=reference%3D",tooltip:void 0},{value:c,tooltip:l}]:[]]:[{value:"jdbc:postgresql://",tooltip:void 0},...n?m:x,{value:":",tooltip:void 0},{value:v,tooltip:r},{value:"/",tooltip:void 0},{value:"[db-name]",tooltip:a},{value:"?user=",tooltip:void 0},{value:"[user]",tooltip:i},...n?[{value:".",tooltip:void 0},{value:c,tooltip:l}]:[],{value:"&password=",tooltip:void 0},{value:"[password]",tooltip:s}]:"dotnet"===t?h?[{value:"User Id=",tooltip:void 0},{value:"[user]",tooltip:i},{value:";Password=",tooltip:void 0},{value:"[password]",tooltip:s},{value:";Server=",tooltip:void 0},...n?m:x,{value:";Port=",tooltip:void 0},{value:v,tooltip:r},{value:";Database=",tooltip:void 0},{value:"[db-name]",tooltip:a},...n?[{value:";Options='reference=",tooltip:void 0},{value:c,tooltip:l},{value:"'",tooltip:void 0}]:[]]:[{value:"User Id=",tooltip:void 0},{value:"[user]",tooltip:i},...n?[{value:".",tooltip:void 0},{value:c,tooltip:l}]:[],{value:";Password=",tooltip:void 0},{value:"[password]",tooltip:s},{value:";Server=",tooltip:void 0},...n?m:x,{value:";Port=",tooltip:void 0},{value:v,tooltip:r},{value:";Database=",tooltip:void 0},{value:"[db-name]",tooltip:a}]:[]},d=e=>{try{return e.split("pooler.supabase.")[1].split(":6543")[0]}catch(e){return"com"}}},31875:function(e,o,t){t.d(o,{F:function(){return h}});var n=t(52322),i=t(17172),s=t(60587),a=t(99959),l=t(80435),r=t(74091),c=t(9109),d=t(57519),u=t(41909),p=t(32079),v=t(95492);let h=()=>{let{ref:e}=(0,a.UO)(),o=(0,d.mM)(),t=(0,c.TF)(),{data:h}=(0,r.Y)({projectRef:e}),m=null==h?void 0:h.find(e=>e.identifier===t.selectedDatabaseId),x=()=>{let e=document.getElementById("connection-pooler");e&&e.scrollIntoView({behavior:"smooth",block:"center"})};return(0,n.jsx)(u.Vq,{open:o.showPoolingModeHelper,onOpenChange:o.setShowPoolingModeHelper,children:(0,n.jsxs)(u.cZ,{hideClose:!0,className:"sm:max-w-4xl",children:[(0,n.jsxs)(u.fK,{children:[(0,n.jsx)(u.$N,{children:(0,n.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,n.jsx)("p",{className:"max-w-2xl",children:"Which pooling mode should I use?"}),(0,n.jsx)(p.z,{asChild:!0,type:"default",icon:(0,n.jsx)(i.Z,{strokeWidth:1.5}),children:(0,n.jsx)("a",{href:"https://supabase.com/docs/guides/database/connecting-to-postgres#how-connection-pooling-works",target:"_blank",rel:"noreferrer",children:"Documentation"})})]})}),(0,n.jsx)(u.Be,{className:"max-w-2xl",children:"A connection pooler is a system (external to Postgres) which manages Postgres connections by allocating connections whenever clients make requests."})]}),(0,n.jsx)(u.P3,{}),(0,n.jsx)(u.VO,{children:(0,n.jsx)(l.U,{className:"max-w-full [&>h3]:text-sm",content:"\nEach pooling mode handles connections differently.\n\n### Transaction mode\nThis mode is recommended if you are connecting from *serverless environments*. A connection is assigned to the client for the duration of a transaction. Two consecutive transactions from the same client could be executed over two different connections. Some session-based Postgres features such as prepared statements are *not available* with this option.\n\n### Session mode\nThis mode is similar to connecting to your database directly. There is full support for prepared statements in this mode. When a new client connects, a connection is assigned to the client until it disconnects. You *might run into pooler connection limits* since the connection is held till the client disconnects.\n\n### Using session and transaction modes at the same time\n ".concat((null==m?void 0:m.pool_mode)==="transaction"?"You can use the session mode connection string (port 5432) and transaction mode connection string (port 6543) in your application.":"To get the best of both worlds, as a starting point, we recommend using session mode just when you need support for prepared statements and transaction mode in other cases.","\n")})}),(null==m?void 0:m.pool_mode)==="session"&&(0,n.jsx)("div",{className:"px-6",children:(0,n.jsxs)(v.bZ,{variant:"warning",children:[(0,n.jsx)(s.Z,{strokeWidth:2}),(0,n.jsx)(v.Cd,{children:"Pooling mode is currently configured to use session mode"}),(0,n.jsxs)(v.X,{children:["To use transaction mode concurrently with session mode, change the pooling mode to transaction first in the"," ",(0,n.jsx)("span",{tabIndex:0,className:"text-foreground cursor-pointer underline underline-offset-2",onClick:()=>{o.setShowPoolingModeHelper(!1),x()},children:"connection pooling settings"}),". After this, you can use transaction mode on port 6543 and session mode on port 5432."]})]})}),(0,n.jsx)(u.cN,{children:(0,n.jsx)(u.GG,{onClick:()=>o.setShowPoolingModeHelper(!1),children:(0,n.jsx)(p.z,{type:"default",children:"Close"})})})]})})}},22379:function(e,o,t){t.d(o,{K:function(){return A}});var n=t(52322),i=t(78232),s=t(39097),a=t.n(s),l=t(5632),r=t(2784),c=t(99959),d=t(41679),u=t(36492),p=t(31696),v=t(99248),h=t(45101);async function m(e,o){let{projectRef:t}=e;if(void 0===t)throw Error("Project ref is required");let{data:n,error:i}=await (0,p.U2)("/platform/projects/{ref}/config/pgbouncer/status",{params:{path:{ref:t}}});return i&&(0,p.S3)(i),n}let x=function(e){let{projectRef:o}=e,{enabled:t,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,u.a)(h.U.pgBouncerStatus(o),e=>{let{signal:t}=e;return m({projectRef:o},t)},{enabled:t&&v.Qy&&void 0!==o,...n})};var f=t(44085),g=t(74091),j=t(9109),b=t(57519),w=t(71640),N=t(6112),y=t(34503),_=t(32079),S=t(95392),C=t(81076);let A=e=>{let{id:o,checked:t,poolingMode:s="transaction",onCheckedChange:u,onSelectPoolingMode:p}=e,v=(0,l.useRouter)(),[h,m]=(0,r.useState)(!1),{ref:A}=(0,c.UO)(),I=(0,b.mM)(),P=(0,j.TF)(),{data:E,isLoading:R,isSuccess:k}=(0,g.Y)({projectRef:A}),{data:T,isSuccess:U}=(0,f.o)({projectRef:A}),{data:D}=x({projectRef:A}),Z=v.pathname.endsWith("/settings/database"),F=null==E?void 0:E.find(e=>e.identifier===P.selectedDatabaseId),O=(null==T?void 0:T.project.db_ip_addr_config)==="ipv6",q=e=>{p(e),m(!1)};return(0,n.jsx)("div",{className:"flex flex-col gap-y-1",children:(0,n.jsxs)("div",{className:"flex gap-x-3 items-center",children:[(0,n.jsx)(w.X,{id:"use-pooler-".concat(o),checked:t,onCheckedChange:()=>u(!t)}),(0,n.jsx)("div",{className:"-mt-[2px] flex flex-col gap-y-1 w-full",children:(0,n.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)(N._,{htmlFor:"use-pooler-".concat(o),className:"text-sm cursor-pointer",children:"Display connection pooler"}),t&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[R&&(0,n.jsx)(d.Z,{className:"w-[100px] py-2.5"}),k&&(0,n.jsx)("div",{className:"flex items-center gap-x-1",children:(0,n.jsxs)(y.h_,{open:h,onOpenChange:m,children:[(0,n.jsx)(y.$F,{asChild:!0,children:(0,n.jsxs)(_.z,{type:"outline",className:"py-0.5 pr-1.5 capitalize",iconRight:(0,n.jsx)(i.Z,{strokeWidth:1}),children:["Mode: ",s]})}),(0,n.jsxs)(y.AW,{side:"bottom",align:"start",className:"w-[280px]",children:[(0,n.jsxs)(y._x,{value:s,onValueChange:e=>q(e),children:[(0,n.jsx)(y.qB,{value:"session",children:"Session mode"}),(null==F?void 0:F.pool_mode)==="transaction"&&(0,n.jsx)(y.qB,{value:"transaction",children:"Transaction mode"})]}),(null==F?void 0:F.pool_mode)==="session"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.VD,{className:"my-1"}),(0,n.jsxs)("div",{className:"px-2 text-xs flex flex-col gap-y-2",children:[(0,n.jsxs)("p",{children:["To use transaction mode, change the pool mode in the"," ",Z?(0,n.jsx)("span",{tabIndex:0,className:"underline hover:text-foreground cursor-pointer transition",onClick:()=>{let e=document.getElementById("connection-pooler");e&&(m(!1),e.scrollIntoView({behavior:"smooth",block:"center"}))},children:"pooling configuration settings"}):(0,n.jsx)(a(),{href:"/project/".concat(A,"/settings/database#connection-pooler"),className:"underline hover:text-foreground",children:"pooling configuration settings"})," ","to use transaction mode first."]}),(0,n.jsx)("p",{children:"You can then connect to session mode on port 5432 and transaction mode on port 6543."})]})]}),(0,n.jsx)(S.Z,{className:"my-1"}),(0,n.jsx)(y.Xi,{onClick:()=>{m(!1),I.setShowPoolingModeHelper(!0)},children:"How to choose pooling modes?"},"more-info")]})]})})]})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[k&&t&&(0,n.jsx)(C.C,{children:"Supavisor"}),U&&(0,n.jsx)(C.C,{children:t?"Resolves to IPv4":O?"Resolves to IPv6":"Will resolve to IPv6"}),(null==D?void 0:D.active)&&(0,n.jsx)(C.C,{variant:"warning",children:"PgBouncer pending removal"})]})]})})]})})}},75951:function(e,o,t){t.d(o,{B:function(){return l},F2:function(){return c},G2:function(){return v},LZ:function(){return h},Y4:function(){return a},_J:function(){return d},dA:function(){return u},hk:function(){return r},nK:function(){return s},q_:function(){return p}});var n=t(63059),i=t(99248);let s=660,a=50,l=20,r={...i.S,INIT_READ_REPLICA:"INIT_READ_REPLICA",INIT_READ_REPLICA_FAILED:"INIT_READ_REPLICA_FAILED"},c={SOUTHEAST_ASIA:[103.8,1.37],NORTHEAST_ASIA:[139.42,35.41],NORTHEAST_ASIA_2:[126.98,37.56],CENTRAL_CANADA:[-73.6,45.5],WEST_US:[-121.96,37.35],EAST_US:[-78.45,38.13],WEST_EU:[-8,53],WEST_EU_2:[-.1,51],CENTRAL_EU:[8,50],SOUTH_ASIA:[72.88,19.08],OCEANIA:[151.2,-33.86],SOUTH_AMERICA:[-46.38,-23.34]},d={SOUTHEAST_ASIA:[103.8,1.37]},u={SOUTHEAST_ASIA:"ap-southeast-1",NORTHEAST_ASIA:"ap-northeast-1",NORTHEAST_ASIA_2:"ap-northeast-2",CENTRAL_CANADA:"ca-central-1",WEST_US:"us-west-1",EAST_US:"us-east-1",WEST_EU:"eu-west-1",WEST_EU_2:"eu-west-2",CENTRAL_EU:"eu-central-1",SOUTH_ASIA:"ap-south-1",OCEANIA:"ap-southeast-2",SOUTH_AMERICA:"sa-east-1"},p=Object.keys(i.Wp).map(e=>({key:e,name:null===i.Wp||void 0===i.Wp?void 0:i.Wp[e],region:u[e],coordinates:c[e]})).filter(e=>void 0!==e.coordinates),v={[n.Vb.Requested]:"Requesting replica instance",[n.Vb.Started]:"Launching replica instance",[n.Vb.LaunchedReadReplicaInstance]:"Initiating replica setup",[n.Vb.InitiatedReadReplicaSetup]:"Downloading base backup",[n.Vb.DownloadedBaseBackup]:"Replaying WAL archives",[n.Vb.ReplayedWalArchives]:"Completing set up",[n.Vb.CompletedReadReplicaSetup]:"Completed"},h={[n.Bm.ReadReplicaInstanceLaunchFailed]:"Failed to launch replica",[n.Bm.InitiateReadReplicaSetupFailed]:"Failed to initiate replica",[n.Bm.DownloadBaseBackupFailed]:"Failed to download backup",[n.Bm.ReplayWalArchivesFailed]:"Failed to replay WAL archives",[n.Bm.CompleteReadReplicaSetupFailed]:"Failed to set up replica"}},37962:function(e,o,t){var n=t(52322),i=t(99959),s=t(34291),a=t.n(s),l=t(46252),r=t(78232),c=t(76141),d=t(89404),u=t(39097),p=t.n(u),v=t(5632),h=t(2784),m=t(61786),x=t(32079),f=t(54383),g=t(90504),j=t(19869),b=t(2322),w=t(80435),N=t(75951),y=t(92575),_=t(89523),S=t(9109);o.Z=e=>{var o;let{variant:t="regular",additionalOptions:s=[],onSelectId:u=a()}=e,C=(0,v.useRouter)(),{ref:A}=(0,i.UO)(),[I,P]=(0,h.useState)(!1),E=(0,S.TF)(),R=E.selectedDatabaseId,{data:k,isLoading:T,isSuccess:U}=(0,y.b)({projectRef:A}),D=null!=k?k:[],Z=D.sort((e,o)=>e.inserted_at>o.inserted_at?1:0).sort(e=>e.identifier===A?-1:0),F=D.find(e=>e.identifier===R),O=(0,_.f)(null!==(o=null==F?void 0:F.region)&&void 0!==o?o:""),q=(0,_.U)(null!=R?R:""),W=s.find(e=>e.id===R);return(0,n.jsxs)(m.J2,{open:I,onOpenChange:P,modal:!1,children:[(0,n.jsx)(m.xo,{asChild:!0,children:(0,n.jsx)("div",{className:"flex items-center space-x-2 cursor-pointer",children:(0,n.jsxs)(x.z,{type:"default",className:(0,f.cn)("pr-2","connected-on-right"===t&&"rounded-r-none","connected-on-left"===t&&"rounded-l-none border-l-0","connected-on-both"===t&&"rounded-none border-x-0"),icon:T&&(0,n.jsx)(l.Z,{className:"animate-spin"}),iconRight:(0,n.jsx)(r.Z,{className:"text-foreground-light",strokeWidth:2,size:12}),children:["Source:"," ",W?(0,n.jsx)("span",{children:W.name}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"capitalize",children:T||(null==F?void 0:F.identifier)===A?"Primary database":"Read replica"})," ",U&&(null==F?void 0:F.identifier)!==A&&(0,n.jsxs)("span",{children:["(",O," - ",q,")"]})]})]})})}),(0,n.jsx)(m.yk,{className:"p-0 w-64",side:"bottom",align:"end",children:(0,n.jsx)(g.mY,{children:(0,n.jsxs)(g.e8,{children:[s.length>0&&(0,n.jsx)(g.fu,{className:"border-b",children:s.map(e=>(0,n.jsx)(g.di,{value:e.id,className:"cursor-pointer w-full",onSelect:()=>{E.setSelectedDatabaseId(e.id),P(!1),u(e.id)},onClick:()=>{E.setSelectedDatabaseId(e.id),P(!1),u(e.id)},children:(0,n.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,n.jsx)("p",{children:e.name}),e.id===R&&(0,n.jsx)(c.Z,{size:14})]})},e.id))}),(0,n.jsx)(g.fu,{children:(0,n.jsx)(j.x,{className:(D||[]).length>7?"h-[210px]":"",children:null==Z?void 0:Z.map(e=>{let o=(0,_.f)(e.region),t=(0,_.U)(e.identifier);if("ACTIVE_HEALTHY"!==e.status){let i=[N.hk.INIT_READ_REPLICA,N.hk.COMING_UP].includes(e.status)?"coming up":"not healthy";return(0,n.jsxs)(b.u,{children:[(0,n.jsx)(b.aJ,{asChild:!0,children:(0,n.jsx)("div",{className:"px-2 py-1.5 w-full flex items-center justify-between",children:(0,n.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Read replica (",o," - ",t,")"]})})}),(0,n.jsx)(b._v,{side:"right",className:"w-80",children:(0,n.jsx)(w.U,{className:"text-xs text-foreground",content:"Replica unable to accept requests as its ".concat(i,". [View infrastructure settings](/project/").concat(A,"/settings/infrastructure) for more information.")})})]},e.identifier)}return(0,n.jsx)(g.di,{value:e.identifier,className:"cursor-pointer w-full",onSelect:()=>{E.setSelectedDatabaseId(e.identifier),P(!1),u(e.identifier)},onClick:()=>{E.setSelectedDatabaseId(e.identifier),P(!1),u(e.identifier)},children:(0,n.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,n.jsx)("p",{children:e.identifier===A?"Primary database":"Read replica (".concat(o," - ").concat(t,")")}),e.identifier===R&&(0,n.jsx)(c.Z,{size:16})]})},e.identifier)})})}),(0,n.jsx)(g.fu,{className:"border-t",children:(0,n.jsx)(g.di,{className:"cursor-pointer w-full",onSelect:()=>{P(!1),C.push("/project/".concat(A,"/settings/infrastructure"))},onClick:()=>P(!1),children:(0,n.jsxs)(p(),{href:"/project/".concat(A,"/settings/infrastructure"),onClick:()=>P(!1),className:"w-full flex items-center gap-2",children:[(0,n.jsx)(d.Z,{size:14,strokeWidth:1.5}),(0,n.jsx)("p",{children:"Create a new read replica"})]})})})]})})})]})}},22329:function(e,o,t){t.d(o,{A:function(){return n}});let n={backups:e=>[e,"database","backups"],poolingConfiguration:e=>[e,"database","pooling-configuration"],indexesFromQuery:(e,o)=>["projects",e,"indexes",{query:o}],indexAdvisorFromQuery:(e,o)=>["projects",e,"index-advisor",{query:o}]}},74091:function(e,o,t){t.d(o,{Y:function(){return l}});var n=t(36492),i=t(31696),s=t(22329);async function a(e,o){let{projectRef:t}=e;if(!t)throw Error("Project ref is required");let{data:n,error:s}=await (0,i.U2)("/platform/projects/{ref}/config/supavisor",{params:{path:{ref:t}},signal:o});return s&&(0,i.S3)(s),n}let l=function(e){let{projectRef:o}=e,{enabled:t=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.a)(s.A.poolingConfiguration(o),e=>{let{signal:t}=e;return a({projectRef:o},t)},{enabled:t&&void 0!==o,...i})}},56302:function(e,o,t){t.d(o,{Z:function(){return n}});let n={list:e=>["project",e,"replicas"],statuses:e=>["project",e,"replicas-statuses"],loadBalancers:e=>["project",e,"load-balancers"]}},92575:function(e,o,t){t.d(o,{b:function(){return r}});var n=t(36492),i=t(99959),s=t(31696),a=t(56302);async function l(e,o){let{projectRef:t}=e;if(!t)throw Error("Project ref is required");let{data:n,error:i}=await (0,s.U2)("/platform/projects/{ref}/databases",{params:{path:{ref:t}},signal:o});return i&&(0,s.S3)(i),n}let r=function(e){let{projectRef:o}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.a)(a.Z.list(o),e=>{let{signal:t}=e;return l({projectRef:o},t)},{enabled:t&&i.Qy&&void 0!==o,...s})}},89523:function(e,o,t){t.d(o,{U:function(){return a},f:function(){return l}});var n=t(75951),i=t(56974),s=t.n(i);let a=e=>{var o;return s()(null!==(o=e.split("-"))&&void 0!==o?o:[])},l=e=>{var o,t;return null===(o=s()(null===(t=n.q_.find(o=>o.region===e))||void 0===t?void 0:t.name.split("(")))||void 0===o?void 0:o.split(")")[0]}},57519:function(e,o,t){t.d(o,{mM:function(){return l}}),t(52322);var n=t(2784),i=t(9162),s=t(4741);t(99959);let a=(0,n.createContext)(function(){let e=(0,i.sj)({usePoolerConnection:!0,setUsePoolerConnection:o=>{e.usePoolerConnection=o},showPoolingModeHelper:!1,setShowPoolingModeHelper:o=>{e.showPoolingModeHelper=o}});return e}());function l(e){let o=(0,n.useContext)(a);return(0,s.R)(o,e)}}}]);