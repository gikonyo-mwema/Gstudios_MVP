"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6681],{47342:function(e,n,t){t.d(n,{z:function(){return b}});var a=t(52322),i=t(39097),r=t.n(i),o=t(5632),s=t(2784),l=t(62202),c=t(32079),d=t(43687),u=t(34503),h=t(84447),v=t(49893),m=t(62134),p=t(74138),g=t(84247),x=t(40119),f=t(26198);let b=(0,s.forwardRef)((e,n)=>{let{disabled:t,onDeleteConnection:i,...b}=e,j=(0,o.useRouter)(),{type:y,connection:_}=b,{data:S}=(0,f.Sy)(),w=null==S?void 0:S.find(e=>e.ref===_.supabase_project_ref),N=(null==w?void 0:w.is_branch_enabled)===!0,[C,P]=(0,s.useState)(!1),[k,E]=(0,s.useState)(!1),L=(0,s.useCallback)(async()=>{try{await i(_)}finally{P(!1)}},[_,i]),I=(0,s.useCallback)(()=>{P(!1)},[]),{mutate:O,isLoading:A}=(0,x.h)({onSuccess:()=>{l.ZP.success("Successfully synced environment variables"),E(!1)}}),R=(0,s.useCallback)(async()=>{O({connectionId:_.id})},[_,O]),V="/project/[ref]/settings/integrations";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.jA,{showNode:!1,actions:t?(0,a.jsx)(c.z,{asChild:!0,disabled:!0,iconRight:(0,a.jsx)(d.Z,{}),type:"default",children:(0,a.jsx)("span",{children:"Manage"})}):(0,a.jsxs)(u.h_,{open:k,onOpenChange:()=>E(!k),modal:!1,children:[(0,a.jsx)(u.$F,{asChild:!0,children:(0,a.jsx)(c.z,{iconRight:(0,a.jsx)(d.Z,{}),type:"default",children:(0,a.jsx)("span",{children:"Manage"})})}),(0,a.jsxs)(u.AW,{side:"bottom",align:"end",children:[j.pathname!==V&&(0,a.jsx)(u.Xi,{asChild:!0,children:(0,a.jsx)(r(),{href:V.replace("[ref]",_.supabase_project_ref),children:"Configure connection"})}),"Vercel"===y&&(0,a.jsxs)(u.Xi,{className:"space-x-2",onSelect:e=>{e.preventDefault(),R()},disabled:A,children:[A?(0,a.jsx)(h.Z,{className:"animate-spin",size:14}):(0,a.jsx)(v.Z,{size:14}),(0,a.jsx)("p",{children:"Resync environment variables"})]}),("Vercel"===y||j.pathname!==V)&&(0,a.jsx)(u.VD,{}),(0,a.jsxs)(u.Xi,{className:"space-x-2",onSelect:()=>P(!0),children:[(0,a.jsx)(m.Z,{size:14}),(0,a.jsx)("p",{children:"Delete connection"})]})]})]}),...b}),(0,a.jsx)(p.Z,{variant:"destructive",size:"GitHub"===y&&N?"medium":"small",visible:C,title:"Confirm to delete ".concat(y," connection"),confirmLabel:"Delete connection",onCancel:I,onConfirm:L,alert:"GitHub"===y&&N?{title:"Branching will be disabled for this project",description:" Deleting this GitHub connection will remove all preview branches on this project,\n                and also disable branching for ".concat(w.name)}:void 0,children:(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["This action cannot be undone. Are you sure you want to delete this ",y," connection?"]})})]})});b.displayName="IntegrationConnectionItem"},96384:function(e,n,t){t.d(n,{g:function(){return a}});let a=Object.values({POSTGRES_URL:{key:"POSTGRES_URL",type:"encrypted"},POSTGRES_PRISMA_URL:{key:"POSTGRES_PRISMA_URL",type:"encrypted"},POSTGRES_URL_NON_POOLING:{key:"POSTGRES_URL_NON_POOLING",type:"encrypted"},POSTGRES_USER:{key:"POSTGRES_USER",type:"encrypted"},POSTGRES_HOST:{key:"POSTGRES_HOST",type:"encrypted"},POSTGRES_PASSWORD:{key:"POSTGRES_PASSWORD",type:"encrypted"},POSTGRES_DATABASE:{key:"POSTGRES_DATABASE",type:"encrypted"},SUPABASE_ANON_KEY:{key:"SUPABASE_ANON_KEY",type:"encrypted"},SUPABASE_URL:{key:"SUPABASE_URL",type:"encrypted"},SUPABASE_SERVICE_ROLE_KEY:{key:"SUPABASE_SERVICE_ROLE_KEY",type:"encrypted"},SUPABASE_JWT_SECRET:{key:"SUPABASE_JWT_SECRET",type:"encrypted"},NEXT_PUBLIC_SUPABASE_ANON_KEY:{key:"NEXT_PUBLIC_SUPABASE_ANON_KEY",type:"encrypted"},NEXT_PUBLIC_SUPABASE_URL:{key:"NEXT_PUBLIC_SUPABASE_URL",type:"encrypted"}}).map(e=>e.key)},78855:function(e,n,t){var a=t(52322),i=t(87622),r=t.n(i),o=t(2784),s=t(62202),l=t(49251),c=t(96384),d=t(95623),u=t(80435),h=t(9673),v=t(9915),m=t(15111),p=t(12459),g=t(26198),x=t(14528),f=t(99248),b=t(45077),j=t(26205);let y=(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"white",viewBox:"0 0 512 512",className:"w-6",children:(0,a.jsx)("path",{"fill-rule":"evenodd",d:"M256,48,496,464H16Z"})});n.Z=()=>{let e=(0,x.lL)(),n=(0,j.x5)(),t=n.vercelConnectionsIntegrationId,{data:i}=(0,v.T)({orgSlug:null==e?void 0:e.slug}),_=null==i?void 0:i.filter(e=>"Vercel"===e.integration.name),S=null==_?void 0:_.find(e=>e.id===t),{data:w}=(0,g.Sy)({enabled:void 0!==t}),N=(0,o.useMemo)(()=>{var n;return null!==(n=null==w?void 0:w.filter(n=>n.organization_id===(null==e?void 0:e.id)).map(e=>({id:e.id.toString(),name:e.name,ref:e.ref})))&&void 0!==n?n:b.Z6},[null==e?void 0:e.id,w]),{data:C}=(0,p.t)({organization_integration_id:t},{enabled:void 0!==t}),P=(0,o.useMemo)(()=>null!=C?C:b.Z6,[C]),k=(0,o.useMemo)(()=>r()(P,"id"),[P]),E=(0,o.useCallback)(e=>{let n=k[e.id];return(null==n?void 0:n.framework)?(0,a.jsx)("img",{src:"".concat(f.GW,"/img/icons/frameworks/").concat(n.framework,".svg"),width:21,height:21,alt:"icon"}):h.B},[k]),{mutate:L,isLoading:I}=(0,m.K)({async onSuccess(e){let{env_sync_error:t}=e;t&&s.ZP.error("Failed to sync environment variables: ".concat(t.message,". Please try re-syncing manually from settings.")),n.setVercelConnectionsOpen(!1)}}),O=(0,o.useCallback)(e=>{L({...e,connection:{...e.connection,metadata:{...e.connection.metadata,supabaseConfig:{projectEnvVars:{write:!0}}}}})},[L]);return(0,a.jsx)(l.ZP,{header:"Add new Vercel Project Connection",size:"large",visible:n.vercelConnectionsOpen,hideFooter:!0,onCancel:()=>n.setVercelConnectionsOpen(!1),children:(0,a.jsxs)("div",{className:"py-10 flex flex-col gap-6 bg-studio h-full",children:[(0,a.jsx)(l.ZP.Content,{children:(0,a.jsx)(u.U,{content:"\n### Choose repository to connect to\n\nCheck the details below before proceeding\n          "})}),(0,a.jsxs)(l.ZP.Content,{className:"flex flex-col gap-2",children:[(0,a.jsx)(d.Z,{organizationIntegrationId:null==S?void 0:S.id,foreignProjects:P,supabaseProjects:N,onCreateConnections:O,installedConnections:null==S?void 0:S.connections,isLoading:I,integrationIcon:y,getForeignProjectIcon:E,choosePrompt:"Choose Vercel Project",mode:"Vercel"}),(0,a.jsx)(u.U,{content:"\nThe following environment variables will be added:\n\n".concat(c.g.map(e=>"\n - `".concat(e,"`")),"\n")})]}),(0,a.jsx)(l.ZP.Content,{children:(0,a.jsx)("ul",{children:(0,a.jsx)("li",{className:"border px-10"})})})]})})}},37354:function(e,n,t){t.d(n,{B:function(){return ee},Z:function(){return en}});var a=t(52322),i=t(39097),r=t.n(i),o=t(95492),s=t(39459),l=t(36660),c=t(78855),d=t(74178),u=t(14528),h=t(99248),v=t(99959),m=t(2784),p=t(62202),g=t(47342),x=t(84247),f=t(80435),b=t(22557),j=t(35281),y=t(16014),_=t(61660),S=t(26205),w=t(88883),N=t(72583),C=t(94175),P=t(9105),k=t(63955),E=t(6112),L=t(61786),I=t(32079),O=t(54383),A=t(43687),R=t(90504),V=t(90488),Z=t(22574),z=t(42070),U=t(93705),T=t(30195),D=t(34928),F=t(36492),B=t(31696),G=t(90301);async function W(e,n){let{connectionId:t}=e;if(!t)throw Error("connectionId is required");let{data:a,error:i}=await (0,B.U2)("/platform/integrations/github/branches/{connectionId}",{params:{path:{connectionId:t}},signal:n});return i&&(0,B.S3)(i),a}let X=function(e){let{connectionId:n}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,F.a)(G.F.githubBranchesList(n),e=>{let{signal:t}=e;return W({connectionId:n},t)},{enabled:t&&void 0!==n,...a})};var H=t(85945),Q=t(48228);async function Y(e,n){let{connectionId:t,workdir:a,supabaseChangesOnly:i,branchLimit:r}=e,{data:o,error:s}=await (0,B.r$)("/platform/integrations/github/connections/{connection_id}",{params:{path:{connection_id:String(t)}},signal:n,body:{workdir:a,supabase_changes_only:i,branch_limit:r}});return s&&(0,B.S3)(s),o}let M=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,H.NL)();return(0,Q.D)(e=>Y(e),{async onSuccess(n,t,i){await Promise.all([a.invalidateQueries(G.F.githubConnectionsList(t.organizationId))]),await (null==e?void 0:e(n,t,i))},async onError(e,t,a){void 0===n?p.Am.error("Failed to update Github connection: ".concat(e.message)):n(e,t,a)},...t})};var K=t(70847),q=e=>{var n,t,i,r,s,l,c,d,h,v,g,x,f,b,y,_;let{connection:S}=e,F=(0,u.lL)(),B=(0,u.Vm)(),[G,W]=(0,m.useState)(!1),H=(0,m.useRef)(null),Q=(null==B?void 0:B.is_branch_enabled)===!0||(null==B?void 0:B.parent_project_ref)!==void 0,{data:Y,isLoading:q}=X({connectionId:Number(S.id)},{enabled:Q}),{mutate:J,isLoading:$}=M({onSuccess:()=>p.ZP.success("Successfully updated connection settings")}),{mutate:ee,isLoading:en}=(0,D.e)({onSuccess:e=>{p.ZP.success("Successfully updated production branch to ".concat(e.git_branch)),W(!1)}}),{data:et}=(0,j.V)({projectRef:null==B?void 0:B.parentRef},{enabled:void 0!==B}),ea=null==et?void 0:et.find(e=>e.is_default),ei=T.Ry({supabaseDirectory:T.Z_().default(null!==(b=null===(t=S.metadata)||void 0===t?void 0:null===(n=t.supabaseConfig)||void 0===n?void 0:n.supabaseDirectory)&&void 0!==b?b:""),supabaseChangesOnly:T.O7().default(null!==(y=null===(r=S.metadata)||void 0===r?void 0:null===(i=r.supabaseConfig)||void 0===i?void 0:i.supabaseChangesOnly)&&void 0!==y&&y),branchLimit:T.Z_().default(String(null!==(_=null===(l=S.metadata)||void 0===l?void 0:null===(s=l.supabaseConfig)||void 0===s?void 0:s.branchLimit)&&void 0!==_?_:50))}),er=(0,k.cI)({resolver:(0,w.F)(ei),defaultValues:{supabaseDirectory:null==S?void 0:null===(d=S.metadata)||void 0===d?void 0:null===(c=d.supabaseConfig)||void 0===c?void 0:c.supabaseDirectory,supabaseChangesOnly:null==S?void 0:null===(v=S.metadata)||void 0===v?void 0:null===(h=v.supabaseConfig)||void 0===h?void 0:h.supabaseChangesOnly,branchLimit:String(null==S?void 0:null===(x=S.metadata)||void 0===x?void 0:null===(g=x.supabaseConfig)||void 0===g?void 0:g.branchLimit)}});function eo(e){if((null==F?void 0:F.id)===void 0)return console.error("Org ID is required");J({connectionId:S.id,organizationId:null==F?void 0:F.id,workdir:e.supabaseDirectory,supabaseChangesOnly:e.supabaseChangesOnly,branchLimit:Number(e.branchLimit)})}return(0,a.jsxs)("div",{className:"flex flex-col gap-6 px-6 py-4",children:[Q?(0,a.jsxs)("div",{children:[(0,a.jsx)(E._,{className:"text-foreground",children:"Production branch"}),(0,a.jsx)("p",{className:"text-xs text-foreground-light mb-3",children:"All other branches will be treated as Preview branches"}),(0,a.jsxs)(o.bZ,{children:[(0,a.jsx)(o.Cd,{className:"text-sm",children:"Changing Git branch for Production Branch coming soon"}),(0,a.jsx)(o.X,{className:"text-xs",children:"If you wish to change the Git branch that is used for the Production Branch you will need to disable Branching and opt back in."})]}),(0,a.jsxs)(L.J2,{open:G,onOpenChange:W,modal:!1,children:[(0,a.jsx)(L.xo,{asChild:!0,name:"branch-selector",children:(0,a.jsx)(I.z,{disabled:!0,type:"default",size:"medium",ref:H,className:(0,O.cn)("justify-start w-80 mt-4",(null==ea?void 0:ea.git_branch)===void 0?"text-foreground-light":"text"),icon:(null==ea?void 0:ea.git_branch)&&(0,a.jsx)(N.Z,{className:"w-4 h-4 text-warning",strokeWidth:1}),loading:en||q,iconRight:(0,a.jsx)("span",{className:"grow flex justify-end",children:(0,a.jsx)(A.Z,{className:""})}),children:(null==ea?void 0:ea.git_branch)||"Select a branch"})}),(0,a.jsx)(L.yk,{className:"p-0",side:"bottom",align:"start",style:{width:null===(f=H.current)||void 0===f?void 0:f.offsetWidth},children:(0,a.jsxs)(R.mY,{children:[(0,a.jsx)(R.sZ,{placeholder:"Find branch..."}),(0,a.jsxs)(R.e8,{children:[(0,a.jsx)(R.rb,{children:"No branches found"}),(0,a.jsx)(R.fu,{children:null==Y?void 0:Y.map(e=>{let n=e.name===(null==ea?void 0:ea.git_branch);return(0,a.jsxs)(R.di,{value:e.name.replaceAll('"',""),className:"cursor-pointer w-full flex items-center justify-between",onSelect:()=>{var n;W(!1),n=e.name,(null==B?void 0:B.parentRef)&&ea&&ee({id:ea.id,projectRef:B.parentRef,branchName:n,gitBranch:n})},children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[n?(0,a.jsx)(N.Z,{className:"w-4 h-4 text-warning",strokeWidth:1}):(0,a.jsx)(C.Z,{className:"w-4 h-4",strokeWidth:1}),e.name]}),e.name===(null==ea?void 0:ea.git_branch)&&(0,a.jsx)(V.Z,{})]},e.name)})})]})]})})]})]}):(0,a.jsxs)(o.bZ,{className:"w-full mb-0",variant:"warning",children:[(0,a.jsx)(K.aN,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Cd,{className:"text-sm",children:"Braching is not enabled"}),(0,a.jsxs)(o.X,{className:"text-xs",children:["This integration has no effect without Branching feature being active.",(0,a.jsx)("br",{}),'Make sure to enable it using "Enable branching" button at the top of the page first.']})]})]}),(0,a.jsx)(Z.l0,{...er,children:(0,a.jsxs)("form",{onSubmit:er.handleSubmit(eo),className:"flex flex-col gap-6",children:[(0,a.jsx)(Z.Wi,{control:er.control,name:"branchLimit",render:e=>{var n,t,i,r,o,s;let{field:l}=e;return(0,a.jsxs)(Z.xJ,{className:"flex flex-col",children:[(0,a.jsx)(Z.lX,{className:"!text",children:"Branch limit"}),(0,a.jsx)(Z.pf,{className:"text-xs text-foreground-lighter !mt-0 !mb-1",children:"Total number of branches that can be automatically created for this connection."}),(0,a.jsx)(Z.NI,{className:"flex gap-3",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(z.I,{...l,className:"w-80",onKeyPress:e=>{"Escape"===e.key&&er.reset()},type:"number"}),(0,a.jsx)(P.Z,{className:(0,O.cn)("text-foreground-lighter transition hover:text cursor-pointer","w-4 h-4 absolute right-3 top-3","duration-150",l.value!==String(null===(t=S.metadata)||void 0===t?void 0:null===(n=t.supabaseConfig)||void 0===n?void 0:n.branchLimit)?"opacity-100 transition":"opacity-0"),onClick:()=>er.reset()}),(0,a.jsx)(I.z,{loading:$,className:(0,O.cn)("duration-150 transition",l.value!==String(null===(r=S.metadata)||void 0===r?void 0:null===(i=r.supabaseConfig)||void 0===i?void 0:i.branchLimit)?"opacity-100":"opacity-0"),htmlType:"submit",disabled:l.value===String(null===(s=S.metadata)||void 0===s?void 0:null===(o=s.supabaseConfig)||void 0===o?void 0:o.branchLimit),children:"Update"})]})})]})}}),(0,a.jsx)(Z.Wi,{control:er.control,name:"supabaseDirectory",render:e=>{var n,t,i,r,o,s;let{field:l}=e;return(0,a.jsxs)(Z.xJ,{className:"flex flex-col",children:[(0,a.jsx)(Z.lX,{className:"!text",children:"Supabase directory"}),(0,a.jsxs)(Z.pf,{className:"text-xs text-foreground-lighter !mt-0 !mb-1",children:["Path in your repository where ",(0,a.jsx)("code",{children:"supabase"})," directory for this connection lives."]}),(0,a.jsx)(Z.NI,{className:"flex gap-3",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(z.I,{...l,className:"w-80",onKeyPress:e=>{"Escape"===e.key&&er.reset()}}),(0,a.jsx)(P.Z,{className:(0,O.cn)("text-foreground-lighter transition hover:text cursor-pointer","w-4 h-4 absolute right-3 top-3","duration-150",l.value!==(null===(t=S.metadata)||void 0===t?void 0:null===(n=t.supabaseConfig)||void 0===n?void 0:n.supabaseDirectory)?"opacity-100 transition":"opacity-0"),onClick:()=>er.reset()}),(0,a.jsx)(I.z,{loading:$,className:(0,O.cn)("duration-150 transition",l.value!==(null===(r=S.metadata)||void 0===r?void 0:null===(i=r.supabaseConfig)||void 0===i?void 0:i.supabaseDirectory)?"opacity-100":"opacity-0"),htmlType:"submit",disabled:""===l.value||l.value===(null===(s=S.metadata)||void 0===s?void 0:null===(o=s.supabaseConfig)||void 0===o?void 0:o.supabaseDirectory),children:"Update"})]})})]})}}),(0,a.jsx)(Z.Wi,{control:er.control,name:"supabaseChangesOnly",render:e=>{let{field:n}=e;return(0,a.jsxs)(Z.xJ,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(Z.NI,{children:(0,a.jsx)(U.r,{className:"mt-1",checked:n.value,onCheckedChange:e=>{n.onChange(e),er.handleSubmit(eo)()}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.lX,{className:"!text",children:"Supabase changes only"}),(0,a.jsxs)(Z.pf,{className:"text-xs text-foreground-lighter",children:["Trigger branch creation only when there were changes to ",(0,a.jsx)("code",{children:"supabase"})," ","directory."]})]})]})}})]})})]})},J=()=>{var e;let{ref:n}=(0,v.UO)(),t=(0,u.Vm)(),i=(0,u.lL)(),r=(0,S.x5)(),{data:o}=(0,_.q)({organizationId:null==i?void 0:i.id}),{data:s}=(0,j.V)({projectRef:n}),{mutate:l}=(0,y.n)({onSuccess:()=>{p.ZP.success("Successfully deleted Github connection")}}),{mutate:c}=(0,b.D)(),h=(0,u.P5)("branchManagement"),w=(null!=s?s:[]).filter(e=>!e.is_default),N=(null==t?void 0:t.parent_project_ref)!==void 0,C=(null==t?void 0:t.is_branch_enabled)===!0||(null==t?void 0:t.parent_project_ref)!==void 0,P=null!==(e=null==o?void 0:o.filter(e=>N?e.project.ref===t.parent_project_ref:e.project.ref===n))&&void 0!==e?e:[],k=(0,m.useCallback)(()=>{r.setGithubConnectionsOpen(!0)},[r]),E=(0,m.useCallback)(async e=>{if(C){if(!n)throw Error("Project ref not found");c({projectRef:n,branchIds:null==w?void 0:w.map(e=>e.id)})}if(!(null==i?void 0:i.id))throw Error("Organization not found");l({connectionId:e.id,organizationId:i.id})},[l,c,C,null==i?void 0:i.id,w,n]);return(0,a.jsx)(d._S,{children:(0,a.jsxs)(d.jX,{children:[(0,a.jsxs)(d.g$,{title:"GitHub Connections",children:[(0,a.jsx)(f.U,{content:"\nConnect any of your GitHub repositories to a project.\n"}),(0,a.jsx)(ee,{title:"github"})]}),(0,a.jsxs)(d.Lc,{children:[(0,a.jsx)(f.U,{content:"\n\n### How will GitHub connections work?\n\nYou will be able to connect a GitHub repository to a Supabase project.\nThe GitHub app will watch for changes in your repository such as file changes, branch changes as well as pull request activity.\n"}),P.length>0?(0,a.jsx)("ul",{className:"flex flex-col",children:P.map(e=>{var n,t,i,r,o,s,l,c,d,u;return(0,a.jsxs)("div",{className:"relative flex flex-col -gap-[1px] [&>li]:pb-0",children:[(0,a.jsx)(g.z,{showNode:!1,disabled:N,connection:{id:String(e.id),added_by:{id:String(null===(n=e.user)||void 0===n?void 0:n.id),primary_email:null!==(l=null===(t=e.user)||void 0===t?void 0:t.primary_email)&&void 0!==l?l:"",username:null!==(c=null===(i=e.user)||void 0===i?void 0:i.username)&&void 0!==c?c:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name}},type:"GitHub",onDeleteConnection:E,className:"!rounded-b-none !mb-0"},e.id),(0,a.jsx)("div",{className:"border-b border-l border-r rounded-b-lg",children:(0,a.jsx)(q,{connection:{id:String(e.id),added_by:{id:String(null===(r=e.user)||void 0===r?void 0:r.id),primary_email:null!==(d=null===(o=e.user)||void 0===o?void 0:o.primary_email)&&void 0!==d?d:"",username:null!==(u=null===(s=e.user)||void 0===s?void 0:s.username)&&void 0!==u?u:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name,supabaseConfig:{supabaseDirectory:e.workdir,supabaseChangesOnly:e.supabase_changes_only,branchLimit:e.branch_limit}}}})})]},e.id)})}):h?(0,a.jsx)(x.FP,{onClick:k,orgSlug:null==i?void 0:i.slug,showNode:!1,children:"Add new project connection"}):(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["Access to"," ",(0,a.jsx)("a",{href:"https://supabase.com/docs/guides/platform/branching",target:"_blank",rel:"noreferrer",className:"text-foreground",children:"branching"})," ","is required to add GitHub connections."]})]})]})})},$=t(55579);let ee=e=>{let{title:n}=e;return(0,a.jsx)("img",{className:"border rounded-lg shadow w-48 mt-6 border-body",src:"".concat(h.GW,"/img/integrations/covers/").concat(n,"-cover.png"),alt:"".concat(n," cover")})};var en=()=>{let e=(0,u.Vm)(),n=(0,u.N$)(null==e?void 0:e.parent_project_ref),t=(null==e?void 0:e.parent_project_ref)!==void 0;return(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsx)(d._S,{children:(0,a.jsxs)(o.bZ,{variant:"default",className:"mt-6",children:[(0,a.jsx)(s.Z,{strokeWidth:2}),(0,a.jsx)(o.Cd,{children:"You are currently on a preview branch of your project"}),(0,a.jsxs)(o.X,{children:["To adjust your project's integration settings, you may return to your"," ",(0,a.jsx)(r(),{href:"/project/".concat(null==n?void 0:n.ref,"/settings/general"),className:"text-brand",children:"main branch"}),"."]})]})}),(0,a.jsx)(J,{}),(0,a.jsx)(d.I7,{}),(0,a.jsx)($.Z,{isProjectScoped:!0}),(0,a.jsx)(c.Z,{}),(0,a.jsx)(l.Z,{})]})}},55579:function(e,n,t){t.d(n,{Z:function(){return U}});var a=t(52322),i=t(39097),r=t.n(i),o=t(2784),s=t(62202),l=t(54383),c=t(32079),d=t(32830),u=t(47342),h=t(84247),v=t(80435),m=t(74178),p=t(9915),g=t(85945),x=t(48228),f=t(88354),b=t(99248),j=t(90301);async function y(e,n){let{organization_integration_id:t,id:a}=e;if(!t)throw Error("organization_integration_id is required");let i=await (0,f.$v)("".concat(b.T5,"/integrations/vercel/connections/").concat(a),{organization_integration_id:t},{signal:n});if(!(0,f.d8)(i))throw i.error;return i}let _=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,g.NL)();return(0,x.D)(e=>y(e),{async onSuccess(n,t,i){await Promise.all([a.invalidateQueries(j.F.integrationsList()),a.invalidateQueries(j.F.integrationsListWithOrg(t.orgSlug)),a.invalidateQueries(j.F.vercelProjectList(t.organization_integration_id)),a.invalidateQueries(j.F.vercelConnectionsList(t.organization_integration_id))]),await (null==e?void 0:e(n,t,i))},async onError(e,t,a){void 0===n?s.Am.error("Failed to delete Vercel connection: ".concat(e.message)):n(e,t,a)},...t})};var S=t(12459),w=t(14528),N=t(82667),C=t(92516),P=t(26205),k=t(37354),E=t(88883),L=t(63955),I=t(30195),O=t(31696);async function A(e){let{id:n,envSyncTargets:t}=e,{data:a,error:i}=await (0,O.r$)("/platform/integrations/vercel/connections/{connection_id}",{params:{path:{connection_id:n}},body:{env_sync_targets:t}});return i&&(0,O.S3)(i),a}let R=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,g.NL)();return(0,x.D)(e=>A(e),{async onSuccess(n,t,i){await a.invalidateQueries(j.F.vercelConnectionsList(t.organizationIntegrationId)),await (null==e?void 0:e(n,t,i))},async onError(e,t,a){void 0===n?s.Am.error("Failed to update Vercel connection: ".concat(e.message)):n(e,t,a)},...t})};var V=t(22574),Z=t(93705),z=e=>{var n;let{connection:t,integration:i}=e,r=null!==(n=t.env_sync_targets)&&void 0!==n?n:[],o=I.Ry({environmentVariablesProduction:I.O7().default(r.includes("production")),environmentVariablesPreview:I.O7().default(r.includes("preview")),environmentVariablesDevelopment:I.O7().default(r.includes("development"))}),l=(0,L.cI)({resolver:(0,E.F)(o),defaultValues:{environmentVariablesProduction:r.includes("production"),environmentVariablesPreview:r.includes("preview"),environmentVariablesDevelopment:r.includes("development")}}),{mutate:c}=R({onSuccess:()=>s.ZP.success("Updated Vercel connection")});function d(e){let{environmentVariablesProduction:n,environmentVariablesPreview:a,environmentVariablesDevelopment:r}=e,o=[];n&&o.push("production"),a&&o.push("preview"),r&&o.push("development"),c({id:t.id,envSyncTargets:o,organizationIntegrationId:i.id})}return(0,a.jsx)(V.l0,{...l,children:(0,a.jsx)("form",{onSubmit:l.handleSubmit(d),className:"w-full space-y-6",children:(0,a.jsxs)("div",{className:"px-6 py-4 flex flex-col gap-y-4",children:[(0,a.jsx)("h5",{className:"text-foreground text-sm",children:"Sync environment variables for selected target environments"}),(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)(V.Wi,{control:l.control,name:"environmentVariablesProduction",render:e=>{let{field:n}=e;return(0,a.jsxs)(V.xJ,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(V.NI,{children:(0,a.jsx)(Z.r,{className:"mt-1",checked:n.value,onCheckedChange:e=>{n.onChange(e),l.handleSubmit(d)()}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(V.lX,{className:"!text",children:"Production"}),(0,a.jsxs)(V.pf,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"production"})," environment."]})]})]})}}),(0,a.jsx)(V.Wi,{control:l.control,name:"environmentVariablesPreview",render:e=>{let{field:n}=e;return(0,a.jsxs)(V.xJ,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(V.NI,{children:(0,a.jsx)(Z.r,{className:"mt-1",checked:n.value,onCheckedChange:e=>{n.onChange(e),l.handleSubmit(d)()}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(V.lX,{className:"!text",children:"Preview"}),(0,a.jsxs)(V.pf,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"preview"})," environment."]})]})]})}}),(0,a.jsx)(V.Wi,{control:l.control,name:"environmentVariablesDevelopment",render:e=>{let{field:n}=e;return(0,a.jsxs)(V.xJ,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(V.NI,{children:(0,a.jsx)(Z.r,{className:"mt-1",checked:n.value,onCheckedChange:e=>{n.onChange(e),l.handleSubmit(d)()}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(V.lX,{className:"!text",children:"Development"}),(0,a.jsxs)(V.pf,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"development"})," environment."]})]})]})}})]})]})})})},U=e=>{var n;let{isProjectScoped:t}=e,i=(0,w.Vm)(),g=(0,w.lL)(),{data:x}=(0,p.T)({orgSlug:null==g?void 0:g.slug}),f=(0,P.x5)(),b=(null==i?void 0:i.parent_project_ref)!==void 0,{mutate:j}=_({onSuccess:()=>{s.ZP.success("Successfully deleted Vercel connection")}}),y=(0,o.useMemo)(()=>null==x?void 0:x.filter(e=>"Vercel"===e.integration.name).map(e=>{if(e.metadata&&"Vercel"===e.integration.name){let n=e.metadata.account.avatar||"Team"!==e.metadata.account.type?"https://vercel.com/api/www/avatar/".concat(e.metadata.account.avatar,"?s=48"):"https://vercel.com/api/www/avatar?teamId=".concat(e.metadata.account.team_id,"&s=48");e.metadata.account.avatar=n}return e}),[x]),E=null==y?void 0:y[0],{data:L}=(0,S.t)({organization_integration_id:null==E?void 0:E.id},{enabled:(null==E?void 0:E.id)!==void 0}),I=null!==(n=null==L?void 0:L.length)&&void 0!==n?n:0,O=(0,o.useCallback)(e=>{f.setVercelConnectionsIntegrationId(e),f.setVercelConnectionsOpen(!0)},[f]),A=(0,o.useCallback)(async e=>{j({id:e.id,organization_integration_id:e.organization_integration_id,orgSlug:null==g?void 0:g.slug})},[j,null==g?void 0:g.slug]),R=I>0&&void 0!==E?"\nYour Vercel connection has access to ".concat(I," Vercel Projects.\nYou can change the scope of the access for Supabase by configuring\n[here](").concat((0,C.H)(E),").\n"):"",V=(t?null==E?void 0:E.connections.filter(e=>e.supabase_project_ref===(null==i?void 0:i.ref)):null==E?void 0:E.connections)||[],Z="".concat(V.length," project ").concat((0,N._6)(V.length,"connection")," ");return(0,a.jsx)(m._S,{children:(0,a.jsxs)(m.jX,{children:[(0,a.jsxs)(m.g$,{title:"Vercel Integration",children:[(0,a.jsx)(v.U,{content:"\n\nConnect your Vercel teams to your Supabase organization.\n"}),(0,a.jsx)(k.B,{title:"vercel"})]}),(0,a.jsxs)(m.Lc,{children:[(0,a.jsx)(v.U,{content:"\n\n### How does the Vercel integration work?\n\nSupabase will keep your environment variables up to date in each of the projects you assign to a Supabase project.\nYou can also link multiple Vercel Projects to the same Supabase project.\n"}),E?(0,a.jsxs)("div",{children:[(0,a.jsx)(h.ML,{title:"Vercel",integration:E}),V.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.WY,{title:Z,markdown:"Repository connections for Vercel"}),(0,a.jsx)("ul",{className:"flex flex-col",children:V.map(e=>(0,a.jsxs)("div",{className:(0,l.cn)(t&&"relative flex flex-col -gap-[1px] [&>li]:pb-0"),children:[(0,a.jsx)(u.z,{connection:e,type:"Vercel",onDeleteConnection:A,className:(0,l.cn)(t&&"!rounded-b-none !mb-0")}),t?(0,a.jsx)("div",{className:"relative pl-8 ml-6 border-l border-muted pb-6",children:(0,a.jsx)("div",{className:"border-b border-l border-r rounded-b-lg",children:(0,a.jsx)(z,{connection:e,integration:E})})}):null]},e.id))})]}):(0,a.jsx)(h.WY,{title:Z,markdown:"Repository connections for Vercel"}),(0,a.jsx)(h.FP,{onClick:()=>O(E.id),orgSlug:null==g?void 0:g.slug,children:"Add new project connection"})]},E.id):(0,a.jsx)("div",{children:(0,a.jsx)(c.z,{asChild:!b,type:"default",disabled:b,iconRight:(0,a.jsx)(d.Z,{}),children:b?(0,a.jsx)("p",{children:"Install Vercel Integration"}):(0,a.jsx)(r(),{href:"https://vercel.com/integrations/supabase",target:"_blank",rel:"noreferrer",children:"Install Vercel Integration"})})}),R&&(0,a.jsx)(v.U,{content:R,className:"text-foreground-lighter"})]})]})})}},9673:function(e,n,t){t.d(n,{B:function(){return r},t:function(){return o}});var a=t(52322),i=t(82796);let r=(0,a.jsx)("div",{className:"flex items-center justify-center rounded bg-black p-1",children:(0,a.jsx)("svg",{className:"m-auto fill-current text-white",width:"12px",height:"12px",viewBox:"0 0 1155 1000",children:(0,a.jsx)("path",{d:"M577.344 0L1154.69 1000H0L577.344 0Z"})})}),o=(0,a.jsx)("div",{className:"flex items-center justify-center rounded bg-green-500 p-1 [[data-theme*=dark]_&]:text-typography-body-dark ",children:(0,a.jsx)(i.Z,{size:12,strokeWidth:2})})},81006:function(e,n,t){t.d(n,{N:function(){return l},Q:function(){return c}});var a=t(85945),i=t(48228),r=t(62202),o=t(31696),s=t(79073);async function l(e){let{id:n}=e,{data:t,error:a}=await (0,o.IV)("/v1/branches/{branch_id}",{params:{path:{branch_id:n}}});return a&&(0,o.S3)(a),t}let c=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,a.NL)();return(0,i.D)(e=>l(e),{async onSuccess(n,t,a){let{projectRef:i}=t;await o.invalidateQueries(s.x.list(i)),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?r.Am.error("Failed to delete branch: ".concat(e.message)):n(e,t,a)},...t})}},34928:function(e,n,t){t.d(n,{e:function(){return c}});var a=t(85945),i=t(48228),r=t(62202),o=t(31696),s=t(79073);async function l(e){let{id:n,branchName:t,gitBranch:a,persistent:i}=e,{data:r,error:s}=await (0,o.r$)("/v1/branches/{branch_id}",{params:{path:{branch_id:n}},body:{branch_name:t,git_branch:a,persistent:i}});return s&&(0,o.S3)(s),r}let c=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,a.NL)();return(0,i.D)(e=>l(e),{async onSuccess(n,t,a){let{projectRef:i}=t;await o.invalidateQueries(s.x.list(i)),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?r.Am.error("Failed to update branch: ".concat(e.message)):n(e,t,a)},...t})}},22557:function(e,n,t){t.d(n,{D:function(){return u}});var a=t(85945),i=t(48228),r=t(62202),o=t(31696),s=t(27181),l=t(81006),c=t(79073);async function d(e){let{branchIds:n,projectRef:t}=e;if(n.length>0&&(await Promise.all(n.map(async e=>{try{return await (0,l.N)({id:e})}catch(e){return e}}))).some(e=>"ok"!==e.message))throw Error("Failed to disable branching: Unable to delete all branches");let{data:a,error:i}=await (0,o.IV)("/v1/projects/{ref}/branches",{params:{path:{ref:t}}});return i&&(0,o.S3)(i),a}let u=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,a.NL)();return(0,i.D)(e=>d(e),{async onSuccess(n,t,a){let{projectRef:i}=t;await o.invalidateQueries(c.x.list(i)),await o.invalidateQueries(s.i.detail(i)),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?r.Am.error("Failed to disable branching: ".concat(e.message)):n(e,t,a)},...t})}},9915:function(e,n,t){t.d(n,{T:function(){return l}});var a=t(36492),i=t(88354),r=t(99248),o=t(90301);async function s(e,n){let{orgSlug:t}=e;if(!t)throw Error("orgSlug is required");let a=await (0,i.U2)("".concat(r.T5,"/integrations/").concat(t,"?expand=true"),{signal:n});if(a.error)throw a.error;return a}let l=function(e){let{orgSlug:n}=e,{enabled:t=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.a)(o.F.integrationsListWithOrg(n),e=>{let{signal:t}=e;return s({orgSlug:n},t)},{enabled:t&&void 0!==n,...i})}},40119:function(e,n,t){t.d(n,{h:function(){return s}});var a=t(48228),i=t(62202),r=t(31696);async function o(e){let{connectionId:n}=e,{data:t,error:a}=await (0,r.v_)("/platform/integrations/vercel/connections/{connection_id}/sync-envs",{params:{path:{connection_id:n}}});return a&&(0,r.S3)(a),t}let s=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.D)(e=>o(e),{async onSuccess(n,t,a){await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?i.Am.error("Failed to sync environment variables: ".concat(e.message)):n(e,t,a)},...t})}},15111:function(e,n,t){t.d(n,{K:function(){return d}});var a=t(85945),i=t(48228),r=t(62202),o=t(31696),s=t(63422),l=t(90301);async function c(e){let{organizationIntegrationId:n,connection:t}=e,{data:a,error:i}=await (0,o.v_)("/platform/integrations/vercel/connections",{body:{organization_integration_id:n,connection:{foreign_project_id:t.foreign_project_id,supabase_project_ref:t.supabase_project_ref,metadata:t.metadata}}});return i&&(0,o.S3)(i),a}let d=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,a.NL)(),d=(0,s.IF)();return(0,i.D)(e=>c(e),{async onSuccess(n,t,a){await Promise.all([o.invalidateQueries(l.F.integrationsList()),o.invalidateQueries(l.F.integrationsListWithOrg(t.orgSlug)),o.invalidateQueries(l.F.vercelProjectList(t.organizationIntegrationId)),o.invalidateQueries(l.F.vercelConnectionsList(t.organizationIntegrationId))]),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){d.setLoading(!1),void 0===n?r.Am.error("Failed to create connection: ".concat(e.message)):n(e,t,a)},...t})}},12459:function(e,n,t){t.d(n,{t:function(){return s}});var a=t(36492),i=t(31696),r=t(90301);async function o(e,n){let{organization_integration_id:t}=e;if(!t)throw Error("organization_integration_id is required");let{data:a,error:r}=await (0,i.U2)("/platform/integrations/vercel/projects/{organization_integration_id}",{params:{path:{organization_integration_id:t},query:{limit:"1000"}},signal:n});return r&&(0,i.S3)(r),a.projects}let s=function(e){let{organization_integration_id:n}=e,{enabled:t=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.a)(r.F.vercelProjectList(n),e=>{let{signal:t}=e;return o({organization_integration_id:n},t)},{enabled:t&&void 0!==n,...i})}},63422:function(e,n,t){t.d(n,{IF:function(){return o}});var a=t(9162),i=t(4741);let r=(0,a.sj)({loading:!1,setLoading:e=>{r.loading=e}}),o=e=>(0,i.R)(r,e)},82796:function(e,n,t){var a=t(52322);t(2784);var i=t(79550),r=t(2515);n.Z=function(e){return(0,a.jsx)(r.Z,{icon:i.Z,...e})}},93705:function(e,n,t){t.d(n,{r:function(){return d}});var a=t(52322),i=t(16530),r=t(10929),o=t(2784),s=t(54383);let l=(0,r.j)("peer inline-flex shrink-0 cursor-pointer items-center rounded-full border transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-brand data-[state=checked]:hover:bg-brand-600/90 data-[state=unchecked]:bg-control data-[state=unchecked]:hover:bg-border",{variants:{size:{small:"h-[16px] w-[28px]",medium:"h-[20px] w-[34px]",large:"h-[24px] w-[44px]"}},defaultVariants:{size:"medium"}}),c=(0,r.j)("pointer-events-none block rounded-full bg-foreground-lighter data-[state=checked]:bg-white shadow-lg ring-0 transition-transform",{variants:{size:{small:"h-[12px] w-[12px] data-[state=checked]:translate-x-[13px] data-[state=unchecked]:translate-x-[1px]",medium:"h-[16px] w-[16px] data-[state=checked]:translate-x-[15px] data-[state=unchecked]:translate-x-[1px]",large:"h-[18px] w-[18px] data-[state=checked]:translate-x-[22px] data-[state=unchecked]:translate-x-[3px]"}},defaultVariants:{size:"medium"}}),d=o.forwardRef((e,n)=>{let{className:t,size:r,...o}=e;return(0,a.jsx)(i.fC,{className:(0,s.cn)(l({size:r}),t),...o,ref:n,children:(0,a.jsx)(i.bU,{className:(0,s.cn)(c({size:r}))})})});d.displayName=i.fC.displayName}}]);