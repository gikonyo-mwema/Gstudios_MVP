(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6193,8020,1273,7298],{90373:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/org/[slug]/general",function(){return n(79329)}])},48998:function(e,t,n){"use strict";n.d(t,{NK:function(){return u},Tf:function(){return m},Yb:function(){return d},cc:function(){return o},rg:function(){return c},x4:function(){return h}});var s=n(79147),a=n(60417),i=n.n(a),r=n(50317),l=n(87115);function o(e){let{editable:t}=e;return t?e:{...e,onAddColumn:void 0,onAddRow:void 0,onEditColumn:void 0,onDeleteColumn:void 0,onEditRow:void 0}}function c(e,t){return Array.isArray(t)?i()(t.map(t=>{let[n,s]=t.split(":");if(n&&s)return{table:e,column:n,ascending:"asc"===s}})):[]}function d(e){return Array.isArray(e)?e.map(e=>{let[t,n,...s]=e.split(":"),a=s.join(":"),i=r.o.find(e=>e.abbrev===n);if(t&&n&&i)return{column:t,operator:i.value,value:a||""}}).filter(e=>void 0!==e):[]}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],{table:n,columns:s,primaryKeys:a,relationships:i}=e,r=s.map(e=>{let n={position:e.ordinal_position,name:e.name,defaultValue:e.default_value,dataType:e.data_type,format:e.format,isPrimaryKey:!1,isIdentity:e.is_identity,isGeneratable:"BY DEFAULT"==e.identity_generation,isNullable:e.is_nullable,isUpdatable:e.is_updatable,isEncrypted:t.includes(e.name),enum:e.enums,comment:e.comment,foreignKey:{targetTableSchema:null,targetTableName:null,targetColumnName:null,deletionAction:void 0}},s=a.find(t=>t.name==e.name);n.isPrimaryKey=!!s;let r=i.find(t=>t.source_schema===e.schema&&t.source_table_name===e.table&&t.source_column_name===e.name);return r&&(n.foreignKey.targetTableSchema=r.target_table_schema,n.foreignKey.targetTableName=r.target_table_name,n.foreignKey.targetColumnName=r.target_column_name,n.foreignKey.deletionAction=r.deletion_action),n});return{name:n.name,comment:n.comment,schema:n.schema,columns:r}}let m=(0,s.Z)(function(e,t,n,s){let a;if(!e.table)return;let i={gridColumns:e.gridColumns,...void 0!==n&&{sorts:n},...void 0!==s&&{filters:s}},r=h(l.E_,t),o=localStorage.getItem(r),{name:c,schema:d}=e.table,u=d&&"public"!=d?"".concat(d,".").concat(c):c;a=o?{...a=JSON.parse(o),[u]:i}:{[u]:i},localStorage.setItem(r,JSON.stringify(a))},500);function h(e,t){return"".concat(e,"_").concat(t)}},54128:function(e,t,n){"use strict";n.d(t,{O:function(){return a}});var s=n(52322);let a=()=>(0,s.jsx)("span",{className:"sb-grid-empty-value opacity-50",children:"EMPTY"})},7423:function(e,t,n){"use strict";n.d(t,{rc:function(){return r},Fy:function(){return o},OX:function(){return f.O},rE:function(){return d},q2:function(){return u},fQ:function(){return x}});var s=n(52322),a=n(14528),i=n(2784);let r=e=>{let{value:t,children:n,onEscape:r,onEnter:l}=e,o=(0,i.useRef)(null),c=(0,a.nN)(o),d=(0,i.useCallback)(e=>{switch(e.key){case"Escape":e.stopPropagation(),r&&r(t);break;case"Enter":e.stopPropagation(),!e.shiftKey&&l&&(e.preventDefault(),l(t))}},[t]);return(0,i.useEffect)(()=>{c&&void 0!==l&&l(t)},[c]),(0,s.jsx)("div",{ref:o,onKeyDown:d,children:n})};var l=n(34503);let o=e=>{let{children:t,side:n,align:a,options:i,onSelect:r}=e;return(0,s.jsxs)(l.h_,{children:[(0,s.jsx)(l.$F,{children:t}),(0,s.jsx)(l.AW,{side:n,align:a,children:(0,s.jsxs)("div",{className:"dropdown-control",style:{maxHeight:"30vh"},children:[0===i.length&&(0,s.jsx)("p",{className:"dropdown-control__empty-text",children:"No more items"}),i.map(e=>(0,s.jsx)(l.Xi,{onClick:()=>r(e.value),children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[e.preLabel&&(0,s.jsx)("span",{className:"grow text-foreground-lighter",children:e.preLabel}),(0,s.jsx)("span",{children:e.label}),e.postLabel&&(0,s.jsx)("span",{className:"text-foreground-lighter",children:e.postLabel})]})},e.value))]})})]})};var c=n(79534);let d=e=>{let{width:t,height:n,value:a,language:i,readOnly:r=!1,onChange:l,onMount:o}=e;return(0,s.jsx)(c.default,{width:t,height:n||"200px",theme:"supabase",wrapperProps:{className:"grid-monaco-editor-container"},className:"grid-monaco-editor",defaultLanguage:i||"plaintext",defaultValue:a,onChange:l,onMount:function(e){e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})});let t=e.getModel().getPositionAt(null==a?void 0:a.length);e.setPosition(t),setTimeout(()=>{null==e||e.focus()},0),o&&o(e)},options:{readOnly:r,tabSize:2,fontSize:13,minimap:{enabled:!1},glyphMargin:!1,folding:!1,lineNumbers:"off",lineNumbersMinChars:0,scrollBeyondLastLine:!1,wordWrap:"on"}})},u=()=>(0,s.jsx)("span",{className:"null-value opacity-50",children:"NULL"});function m(e,t){return e.indexOf(t)>=0}var h=n(37381),p=n(64568);function x(e){let{gridRef:t}=e,{rows:n,gridColumns:s,selectedCellPosition:a}=(0,h.Qq)(),[r,l]=i.useState("Command");return i.useEffect(()=>{var e,t;l("windows"==((null===(e=navigator)||void 0===e?void 0:e.appVersion.indexOf("Win"))!==-1?"windows":(null===(t=navigator)||void 0===t?void 0:t.appVersion.indexOf("Mac"))!==-1?"macos":"unknown")?"Control":"Command")},[]),!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],[s,a]=i.useState(),r=s=>{if(!e||m(t,s.target.nodeName)||m(n,s.target.className))return;let i=s.metaKey&&s.shiftKey?"Command+Shift+".concat(s.key):s.metaKey?"Command+".concat(s.key):s.shiftKey&&"Enter"===s.key?"Shift+".concat(s.key):s.ctrlKey&&s.key?"Control+".concat(s.key):s.key;e[i]&&(i.includes("+")?(s.preventDefault(),e[i](s),a(null)):(a(s.key),s.preventDefault()))},l=t=>{e&&e[t.key]&&s===t.key&&(t.preventDefault(),e[t.key](t),a(null))};i.useEffect(()=>(window.addEventListener("keydown",r),window.addEventListener("keyup",l),()=>{window.removeEventListener("keydown",r),window.removeEventListener("keyup",l)}))}({["".concat(r,"+ArrowUp")]:e=>{if(e.stopPropagation(),a){var n;let e={idx:null!==(n=null==a?void 0:a.idx)&&void 0!==n?n:0,rowIdx:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(0)})},["".concat(r,"+ArrowDown")]:e=>{if(e.stopPropagation(),a){var s;let e={idx:null!==(s=null==a?void 0:a.idx)&&void 0!==s?s:0,rowIdx:n.length>1?n.length-1:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(n.length)})},["".concat(r,"+ArrowLeft")]:e=>{var n;e.stopPropagation();let i={idx:s.filter(e=>e.frozen).length,rowIdx:null!==(n=null==a?void 0:a.rowIdx)&&void 0!==n?n:0};t.current.selectCell(i)},["".concat(r,"+ArrowRight")]:e=>{var n,i;e.stopPropagation(),null===(n=t.current)||void 0===n||n.selectCell({idx:s.length-1,rowIdx:null!==(i=null==a?void 0:a.rowIdx)&&void 0!==i?i:0})},["".concat(r,"+c")]:e=>{if(e.stopPropagation(),a){let{idx:e,rowIdx:r}=a;if(e>0){var t,i;let a=s[e].key,l=null!==(i=null===(t=n[r])||void 0===t?void 0:t[a])&&void 0!==i?i:"",o=(0,p.Lw)(l);(0,p.vQ)(o)}}}},["INPUT","TEXTAREA","SELECT"]),null}var f=n(54128)},825:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var s=n(52322),a=n(2784),i=n(48998),r=n(27570),l=n(74138),o=n(86305),c=n(14528),d=n(83537),u=n(32079),m=n(8504),h=n(4419),p=n(37952),x=n(37381),f=n(7423),g=n(53475);let j=[{value:100,label:"100 rows"},{value:500,label:"500 rows"},{value:1e3,label:"1000 rows"}];var v=e=>{var t,n,v;let{isLoading:y=!1}=e,b=(0,x.Qq)(),N=(0,x.I0)(),w=(0,g._2)(),_=w.page,[{filter:C}]=(0,c.x3)({arrayKeys:["filter"]}),S=(0,i.Yb)(C),k=null!==(t=b.table)&&void 0!==t?t:void 0,E=(0,d.fN)(),{project:A}=(0,r.d2)(),{data:T,isLoading:I,isSuccess:Z,isError:z}=(0,o.H)({queryKey:[null==k?void 0:k.schema,null==k?void 0:k.name,"count"],projectRef:null==A?void 0:A.ref,connectionString:null==A?void 0:A.connectionString,table:k,filters:S,impersonatedRole:E.role},{keepPreviousData:!0,onSuccess(e){N({type:"SET_ROWS_COUNT",payload:e.count})}}),P=Math.ceil((null!==(n=null==T?void 0:T.count)&&void 0!==n?n:0)/w.rowsPerPage),R=(null!==(v=null==T?void 0:T.count)&&void 0!==v?v:0)>0?P:1;(0,a.useEffect)(()=>{_&&_>R&&w.setPage(R)},[_,R]),(0,a.useEffect)(()=>{},[b.selectedRows]);let[L,O]=(0,a.useState)(!1),D=()=>{q(),N({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:new Set}})},[F,U]=(0,a.useState)(!1),M=()=>{B(),N({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:new Set}})},q=()=>{let e=_-1;w.setPage(e)},B=()=>{let e=_+1;w.setPage(e)};return(0,s.jsxs)("div",{className:"sb-grid-pagination",children:[I&&(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Loading records count..."}),Z&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.z,{icon:(0,s.jsx)(m.Z,{}),type:"outline",disabled:_<=1||I,onClick:()=>{_>1&&(b.selectedRows.size>=1?O(!0):q())},style:{padding:"3px 10px"}}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Page"}),(0,s.jsx)("div",{className:"sb-grid-pagination-input-container",children:(0,s.jsx)(h.Z,{value:_,onChange:function(e){let t=e.target.value,n=Number(t)>P?P:Number(t);w.setPage(n||1)},size:"tiny",style:{width:"3rem"},max:P,min:1})}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"of ".concat(R)}),(0,s.jsx)(u.z,{icon:(0,s.jsx)(p.Z,{}),type:"outline",disabled:_>=P||I,onClick:()=>{_<P&&(b.selectedRows.size>=1?U(!0):B())},style:{padding:"3px 10px"}}),(0,s.jsx)(f.Fy,{options:j,onSelect:function(e){let t=Number(e);w.setRowsPerPage(isNaN(t)?100:t)},side:"top",align:"start",children:(0,s.jsx)(u.z,{asChild:!0,type:"outline",style:{padding:"3px 10px"},children:(0,s.jsx)("span",{children:"".concat(w.rowsPerPage," rows")})})}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"".concat(T.count.toLocaleString()," ").concat(0===T.count||T.count>1?"records":"record")}),(0,s.jsx)(l.Z,{visible:L,title:"Confirm moving to previous page",confirmLabel:"Confirm",onCancel:()=>O(!1),onConfirm:()=>{D()},children:(0,s.jsx)("p",{className:"py-4 text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,s.jsx)(l.Z,{visible:F,title:"Confirm moving to next page",confirmLabel:"Confirm",onCancel:()=>U(!1),onConfirm:()=>{M()},children:(0,s.jsx)("p",{className:"py-4 text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})})]}),z&&(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Error fetching records count. Please refresh the page."})]})},y=n(26541),b=n(99959),N=n(38264),w=n(38069),_=e=>{let{isLoading:t,isRefetching:n}=e,{id:a}=(0,b.UO)(),i=a?Number(a):void 0,{data:r}=(0,y.Z)(i),[{view:l="data"},o]=(0,c.x3)();return(0,s.jsxs)("div",{className:"flex min-h-9 overflow-hidden items-center px-5 w-full border-t",children:["data"===l&&(0,s.jsx)(v,{isLoading:t}),(0,s.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[r&&"data"===l&&(0,s.jsx)(w.Z,{table:r,isRefetching:n}),(0,s.jsx)(N.Z,{width:75,options:["definition","data"],activeOption:l,borderOverride:"border",onClickOption:e=>{"data"===e?o({view:void 0}):o({view:e})}})]})]})}},1028:function(e,t,n){"use strict";n.d(t,{SJ:function(){return i},k3:function(){return l},_O:function(){return g},$3:function(){return j}});var s=n(52322),a=n(7423);let i=e=>{let t=e.row[e.column.key];return null===t?(0,s.jsx)(a.q2,{}):(0,s.jsx)(s.Fragment,{children:t?"TRUE":"FALSE"})};n(2784);var r=n(54128);let l=e=>{let t=e.row[e.column.key];return null===t?(0,s.jsx)(a.q2,{}):""===t?(0,s.jsx)(r.O,{}):(("object"==typeof t||Array.isArray(t))&&(t=JSON.stringify(t)),(0,s.jsx)(s.Fragment,{children:t}))};var o=n(24990),c=n(39097),d=n.n(c),u=n(32079),m=n(37952),h=n(27570),p=n(6564),x=n(57924),f=n(53475);let g=e=>{var t;let{project:n}=(0,h.d2)(),i=(0,f._2)(),{projectRef:r,tableId:l,row:c,column:g}=e,j=l?Number(l):void 0,{data:v}=(0,p.yp)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString,id:j}),y=(null!==(t=null==v?void 0:v.relationships)&&void 0!==t?t:[]).find(e=>e.source_schema===(null==v?void 0:v.schema)&&e.source_table_name===(null==v?void 0:v.name)&&e.source_column_name===g.name),{data:b}=(0,x.Bj)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString,schema:null==y?void 0:y.target_table_schema}),N=null==b?void 0:b.find(e=>e.schema===(null==y?void 0:y.target_table_schema)&&e.name===y.target_table_name),w=c[g.key];return(0,s.jsxs)("div",{className:"sb-grid-foreign-key-formatter flex justify-between",children:[(0,s.jsx)("span",{className:"sb-grid-foreign-key-formatter__text",children:null===w?(0,s.jsx)(a.q2,{}):w}),void 0!==y&&void 0!==N&&null!==w&&(0,s.jsxs)(o.fC,{delayDuration:0,children:[(0,s.jsx)(o.xz,{asChild:!0,children:(0,s.jsx)(u.z,{type:"default",size:"tiny",className:"translate-y-[2px]",onClick:()=>{},style:{padding:"3px"},asChild:!0,children:(0,s.jsx)(d(),{href:"/project/".concat(r,"/editor/").concat(null==N?void 0:N.id,"?filter=").concat(null==y?void 0:y.target_column_name,"%3Aeq%3A").concat(w),onClick:()=>i.setSelectedSchemaName(y.target_table_schema),children:(0,s.jsx)(m.Z,{size:"tiny"})})})}),(0,s.jsx)(o.h_,{children:(0,s.jsx)(o.h_,{children:(0,s.jsxs)(o.VY,{side:"bottom",children:[(0,s.jsx)(o.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"View referencing record"})})]})})})]})]})},j=e=>{let t=e.row[e.column.key];if(null===t)return(0,s.jsx)(a.q2,{});if(""===t)return(0,s.jsx)(a.OX,{});if("string"==typeof t&&t.endsWith("..."))return(0,s.jsx)(s.Fragment,{children:t});try{let e=JSON.parse(t);return(0,s.jsx)(s.Fragment,{children:JSON.stringify(e)})}catch(e){return(0,s.jsx)(s.Fragment,{children:JSON.stringify(t)})}}},98849:function(e,t,n){"use strict";n.d(t,{Lx:function(){return M},x8:function(){return f},rj:function(){return Z},F_:function(){return R}});var s=n(52322),a=n(24990),i=n(29779),r=n(68871),l=n(2784),o=n(92843),c=n(20103),d=n(56167),u=n(89689),m=n(94044),h=n(37952),p=n(37381),x=n(53120);function f(e){let{column:t,columnType:n,isPrimaryKey:f,isEncrypted:g,format:j,foreignKey:v}=e,y=l.useRef(null),b=(0,p.I0)(),N=t.idx,w=t.key,_="array"==n?"".concat(j.replace("_",""),"[]"):j,C=(0,p.Qq)(),S=t.name;(0,l.useEffect)(()=>{C.gridColumns[N].key!=w&&b({type:"UPDATE_COLUMN_IDX",payload:{columnKey:w,columnIdx:N}})},[w,N,C.gridColumns]);let[{isDragging:k},E]=(0,o.c)({type:"column-header",item:()=>({key:w,index:N}),canDrag:()=>!t.frozen,collect:e=>({isDragging:e.isDragging()})}),[{handlerId:A},T]=(0,c.L)({accept:"column-header",collect:e=>({handlerId:e.getHandlerId()}),hover(e,n){var s;if(!y.current||t.frozen)return;let a=e.index,i=e.key;if(a===N)return;let r=null===(s=y.current)||void 0===s?void 0:s.getBoundingClientRect(),l=(r.right-r.left)/2,o=n.getClientOffset().x-r.left;a<N&&o<l||a>N&&o>l||(I(i,w),e.index=N)}}),I=(e,t)=>{e!=t&&b({type:"MOVE_COLUMN",payload:{fromKey:e,toKey:t}})},Z=t.frozen?"sb-grid-column-header--cursor":"";return E(T(y)),(0,s.jsx)("div",{ref:y,"data-handler-id":A,style:{opacity:k?0:1},className:"w-full",children:(0,s.jsxs)("div",{className:"sb-grid-column-header ".concat(Z),children:[(0,s.jsxs)("div",{className:"sb-grid-column-header__inner",children:[function(e,t){let{name:n,foreignKey:l}=t;return"foreign_key"===e?(0,s.jsxs)(a.fC,{delayDuration:0,children:[(0,s.jsx)(a.xz,{children:(0,s.jsx)(m.Z,{size:"tiny",strokeWidth:2})}),(0,s.jsx)(a.h_,{children:(0,s.jsxs)(a.VY,{side:"bottom",children:[(0,s.jsx)(a.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"Foreign key relation:"}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("p",{className:"text-xs text-foreground",children:n}),(0,s.jsx)(h.Z,{size:"tiny",strokeWidth:1.5}),(0,s.jsxs)("p",{className:"text-xs text-foreground",children:[null==l?void 0:l.targetTableSchema,".",null==l?void 0:l.targetTableName,".",null==l?void 0:l.targetColumnName]})]}),(null==l?void 0:l.deletionAction)!==r.N.NO_ACTION&&(0,s.jsxs)("p",{className:"text-xs text-foreground mt-1",children:["On delete: ",(0,i.s8)(null==l?void 0:l.deletionAction)]})]})})]})})]}):null}(n,{name:t.name,foreignKey:v}),f&&(0,s.jsxs)(a.fC,{delayDuration:0,children:[(0,s.jsx)(a.xz,{children:(0,s.jsx)("div",{className:"sb-grid-column-header__inner__primary-key",children:(0,s.jsx)(d.Z,{size:"tiny",strokeWidth:2})})}),(0,s.jsx)(a.h_,{children:(0,s.jsxs)(a.VY,{side:"bottom",children:[(0,s.jsx)(a.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"Primary key"})})]})})]}),(0,s.jsx)("span",{className:"sb-grid-column-header__inner__name",title:S,children:t.name}),(0,s.jsx)("span",{className:"sb-grid-column-header__inner__format",children:_}),g&&(0,s.jsxs)(a.fC,{delayDuration:0,children:[(0,s.jsx)(a.xz,{children:(0,s.jsx)(u.Z,{size:"tiny",strokeWidth:2})}),(0,s.jsx)(a.h_,{children:(0,s.jsxs)(a.VY,{side:"bottom",children:[(0,s.jsx)(a.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"Encrypted column"})})]})})]})]}),(0,s.jsx)(x.ov,{column:t,isEncrypted:g})]})})}var g=n(79147),j=n(47370);n(72452);var v=n(64018),y=n(32079),b=n(64568),N=n(27570),w=n(56006),_=n(41679),C=n(75153),S=n(14528),k=n(82667),E=n(71623);function A(e,t){let{show:n}=(0,E.av)();return(0,s.jsx)(j.X2,{...t,onContextMenu:function(e){n(e,{id:x.ep,props:{rowIdx:t.rowIdx}})}},e)}let T=e=>{var t;return null!==(t=null==e?void 0:e.idx)&&void 0!==t?t:-1},I=(0,g.Z)((e,t,n)=>{n({type:"UPDATE_COLUMN_SIZE",payload:{index:e,width:Math.round(t)}})},500),Z=(0,v.X$)((0,l.forwardRef)((e,t)=>{var n;let{width:a,height:i,containerClass:r,gridClass:o,rowClass:c,rows:d,error:u,isLoading:m,isSuccess:h,isError:x,filters:f,setParams:g,updateRow:v,onAddRow:E,onImportData:Z,onEditForeignKeyColumnValue:z}=e,P=(0,p.I0)(),R=(0,p.Qq)();async function L(e,t){let n=e[t.indexes[0]],s=d.find(e=>e.idx==n.idx),a=Object.keys(n).find(e=>n[e]!==s[e]);a&&v(s,{[a]:n[a]})}let O=(0,l.useRef)(null);function D(){var e,t,n;let s=null===(n=O.current)||void 0===n?void 0:n.row[null===(t=O.current)||void 0===t?void 0:null===(e=t.column)||void 0===e?void 0:e.key],a=(0,b.Lw)(s);a&&(0,k.vQ)(a)}(0,S.aL)({"Command+c":e=>{e.stopPropagation(),D()},"Control+c":e=>{e.stopPropagation(),D()}},["INPUT","TEXTAREA"]);let F=R.table,{project:U}=(0,N.d2)(),{data:M}=(0,C.X)({projectRef:null==U?void 0:U.ref,connectionString:null==U?void 0:U.connectionString,schema:null!==(n=null==F?void 0:F.schema)&&void 0!==n?n:void 0}),q=()=>{g(e=>({...e,filter:[]}))};return(0,s.jsx)("div",{className:"".concat(r," flex flex-col"),style:{width:a||"100%",height:i||"50vh"},children:(0,s.jsx)(j.ZP,{ref:t,className:"".concat(o," flex-grow"),rowClass:c,columns:R.gridColumns,rows:null!=d?d:[],renderers:{renderRow:A,noRowsFallback:(0,s.jsxs)("div",{style:{width:"calc(100vw - 255px - 55px)"},children:[m&&(0,s.jsx)("div",{className:"p-2 col-span-full",children:(0,s.jsx)(_.A,{})}),x&&(0,s.jsx)("div",{className:"p-2 col-span-full",children:(0,s.jsx)(w.Z,{error:u,subject:"Failed to retrieve rows from table"})}),h&&(0,s.jsx)(s.Fragment,{children:0===(null!=f?f:[]).length?(0,s.jsxs)("div",{style:{height:"calc(100% - 35px)"},className:"flex flex-col items-center justify-center col-span-full",children:[(0,s.jsx)("p",{className:"text-sm text-light",children:"This table is empty"}),void 0!==E&&void 0!==Z&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-sm text-light mt-1",children:"Add rows to your table to get started."}),(0,s.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:void 0!==E&&void 0!==Z&&(0,s.jsx)(y.z,{type:"default",onClick:Z,children:"Import data via CSV"})})]})]}):(0,s.jsxs)("div",{style:{height:"calc(100% - 35px)"},className:"flex flex-col items-center justify-center col-span-full",children:[(0,s.jsx)("p",{className:"text-sm text-light",children:"The filters applied has returned no results from this table"}),(0,s.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:(0,s.jsx)(y.z,{type:"default",onClick:()=>q(),children:"Remove all filters"})})]})})]})},rowKeyGetter:T,selectedRows:R.selectedRows,onColumnResize:function(e,t){I(e,t,P)},onRowsChange:L,onSelectedCellChange:function(e){O.current=e,P({type:"SELECTED_CELL_CHANGE",payload:{position:{idx:e.column.idx,rowIdx:e.rowIdx}}})},onSelectedRowsChange:function(e){P({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:e}})},onCellDoubleClick:e=>(function(e,t){let n=function(e){var t,n;let{targetTableSchema:s,targetTableName:a,targetColumnName:i}=null!==(n=null==F?void 0:null===(t=F.columns.find(t=>t.name==e))||void 0===t?void 0:t.foreignKey)&&void 0!==n?n:{};return null==M?void 0:M.find(e=>e.target_schema==s&&e.target_table==a&&e.target_columns==i)}(t.name);n&&z({foreignKey:n,row:e,column:t})})(e.row,e.column)})})}));var z=n(4582),P=n(87115);let R={key:P.W,name:"",idx:0,width:65,maxWidth:65,resizable:!1,sortable:!1,frozen:!0,isLastFrozenColumn:!1,renderHeaderCell:e=>{let[t,n]=(0,j.Gt)();return(0,s.jsx)(D,{"aria-label":"Select All",tabIndex:e.tabIndex,value:t,onChange:e=>n({type:"HEADER",checked:e})})},renderCell:e=>{let[t,n]=(0,j.Gt)();return(0,s.jsx)(O,{"aria-label":"Select",tabIndex:e.tabIndex,value:t,row:e.row,onChange:(t,s)=>{n({type:"ROW",row:e.row,checked:t,isShiftClick:s})},onClick:L})},renderGroupCell:e=>{let[t,n]=(0,j.Gt)();return(0,s.jsx)(O,{"aria-label":"Select Group",tabIndex:e.tabIndex,value:t,onChange:t=>{n({type:"ROW",row:e.row,checked:t,isShiftClick:!1})},onClick:L})},parent:void 0,level:0,minWidth:0,draggable:!1};function L(e){e.stopPropagation()}function O(e){let{row:t,value:n,tabIndex:i,disabled:r,onClick:l,onChange:o,"aria-label":c,"aria-labelledby":d}=e,{onEditRow:u}=(0,p.Qq)();return(0,s.jsxs)("div",{className:"sb-grid-select-cell__formatter",children:[(0,s.jsx)("input",{"aria-label":c,"aria-labelledby":d,tabIndex:i,type:"checkbox",className:"rdg-row__select-column__select-action",disabled:r,checked:n,onChange:function(e){o(e.target.checked,e.nativeEvent.shiftKey)},onClick:l}),u&&t&&(0,s.jsxs)(a.fC,{delayDuration:0,children:[(0,s.jsx)(a.xz,{asChild:!0,children:(0,s.jsx)(y.z,{type:"text",size:"tiny",className:"rdg-row__select-column__edit-action",icon:(0,s.jsx)(z.Z,{size:"tiny",strokeWidth:1.5,className:"text-foreground"}),onClick:function(e){e.stopPropagation(),u&&t&&u(t)},style:{padding:"3px"}})}),(0,s.jsx)(a.h_,{children:(0,s.jsxs)(a.VY,{side:"bottom",children:[(0,s.jsx)(a.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"Expand row"})})]})})]})]})}function D(e){let{disabled:t,tabIndex:n,value:a,onChange:i,onClick:r,"aria-label":l,"aria-labelledby":o}=e;return(0,s.jsx)("div",{className:"sb-grid-select-cell__header",children:(0,s.jsx)("input",{"aria-label":l,"aria-labelledby":o,tabIndex:n,type:"checkbox",className:"sb-grid-select-cell__header__input",disabled:t,checked:a,onChange:function(e){i(e.target.checked,e.nativeEvent.shiftKey)},onClick:r})})}var F=n(31654),U=n(1028);let M={key:P.uZ,name:"",idx:999,width:100,maxWidth:100,resizable:!1,sortable:!1,frozen:!1,isLastFrozenColumn:!1,renderHeaderCell:()=>(0,s.jsx)(q,{"aria-label":"Add New Row"}),renderCell:U.k3,parent:void 0,level:0,minWidth:0,draggable:!1},q=e=>{let{}=e,{onAddColumn:t}=(0,p.Qq)();return(0,s.jsx)("div",{className:"sb-grid-add-column",children:(0,s.jsx)(y.z,{block:!0,type:"text",onClick:t,icon:(0,s.jsx)(F.Z,{})})})}},38069:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var s=n(52322),a=n(85945),i=n(66760),r=n(18545),l=n(2784),o=n(32079);let c=new(n(10978)).Z({concurrency:1});var d=n(44446),u=n(76141),m=e=>{let{table:t,isRefetching:n}=e,{ref:m}=(0,i.UO)(),h=(0,a.NL)(),p=r.M.query(m,[t.schema,t.name]),[x,f]=(0,l.useState)();async function g(){await h.invalidateQueries(p)}return(0,l.useEffect)(()=>{let e,t=!0;return c.on("active",()=>{e&&clearTimeout(e),t&&f("saving")}),c.on("idle",()=>{e&&clearTimeout(e),e=window.setTimeout(()=>f(void 0),2e3),t&&f("saved")}),()=>{t=!1,e&&clearTimeout(e)}},[]),(0,s.jsx)(o.z,{type:"text",icon:x?"saved"===x?(0,s.jsx)(u.Z,{className:"text-brand",strokeWidth:3}):(0,s.jsx)(s.Fragment,{}):(0,s.jsx)(d.Z,{className:"text-foreground-muted",strokeWidth:1.5}),onClick:()=>{x||g()},loading:n||"saving"===x,children:x?"saved"===x?"Changes saved":"Saving changes":"Refresh"})}},50317:function(e,t,n){"use strict";n.d(t,{o:function(){return p},E:function(){return y}});var s=n(52322),a=n(14819),i=n.n(a),r=n(18149),l=n.n(r),o=n(23915),c=n(89404),d=n(2784),u=n(48998),m=n(61786),h=n(32079);let p=[{value:"=",label:"equals",preLabel:"[ = ]",abbrev:"eq"},{value:"<>",label:"not equal",preLabel:"[ <> ]",abbrev:"neq"},{value:">",label:"greater than",preLabel:"[ > ]",abbrev:"gt"},{value:"<",label:"less than",preLabel:"[ < ]",abbrev:"lt"},{value:">=",label:"greater than or equal",preLabel:"[ >= ]",abbrev:"gte"},{value:"<=",label:"less than or equal",preLabel:"[ <= ]",abbrev:"lte"},{value:"~~",label:"like operator",preLabel:"[ ~~ ]",abbrev:"like"},{value:"~~*",label:"ilike operator",preLabel:"[ ~~* ]",abbrev:"ilike"},{value:"in",label:"one of a list of values",preLabel:"[ in ]",abbrev:"in"},{value:"is",label:"checking for (null,not null,true,false)",preLabel:"[ is ]",abbrev:"is"}];var x=n(43687),f=n(750),g=n(7423),j=n(8609),v=(0,d.memo)(e=>{var t,n;let{table:a,filter:i,filterIdx:r,onChange:l,onDelete:o,onKeyDown:c}=e,d=a.columns.find(e=>e.name===i.column),u=(null===(t=a.columns)||void 0===t?void 0:t.map(e=>({value:e.name,label:e.name,postLabel:e.dataType})))||[],m=(null==d?void 0:d.format)==="timestamptz"?"yyyy-mm-dd hh:mm:ss+zz":(null==d?void 0:d.format)==="timestamp"?"yyyy-mm-dd hh:mm:ss":"Enter a value";return(0,s.jsxs)("div",{className:"flex w-full items-center justify-between gap-x-1 px-3",children:[(0,s.jsx)(g.Fy,{align:"start",options:u,onSelect:e=>l(r,{...i,column:e}),children:(0,s.jsx)(h.z,{asChild:!0,type:"outline",icon:(0,s.jsx)("div",{className:"text-foreground-lighter",children:(0,s.jsx)(x.Z,{strokeWidth:1.5,size:14})}),className:"w-32 justify-start",children:(0,s.jsx)("span",{children:null!==(n=null==d?void 0:d.name)&&void 0!==n?n:""})})}),(0,s.jsx)(g.Fy,{align:"start",options:p,onSelect:e=>l(r,{...i,operator:e}),children:(0,s.jsx)(h.z,{asChild:!0,type:"outline",icon:(0,s.jsx)("div",{className:"text-foreground-lighter",children:(0,s.jsx)(x.Z,{strokeWidth:1.5,size:14})}),children:(0,s.jsx)("span",{children:i.operator})})}),(0,s.jsx)(f.Z,{size:"tiny",className:"w-full",placeholder:m,value:i.value,onChange:e=>l(r,{...i,value:e.target.value}),onKeyDown:c}),(0,s.jsx)(h.z,{type:"text",className:"px-1",icon:(0,s.jsx)(j.Z,{strokeWidth:1.5,size:14}),onClick:()=>o(r)})]})}),y=e=>{let{table:t,filters:n,setParams:a}=e,[i,r]=(0,d.useState)(!1),l=(n||[]).length>0?"Filtered by ".concat(n.length," rule").concat(n.length>1?"s":""):"Filter";return(0,s.jsxs)(m.J2,{open:i,onOpenChange:r,modal:!1,children:[(0,s.jsx)(m.xo,{asChild:!0,children:(0,s.jsx)(h.z,{type:(n||[]).length>0?"link":"text",icon:(0,s.jsx)(o.Z,{strokeWidth:1.5,className:"text-foreground-light"}),children:l})}),(0,s.jsx)(m.yk,{className:"p-0 w-96",side:"bottom",align:"start",children:(0,s.jsx)(b,{table:t,filters:n,onApplyFilters:e=>{a(t=>({...t,filter:e.map(e=>{let t=p.find(t=>t.value===e.operator);return"".concat(e.column,":").concat(null==t?void 0:t.abbrev,":").concat(e.value)})}))}})})]})};let b=e=>{let{table:t,filters:n,onApplyFilters:a}=e,r=(0,d.useMemo)(()=>(0,u.Yb)(null!=n?n:[]),[n]),[o,p]=(0,d.useState)(r),x=(0,d.useCallback)((e,t)=>{p(n=>i()(n,{[e]:{$set:t}}))},[]),f=(0,d.useCallback)(e=>{p(t=>i()(t,{$splice:[[e,1]]}))},[]);function g(e){"Enter"===e.key&&a(o)}return(0,s.jsxs)("div",{className:"space-y-2 py-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[o.map((e,n)=>(0,s.jsx)(v,{table:t,filter:e,filterIdx:n,onChange:x,onDelete:f,onKeyDown:g},"filter-".concat(e.column,"-").concat([n]))),0==o.length&&(0,s.jsxs)("div",{className:"space-y-1 px-3",children:[(0,s.jsx)("h5",{className:"text-sm text-foreground-light",children:"No filters applied to this view"}),(0,s.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Add a column below to filter the view"})]})]}),(0,s.jsx)(m.Fm,{}),(0,s.jsxs)("div",{className:"px-3 flex flex-row justify-between",children:[(0,s.jsx)(h.z,{icon:(0,s.jsx)(c.Z,{}),type:"text",onClick:function(){var e;let n=null===(e=t.columns[0])||void 0===e?void 0:e.name;n&&p([...o,{column:n,operator:"=",value:""}])},children:"Add filter"}),(0,s.jsx)(h.z,{disabled:l()(o,r),type:"default",onClick:()=>a(o),children:"Apply filter"})]})]})}},54664:function(e,t,n){"use strict";n.d(t,{f:function(){return w}});var s=n(52322),a=n(14819),i=n.n(a),r=n(18149),l=n.n(r),o=n(54026),c=n(78232),d=n(2784),u=n(48998),m=n(7423),h=n(61786),p=n(32079),x=n(92843),f=n(20103),g=n(94570),j=n(2515),v=function(e){return(0,s.jsx)(j.Z,{icon:g.Z,...e})},y=n(22854),b=n(61373),N=(0,d.memo)(e=>{let{table:t,index:n,columnName:a,sort:i,onDelete:r,onToggle:l,onDrag:o}=e,c=t.columns.find(e=>e.name===a),u=(0,d.useRef)(null),[{isDragging:m},h]=(0,x.c)({type:"sort-row",item:()=>({key:a,index:n}),collect:e=>({isDragging:e.isDragging()})}),[{handlerId:g},j]=(0,f.L)({accept:"sort-row",collect:e=>({handlerId:e.getHandlerId()}),hover(e,t){var s;if(!u.current)return;let a=e.index;if(a===n)return;let i=null===(s=u.current)||void 0===s?void 0:s.getBoundingClientRect(),r=(i.bottom-i.top)/2,l=t.getClientOffset().y-i.top;a<n&&l<r||a>n&&l>r||(N(a,n),e.index=n)}}),N=(e,t)=>{e!=t&&o(e,t)};return(h(j(u)),c)?(0,s.jsxs)("div",{className:"flex items-center gap-3 px-3",ref:u,style:{opacity:m?0:1},"data-handler-id":g,children:[(0,s.jsx)("span",{className:"transition-color text-foreground-lighter hover:text-foreground-light",children:(0,s.jsx)(v,{strokeWidth:2,size:16})}),(0,s.jsx)("div",{className:"grow",children:(0,s.jsxs)("span",{className:"flex grow items-center gap-1 truncate text-sm text-foreground",children:[(0,s.jsx)("span",{className:"text-xs text-foreground-lighter",children:n>0?"then by":"sort by"}),c.name]})}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("label",{className:"text-xs text-foreground-lighter",children:"ascending:"}),(0,s.jsx)(y.Z,{size:"tiny",layout:"flex",defaultChecked:i.ascending,onChange:e=>l(a,e)})]}),(0,s.jsx)(p.z,{icon:(0,s.jsx)(b.Z,{strokeWidth:1.5,size:14}),size:"tiny",type:"text",onClick:()=>r(a)})]}):null}),w=e=>{let{table:t,sorts:n,setParams:a}=e,[i,r]=(0,d.useState)(!1),l=(n||[]).length>0?"Sorted by ".concat(n.length," rule").concat(n.length>1?"s":""):"Sort";return(0,s.jsxs)(h.J2,{modal:!1,open:i,onOpenChange:r,children:[(0,s.jsx)(h.xo,{asChild:!0,children:(0,s.jsx)(p.z,{type:(n||[]).length>0?"link":"text",icon:(0,s.jsx)(o.Z,{strokeWidth:1.5,className:"text-foreground-light"}),children:l})}),(0,s.jsx)(h.yk,{className:"p-0 w-96",side:"bottom",align:"start",children:(0,s.jsx)(_,{table:t,sorts:n,onApplySorts:e=>{a(t=>({...t,sort:e.map(e=>"".concat(e.column,":").concat(e.ascending?"asc":"desc"))}))}})})]})};let _=e=>{let{table:t,sorts:n,onApplySorts:a}=e,r=(0,d.useMemo)(()=>(0,u.rg)(t.name,null!=n?n:[]),[t.name,n]),[o,x]=(0,d.useState)(r),f=t.columns.filter(e=>!o.find(t=>t.column==e.name)),g=(null==f?void 0:f.map(e=>({value:e.name,label:e.name})))||[],j=(0,d.useCallback)(e=>{x(t=>t.filter(t=>t.column!==e))},[]),v=(0,d.useCallback)((e,t)=>{x(n=>{let s=n.findIndex(t=>t.column===e);return i()(n,{[s]:{$merge:{ascending:t}}})})},[]),y=(0,d.useCallback)((e,t)=>{x(n=>i()(n,{$splice:[[e,1],[t,0,n[e]]]}))},[]);return(0,s.jsxs)("div",{className:"space-y-2 py-2",children:[o.map((e,n)=>(0,s.jsx)(N,{table:t,index:n,columnName:e.column,sort:e,onDelete:j,onToggle:v,onDrag:y},e.column)),0===o.length&&(0,s.jsxs)("div",{className:"space-y-1 px-3",children:[(0,s.jsx)("h5",{className:"text-sm text-foreground-light",children:"No sorts applied to this view"}),(0,s.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Add a column below to sort the view"})]}),(0,s.jsx)(h.Fm,{}),(0,s.jsxs)("div",{className:"px-3 flex flex-row justify-between",children:[f&&f.length>0?(0,s.jsx)(m.Fy,{options:g,onSelect:function(e){x([...o,{table:t.name,column:e,ascending:!0}])},side:"bottom",align:"start",children:(0,s.jsxs)(p.z,{type:"text",iconRight:(0,s.jsx)(c.Z,{size:"14",className:"text-foreground-light"}),className:"sb-grid-dropdown__item-trigger",children:["Pick ",o.length>1?"another":"a"," column to sort by"]})}):(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"All columns have been added"}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(p.z,{disabled:l()(o,r),type:"default",onClick:()=>a(o),children:"Apply sorting"})})]})]})}},53120:function(e,t,n){"use strict";n.d(t,{ov:function(){return g},ep:function(){return w},q4:function(){return N}});var s=n(52322),a=n(24990),i=n(34503),r=n(74559),l=n(2784),o=n(92795),c=n(2515),d=function(e){return(0,s.jsx)(c.Z,{icon:o.Z,...e})},u=n(89689),m=n(95392),h=n(62134),p=n(32079),x=n(43687),f=n(37381),g=e=>{let{column:t,isEncrypted:n}=e,l=(0,f.Qq)(),o=(0,f.I0)(),{onEditColumn:c,onDeleteColumn:g}=l,j=t.key;function v(){c&&c(j)}function y(){g&&g(j)}return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(i.h_,{children:[(0,s.jsx)(i.$F,{asChild:!0,children:(0,s.jsx)(p.z,{className:"opacity-50 flex",type:"text",style:{padding:"3px"},children:(0,s.jsx)(x.Z,{})})}),(0,s.jsx)(i.AW,{align:"end",side:"bottom",children:(0,s.jsxs)(s.Fragment,{children:[l.editable&&void 0!==v&&(0,s.jsxs)(a.fC,{delayDuration:0,children:[(0,s.jsx)(a.xz,{asChild:!0,className:"".concat(n?"opacity-50":""),children:(0,s.jsxs)(i.Xi,{className:"space-x-2",onClick:v,disabled:n,children:[(0,s.jsx)(r.Z,{size:"tiny"}),(0,s.jsx)("p",{children:"Edit column"})]})}),n&&(0,s.jsx)(a.h_,{children:(0,s.jsxs)(a.VY,{side:"bottom",children:[(0,s.jsx)(a.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"Encrypted columns cannot be edited"})})]})})]}),(0,s.jsx)(i.Xi,{className:"space-x-2",onClick:t.frozen?function(){o({type:"UNFREEZE_COLUMN",payload:{columnKey:j}})}:function(){o({type:"FREEZE_COLUMN",payload:{columnKey:j}})},children:t.frozen?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d,{size:"tiny"}),(0,s.jsx)("p",{children:"Unfreeze column"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{size:"tiny"}),(0,s.jsx)("p",{children:"Freeze column"})]})}),l.editable&&void 0!==y&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Z,{}),(0,s.jsxs)(i.Xi,{className:"space-x-2",onClick:y,children:[(0,s.jsx)(h.Z,{size:"tiny",stroke:"red"}),(0,s.jsx)("p",{children:"Delete column"})]})]})]})})]})})},j=n(71623),v=n(54506),y=n(53475),b=n(64568),N=e=>{let{rows:t}=e,n=(0,f.Qq)(),a=(0,y._2)();function i(e){let{data:t}=e;return"edit"===t?void 0==n.onEditRow:"delete"===t&&!n.editable}let o=(0,l.useCallback)(e=>{var s;let{props:a}=e;if(!n.selectedCellPosition||!a)return;let{rowIdx:i}=a,r=t[i][n.gridColumns[null===(s=n.selectedCellPosition)||void 0===s?void 0:s.idx].key],l=(0,b.Lw)(r);(0,b.vQ)(l)},[t,n.gridColumns,n.selectedCellPosition]);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(j.v2,{id:w,animation:!1,children:[(0,s.jsxs)(j.ck,{onClick:o,children:[(0,s.jsx)(v.Z,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Copy cell content"})]}),(0,s.jsxs)(j.ck,{onClick:function(e){let{props:s}=e,{rowIdx:a}=s,i=t[a];n.onEditRow&&n.onEditRow(i)},hidden:i,data:"edit",children:[(0,s.jsx)(r.Z,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Edit row"})]}),n.editable&&(0,s.jsx)(j.Z0,{}),(0,s.jsxs)(j.ck,{onClick:function(e){let{props:n}=e,{rowIdx:s}=n,i=t[s];i&&a.onDeleteRows([i])},hidden:i,data:"delete",children:[(0,s.jsx)(h.Z,{size:"tiny",stroke:"red"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Delete row"})]})]})})};let w="row-context-menu-id"},87115:function(e,t,n){"use strict";n.d(t,{E_:function(){return a},Vz:function(){return i},W:function(){return l},ZR:function(){return r},jg:function(){return c},mr:function(){return s},uZ:function(){return o}});let s=100,a="supabase_grid",i=-1,r=-2,l="supabase-grid-select-row",o="supabase-grid-add-column",c="Please add a primary key column to your table to update or delete rows"},69960:function(e,t,n){"use strict";n.d(t,{AE:function(){return V.A},zB:function(){return H},NK:function(){return p.NK}});var s=n(52322),a=n(2784),i=n(28846),r=n(52797),l=n(28316),o=n(99959),c=n(27570),d=n(57142),u=n(14528),m=n(83537),h=n(53475),p=n(48998),x=n(7423),f=n(825),g=n(98849),j=n(24990),v=n(59491),y=n(6277),b=n(46782),N=n.n(b),w=n(78232),_=n(53020),C=n(54813),S=n(8609),k=n(17913),E=n(3536),A=n(90286),T=n.n(A),I=n(62202),Z=n(37381),z=n(86305),P=n(34503),R=n(32079),L=n(54383),O=n(50317),D=n(54664),F=e=>{let{table:t,sorts:n,filters:a,onAddColumn:i,onAddRow:r,onImportData:l,headerActions:o,customHeader:c}=e,{selectedRows:d}=(0,Z.Qq)();return(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex h-10 items-center justify-between bg-surface-100 px-5 py-1.5",children:[c?(0,s.jsx)(s.Fragment,{children:c}):(0,s.jsx)(s.Fragment,{children:d.size>0?(0,s.jsx)(M,{table:t,sorts:n,filters:a}):(0,s.jsx)(U,{table:t,onAddColumn:i,onAddRow:r,onImportData:l})}),(0,s.jsx)("div",{className:"sb-grid-header__inner",children:o})]})})};let U=e=>{let{table:t,onAddColumn:n,onAddRow:a,onImportData:i}=e,r=(0,u.Xo)(v.KA.TENANT_SQL_ADMIN_WRITE,"columns"),[{filter:l,sort:o},c]=(0,u.x3)({arrayKeys:["sort","filter"]});return(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(O.E,{table:t,filters:l,setParams:c}),(0,s.jsx)(D.f,{table:t,sorts:o,setParams:c})]}),(void 0!==a||void 0!==n)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-[20px] w-px border-r border-control"}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:r&&(0,s.jsxs)(P.h_,{children:[(0,s.jsx)(P.$F,{asChild:!0,children:(0,s.jsx)(R.z,{"data-testid":"table-editor-insert-new-row",type:"primary",size:"tiny",icon:(0,s.jsx)(w.Z,{strokeWidth:1.5}),children:"Insert"})}),(0,s.jsx)(P.AW,{side:"bottom",align:"start",children:[...void 0!==a?[(0,s.jsxs)(P.Xi,{className:"group space-x-2",onClick:a,children:[(0,s.jsxs)("div",{className:"-mt-2 pr-1.5",children:[(0,s.jsx)("div",{className:"border border-foreground-lighter w-[15px] h-[4px]"}),(0,s.jsx)("div",{className:"border border-foreground-lighter w-[15px] h-[4px] my-[2px]"}),(0,s.jsx)("div",{className:(0,L.cn)(["border border-foreground-light w-[15px] h-[4px] translate-x-0.5","transition duration-200 group-data-[highlighted]:border-brand group-data-[highlighted]:translate-x-0"])})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:"Insert row"}),(0,s.jsxs)("p",{className:"text-foreground-light",children:["Insert a new row into ",t.name]})]})]},"add-row")]:[],...void 0!==n?[(0,s.jsxs)(P.Xi,{className:"group space-x-2",onClick:n,children:[(0,s.jsxs)("div",{className:"flex -mt-2 pr-1.5",children:[(0,s.jsx)("div",{className:"border border-foreground-lighter w-[4px] h-[15px]"}),(0,s.jsx)("div",{className:"border border-foreground-lighter w-[4px] h-[15px] mx-[2px]"}),(0,s.jsx)("div",{className:(0,L.cn)(["border border-foreground-light w-[4px] h-[15px] -translate-y-0.5","transition duration-200 group-data-[highlighted]:border-brand group-data-[highlighted]:translate-y-0"])})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:"Insert column"}),(0,s.jsxs)("p",{className:"text-foreground-light",children:["Insert a new column into ",t.name]})]})]},"add-column")]:[],...void 0!==i?[(0,s.jsxs)(P.Xi,{className:"group space-x-2",onClick:i,children:[(0,s.jsxs)("div",{className:"relative -mt-2",children:[(0,s.jsx)(_.Z,{size:18,strokeWidth:1.5,className:"-translate-x-[2px]"}),(0,s.jsx)(C.Z,{className:(0,y.default)("transition duration-200 absolute bottom-0 right-0 translate-y-1 opacity-0 bg-brand-400 rounded-full","group-data-[highlighted]:translate-y-0 group-data-[highlighted]:text-brand group-data-[highlighted]:opacity-100"),strokeWidth:3,size:12})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:"Import data from CSV"}),(0,s.jsx)("p",{className:"text-foreground-light",children:"Insert new rows from a CSV"})]})]},"import-data")]:[]]})]})})]})]})},M=e=>{var t,n;let{table:i,sorts:r,filters:l}=e,o=(0,Z.Qq)(),u=(0,Z.I0)(),{project:p}=(0,c.d2)(),x=(0,h._2)(),f=(0,m.fN)(),g=void 0!==f.role,[v,y]=(0,a.useState)(!1),{data:b}=(0,d.KK)({queryKey:[i.schema,i.name],projectRef:null==p?void 0:p.ref,connectionString:null==p?void 0:p.connectionString,table:i,sorts:r,filters:l,page:x.page,limit:x.rowsPerPage,impersonatedRole:f.role}),{data:w}=(0,z.H)({queryKey:[null==i?void 0:i.schema,null==i?void 0:i.name,"count"],projectRef:null==p?void 0:p.ref,connectionString:null==p?void 0:p.connectionString,table:i,filters:l,impersonatedRole:f.role},{keepPreviousData:!0}),_=()=>{u({type:"SELECT_ALL_ROWS",payload:{selectedRows:new Set(P.map(e=>e.idx))}})};async function C(){if(y(!0),F&&L>5e5)return I.ZP.error("Sorry! We're unable to support exporting of CSV for row counts larger than ".concat(5e5.toLocaleString()," at the moment.")),y(!1);if(!p)return I.ZP.error("Project is required"),y(!1);let e=(F?await (0,d.wF)({projectRef:p.ref,connectionString:p.connectionString,table:i,filters:l,sorts:r,impersonatedRole:f.role}):P.filter(e=>O.has(e.idx))).map(e=>(Object.keys(e).map(t=>{"object"==typeof e[t]&&null!==e[t]&&(e[t]=JSON.stringify(e[t]))}),e)),t=new Blob([T().unparse(e,{columns:o.table.columns.map(e=>e.name)})],{type:"text/csv;charset=utf-8;"});N()(t,"".concat(o.table.name,"_rows.csv")),y(!1)}function A(){u({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:new Set}})}let P=null!==(t=null==b?void 0:b.rows)&&void 0!==t?t:[],L=null!==(n=null==w?void 0:w.count)&&void 0!==n?n:0,{selectedRows:O,editable:D,allRowsSelected:F}=o;return(0,m.gv)(()=>{(F||O.size>0)&&A()}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(R.z,{type:"default",className:"px-1",icon:(0,s.jsx)(S.Z,{}),onClick:A}),(0,s.jsx)("span",{className:"text-xs text-foreground",children:F?"".concat(L," rows selected"):O.size>1?"".concat(O.size," rows selected"):"".concat(O.size," row selected")}),!F&&L>P.length&&(0,s.jsxs)(R.z,{type:"link",onClick:()=>_(),children:["Select all ",L," rows"]})]}),(0,s.jsx)("div",{className:"h-[20px] border-r border-strong"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(R.z,{type:"primary",size:"tiny",icon:(0,s.jsx)(k.Z,{}),loading:v,disabled:v,onClick:C,children:"Export to CSV"}),D&&(0,s.jsxs)(j.fC,{delayDuration:0,children:[(0,s.jsx)(j.xz,{asChild:!0,children:(0,s.jsx)(R.z,{type:"default",size:"tiny",icon:(0,s.jsx)(E.Z,{}),onClick:()=>{let e=F?L:O.size,t=Array.from(O),n=P.filter(e=>t.includes(e.idx));x.onDeleteRows(n,{allRowsSelected:F,numRows:e,callback:()=>{u({type:"REMOVE_ROWS",payload:{rowIdxs:t}}),u({type:"SELECTED_ROWS_CHANGE",payload:{selectedRows:new Set}})}})},disabled:F&&g,children:F?"Delete ".concat(L," rows"):O.size>1?"Delete ".concat(O.size," rows"):"Delete ".concat(O.size," row")})}),F&&g&&(0,s.jsx)(j.h_,{children:(0,s.jsxs)(j.VY,{side:"bottom",children:[(0,s.jsx)(j.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"Table truncation is not supported when impersonating a role"})})]})})]})]})]})};var q=n(53120),B=n(87115),W=n(782);async function G(e,t,n,s,a){var i,r;let l=e.projectRef?function(e,t,n){let s=(0,p.x4)(B.E_,e),a=localStorage.getItem(s);if(a)return JSON.parse(a)[n&&"public"!=n?"".concat(n,".").concat(t):t]}(e.projectRef,e.table.name,e.table.schema):void 0;if(!t.isInitialComplete&&void 0===s&&void 0===a&&((null==l?void 0:l.sorts)||(null==l?void 0:l.filters)))return{savedState:{sorts:l.sorts,filters:l.filters}};let o=(0,W.cv)(e.table,{projectRef:e.projectRef,tableId:e.tableId,editable:e.editable,defaultWidth:null===(i=e.gridProps)||void 0===i?void 0:i.defaultColumnWidth,onAddColumn:e.editable?e.onAddColumn:void 0,onExpandJSONEditor:e.onExpandJSONEditor,onExpandTextEditor:e.onExpandTextEditor});return n({type:"INIT_TABLE",payload:{table:e.table,gridProps:e.gridProps,gridColumns:o,savedState:l,editable:e.editable,onError:null!==(r=e.onError)&&void 0!==r?r:e=>{console.error("Supabase grid error: ",e)}}}),{savedState:{}}}let H=e=>{let t=(0,p.cc)(e);return(0,s.jsx)(Z.g3,{children:(0,s.jsx)(i.W,{backend:r.PD,context:window,children:(0,s.jsx)(Y,{...t})})})},Y=e=>{var t,n;let{editable:i,projectRef:r,gridProps:j,headerActions:v,showCustomChildren:y,customHeader:b,children:N,onAddRow:w,onAddColumn:_,updateTableRow:C,onEditForeignKeyColumnValue:S,onImportData:k}=e,{id:E}=(0,o.UO)(),A=(0,Z.I0)(),T=(0,Z.Qq)(),I=(0,h._2)(),z=(0,a.useRef)(null),[P,R]=(0,a.useState)(!1),[{sort:L,filter:O},D]=(0,u.x3)({arrayKeys:["sort","filter"]}),U=(0,p.rg)(e.table.name,L),M=(0,p.Yb)(O),B=(0,m.fN)(),{project:W}=(0,c.d2)(),{data:H,error:Y,isSuccess:V,isError:K,isLoading:X,isRefetching:Q}=(0,d.KK)({queryKey:[e.table.schema,e.table.name],projectRef:null==W?void 0:W.ref,connectionString:null==W?void 0:W.connectionString,table:e.table,sorts:U,filters:M,page:I.page,limit:I.rowsPerPage,impersonatedRole:B.role},{keepPreviousData:!0,retryDelay:(e,t)=>{var n;return(t&&(null===(n=t.message)||void 0===n?void 0:n.includes("does not exist"))&&D(e=>({...e,sort:void 0})),e>3)?1/0:5e3},onSuccess(e){A({type:"SET_ROWS_COUNT",payload:e.rows.length})}});return(0,a.useEffect)(()=>{P||R(!0)},[]),(0,a.useEffect)(()=>{P&&A({type:"UPDATE_FILTERS",payload:{}})},[JSON.stringify(M)]),(0,a.useEffect)(()=>{P&&A({type:"UPDATE_SORTS",payload:{}})},[JSON.stringify(U)]),(0,a.useEffect)(()=>{T.isInitialComplete&&r&&T.table&&(0,p.Tf)(T,r,L,O)},[T.table,T.isInitialComplete,T.gridColumns,JSON.stringify(U),JSON.stringify(M),r]),(0,a.useEffect)(()=>{A({type:"INIT_CALLBACK",payload:{...e}})},[]),(0,a.useEffect)(()=>{let t=async()=>{let{savedState:t}=await G({...e,tableId:E},T,A,L,O);(t.sorts||t.filters)&&D(e=>({...e,...t.sorts&&{sort:t.sorts},...t.filters&&{filter:t.filters}}))},n=JSON.stringify(e.table)!==JSON.stringify(T.table);(!T.table||n)&&t()},[T.table,e.table,e.schema]),(0,s.jsxs)("div",{className:"sb-grid",children:[(0,s.jsx)(F,{table:e.table,sorts:U,filters:M,onAddRow:i?w:void 0,onAddColumn:i?_:void 0,onImportData:i?k:void 0,headerActions:v,customHeader:b}),y&&void 0!==N?(0,s.jsx)(s.Fragment,{children:N}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.rj,{ref:z,...j,rows:null!==(t=null==H?void 0:H.rows)&&void 0!==t?t:[],error:Y,isLoading:X,isSuccess:V,isError:K,filters:M,setParams:D,updateRow:C,onAddRow:w,onImportData:k,onEditForeignKeyColumnValue:S}),(0,s.jsx)(f.Z,{isLoading:X,isRefetching:Q}),(0,s.jsx)(x.fQ,{gridRef:z})]}),P&&(0,l.createPortal)((0,s.jsx)(q.q4,{rows:null!==(n=null==H?void 0:H.rows)&&void 0!==n?n:[]}),document.body)]})};var V=n(7820)},7820:function(e,t,n){"use strict";n.d(t,{A:function(){return u}});var s=n(87612),a=n(83561);function i(e,t){return 0===t.length?e:e+=" where ".concat(t.map(e=>{switch(e.operator){case"in":let t;return t=Array.isArray(e.value)?e.value.map(e=>r(e)):String(e.value).split(",").map(e=>r(e)),"".concat((0,a.ident)(e.column)," ").concat(e.operator," (").concat(t.join(","),")");case"is":return function(e){let t=String(e.value);switch(t){case"null":case"false":case"true":case"not null":return"".concat((0,a.ident)(e.column)," ").concat(e.operator," ").concat(t);default:return"".concat((0,a.ident)(e.column)," ").concat(e.operator," ").concat(r(e.value))}}(e);default:return"".concat((0,a.ident)(e.column)," ").concat(e.operator," ").concat(r(e.value))}}).join(" and "))}function r(e){return"string"!=typeof e||(null==e?void 0:e.startsWith("ARRAY["))&&(null==e?void 0:e.endsWith("]"))?e:(0,a.literal)(e)}function l(e){return"".concat((0,a.ident)(e.schema),".").concat((0,a.ident)(e.name))}class o{range(e,t){return this.pagination={offset:e,limit:t-e+1},this}toSql(){try{var e;let{actionValue:t,actionOptions:n,filters:s,sorts:r}=null!==(e=this.options)&&void 0!==e?e:{};switch(this.action){case"count":return function(e,t){let n="select count(*) from ".concat(l(e)),{filters:s}=null!=t?t:{};return s&&(n=i(n,s)),n+";"}(this.table,{filters:s});case"delete":return function(e,t,n){if(!t||0===t.length)throw{message:"no filters for this delete query"};let s="delete from ".concat(l(e)),{returning:a,enumArrayColumns:r}=null!=n?n:{};return t&&(s=i(s,t)),a&&(s+=void 0===r||0===r.length?" returning *":" returning *, ".concat(r.map(e=>'"'.concat(e,'"::text[]')).join(","))),s+";"}(this.table,s,{returning:null==n?void 0:n.returning,enumArrayColumns:null==n?void 0:n.enumArrayColumns});case"insert":return function(e,t,n){if(!t||0===t.length)throw{message:"no value to insert"};let{returning:s,enumArrayColumns:i}=null!=n?n:{},r=Object.keys(t[0]).map(e=>(0,a.ident)(e)).join(","),o="";return o=0==r.length?(0,a.format)("insert into %1$s select from jsonb_populate_recordset(null::%1$s, %2$s)",l(e),(0,a.literal)(JSON.stringify(t))):(0,a.format)("insert into %1$s (%2$s) select %2$s from jsonb_populate_recordset(null::%1$s, %3$s)",l(e),r,(0,a.literal)(JSON.stringify(t))),s&&(o+=void 0===i||0===i.length?" returning *":" returning *, ".concat(i.map(e=>'"'.concat(e,'"::text[]')).join(","))),o+";"}(this.table,t,{returning:null==n?void 0:n.returning,enumArrayColumns:null==n?void 0:n.enumArrayColumns});case"select":return function(e,t,n){var s;let r="";r+="select ".concat(null!=t?t:"*"," from ").concat(l(e));let{filters:o,pagination:c,sorts:d}=null!=n?n:{};if(o&&(r=i(r,o)),d&&(s=r,r=0===d.length?s:s+=" order by ".concat(d.map(e=>{let t=e.ascending?"asc":"desc",n=e.nullsFirst?"nulls first":"nulls last";return"".concat((0,a.ident)(e.table),".").concat((0,a.ident)(e.column)," ").concat(t," ").concat(n)}).join(", "))),c){let{limit:e,offset:t}=null!=c?c:{};r+=" limit ".concat((0,a.literal)(e)," offset ").concat((0,a.literal)(t))}return r+";"}(this.table,t,{filters:s,pagination:this.pagination,sorts:r});case"update":return function(e,t,n){let{filters:s,returning:r,enumArrayColumns:o}=null!=n?n:{};if(!s||0===s.length)throw{message:"no filters for this update query"};let c=Object.keys(t).map(e=>(0,a.ident)(e)).join(","),d=(0,a.format)("update %1$s set (%2$s) = (select %2$s from json_populate_record(null::%1$s, %3$s))",l(e),c,(0,a.literal)(JSON.stringify(t)));return s&&(d=i(d,s)),r&&(d+=void 0===o||0===o.length?" returning *":" returning *, ".concat(o.map(e=>'"'.concat(e,'"::text[]')).join(","))),d+";"}(this.table,t,{filters:s,returning:null==n?void 0:n.returning,enumArrayColumns:null==n?void 0:n.enumArrayColumns});case"truncate":return function(e,t){let n="truncate ".concat(l(e)),{cascade:s}=null!=t?t:{};return s&&(n+=" cascade"),n+";"}(this.table,{cascade:null==n?void 0:n.cascade});default:return""}}catch(e){throw e}}constructor(e,t,n){(0,s._)(this,"table",void 0),(0,s._)(this,"action",void 0),(0,s._)(this,"options",void 0),(0,s._)(this,"pagination",void 0),this.table=e,this.action=t,this.options=n}}class c{filter(e,t,n){return this.filters.push({column:e,operator:t,value:n}),this}match(e){return Object.entries(e).map(e=>{let[t,n]=e;this.filters.push({column:t,operator:"=",value:n})}),this}order(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.sorts.push({table:e,column:t,ascending:n,nullsFirst:s}),this}range(e,t){return this._getQueryModifier().range(e,t)}toSql(){return this._getQueryModifier().toSql()}_getQueryModifier(){return new o(this.table,this.action,{actionValue:this.actionValue,actionOptions:this.actionOptions,filters:this.filters,sorts:this.sorts})}constructor(e,t,n,a){(0,s._)(this,"table",void 0),(0,s._)(this,"action",void 0),(0,s._)(this,"actionValue",void 0),(0,s._)(this,"actionOptions",void 0),(0,s._)(this,"filters",void 0),(0,s._)(this,"sorts",void 0),this.table=e,this.action=t,this.actionValue=n,this.actionOptions=a,this.filters=[],this.sorts=[]}}class d{count(){return new c(this.table,"count")}delete(e){return new c(this.table,"delete",void 0,e)}insert(e,t){return new c(this.table,"insert",e,t)}select(e){return new c(this.table,"select",e)}update(e,t){return new c(this.table,"update",e,t)}truncate(e){return new c(this.table,"truncate",void 0,e)}constructor(e){(0,s._)(this,"table",void 0),this.table=e}}class u{from(e,t){return new d({name:e,schema:null!=t?t:"public"})}}},37381:function(e,t,n){"use strict";n.d(t,{g3:function(){return m},I0:function(){return p},Qq:function(){return h}});var s=n(2784),a=n(64018),i=n(87115),r=n(14819),l=n.n(r),o=n(64568);function c(e){let t=(0,o.I8)(e);return t.renderEditCell=e.renderEditCell,t.renderHeaderCell=e.renderHeaderCell,t.renderCell=e.renderCell,t.renderGroupCell=e.renderGroupCell,t}let d={table:null,isInitialComplete:!1,editable:!1,allRowsSelected:!1,onAddColumn:null,onAddRow:null,onError:null,onEditRow:null,onEditColumn:null,onDeleteColumn:null,gridColumns:[],rows:[],selectedRows:new Set,selectedCellPosition:null,totalRows:i.Vz},u=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,n=arguments.length>1?arguments[1]:void 0;for(let s=0;s<t.length;s++)e=t[s](e,n);return e}}((e,t)=>{switch(t.type){case"INIT_TABLE":return{...e,table:t.payload.table,isInitialComplete:!0,editable:t.payload.editable||!1};case"UPDATE_FILTERS":{let t={...e};return t.page=1,t.totalRows=i.ZR,t}case"UPDATE_SORTS":return{...e};default:return e}},(e,t)=>"INIT_CALLBACK"===t.type?{...e,onAddColumn:t.payload.onAddColumn,onAddRow:t.payload.onAddRow,onError:t.payload.onError,onEditRow:t.payload.onEditRow,onEditColumn:t.payload.onEditColumn,onDeleteColumn:t.payload.onDeleteColumn}:e,(e,t)=>{switch(t.type){case"INIT_TABLE":return{...e,gridColumns:function(e,t){let n=e;if(null==t?void 0:t.gridColumns){n=[];let s=t.gridColumns.filter(e=>(null==e?void 0:e.name)!=="");for(let t=0;t<s.length;t++){let a=s[t],i=e.find(e=>e.key===a.key);i&&n.push({...i,width:a.width,frozen:a.frozen})}let a=e.filter(e=>!s.find(t=>t.key===e.key)&&""!==e.name);n=n.concat(a);let r=e.find(e=>e.key===i.W);r&&(n=[r,...n]);let l=e.find(e=>e.key===i.uZ);l&&n.push(l)}return n}(t.payload.gridColumns,t.payload.savedState)};case"MOVE_COLUMN":{let n=e.gridColumns.findIndex(e=>e.key===t.payload.fromKey),s=e.gridColumns.findIndex(e=>e.key===t.payload.toKey),a=e.gridColumns[n];return{...e,gridColumns:l()(e.gridColumns,{$splice:[[n,1],[s,0,a]]})}}case"UPDATE_COLUMN_SIZE":{let n=c(e.gridColumns[t.payload.index]);return n.width=t.payload.width,{...e,gridColumns:l()(e.gridColumns,{[t.payload.index]:{$set:n}})}}case"FREEZE_COLUMN":{let n=e.gridColumns.findIndex(e=>e.key===t.payload.columnKey),s=c(e.gridColumns[n]);return s.frozen=!0,{...e,gridColumns:l()(e.gridColumns,{[n]:{$set:s}})}}case"UNFREEZE_COLUMN":{let n=e.gridColumns.findIndex(e=>e.key===t.payload.columnKey),s=c(e.gridColumns[n]);return s.frozen=!1,{...e,gridColumns:l()(e.gridColumns,{[n]:{$set:s}})}}case"UPDATE_COLUMN_IDX":{let n=e.gridColumns.findIndex(e=>e.key===t.payload.columnKey),s=c(e.gridColumns[n]);return s.idx=t.payload.columnIdx,{...e,gridColumns:l()(e.gridColumns,{[n]:{$set:s}}).sort((e,t)=>e.idx-t.idx)}}default:return e}},(e,t)=>{switch(t.type){case"INIT_TABLE":return{...e,selectedCellPosition:null,selectedRows:new Set,totalRows:i.ZR};case"SELECTED_CELL_CHANGE":return{...e,selectedCellPosition:t.payload.position};case"SELECTED_ROWS_CHANGE":return{...e,allRowsSelected:!1,selectedRows:t.payload.selectedRows};case"SELECT_ALL_ROWS":return{...e,allRowsSelected:!0,selectedRows:t.payload.selectedRows};case"SET_ROWS":return{...e,rows:t.payload.rows};case"SET_ROWS_COUNT":return{...e,totalRows:t.payload};default:return e}}),{Provider:m,useTrackedState:h,useUpdate:p}=(0,a.fH)(()=>(0,s.useReducer)(u,d))},64568:function(e,t,n){"use strict";function s(e){try{return JSON.parse(JSON.stringify(e))}catch(e){throw e}}function a(e){return null===e?"":"object"==typeof e||Array.isArray(e)?JSON.stringify(e):e}n.d(t,{I8:function(){return s},Lw:function(){return a},vQ:function(){return i}});let i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(window.document.hasFocus()){var n,s;null===(s=window.navigator)||void 0===s||null===(n=s.clipboard)||void 0===n||n.writeText(e).then(t)}else console.warn("Unable to copy to clipboard")}},782:function(e,t,n){"use strict";n.d(t,{i1:function(){return X},ve:function(){return $},cv:function(){return Q}});var s=n(52322),a=n(57142),i=n(54383),r=n(32079),l=n(71294),o=n(37381);let c=e=>{let{row:t,column:n,isNullable:a,onRowChange:i,onClose:r}=e,c=(0,o.Qq)().gridColumns.find(e=>e.name==n.key),d=t[n.key];return(0,s.jsxs)(l.ZP,{autoFocus:!0,id:"boolean-editor",name:"boolean-editor",size:"small",onBlur:()=>r(!1),onChange:e=>{let s=e.target.value;"null"===s?i({...t,[n.key]:null},!0):i({...t,[n.key]:"true"===s},!0)},defaultValue:null===d?"null":d.toString(),style:{width:"".concat((null==c?void 0:c.width)||n.width,"px")},children:[(0,s.jsx)(l.ZP.Option,{value:"true",children:"TRUE"}),(0,s.jsx)(l.ZP.Option,{value:"false",children:"FALSE"}),a&&(0,s.jsx)(l.ZP.Option,{value:"null",children:"NULL"})]})};var d=n(2784);function u(e){null==e||e.focus(),null==e||e.select()}function m(e){let{row:t,column:n,onRowChange:a,onClose:i}=e,r=t[n.key];return(0,s.jsx)("input",{className:"sb-grid-date-editor",ref:u,value:null!=r?r:"",onChange:function(e){let s=e.target.value;""==s?a({...t,[n.key]:null}):a({...t,[n.key]:s})},onBlur:()=>i(!0),type:"date"})}var h=n(28879),p=n.n(h),x=n(89945),f=n.n(x);function g(e){null==e||e.focus(),null==e||e.select()}function j(e){let{row:t,column:n,format:a,onRowChange:i,onClose:r}=e,l=t[n.key],o=l?p()(l,a).format("YYYY-MM-DDTHH:mm:ss"):l;return(0,s.jsx)("input",{className:"sb-grid-datetime-editor",ref:g,value:null!=o?o:"",onChange:function(e){let s=e.target.value;if(0===s.length)i({...t,[n.key]:null});else{let e=p()(s).format(a);i({...t,[n.key]:e})}},onBlur:()=>r(!0),type:"datetime-local",step:"1"})}function v(e){return(0,s.jsx)(j,{...e,format:"YYYY-MM-DDTHH:mm:ss"})}function y(e){return(0,s.jsx)(j,{...e,format:"YYYY-MM-DDTHH:mm:ssZ"})}p().extend(f());var b=n(1842),N=n.n(b),w=n(52335),_=n(62202),C=n(99959),S=n(7423),k=n(20746),E=n(14528),A=n(26541),T=n(82667),I=n(10012),Z=n(2322);let z=e=>{try{return JSON.parse(e),!0}catch(e){return!1}},P=e=>{try{let t=JSON.parse(e);return JSON.stringify(t)}catch(t){if("string"==typeof e)return e.replaceAll('"','"');return JSON.stringify(e)}},R=e=>{let{row:t,column:n,isEditable:i=!0,onRowChange:r,onExpandEditor:l}=e,c=(0,o.Qq)(),{id:u}=(0,C.UO)(),m=u?Number(u):void 0,{data:h}=(0,A.Z)(m),p=(0,E.Vm)(),x=c.gridColumns.find(e=>e.name==n.key),f=t[n.key],g=(0,T.ZO)(N()(f)?"":P(f)),j="string"==typeof f&&f.endsWith("...")&&f.length>a.no,[v,y]=(0,d.useState)(!0),[b,R]=(0,d.useState)(g),{mutate:L,isLoading:O,isSuccess:D}=(0,k.rp)(),F=(0,d.useCallback)(()=>{i&&r(t,!0),y(!1)},[]),U=(0,d.useCallback)(e=>{(null!==e?(0,T.tT)(e):e)!==b?q(e):y(!1)},[D]),M=()=>{F(),l(n.key,{...t,[n.key]:(0,T.dW)(b)||t[n.key]})},q=e=>{if(i){if(e){if(z(e)){let s=JSON.parse(e);r({...t,[n.key]:s},!0),y(!1)}else{let{onError:e}=c;e&&e(Error("Please enter a valid JSON"))}}else r({...t,[n.key]:null},!0),y(!1)}};return(0,s.jsx)(I.Z,{open:v,side:"bottom",align:"start",sideOffset:-35,className:"rounded-none",overlay:j&&!D?(0,s.jsxs)("div",{style:{width:"".concat((null==x?void 0:x.width)||n.width,"px")},className:"flex items-center justify-center flex-col relative",children:[(0,s.jsx)(S.rE,{readOnly:!0,onChange:()=>{},width:"".concat((null==x?void 0:x.width)||n.width,"px"),value:null!=b?b:"",language:"markdown"}),(0,s.jsx)(G,{isLoading:O,loadFullValue:()=>{if(void 0===h||void 0===p)return;if(0===h.primary_keys.length)return(0,_.ZP)("Unable to load value as table has no primary keys");let e=h.primary_keys.reduce((e,n)=>({...e,[n.name]:t[n.name]}),{});L({table:{schema:h.schema,name:h.name},column:n.name,pkMatch:e,projectRef:null==p?void 0:p.ref,connectionString:null==p?void 0:p.connectionString},{onSuccess:e=>{R(JSON.stringify(e))}})}})]}):(0,s.jsxs)(S.rc,{value:b,onEscape:F,onEnter:U,children:[(0,s.jsx)(S.rE,{width:"".concat((null==x?void 0:x.width)||n.width,"px"),value:null!=b?b:"",language:"json",readOnly:!i,onChange:e=>{i&&(e&&""!=e?R(e):R(null))}}),(0,s.jsxs)("div",{className:"flex items-start justify-between p-2 bg-surface-200 gap-x-2",children:[i&&(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"px-1.5 py-[2.5px] rounded bg-selection border border-strong flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-[10px]",children:""})}),(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"Save changes"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"px-1 py-[2.5px] rounded bg-selection border border-strong flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-[10px]",children:"Esc"})}),(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"Cancel changes"})]})]}),(0,s.jsxs)(Z.u,{children:[(0,s.jsx)(Z.aJ,{asChild:!0,children:(0,s.jsx)("div",{className:"border border-strong rounded p-1 flex items-center justify-center transition cursor-pointer bg-selection hover:bg-border-strong",onClick:()=>M(),children:(0,s.jsx)(w.Z,{size:12,strokeWidth:2})})}),(0,s.jsx)(Z._v,{side:"bottom",align:"center",children:(0,s.jsx)("span",{children:"Expand editor"})})]})]})]}),children:(0,s.jsx)("div",{className:"".concat(b&&0==g.trim().length?"sb-grid-fill-container":""," sb-grid-json-editor__trigger"),onClick:()=>y(!v),children:null===b||""===b?(0,s.jsx)(S.q2,{}):g})})};function L(e){null==e||e.focus(),null==e||e.select()}function O(e){let{row:t,column:n,onRowChange:a,onClose:i}=e,r=t[n.key];return(0,s.jsx)("input",{className:"sb-grid-number-editor",ref:L,value:null!=r?r:"",onChange:function(e){let s=e.target.value;""==s?a({...t,[n.key]:null}):a({...t,[n.key]:s})},onBlur:function(){i(!0)},type:"number"})}function D(e){let{row:t,column:n,onRowChange:a,onClose:i,options:r,isNullable:c}=e,d=(0,o.Qq)().gridColumns.find(e=>e.name==n.key),u=t[n.key];return(0,s.jsxs)(l.ZP,{autoFocus:!0,id:"select-editor",name:"select-editor",size:"small",defaultValue:null!=u?u:"",className:"sb-grid-select-editor !gap-2",style:{width:"".concat((null==d?void 0:d.width)||n.width,"px")},onChange:function(e){e.target.value&&""!=e.target.value?a({...t,[n.key]:e.target.value},!0):a({...t,[n.key]:null},!0)},onBlur:function(){i(!1)},children:[c&&(0,s.jsx)(l.ZP.Option,{value:"",children:"NULL"}),r.map(e=>{let{label:t,_value:n}=e;return(0,s.jsx)(l.ZP.Option,{value:n,selected:n===u,children:t},n)})]})}let F=e=>{let{row:t,column:n,isNullable:i,isEditable:l,onRowChange:c,onExpandEditor:u}=e,m=(0,o.Qq)(),{id:h}=(0,C.UO)(),p=h?Number(h):void 0,{data:x}=(0,A.Z)(p),f=(0,E.Vm)(),g=m.gridColumns.find(e=>e.name==n.key),j=t[n.key],[v,y]=(0,d.useState)(!0),[b,N]=(0,d.useState)(j),{mutate:T,isLoading:z,isSuccess:P}=(0,k.rp)(),R="string"==typeof j&&j.endsWith("...")&&j.length>a.no,L=(0,d.useCallback)(()=>{l&&c(t,!0),y(!1)},[]),O=(0,d.useCallback)(e=>{l&&e!==b&&c({...t,[n.key]:e},!0),y(!1)},[P]),D=()=>{L(),u(n.key,{...t,[n.key]:b||t[n.key]})};return(0,s.jsx)(I.Z,{open:v,side:"bottom",align:"start",sideOffset:-35,className:"rounded-none",overlay:R&&!P?(0,s.jsxs)("div",{style:{width:"".concat((null==g?void 0:g.width)||n.width,"px")},className:"flex items-center justify-center flex-col relative",children:[(0,s.jsx)(S.rE,{readOnly:!0,onChange:()=>{},width:"".concat((null==g?void 0:g.width)||n.width,"px"),value:null!=b?b:"",language:"markdown"}),(0,s.jsx)(G,{isLoading:z,loadFullValue:()=>{if(void 0===x||void 0===f)return;if(0===x.primary_keys.length)return(0,_.ZP)("Unable to load value as table has no primary keys");let e=x.primary_keys.reduce((e,n)=>({...e,[n.name]:t[n.name]}),{});T({table:{schema:x.schema,name:x.name},column:n.name,pkMatch:e,projectRef:null==f?void 0:f.ref,connectionString:null==f?void 0:f.connectionString},{onSuccess:e=>N(e)})}})]}):(0,s.jsxs)(S.rc,{value:b,onEscape:L,onEnter:O,children:[(0,s.jsx)(S.rE,{width:"".concat((null==g?void 0:g.width)||n.width,"px"),value:null!=b?b:"",readOnly:!l,onChange:e=>{l&&(e?N(e):N(""))}}),l&&(0,s.jsxs)("div",{className:"flex items-start justify-between p-2 bg-surface-200 space-x-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"px-1.5 py-[2.5px] rounded bg-surface-300 border border-strong flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-[10px]",children:""})}),(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"Save changes"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"px-1 py-[2.5px] rounded bg-surface-300 border border-strong flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-[10px]",children:"Esc"})}),(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"Cancel changes"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end gap-y-1",children:[(0,s.jsxs)(Z.u,{children:[(0,s.jsx)(Z.aJ,{asChild:!0,children:(0,s.jsx)(r.z,{type:"default",className:"px-1",onClick:()=>D(),icon:(0,s.jsx)(w.Z,{size:12,strokeWidth:2})})}),(0,s.jsx)(Z._v,{side:"bottom",children:"Expand editor"})]}),i&&(0,s.jsx)(r.z,{asChild:!0,htmlType:"button",type:"default",size:"tiny",onClick:()=>O(null),children:(0,s.jsx)("div",{children:"Set to NULL"})})]})]})]}),children:(0,s.jsx)("div",{className:"".concat(b&&0==b.trim().length?"sb-grid-fill-container":""," sb-grid-text-editor__trigger"),onClick:()=>y(!v),children:null===b?(0,s.jsx)(S.q2,{}):""===b?(0,s.jsx)(S.OX,{}):b})})};function U(e){null==e||e.focus(),null==e||e.select()}p().extend(f());let M="HH:mm:ss";function q(e){let{row:t,column:n,format:a,onRowChange:i,onClose:r}=e,l=t[n.key],o=l?p()(l,a).format(M):l;return(0,s.jsx)("input",{className:"sb-grid-time-editor",ref:U,value:null!=o?o:"",onChange:function(e){let s=e.target.value;if(""==s)i({...t,[n.key]:null});else{let e=p()(s,M).format(a);i({...t,[n.key]:e})}},onBlur:()=>r(!0),type:"time",step:"1"})}function B(e){return(0,s.jsx)(q,{...e,format:"HH:mm:ss"})}function W(e){return(0,s.jsx)(q,{...e,format:"HH:mm:ssZZ"})}let G=e=>{let{isLoading:t,loadFullValue:n}=e;return(0,s.jsxs)("div",{className:(0,i.cn)("absolute top-0 left-0 flex items-center justify-center flex-col gap-y-3","text-xs w-full h-full px-3 text-center","bg-default/80 backdrop-blur-[1.5px]"),children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,s.jsxs)("p",{children:["Value is larger than ",a.no.toLocaleString()," characters"]}),(0,s.jsx)("p",{className:"text-foreground-light",children:"You may try to render the entire value, but your browser may run into performance issues"})]}),(0,s.jsx)(r.z,{type:"default",loading:t,onClick:n,children:"Load full value"})]})};var H=n(1028),Y=n(98849),V=n(87115),K=n(52673);let X=9;function Q(e,t){let n=e.columns.map((e,n)=>{var a;let i=function(e){if((0,K.Pm)(e))return"foreign_key";if((0,K.v3)(e.dataType))return"number";if((0,K.nr)(e.dataType))return"array";if((0,K.om)(e.dataType))return"json";if((0,K.II)(e.dataType))return"text";if((0,K.kO)(e.format))return"citext";if((0,K.VO)(e.format))return"date";else if((0,K.LT)(e.format))return"time";else if((0,K.Kp)(e.format))return"datetime";else if((0,K.nL)(e.dataType))return"boolean";else if((0,K.N8)(e.dataType))return"enum";else return"unknown"}(e),r=$(e),l=(e.name.length+e.format.length)*X,o=(null==t?void 0:t.defaultWidth)?t.defaultWidth:r<l?l:r;return{key:e.name,name:e.name,idx:n+1,resizable:!0,sortable:!0,width:o,minWidth:V.mr,frozen:e.isPrimaryKey||!1,isLastFrozenColumn:!1,renderHeaderCell:t=>(0,s.jsx)(Y.x8,{...t,columnType:i,isPrimaryKey:e.isPrimaryKey,isEncrypted:e.isEncrypted,format:e.format,foreignKey:e.foreignKey}),renderEditCell:t?function(e,t,n,a,i){if(!n)return["array","json"].includes(t)?e=>(0,s.jsx)(R,{...e,isEditable:n,onExpandEditor:a}):["number","boolean"].includes(t)?void 0:e=>(0,s.jsx)(F,{...e,isEditable:n,onExpandEditor:i});if(!e.isPrimaryKey&&e.isUpdatable)switch(t){case"boolean":return t=>(0,s.jsx)(c,{...t,isNullable:e.isNullable});case"date":return m;case"datetime":return e.format.endsWith("z")?y:v;case"time":return e.format.endsWith("z")?W:B;case"enum":{let t=e.enum.map(e=>({label:e,value:e}));return n=>(0,s.jsx)(D,{...n,options:t,isNullable:e.isNullable})}case"array":case"json":return e=>(0,s.jsx)(R,{...e,onExpandEditor:a});case"number":return O;case"citext":case"text":return t=>(0,s.jsx)(F,{...t,isEditable:n,isNullable:e.isNullable,onExpandEditor:i});default:return}}(e,i,null!==(a=null==t?void 0:t.editable)&&void 0!==a&&a,t.onExpandJSONEditor,t.onExpandTextEditor):void 0,renderCell:function(e,t,n){switch(t){case"boolean":return H.SJ;case"foreign_key":if(e.isPrimaryKey||!e.isUpdatable)return H.k3;return e=>(0,s.jsx)(H._O,{...e,projectRef:n.projectRef,tableId:n.tableId});case"json":return H.$3;default:return H.k3}}(e,i,{projectRef:null==t?void 0:t.projectRef,tableId:null==t?void 0:t.tableId}),parent:void 0,level:0,maxWidth:void 0,draggable:!1}}),a=[Y.F_,...n];return(null==t?void 0:t.onAddColumn)&&a.push(Y.Lx),a}function $(e){return(0,K.v3)(e.dataType)?120:(0,K.Kp)(e.format)||(0,K.VO)(e.format)||(0,K.LT)(e.format)?150:(0,K.nL)(e.dataType)?120:(0,K.N8)(e.dataType)?150:250}},52673:function(e,t,n){"use strict";n.d(t,{II:function(){return d},Kp:function(){return p},LT:function(){return j},N8:function(){return N},Pm:function(){return w},VO:function(){return f},kO:function(){return m},nL:function(){return y},nr:function(){return o},om:function(){return r},v3:function(){return a}});let s=["smallint","integer","bigint","decimal","numeric","real","double precision","serial","bigserial","int2","int4","int8","float4","float8","smallserial","serial2","serial4","serial8"];function a(e){return s.indexOf(e.toLowerCase())>-1}let i=["json","jsonb","array"];function r(e){return i.indexOf(e.toLowerCase())>-1}let l=["array"];function o(e){return l.indexOf(e.toLowerCase())>-1}let c=["uuid","text","character varying"];function d(e){return c.indexOf(e.toLowerCase())>-1}let u=["citext"];function m(e){return u.indexOf(e.toLowerCase())>-1}let h=["timestamp","timestamptz"];function p(e){return h.indexOf(e.toLowerCase())>-1}let x=["date"];function f(e){return x.indexOf(e.toLowerCase())>-1}let g=["time","timetz"];function j(e){return g.indexOf(e.toLowerCase())>-1}let v=["boolean","bool"];function y(e){return v.indexOf(e.toLowerCase())>-1}let b=["user-defined"];function N(e){return b.indexOf(e.toLowerCase())>-1}function w(e){var t;let{targetTableSchema:n,targetTableName:s,targetColumnName:a}=null!==(t=null==e?void 0:e.foreignKey)&&void 0!==t?t:{};return!!n&&!!s&&!!a}},82366:function(e,t,n){"use strict";n.d(t,{h:function(){return u}});var s=n(52322),a=n(14698),i=n(31310),r=n(26198),l=n(28879),o=n.n(l),c=n(49251),d=n(750),u=e=>{let{selectedLog:t,onClose:n}=e,{data:l}=(0,r.Sy)(),{data:u}=(0,i.tl)();return null==l||l.find(e=>e.ref===(null==t?void 0:t.target.metadata.project_ref)),null==u||u.find(e=>e.slug===(null==t?void 0:t.target.metadata.org_slug)),(0,s.jsxs)(c.ZP,{size:"large",header:'"'.concat(null==t?void 0:t.action.name,'" on ').concat(o()(null==t?void 0:t.occurred_at).format("DD MMM YYYY, HH:mm:ss")),visible:void 0!==t,onCancel:n,cancelText:"Close",children:[(0,s.jsx)(a.hj,{header:(0,s.jsx)(a.S0,{children:"General"}),children:(0,s.jsx)(a.B4,{loading:!1,children:(0,s.jsx)(d.Z,{readOnly:!0,size:"small",label:"Occurred at",value:null==t?void 0:t.occurred_at,descriptionText:o()(null==t?void 0:t.occurred_at).format("DD MMM YYYY, HH:mm:ss (ZZ)")})})}),(0,s.jsx)(c.ZP.Separator,{}),(0,s.jsx)(a.hj,{header:(0,s.jsx)(a.S0,{children:"Actor"}),children:(0,s.jsxs)(a.B4,{loading:!1,children:[(0,s.jsx)(d.Z,{readOnly:!0,size:"small",label:"Actor ID",value:null==t?void 0:t.actor.id}),(0,s.jsx)(d.Z.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==t?void 0:t.actor.metadata,null,2)})]})}),(0,s.jsx)(c.ZP.Separator,{}),(0,s.jsx)(a.hj,{header:(0,s.jsx)(a.S0,{children:"Action"}),children:(0,s.jsxs)(a.B4,{loading:!1,children:[(0,s.jsx)(d.Z,{readOnly:!0,size:"small",label:"Name",value:null==t?void 0:t.action.name}),(0,s.jsx)(d.Z.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==t?void 0:t.action.metadata,null,2)})]})}),(0,s.jsx)(c.ZP.Separator,{}),(0,s.jsx)(a.hj,{header:(0,s.jsx)(a.S0,{children:"Target"}),children:(0,s.jsxs)(a.B4,{loading:!1,children:[(0,s.jsx)(d.Z,{readOnly:!0,size:"small",label:"Name",value:null==t?void 0:t.target.description}),(0,s.jsx)(d.Z.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==t?void 0:t.target.metadata,null,2)})]})})]})}},28019:function(e,t,n){"use strict";n.d(t,{CM:function(){return j},$L:function(){return k},ZP:function(){return E}});var s=n(52322),a=n(47852),i=n(34291),r=n.n(i),l=n(1309),o=e=>{let{operation:t="",onSelectOperation:n=r()}=e;return(0,s.jsxs)("div",{className:"flex justify-between space-x-12",children:[(0,s.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,s.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"allowed-operation",children:"Allowed operation"}),(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Select an operation for this policy"})]}),(0,s.jsx)("div",{className:"w-2/3",children:(0,s.jsx)("div",{className:"flex items-center space-x-8",children:(0,s.jsx)(l.Z.Group,{type:"small-cards",size:"tiny",id:"allowed-operation",children:["SELECT","INSERT","UPDATE","DELETE","ALL"].map(e=>(0,s.jsx)(l.Z,{name:"allowed-operation",label:e,value:e,checked:t===e,onChange:e=>n(e.target.value)},e))})})})]})},c=n(24990),d=n(2784),u=n(66855),m=n(70458),h=n(14528),p=e=>{let{operation:t="",definition:n="",check:a="",onUpdatePolicyUsing:i=r(),onUpdatePolicyCheck:l=r()}=e,o=e=>["SELECT","UPDATE","DELETE","ALL"].includes(e)||!e,p=e=>["INSERT","UPDATE","ALL"].includes(e),x=(0,h.D9)(t)||"";return(0,d.useEffect)(()=>{o(x)&&!o(t)&&i(void 0),p(x)&&!p(t)&&l(void 0)},[t]),(0,s.jsxs)("div",{className:"space-y-4",children:[o(t)&&(0,s.jsxs)("div",{className:"flex space-x-12",children:[(0,s.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"policy-name",children:"USING expression"}),(0,s.jsxs)(c.fC,{delayDuration:0,children:[(0,s.jsx)(c.xz,{children:(0,s.jsx)(u.Z,{className:"text-foreground-light",size:16,strokeWidth:1.5})}),(0,s.jsx)(c.h_,{children:(0,s.jsxs)(c.VY,{side:"bottom",children:[(0,s.jsx)(c.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-[300px] space-y-2 border border-background",children:[(0,s.jsx)("p",{className:"text-xs text-foreground",children:"This expression will be added to queries that refer to the table if row-level security is enabled."}),(0,s.jsx)("p",{className:"text-xs text-foreground",children:"Rows for which the expression returns true will be visible. Any rows for which the expression returns false or null will not be visible to the user (in a SELECT), and will not be available for modification (in an UPDATE or DELETE)."}),(0,s.jsx)("p",{className:"text-xs text-foreground",children:"Such rows are silently suppressed - no error is reported."})]})]})})]})]}),(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Provide a SQL conditional expression that returns a boolean."})]}),(0,s.jsx)("div",{className:"w-2/3 ".concat(p(t)?"h-32":"h-56"),children:(0,s.jsx)(m.Z,{defaultValue:n,onInputChange:i})})]}),p(t)&&(0,s.jsxs)("div",{className:"flex space-x-12",children:[(0,s.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"policy-name",children:"WITH CHECK expression"}),(0,s.jsxs)(c.fC,{delayDuration:0,children:[(0,s.jsx)(c.xz,{children:(0,s.jsx)(u.Z,{className:"text-foreground-light",size:16,strokeWidth:1.5})}),(0,s.jsx)(c.h_,{children:(0,s.jsxs)(c.VY,{side:"bottom",children:[(0,s.jsx)(c.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-[300px] space-y-2 border border-background",children:[(0,s.jsx)("p",{className:"text-xs text-foreground",children:"This expression will be used in INSERT and UPDATE queries against the table if row-level security is enabled."}),(0,s.jsx)("p",{className:"text-xs text-foreground",children:"Only rows for which the expression evaluates to true will be allowed. An error will be thrown if the expression evaluates to false or null for any of the records inserted or any of the records that result from the update."}),(0,s.jsx)("p",{className:"text-xs text-foreground",children:"Note that this expression is evaluated against the proposed new contents of the row, not the original contents."})]})]})})]})]}),(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Provide a SQL conditional expression that returns a boolean."})]}),(0,s.jsx)("div",{className:"w-2/3 ".concat(o(t)?"h-32":"h-56"),children:(0,s.jsx)(m.Z,{defaultValue:a,onInputChange:l})})]})]})},x=n(32079),f=e=>{let{showTemplates:t,onViewTemplates:n=r(),onReviewPolicy:a=r()}=e;return(0,s.jsx)("div",{className:"flex justify-between items-center border-t px-6 py-4 border-default",children:(0,s.jsxs)("div",{className:"flex w-full items-center justify-end gap-2",children:[t&&(0,s.jsx)(x.z,{type:"default",onClick:n,children:"View templates"}),(0,s.jsx)(x.z,{type:"primary",onClick:a,children:"Review"})]})})},g=n(750),j=e=>{let{name:t="",limit:n=100,onUpdatePolicyName:a}=e;return(0,s.jsxs)("div",{className:"flex space-x-12",children:[(0,s.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,s.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"policy-name",children:"Policy name"}),(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"A descriptive name for your policy"})]}),(0,s.jsx)("div",{className:"relative w-2/3",children:(0,s.jsx)(g.Z,{id:"policy-name",value:t,onChange:e=>a(e.target.value),actions:(0,s.jsxs)("span",{className:"mr-3 text-sm text-foreground-lighter",children:[t.length,"/",n]})})})]})},v=n(31738),y=n(27570),b=n(56006),N=n(18954),w=n(41679),_=n(45997),C=n(829),S=n.n(C),k=e=>{let{selectedRoles:t,onUpdateSelectedRoles:n}=e,{project:a}=(0,y.d2)(),{data:i,error:r,isLoading:l,isError:o,isSuccess:c}=(0,_.x)({projectRef:null==a?void 0:a.ref,connectionString:null==a?void 0:a.connectionString}),d=S()((null!=i?i:[]).filter(e=>!v.Bv.includes(e.name)),e=>e.name.toLocaleLowerCase()).map(e=>({id:e.id,name:e.name,value:e.name,disabled:!1}));return(0,s.jsxs)("div",{className:"flex space-x-12",children:[(0,s.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,s.jsx)("label",{className:"text-foreground-light text-base",htmlFor:"policy-name",children:"Target roles"}),(0,s.jsx)("p",{className:"text-foreground-lighter text-sm",children:"Apply policy to the selected roles"})]}),(0,s.jsxs)("div",{className:"relative w-2/3",children:[l&&(0,s.jsx)(w.Z,{className:"py-4"}),o&&(0,s.jsx)(b.Z,{error:r,subject:"Failed to retrieve database roles"}),c&&(0,s.jsx)(N.Z,{options:d,value:t,placeholder:"Defaults to all (public) roles if none selected",searchPlaceholder:"Search for a role",onChange:n})]})]})},E=e=>{var t,n,i,r;let{isNewPolicy:l=!0,policyFormFields:c={},onUpdatePolicyFormFields:d=()=>{},onViewTemplates:u=()=>{},onReviewPolicy:m=()=>{}}=e,h=null!==(t=null==c?void 0:c.command)&&void 0!==t?t:"",x=null!==(n=null==c?void 0:c.definition)&&void 0!==n?n:"",g=null!==(i=null==c?void 0:c.check)&&void 0!==i?i:"",v=(null!==(r=null==c?void 0:c.roles)&&void 0!==r?r:[]).filter(e=>"public"!==e);return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"space-y-8 py-8",children:[(0,s.jsx)(a.C.Content,{children:(0,s.jsx)(j,{name:c.name,limit:63,onUpdatePolicyName:e=>d({name:e})})}),(0,s.jsx)(a.C.Separator,{}),l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.C.Content,{children:(0,s.jsx)(o,{operation:h,onSelectOperation:e=>d({command:e})})}),(0,s.jsx)(a.C.Separator,{})]}),(0,s.jsx)(a.C.Content,{children:(0,s.jsx)(k,{selectedRoles:v,onUpdateSelectedRoles:e=>d({roles:e})})}),(0,s.jsx)(a.C.Separator,{}),(0,s.jsx)(a.C.Content,{children:(0,s.jsx)(p,{operation:h,definition:x,check:g,onUpdatePolicyUsing:e=>d({definition:e}),onUpdatePolicyCheck:e=>d({check:e})})})]}),(0,s.jsx)(f,{showTemplates:l,onViewTemplates:u,onReviewPolicy:m})]})}},61576:function(e,t,n){"use strict";n.d(t,{g:function(){return s}});let s=(e,t)=>[{id:"policy-1",preview:!1,templateName:"Enable read access to everyone",description:"This policy gives read access to your table for all users via the SELECT operation.",statement:'\ncreate policy "Enable read access for all users"\non "'.concat(e,'"."').concat(t,'"\nfor select using (true);').trim(),name:"Enable read access for all users",definition:"true",check:"",command:"SELECT",roles:[]},{id:"policy-2",preview:!1,templateName:"Enable insert access for authenticated users only",description:"This policy gives insert access to your table for all authenticated users only.",statement:'\ncreate policy "Enable insert for authenticated users only"\non "'.concat(e,'"."').concat(t,'"\nfor insert to authenticated \nwith check (true);').trim(),name:"Enable insert for authenticated users only",definition:"",check:"true",command:"INSERT",roles:["authenticated"]},{id:"policy-3",preview:!1,templateName:"Enable update access for users based on their email *",description:'This policy assumes that your table has a column "email", and allows users to update rows which the "email" column matches their email.',statement:'\ncreate policy "Enable update for users based on email"\non "'.concat(e,'"."').concat(t,"\"\nfor update using (\n  (select auth.jwt()) ->> 'email' = email\n) with check (\n  (select auth.jwt()) ->> 'email' = email\n);").trim(),name:"Enable update for users based on email",definition:"(select auth.jwt()) ->> 'email' = email",check:"(select auth.jwt()) ->> 'email' = email",command:"UPDATE",roles:[]},{id:"policy-4",preview:!1,templateName:"Enable delete access for users based on their user ID *",description:'This policy assumes that your table has a column "user_id", and allows users to delete rows which the "user_id" column matches their ID',statement:'\ncreate policy "Enable delete for users based on user_id"\non "'.concat(e,'"."').concat(t,'"\nfor delete using (\n  (select auth.uid()) = user_id\n);').trim(),name:"Enable delete for users based on user_id",definition:"(select auth.uid()) = user_id",check:"",command:"DELETE",roles:[]},{id:"policy-5",preview:!1,templateName:"Enable insert access for users based on their user ID *",description:'This policy assumes that your table has a column "user_id", and allows users to insert rows which the "user_id" column matches their ID',statement:'\ncreate policy "Enable insert for users based on user_id"\non "'.concat(e,'"."').concat(t,'"\nfor insert with check (\n  (select auth.uid()) = user_id\n);').trim(),name:"Enable insert for users based on user_id",definition:"",check:"(select auth.uid()) = user_id",command:"INSERT",roles:[]},{id:"policy-6",preview:!0,name:"Policy with table joins",templateName:"Policy with table joins",description:"\nQuery across tables to build more advanced RLS rules\n    \nAssuming 2 tables called `teams` and `members`, you can query both tables in the policy to control access to the members table.",statement:'\ncreate policy "Members can update team details if they belong to the team"\non teams for update using (\n  (select auth.uid()) in (\n    select user_id from members where team_id = id\n  )\n);\n'.trim(),definition:"(select auth.uid()) in (select user_id from members where team_id = id)",check:"",command:"UPDATE",roles:[]},{id:"policy-7",preview:!0,templateName:"Policy with security definer functions",description:"\nUseful in a many-to-many relationship where you want to restrict access to the linking table. \n    \nAssuming 2 tables called `teams` and `members`, you can use a security definer function in combination with a policy to control access to the members table.".trim(),statement:'\ncreate or replace function get_teams_for_user(user_id uuid)\nreturns setof bigint as $$\n  select team_id from members where user_id = $1\n$$ stable language sql security definer;\n\ncreate policy "Team members can update team members if they belong to the team"\non members\nfor all using (\n  team_id in (select get_teams_for_user(auth.uid()))\n);\n'.trim(),name:"Policy with security definer functions",definition:"team_id in (select get_teams_for_user(auth.uid()))",check:"",command:"ALL",roles:[]},{id:"policy-8",preview:!0,name:"Policy to implement Time To Live (TTL)",templateName:"Policy to implement Time To Live (TTL)",description:"\nImplement a TTL-like feature that you see in Instagram stories or Snapchat where messages expire after a day.\n    \nRows under the table are available only if they have been created within the last 24 hours.",statement:'\ncreate policy "Stories are live for a day"\non "'.concat(e,'"."').concat(t,"\"\nfor select using (\n  created_at > (current_timestamp - interval '1 day')\n);\n").trim(),definition:"created_at > (current_timestamp - interval '1 day')",check:"",command:"SELECT",roles:[]}]},34663:function(e,t,n){"use strict";n.d(t,{$A:function(){return S},rE:function(){return v},yV:function(){return en},pT:function(){return V},tV:function(){return ey},jm:function(){return $}});var s=n(52322),a=n(45455),i=n.n(a),r=n(66594),l=n(5632),o=n(2784),c=n(62202),d=n(99959),u=n(31362),m=n(27570),h=n(41543),p=n(62029),x=n(61531),f=n(6499),g=n(92270),j=n(73831),v=e=>{let{schema:t,tables:n,hasTables:a,isLocked:v,onSelectCreatePolicy:y,onSelectEditPolicy:b}=e,N=(0,l.useRouter)(),{ref:w}=(0,d.UO)(),{project:_}=(0,m.d2)(),[C,S]=(0,o.useState)({}),[k,E]=(0,o.useState)({}),{mutate:A}=(0,g.V)({onError:e=>{c.ZP.error("Failed to toggle RLS: ".concat(e.message))},onSettled:()=>{I()}}),{mutate:T}=(0,f.l)({onSuccess:()=>{c.ZP.success("Successfully deleted policy!")},onSettled:()=>{I()}}),I=()=>{E({}),S({})},Z=e=>{S(e)},z=e=>{b(e)},P=e=>{E(e)},R=async()=>{let e={id:C.id,rls_enabled:!C.rls_enabled};A({projectRef:null==_?void 0:_.ref,connectionString:null==_?void 0:_.connectionString,id:e.id,schema:C.schema,payload:e})},L=async()=>{if(!_)return console.error("Project is required");T({projectRef:_.ref,connectionString:_.connectionString,id:k.id})};return 0===n.length?(0,s.jsx)("div",{className:"flex-grow flex items-center justify-center",children:(0,s.jsx)(p.Z,{size:"large",title:"Row-Level Security (RLS) Policies",ctaButtonLabel:"Create a table",infoButtonLabel:"What is RLS?",infoButtonUrl:"https://supabase.com/docs/guides/auth/row-level-security",onClickCta:()=>N.push("/project/".concat(w,"/editor")),children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(x.Z,{title:"What are policies?",icon:(0,s.jsx)(r.Z,{size:14,strokeWidth:2}),description:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm",children:"Policies restrict, on a per-user basis, which rows can be returned by normal queries, or inserted, updated, or deleted by data modification commands."}),(0,s.jsx)("p",{className:"text-sm",children:"This is also known as Row-Level Security (RLS). Each policy is attached to a table, and the policy is executed each time its accessed."})]})}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Create a table in this schema first before creating a policy."})]})})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-4 pb-4",children:[v&&(0,s.jsx)(u.Z,{schema:t,entity:"policies"}),n.length>0?n.map(e=>(0,s.jsx)("section",{children:(0,s.jsx)(ey,{table:e,isLocked:v,onSelectToggleRLS:Z,onSelectCreatePolicy:()=>y(e.name),onSelectEditPolicy:z,onSelectDeletePolicy:P})},e.id)):a?(0,s.jsx)(h.Z,{}):null]}),(0,s.jsx)(j.Z,{danger:!0,visible:!i()(k),title:"Confirm to delete policy",description:'This is permanent! Are you sure you want to delete the policy "'.concat(k.name,'"'),buttonLabel:"Delete",buttonLoadingLabel:"Deleting",onSelectCancel:I,onSelectConfirm:L}),(0,s.jsx)(j.Z,{danger:C.rls_enabled,visible:!i()(C),title:"Confirm to ".concat(C.rls_enabled?"disable":"enable"," Row Level Security"),description:"Are you sure you want to ".concat(C.rls_enabled?"disable":"enable",' Row Level Security for the table "').concat(C.name,'"?'),buttonLabel:"Confirm",buttonLoadingLabel:"Saving",onSelectCancel:I,onSelectConfirm:R})]})},y=n(34291),b=n.n(y),N=n(99248),w=n(16289),_=n(47852),C=n(74138);let S={SELECTION:"SELECTION",TEMPLATES:"TEMPLATES",EDITOR:"EDITOR",REVIEW:"REVIEW"};var k=n(93352),E=n.n(k),A=n(18149),T=n.n(A);let I=(e,t)=>{let{definition:n,check:s}=e,a={...e,definition:n?n.replace(/\s+/g," ").trim():void 0===n?null:n,check:s?s.replace(/\s+/g," ").trim():void 0===s?null:s};if(i()(t))return Z(a);if(T()(e,t))return{};let r={};return(T()(a.name,t.name)||(r.name=a.name),T()(a.definition,t.definition)||(r.definition=a.definition),T()(a.check,t.check)||(r.check=a.check),T()(a.roles,t.roles)||(r.roles=a.roles),i()(r))?{}:z(a,r)},Z=e=>{let{name:t,definition:n,check:s,command:a,schema:i,table:r}=e,l=0===e.roles.length?["public"]:e.roles;return{description:"Add policy for the ".concat(a,' operation under the policy "').concat(t,'"'),statement:['CREATE POLICY "'.concat(t,'" ON "').concat(i,'"."').concat(r,'"'),"AS PERMISSIVE FOR ".concat(a),"TO ".concat(l.join(", ")),"".concat(n?"USING (".concat(n,")"):""),"".concat(s?"WITH CHECK (".concat(s,")"):"")].join("\n")}},z=(e,t)=>{var n;let{name:s,schema:a,table:i}=e,r=E()(t,["definition"]),l=E()(t,["check"]),o=E()(t,["name"]),c=E()(t,["roles"]),d=Object.keys(t),u="Update policy's ".concat(1===d.length?d[0]:"".concat(d.slice(0,d.length-1).join(", ")," and ").concat(d[d.length-1])," "),m=0===(null!==(n=null==t?void 0:t.roles)&&void 0!==n?n:[]).length?["public"]:t.roles,h='ALTER POLICY "'.concat(s,'" ON "').concat(a,'"."').concat(i,'"');return{description:u,statement:["BEGIN;",...r?["  ".concat(h," USING (").concat(t.definition,");")]:[],...l?["  ".concat(h," WITH CHECK (").concat(t.check,");")]:[],...c?["  ".concat(h," TO ").concat(m.join(", "),";")]:[],...o?["  ".concat(h,' RENAME TO "').concat(t.name,'";')]:[],"COMMIT;"].join("\n")}},P=e=>{let{command:t,definition:n,check:s,roles:a}=e;return{...e,action:"PERMISSIVE",command:t||void 0,definition:n||void 0,check:s||void 0,roles:a.length>0?a:void 0}},R=(e,t)=>{let{definition:n,check:s}=e,a={...e,definition:n?n.replace(/\s+/g," ").trim():n,check:s?s.replace(/\s+/g," ").trim():s},i={id:t.id};return T()(a.name,t.name)||(i.name=a.name),T()(a.definition,t.definition)||(i.definition=a.definition||void 0),T()(a.check,t.check)||(i.check=a.check||void 0),T()(a.roles,t.roles)||(0===a.roles.length?i.roles=["public"]:i.roles=a.roles||void 0),i};var L=n(28019),O=n(70458),D=n(32079),F=e=>{let{policy:t={},onSelectBack:n=b(),onSelectSave:a=b()}=e,[r,l]=(0,o.useState)(!1),c=t.statement||"";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.C.Content,{children:(0,s.jsxs)("div",{className:"space-y-6 py-8",children:[(0,s.jsx)("div",{className:"flex items-center justify-between space-y-8",children:(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"This is the SQL statement that will be used to create your policy."})})}),(0,s.jsx)("div",{className:"space-y-4 overflow-y-auto",style:{maxHeight:"25rem"},children:i()(t)?(0,s.jsx)("div",{className:"my-10 flex items-center justify-center space-x-2 opacity-50",children:(0,s.jsx)("p",{className:"text-base text-foreground-light",children:"There are no changes made to this policy"})}):(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("span",{children:t.description}),(0,s.jsx)("div",{className:"h-40",children:(0,s.jsx)(O.Z,{readOnly:!0,defaultValue:c})})]})})]})}),(0,s.jsxs)("div",{className:"flex w-full items-center justify-end gap-2 border-t px-6 py-4 border-default",children:[(0,s.jsx)(D.z,{type:"default",onClick:n,children:"Back to edit"}),(0,s.jsx)(D.z,{type:"primary",disabled:i()(t),onClick:()=>{l(!0),a()},loading:r,children:"Save policy"})]})]})},U=n(86699),M=n(2515),q=function(e){return(0,s.jsx)(M.Z,{icon:U.Z,...e})},B=n(74559),W=n(95492),G=n(32830),H=n(43276),Y=n(39383),V=e=>{let{description:t="",showAssistantPreview:n,onViewTemplates:a=b(),onViewEditor:i=b(),onToggleFeaturePreviewModal:r}=e;return(0,w.WZ)(),(0,s.jsxs)(_.C.Content,{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:t}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-2 lg:grid-cols-1",children:[(0,s.jsx)(H.Z,{title:"Get started quickly",description:"Create a policy from a template",icon:(0,s.jsx)("div",{className:"flex",children:(0,s.jsx)("div",{className:" flex h-8 w-8 items-center justify-center rounded bg-foreground text-background ",children:(0,s.jsx)(q,{size:14,strokeWidth:2})})}),onClick:a}),(0,s.jsx)(H.Z,{title:"For full customization",description:"Create a policy from scratch",icon:(0,s.jsx)("div",{className:"flex",children:(0,s.jsx)("div",{className:" flex h-8 w-8 items-center justify-center rounded bg-foreground text-background ",children:(0,s.jsx)(B.Z,{size:14,strokeWidth:2})})}),onClick:i})]})]}),n&&void 0!==r&&(0,s.jsxs)(W.bZ,{children:[(0,s.jsx)(Y.Z,{}),(0,s.jsx)(W.Cd,{children:"Try the new Supabase Assistant for RLS policies"}),(0,s.jsx)(W.X,{children:"Create RLS policies for your tables with the help of AI"}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,s.jsx)(D.z,{type:"default",onClick:r,children:"Toggle feature preview"}),(0,s.jsx)(D.z,{asChild:!0,type:"default",icon:(0,s.jsx)(G.Z,{size:14,strokeWidth:1.5}),children:(0,s.jsx)("a",{href:"https://supabase.com/blog/studio-introducing-assistant#introducing-the-supabase-assistant",target:"_blank",rel:"noreferrer",children:"Learn more"})})]})]})]})},K=e=>{let{selectedTemplate:t}=e,{id:n,templateName:a,description:r,statement:l}=t;return(0,s.jsx)("div",{className:"space-y-8",style:{width:"70%"},children:!i()(t)&&(0,s.jsx)("div",{className:"flex h-full flex-col justify-between",children:(0,s.jsxs)("div",{className:"my-5 h-full space-y-6 px-6",children:[(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,s.jsx)("h3",{className:"text-foreground text-base",children:a}),(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:r})]})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-foreground-light text-sm",children:"Policy SQL template:"}),(0,s.jsx)("div",{className:"h-64",children:(0,s.jsx)(O.Z,{readOnly:!0,queryId:n,defaultValue:l})})]})]})})})},X=n(3085),Q=e=>{let{templates:t=[],templatesNote:n="",selectedTemplate:a,setSelectedTemplate:i=b()}=e;return(0,s.jsxs)("div",{className:"flex flex-col justify-between border-r border-default",style:{width:"30%"},children:[(0,s.jsx)("div",{className:"hide-scrollbar  divide-border-primary space-y-0 divide-y divide-solid overflow-y-auto",style:{maxHeight:"24rem"},children:(0,s.jsx)(X.ZP,{type:"border",children:t.map((e,t)=>{let n=(null==a?void 0:a.id)===(null==e?void 0:e.id);return(0,s.jsx)("div",{className:"border-b border-overlay hover:bg-surface-200 "+(n?"bg-surface-300":""),children:(0,s.jsx)(X.ZP.Item,{active:n,onClick:()=>i(e),children:(0,s.jsx)("div",{className:"truncate py-2",children:e.templateName})},e.id)},t)})})}),n&&(0,s.jsx)("div",{className:"px-4 py-2",children:(0,s.jsx)("p",{className:"text-xs text-foreground-lighter",children:n})})]})},$=e=>{let{templates:t=[],templatesNote:n="",onUseTemplate:a=b()}=e,[r,l]=(0,o.useState)(t[0]);return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between border-t border-default",children:[(0,s.jsx)(Q,{templatesNote:n,templates:t,selectedTemplate:r,setSelectedTemplate:l}),(0,s.jsx)(K,{selectedTemplate:r})]}),(0,s.jsxs)("div",{className:"flex w-full items-center justify-end gap-3 border-t px-6 py-4 border-default",children:[(0,s.jsx)("span",{className:"text-sm text-foreground-lighter",children:"This will override any existing code you've written"}),(0,s.jsx)(D.z,{type:"primary",disabled:i()(r),onClick:()=>a(r),children:"Use this template"})]})]})},J=n(61576),ee=n(52253),et=e=>{let{view:t,schema:n,table:a,isNewPolicy:i,showAssistantPreview:r,onSelectBackFromTemplates:l=b(),onToggleFeaturePreviewModal:o}=e,c=()=>t===S.EDITOR||t===S.SELECTION?"".concat(i?"Adding new policy to":"Editing policy from"," ").concat(n,".").concat(a):t===S.REVIEW?"Reviewing policy to be ".concat(i?"created":"updated"," on ").concat(n,".").concat(a):void 0;return t===S.TEMPLATES?(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("span",{onClick:l,className:"cursor-pointer text-foreground-lighter transition-colors hover:text-foreground",children:(0,s.jsx)(ee.Z,{strokeWidth:2,size:14})}),(0,s.jsx)("h4",{children:"Select a template to use for your new policy"})]})}):(0,s.jsxs)("div",{className:"w-full flex items-center justify-between gap-x-4",children:[(0,s.jsx)("h4",{className:"truncate",title:c(),children:c()}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[r&&t===S.EDITOR&&(0,s.jsx)(D.z,{type:"default",icon:(0,s.jsx)(Y.Z,{size:14}),onClick:o,children:"Try Supabase Assistant"}),(0,s.jsx)(D.z,{asChild:!0,type:"default",icon:(0,s.jsx)(G.Z,{size:14}),children:(0,s.jsxs)("a",{href:"https://supabase.com/docs/learn/auth-deep-dive/auth-policies",target:"_blank",rel:"noreferrer",children:[" ","Documentation"]})})]})]})},en=e=>{let{visible:t=!1,schema:n="",table:a="",selectedPolicyToEdit:r={},showAssistantPreview:l=!1,onSelectCancel:d=b(),onCreatePolicy:u,onUpdatePolicy:m,onSaveSuccess:h=b()}=e,p=(0,w.WZ)(),x=i()(r),f=x?{schema:n,table:a,name:"",definition:"",check:"",command:null,roles:[]}:r,[g,j]=(0,o.useState)(""),[v,y]=(0,o.useState)(S.EDITOR),[k,E]=(0,o.useState)(f),[A,T]=(0,o.useState)(""),[Z,z]=(0,o.useState)(!1),[O,D]=(0,o.useState)(!1);(0,o.useEffect)(()=>{t&&(x?U():M(),E(f))},[t]);let U=()=>y(S.SELECTION),M=()=>y(S.EDITOR),q=()=>{j(v),y(S.TEMPLATES)},B=()=>y(S.REVIEW),W=()=>{p.setSelectedFeaturePreview(N.dA.UI_PREVIEW_RLS_AI_ASSISTANT),p.setShowFeaturePreviewModal(!p.showFeaturePreviewModal),d()},G=async e=>{(x?await u(e):await m(e))?M():h()};return(0,s.jsx)(_.C,{hideFooter:!0,size:v===S.SELECTION?"medium":"xxlarge",visible:t,contentStyle:{padding:0},header:[(0,s.jsx)(et,{view:v,isNewPolicy:x,schema:n,table:a,showAssistantPreview:l,onSelectBackFromTemplates:()=>y(g),onToggleFeaturePreviewModal:W},"0")],onCancel:()=>{Z?D(!0):d()},children:(0,s.jsxs)("div",{children:[(0,s.jsx)(C.Z,{visible:O,title:"Discard changes",confirmLabel:"Discard",onCancel:()=>D(!1),onConfirm:()=>{d(),D(!1),z(!1)},children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"There are unsaved changes. Are you sure you want to close the editor? Your changes will be lost."})}),v===S.SELECTION?(0,s.jsx)(V,{description:"Write rules with PostgreSQL's policies to fit your unique business needs.",onViewTemplates:q,onViewEditor:M,showAssistantPreview:l,onToggleFeaturePreviewModal:W}):v===S.EDITOR?(0,s.jsx)(L.ZP,{isNewPolicy:x,policyFormFields:k,onUpdatePolicyFormFields:e=>{z(!0),e.name&&e.name.length>63||E({...k,...e})},onViewTemplates:q,onReviewPolicy:()=>{let{name:e,definition:t,check:n,command:s}=k;return 0===e.length?c.ZP.error("Please provide a name for your policy"):s?["SELECT","DELETE"].includes(s)&&!t?c.ZP.error("Please provide a USING expression for your policy"):"INSERT"!==s||n?"UPDATE"!==s||t||n?void(T(I(k,r)),B()):c.ZP.error("Please provide either a USING, or WITH CHECK expression, or both for your policy"):c.ZP.error("Please provide a WITH CHECK expression for your policy"):c.ZP.error("Please select an operation for your policy")}}):v===S.TEMPLATES?(0,s.jsx)($,{templates:(0,J.g)(n,a).filter(e=>!e.preview),templatesNote:"* References a specific column in the table",onUseTemplate:e=>{E({...k,name:e.name,definition:e.definition,check:e.check,command:e.command,roles:e.roles}),M()}}):v===S.REVIEW?(0,s.jsx)(F,{policy:A,onSelectBack:M,onSelectSave:()=>{G(x?P(k):R(k,r)),z(!1)}}):null]})})},es=n(70847),ea=n(64306),ei=n(49521),er=n(24990),el=n(59491),eo=n(81076),ec=n(34503),ed=n(23056),eu=n(62134),em=n(14528),eh=n(33635),ep=e=>{let{policy:t,onSelectEditPolicy:n=b(),onSelectDeletePolicy:a=b()}=e,i=(0,em.Xo)(el.KA.TENANT_SQL_ADMIN_WRITE,"policies"),{project:r}=(0,m.d2)(),{data:l}=(0,eh.$E)({projectRef:null==r?void 0:r.ref}),o=(null==l?void 0:l.EXTERNAL_ANONYMOUS_USERS_ENABLED)&&(t.roles.includes("authenticated")||t.roles.includes("public"));return(0,s.jsxs)(ea.Z.Content,{className:"flex border-overlay w-full space-x-4 border-b py-4 lg:items-center",children:[(0,s.jsxs)("div",{className:"flex grow flex-col space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("p",{className:"font-mono text-xs text-foreground-light",children:t.command}),(0,s.jsx)("p",{className:"text-sm text-foreground",children:t.name}),o?(0,s.jsx)(eo.C,{color:"yellow",children:"Applies to anonymous users"}):null]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:"Applied to:"}),t.roles.slice(0,3).map((e,t)=>(0,s.jsx)("code",{className:"text-foreground-light text-xs",children:e},"policy-".concat(e,"-").concat(t))),(0,s.jsxs)(er.fC,{delayDuration:0,children:[(0,s.jsx)(er.xz,{children:t.roles.length>3&&(0,s.jsxs)("code",{className:"text-foreground-light text-xs",children:["+ ",t.roles.length-3," more roles"]},"policy-etc")}),(0,s.jsx)(er.h_,{children:(0,s.jsxs)(er.VY,{side:"bottom",children:[(0,s.jsx)(er.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background max-w-[220px] text-center",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:t.roles.slice(3).join(", ")})})]})})]})]})]}),(0,s.jsx)("div",{children:i?(0,s.jsxs)(ec.h_,{children:[(0,s.jsx)(ec.$F,{asChild:!0,children:(0,s.jsx)(D.z,{type:"default",style:{paddingLeft:4,paddingRight:4},icon:(0,s.jsx)(ed.Z,{})})}),(0,s.jsxs)(ec.AW,{side:"bottom",align:"end",className:"w-40",children:[(0,s.jsxs)(ec.Xi,{className:"space-x-2",onClick:()=>n(t),children:[(0,s.jsx)(B.Z,{size:14}),(0,s.jsx)("p",{children:"Edit policy"})]}),(0,s.jsx)(ec.VD,{}),(0,s.jsxs)(ec.Xi,{className:"space-x-2",onClick:()=>a(t),children:[(0,s.jsx)(eu.Z,{size:14}),(0,s.jsx)("p",{children:"Delete policy"})]})]})]}):(0,s.jsxs)(er.fC,{delayDuration:0,children:[(0,s.jsx)(er.xz,{asChild:!0,children:(0,s.jsx)(D.z,{disabled:!0,type:"default",style:{paddingLeft:4,paddingRight:4},icon:(0,s.jsx)(ed.Z,{})})}),!i&&(0,s.jsx)(er.h_,{children:(0,s.jsxs)(er.VY,{side:"left",children:[(0,s.jsx)(er.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to edit RLS policies"})})]})})]})})]})},ex=n(16826),ef=n(39097),eg=n.n(ef),ej=n(63910),ev=e=>{let{table:t,isLocked:n,onSelectToggleRLS:a=b(),onSelectCreatePolicy:i}=e,{ref:r}=(0,l.useRouter)().query,o=(0,ej.bB)(),c=(0,em.Xo)(el.KA.TENANT_SQL_ADMIN_WRITE,"tables");return(0,s.jsxs)("div",{id:t.id.toString(),className:"flex w-full items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex gap-x-4 text-left",children:[(0,s.jsx)(eg(),{href:"/project/".concat(r,"/editor/").concat(t.id),children:(0,s.jsx)("h4",{className:"m-0",children:t.name})}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[n&&(0,s.jsx)(eo.C,{children:(0,s.jsxs)("span",{className:"flex gap-2 items-center text-xs uppercase text-foreground-lighter",children:[(0,s.jsx)(ex.Z,{size:12})," Locked"]})}),(0,s.jsx)(eo.C,{variant:t.rls_enabled?"brand":"warning",children:t.rls_enabled?"Row Level Security enabled":"Row Level Security disabled"})]})]}),!n&&(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"flex flex-row justify-end gap-x-2",children:[(0,s.jsxs)(er.fC,{delayDuration:0,children:[(0,s.jsx)(er.xz,{asChild:!0,children:(0,s.jsx)(D.z,{type:"default",disabled:!c,onClick:()=>a(t),children:t.rls_enabled?"Disable RLS":"Enable RLS"})}),!c&&(0,s.jsx)(er.h_,{children:(0,s.jsxs)(er.VY,{side:"bottom",children:[(0,s.jsx)(er.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to toggle RLS"})})]})})]}),!o&&(0,s.jsx)(D.z,{type:"default",disabled:!c,onClick:()=>i(),children:"Create policy"})]})})]})},ey=e=>{let{table:t,isLocked:n,onSelectToggleRLS:a=b(),onSelectCreatePolicy:i,onSelectEditPolicy:r=b(),onSelectDeletePolicy:l=b()}=e,{project:o}=(0,m.d2)(),{data:c}=(0,ei.r)({projectRef:null==o?void 0:o.ref,connectionString:null==o?void 0:o.connectionString}),d=(null!=c?c:[]).filter(e=>e.schema===t.schema&&e.table===t.name).sort((e,t)=>e.name.localeCompare(t.name));return(0,s.jsxs)(ea.Z,{className:"!m-0",title:(0,s.jsx)(ev,{table:t,isLocked:n,onSelectToggleRLS:a,onSelectCreatePolicy:i}),children:[(!t.rls_enabled||0===d.length)&&(0,s.jsxs)("div",{className:"px-6 py-4 flex flex-col gap-y-3",children:[t.rls_enabled&&0===d.length&&(0,s.jsxs)(W.bZ,{children:[(0,s.jsx)(es.aN,{}),(0,s.jsx)(W.Cd,{children:"Row Level Security is enabled for this table, but no policies are set"}),(0,s.jsxs)(W.X,{children:["Select queries will return an"," ",(0,s.jsx)("span",{className:"text-foreground underline",children:"empty array"})," of results."]})]}),!t.rls_enabled&&(0,s.jsxs)(W.bZ,{variant:"warning",children:[(0,s.jsx)(es.aN,{}),(0,s.jsx)(W.Cd,{children:"Warning: Row Level Security is disabled. Your table is publicly readable and writable."}),(0,s.jsx)(W.X,{children:"Anyone with the project's anonymous key can modify or delete your data. Enable RLS and create access policies to keep your data secure."})]}),0===d.length&&(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:"No policies created yet"})]}),null==d?void 0:d.map(e=>(0,s.jsx)(ep,{policy:e,onSelectEditPolicy:r,onSelectDeletePolicy:l},e.id))]})}},92293:function(e,t,n){"use strict";n.d(t,{Y:function(){return a},w:function(){return s}});let s=.8,a=["Pricing","My project isn't getting traction","Poor customer service","Missing feature","I didn't see the value","Supabase didn't meet my needs","Dashboard is too complicated","Postgres is too complicated","Problem not solved","Too many bugs/issues","I decided to use something else","My work has finished/discontinued","Im migrating to/starting a new project","None of the above"]},46216:function(e,t,n){"use strict";var s=n(52322),a=n(39097),i=n.n(a),r=n(84605),l=n(61531),o=n(26198),c=n(93463);t.Z=e=>{var t;let{organization:n}=e,{data:a}=(0,o.Sy)({}),d=null!==(t=null==a?void 0:a.filter(e=>e.organization_id===(null==n?void 0:n.id)).length)&&void 0!==t?t:0,{data:u}=(0,c.G)({orgSlug:null==n?void 0:n.slug});return d>0||(null==u?void 0:u.plan)===void 0||"free"===u.plan.id||"enterprise"===u.plan.id?null:(0,s.jsx)(l.Z,{defaultVisibility:!0,hideCollapse:!0,title:"Your organization is on the ".concat(u.plan.name," plan with no projects running"),icon:(0,s.jsx)(r.Z,{strokeWidth:2}),description:(0,s.jsxs)("div",{children:["The monthly fees for the paid plan still apply. To cancel your subscription, head over to your"," ",(0,s.jsx)(i(),{href:"/org/".concat(null==n?void 0:n.slug,"/billing"),className:"text-sm text-green-900 transition hover:text-green-1000",children:"organization billing settings ."})]})})}},43544:function(e,t,n){"use strict";n.d(t,{Z:function(){return b}});var s=n(52322),a=n(12333),i=n(66432),r=n(83765),l=n(6659),o=n(2784),c=n(62202),d=n(47852),u=n(48228),m=n(31696);async function h(e){let{slug:t,hcaptchaToken:n}=e,{data:s,error:a}=await (0,m.v_)("/platform/organizations/{slug}/payments/setup-intent",{params:{path:{slug:t}},body:{hcaptchaToken:n}});return a&&(0,m.S3)(a),s}let p=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,u.D)(e=>h(e),{async onSuccess(t,n,s){await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?c.Am.error("Failed to setup intent: ".concat(e.message)):t(e,n,s)},...n})};var x=n(14528),f=n(99248),g=n(30242),j=n(32079),v=e=>{let{returnUrl:t,onCancel:n,onConfirm:a}=e,r=(0,i.useStripe)(),l=(0,i.useElements)(),[u,m]=(0,o.useState)(!1),h=async e=>{if(e.preventDefault(),!r||!l){console.error("Stripe.js has not loaded");return}m(!0),void 0!==document&&document.body.classList.add("!pointer-events-auto");let{error:n}=await r.confirmSetup({elements:l,redirect:"if_required",confirmParams:{return_url:t}});if(n){var s;m(!1),c.ZP.error(null!==(s=null==n?void 0:n.message)&&void 0!==s?s:" Failed to save card details")}else m(!1),a();void 0!==document&&document.body.classList.remove("!pointer-events-auto")};return(0,s.jsxs)("form",{onSubmit:h,children:[(0,s.jsx)(d.C.Content,{children:(0,s.jsx)("div",{className:"transition ".concat(u?"pointer-events-none opacity-75":"opacity-100"),children:(0,s.jsx)(i.PaymentElement,{})})}),(0,s.jsx)(d.C.Separator,{}),(0,s.jsx)(d.C.Content,{children:(0,s.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,s.jsx)(j.z,{block:!0,htmlType:"submit",type:"primary",loading:u,disabled:u,children:"Save"}),(0,s.jsx)(j.z,{htmlType:"button",type:"default",onClick:n,block:!0,disabled:u,children:"Cancel"})]})})]})};let y=(0,r.J)(f.Yw);var b=e=>{let{visible:t,returnUrl:n,onCancel:r,onConfirm:u}=e,{resolvedTheme:m}=(0,l.F)(),[h,f]=(0,o.useState)(),j=(0,x.lL)(),b=(0,g.Y)(),[N,w]=(0,o.useState)(null),[_,C]=(0,o.useState)(null),{mutate:S}=p({onSuccess:e=>{f(e)},onError:e=>{c.ZP.error("Failed to setup intent: ".concat(e.message))}}),k=(0,o.useCallback)(e=>{C(e)},[]);(0,o.useEffect)(()=>{let e=async e=>{let t=null==j?void 0:j.slug;return t?e?void(f(void 0),S({slug:t,hcaptchaToken:e})):console.error("HCaptcha token required"):console.error("Slug is required")};(async()=>{if(t&&_&&b){let t=N;try{if(!t){var n;let e=await _.execute({async:!0});t=null!==(n=null==e?void 0:e.response)&&void 0!==n?n:null}}catch(e){return}await e(null!=t?t:void 0),E()}})()},[t,_,b]);let E=()=>{w(null),null==_||_.resetCaptcha()},A={clientSecret:h?h.client_secret:"",appearance:{theme:(null==m?void 0:m.includes("dark"))?"night":"flat",labels:"floating"}},T=()=>(f(void 0),r());return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Z,{ref:k,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{T(),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onVerify:e=>{w(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>{w(null)}}),(0,s.jsx)(d.C,{hideFooter:!0,size:"medium",visible:t&&void 0!==h,header:"Add new payment method",onCancel:T,className:"PAYMENT",children:(0,s.jsx)("div",{className:"py-4 space-y-4",children:(0,s.jsx)(i.Elements,{stripe:y,options:A,children:(0,s.jsx)(v,{returnUrl:n,onCancel:T,onConfirm:()=>(f(void 0),u())})})})})]})}},31362:function(e,t,n){"use strict";n.d(t,{b:function(){return d}});var s=n(52322),a=n(2784),i=n(47852),r=n(32079),l=n(95492),o=n(39459),c=n(11354);let d=e=>{let{visible:t,onClose:n}=e;return(0,s.jsx)(i.C,{size:"medium",visible:t,header:"Schemas managed by Supabase",customFooter:(0,s.jsx)("div",{className:"flex items-center justify-end space-x-2",children:(0,s.jsx)(r.z,{type:"default",onClick:()=>n(),children:"Understood"})}),onCancel:()=>n(),children:(0,s.jsxs)(i.C.Content,{className:"py-4 space-y-2",children:[(0,s.jsx)("p",{className:"text-sm",children:"The following schemas are managed by Supabase and are currently protected from write access through the dashboard."}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:c.F.map(e=>(0,s.jsx)("code",{className:"text-xs",children:e},e))}),(0,s.jsx)("p",{className:"text-sm !mt-4",children:"These schemas are critical to the functionality of your Supabase project and hence we highly recommend not altering them."}),(0,s.jsx)("p",{className:"text-sm",children:"You can, however, still interact with those schemas through the SQL Editor although we advise you only do so if you know what you are doing."})]})})};t.Z=e=>{let{schema:t,entity:n}=e,[i,c]=(0,a.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.bZ,{children:[(0,s.jsx)(o.Z,{strokeWidth:2}),(0,s.jsxs)(l.Cd,{children:["Currently viewing ",n," from a protected schema"]}),(0,s.jsxs)(l.X,{children:[(0,s.jsxs)("p",{className:"mb-2",children:["The ",(0,s.jsx)("code",{className:"text-xs",children:t})," schema is managed by Supabase and is read-only through the dashboard."]}),(0,s.jsx)(r.z,{type:"default",size:"tiny",onClick:()=>c(!0),children:"Learn more"})]})]}),(0,s.jsx)(d,{visible:i,onClose:()=>c(!1)})]})}},31738:function(e,t,n){"use strict";n.d(t,{Bv:function(){return a},IC:function(){return i},NM:function(){return s}});let s=["anon","service_role","authenticated","authenticator","dashboard_user","supabase_admin","supabase_auth_admin","supabase_functions_admin","supabase_read_only_user","supabase_realtime_admin","supabase_replication_admin","supabase_storage_admin","pgbouncer","pgsodium_keyholder","pgsodium_keyiduser","pgsodium_keymaker","pgtle_admin"],a=["postgres","pgbouncer","supabase_admin","supabase_auth_admin","supabase_storage_admin","dashboard_user","authenticator","pg_database_owner","pg_read_all_data","pg_write_all_data"],i={canLogin:{disabled:!1,description:"User can login",grant_by_dashboard:!0},canCreateRole:{disabled:!1,description:"User can create roles",grant_by_dashboard:!0},canCreateDb:{disabled:!1,description:"User can create databases",grant_by_dashboard:!0},canBypassRls:{disabled:!1,description:"User bypasses every row level security policy",grant_by_dashboard:!0},isSuperuser:{disabled:!0,description:"User is a Superuser",grant_by_dashboard:!1},isReplicationRole:{disabled:!1,description:"User can initiate streaming replication and put the system in and out of backup mode",grant_by_dashboard:!0}}},2320:function(e,t,n){"use strict";var s=n(52322),a=n(2322);t.Z=e=>{let{projectUpdateDisabled:t,projectNotActive:n=!1,children:i,tooltip:r}=e;return(0,s.jsxs)(a.u,{children:[(0,s.jsx)(a.aJ,{asChild:!0,children:i}),t&&(0,s.jsx)(a._v,{side:"bottom",className:"w-72 text-center",children:t?r||"Subscription changes are currently disabled. Our engineers are working on a fix.":n?"Unable to update subscription as project is currently not active":""})]})}},41421:function(e,t,n){"use strict";var s=n(52322),a=n(59491),i=n(90488);let r=e=>{let{description:t,hasReadScope:n,hasWriteScope:a}=e;if(n||a){let e=[n?"Read":null,a?"Write":null].filter(Boolean).map(e=>(0,s.jsx)("span",{className:"font-semibold text-foreground",children:e},e)).reduce((e,t)=>(0,s.jsxs)(s.Fragment,{children:[e,(0,s.jsx)("span",{children:" and "}),t]}));return(0,s.jsxs)("div",{className:"first:border-t border-b flex flex-row space-x-1 text-sm text-foreground-light py-2 px-1",children:[(0,s.jsx)("div",{className:"pt-0.5",children:(0,s.jsx)(i.Z,{stroke:"green",height:18,width:18,strokeWidth:1.5})}),(0,s.jsxs)("div",{children:[e," ",t]})]})}return null};t.Z=e=>{let{icon:t,name:n,domain:i,scopes:l}=e;return(0,s.jsxs)("div",{className:"flex space-y-4 flex-col",children:[(0,s.jsxs)("div",{className:"flex flex-row space-x-4",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("div",{className:"w-14 h-14 md:w-16 md:h-16 bg-center bg-no-repeat bg-cover flex items-center justify-center rounded-md border border-control",style:{backgroundImage:null!==t?"url('".concat(t,"')"):"none"},children:null===t&&(0,s.jsx)("p",{className:"text-foreground-light text-lg",children:n[0]})})}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:[n," (",i,") is requesting API access to an organization."]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"Permissions"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["The following scopes will apply for the"," ",(0,s.jsx)("span",{className:"text-amber-900",children:"selected organization and all of its projects."})]}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsx)(r,{description:"access to auth configurations and SSO providers.",hasReadScope:l.includes(a.YX.AUTH_READ),hasWriteScope:l.includes(a.YX.AUTH_WRITE)}),(0,s.jsx)(r,{description:"access to Postgres configurations, SQL snippets, SSL enforcement configurations and Typescript schema types.",hasReadScope:l.includes(a.YX.DATABASE_READ),hasWriteScope:l.includes(a.YX.DATABASE_WRITE)}),(0,s.jsx)(r,{description:"access to custom domains and vanity subdomains.",hasReadScope:l.includes(a.YX.DOMAINS_READ),hasWriteScope:l.includes(a.YX.DOMAINS_WRITE)}),(0,s.jsx)(r,{description:"access to edge functions.",hasReadScope:l.includes(a.YX.EDGE_FUNCTIONS_READ),hasWriteScope:l.includes(a.YX.EDGE_FUNCTIONS_WRITE)}),(0,s.jsx)(r,{description:"access to environments/branches.",hasReadScope:l.includes(a.YX.ENVIRONMENT_READ),hasWriteScope:l.includes(a.YX.ENVIRONMENT_WRITE)}),(0,s.jsx)(r,{description:"access to the organization and all its members.",hasReadScope:l.includes(a.YX.ORGANIZATIONS_READ),hasWriteScope:l.includes(a.YX.ORGANIZATIONS_WRITE)}),(0,s.jsx)(r,{description:"access to metadata, its upgrade status, network restrictions and network bans.",hasReadScope:l.includes(a.YX.PROJECTS_READ),hasWriteScope:l.includes(a.YX.PROJECTS_WRITE)}),(0,s.jsx)(r,{description:"access to PostgREST configurations.",hasReadScope:l.includes(a.YX.REST_READ),hasWriteScope:l.includes(a.YX.REST_WRITE)}),(0,s.jsx)(r,{description:"access to API keys, secrets and pgsodium configurations.",hasReadScope:l.includes(a.YX.SECRETS_READ),hasWriteScope:l.includes(a.YX.SECRETS_WRITE)}),(0,s.jsx)(r,{description:"access to storage buckets and files.",hasReadScope:l.includes(a.YX.STORAGE_READ),hasWriteScope:l.includes(a.YX.STORAGE_WRITE)})]})]})]})}},97072:function(e,t,n){"use strict";n.d(t,{bm:function(){return l},ty:function(){return o}});var s=n(52322),a=n(92293),i=n(86418),r=n(48869);let l={white:{bar:"fill-foreground",marker:"bg-foreground"},green:{bar:"fill-green-800",marker:"bg-green-800"},"dark-green":{bar:"fill-green-1000",marker:"bg-green-1000"},blue:{bar:"fill-blue-900",marker:"bg-blue-900"},yellow:{bar:"fill-yellow-800",marker:"bg-yellow-800"},"dark-yellow":{bar:"fill-yellow-1000",marker:"bg-yellow-1000"},orange:{bar:"fill-orange-800",marker:"bg-orange-800"},"dark-orange":{bar:"fill-orange-1000",marker:"bg-orange-1100"},red:{bar:"fill-red-800",marker:"bg-red-800"},"dark-red":{bar:"fill-red-1000",marker:"bg-red-1000"},purple:{bar:"fill-purple-900",marker:"bg-purple-900"}},o=[{key:"bandwidth",name:"Bandwidth",description:"Amount of data transmitted over all network connections",attributes:[{anchor:"egress",key:i.tk.EGRESS,attributes:[{key:i.Iw.AUTH,name:"Auth Egress",color:"yellow"},{key:i.Iw.DATABASE,name:"Database Egress",color:"green"},{key:i.Iw.STORAGE,name:"Storage Egress",color:"blue"},{key:i.Iw.REALTIME,name:"Realtime Egress",color:"orange"},{key:i.Iw.FUNCTIONS,name:"Functions Egress",color:"purple"},{key:i.Iw.SUPAVISOR,name:"Supavisor Egress",color:"red"}],name:"Total Egress",unit:"bytes",description:"Contains any outgoing traffic (includes Database, Storage, Realtime, Auth, API, Edge Functions, Supavisor) from your database.\nBilling is based on the total sum of egress in GB throughout your billing period.",chartDescription:"The data refreshes every 24 hours."}]},{key:"sizeCount",name:"Size & Counts",description:"Amount of resources your project is consuming",attributes:[{anchor:"dbSize",key:i.tk.DATABASE_SIZE,attributes:[{key:i.tk.DATABASE_SIZE.toLowerCase(),color:"white"}],name:"Database size",chartPrefix:"Average",unit:"bytes",description:"Database size refers to the monthly average storage usage, as reported by Postgres. Paid plans use auto-scaling disks.\nBilling is based on the average daily database size used in GB throughout the billing period. Billing is independent of the provisioned disk size.",links:[{name:"Documentation",url:"https://supabase.com/docs/guides/platform/database-size"}],chartDescription:"The data refreshes every 24 hours.",additionalInfo:(e,t)=>{var n,l,o,c;let d=null==t?void 0:t.usages.find(e=>e.metric===i.tk.DATABASE_SIZE),u="number"!=typeof d?(null!==(l=null==d?void 0:d.usage)&&void 0!==l?l:0)/(null!==(o=null==d?void 0:d.pricing_free_units)&&void 0!==o?o:0):0,m=d&&(null!==(c=null==d?void 0:d.pricing_free_units)&&void 0!==c?c:0)>0,h=m&&u>=a.w,p=m&&u>=1,x=null==d?void 0:d.capped,f=(null==e?void 0:null===(n=e.plan)||void 0===n?void 0:n.name)==="Free";return(0,s.jsx)("div",{children:(h||p)&&x&&(0,s.jsx)(r.b,{withIcon:!0,variant:p?"danger":"warning",title:p?"Exceeding database size limit":"Nearing database size limit",children:(0,s.jsx)("div",{className:"flex w-full items-center flex-col justify-center space-y-2 md:flex-row md:justify-between",children:(0,s.jsxs)("div",{children:["When you reach your database size limit, your project can go into read-only mode."," ",f?"Please upgrade your plan.":"Disable your spend cap to scale seamlessly and pay for over-usage beyond your plans quota."]})})})})}},{anchor:"storageSize",key:i.tk.STORAGE_SIZE,attributes:[{key:i.tk.STORAGE_SIZE.toLowerCase(),color:"white"}],name:"Storage Size",chartPrefix:"Average",unit:"bytes",description:"Sum of all objects in your storage buckets.\nBilling is based on the average daily size in GB throughout your billing period.",chartDescription:"The data refreshes every 24 hours.",links:[{name:"Storage",url:"https://supabase.com/docs/guides/storage"}]},{anchor:"funcCount",key:i.tk.FUNCTION_COUNT,attributes:[{key:i.tk.FUNCTION_COUNT.toLowerCase(),color:"white"}],name:"Edge Function Count",chartPrefix:"Max",unit:"absolute",description:"Number of serverless functions in your project.\nBilling is based on the maximum amount of functions at any point in time throughout your billing period.",chartDescription:"The data refreshes every 24 hours."}]},{key:"activity",name:"Activity",description:"Usage statistics that reflect the activity of your project",attributes:[{anchor:"mau",key:i.tk.MONTHLY_ACTIVE_USERS,attributes:[{key:i.tk.MONTHLY_ACTIVE_USERS.toLowerCase(),color:"white"}],name:"Monthly Active Users",chartPrefix:"Cumulative",chartSuffix:"in billing period",unit:"absolute",description:"Users who log in or refresh their token count towards MAU.\nBilling is based on the sum of distinct users requesting your API throughout the billing period. Resets every billing cycle.",chartDescription:"The data is refreshed over a period of 24 hours and resets at the beginning of every billing period.\nThe data points are relative to the beginning of your billing period and will reset with your billing period.",links:[{name:"Auth",url:"https://supabase.com/docs/guides/auth"}]},{anchor:"mauSso",key:i.tk.MONTHLY_ACTIVE_SSO_USERS,attributes:[{key:i.tk.MONTHLY_ACTIVE_SSO_USERS.toLowerCase(),color:"white"}],name:"Monthly Active SSO Users",chartPrefix:"Cumulative",chartSuffix:"in billing period",unit:"absolute",description:"SSO users who log in or refresh their token count towards SSO MAU.\nBilling is based on the sum of distinct Single Sign-On users requesting your API throughout the billing period. Resets every billing cycle.",chartDescription:"The data refreshes over a period of 24 hours and resets at the beginning of every billing period.\nThe data points are relative to the beginning of your billing period and will reset with your billing period.",links:[{name:"SSO with SAML 2.0",url:"https://supabase.com/docs/guides/auth/sso/auth-sso-saml"}]},{anchor:"storageImageTransformations",key:i.tk.STORAGE_IMAGES_TRANSFORMED,attributes:[{key:i.tk.STORAGE_IMAGES_TRANSFORMED.toLowerCase(),color:"white"}],name:"Storage Image Transformations",chartPrefix:"Cumulative",chartSuffix:"in billing period",unit:"absolute",description:"We count all images that were transformed in the billing period, ignoring any transformations.\nUsage example: You transform one image with four different size transformations and another image with just a single transformation. It counts as two, as only two images were transformed.\nBilling is based on the count of (origin) images that used transformations throughout the billing period. Resets every billing cycle.",chartDescription:"The data refreshes every 24 hours.\nThe data points are relative to the beginning of your billing period and will reset with your billing period.",links:[{name:"Documentation",url:"https://supabase.com/docs/guides/storage/image-transformations"}]},{anchor:"funcInvocations",key:i.tk.FUNCTION_INVOCATIONS,attributes:[{key:i.tk.FUNCTION_INVOCATIONS.toLowerCase(),color:"white"}],name:"Edge Function Invocations",unit:"absolute",description:"Every serverless function invocation independent of response status is counted.\nBilling is based on the sum of all invocations throughout your billing period.",chartDescription:"The data refreshes every 24 hours.",links:[{name:"Edge Functions",url:"https://supabase.com/docs/guides/functions"}]},{anchor:"realtimeMessageCount",key:i.tk.REALTIME_MESSAGE_COUNT,attributes:[{key:i.tk.REALTIME_MESSAGE_COUNT.toLowerCase(),color:"white"}],name:"Realtime Messages",unit:"absolute",description:"Count of messages going through Realtime. Includes database changes, broadcast and presence. \nUsage example: If you do a database change and 5 clients listen to that change via Realtime, that's 5 messages. If you broadcast a message and 4 clients listen to that, that's 5 messages (1 message sent, 4 received).\nBilling is based on the total amount of messages throughout your billing period.",chartDescription:"The data refreshes every 24 hours.",links:[{name:"Realtime Quotas",url:"https://supabase.com/docs/guides/realtime/quotas"}]},{anchor:"realtimePeakConnections",key:i.tk.REALTIME_PEAK_CONNECTIONS,attributes:[{key:i.tk.REALTIME_PEAK_CONNECTIONS.toLowerCase(),color:"white"}],name:"Realtime Peak Connections",chartPrefix:"Max",unit:"absolute",description:"Total number of successful connections. Connections attempts are not counted towards usage.\nBilling is based on the maximum amount of concurrent peak connections throughout your billing period.",chartDescription:"The data refreshes every 24 hours.",links:[{name:"Realtime Quotas",url:"https://supabase.com/docs/guides/realtime/quotas"}]}]}]},52683:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var s=n(52322),a=n(6277),i=n(28879),r=n.n(i),l=n(80604),o=n(60995),c=n(83039),d=n(27118),u=n(504),m=n(52406),h=n(8159),p=n(98578),x=n(97072);let f=e=>{let{name:t,unit:n,value:a,isAfterToday:i,tooltipFormatter:r}=e,l="percentage"===n?Number(a).toFixed(2):Number(a);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:t}),i?(0,s.jsx)("p",{className:"text-foreground-light text-lg",children:"No data yet"}):(0,s.jsx)("p",{className:"text-xl",children:void 0!==r?r(l):l})]})},g=e=>{var t;let{attribute:n,attributeMeta:i,sumValue:r,tooltipFormatter:l,unit:o}=e,c=Number(null!==(t=null==i?void 0:i.value)&&void 0!==t?t:0),d=(c/r*100).toFixed(1);return(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 w-[175px]",children:[(0,s.jsx)("div",{className:(0,a.default)("w-3 h-3 rounded-full border",x.bm[n.color].marker)}),(0,s.jsxs)("p",{className:"text-xs prose",children:[n.name," (",d,"%):"," "]})]}),(0,s.jsx)("p",{className:"text-xs tabular-nums",children:void 0!==l?l(c):"".concat(c).concat("hours"===o?" H":"")})]},n.name)},j=e=>{let{attributes:t,values:n,isAfterToday:a,tooltipFormatter:i,unit:r}=e,l=n.reduce((e,t)=>e+Number(t.value),0);return(0,s.jsx)(s.Fragment,{children:a?(0,s.jsx)("p",{className:"text-foreground-light text-lg",children:"No data yet"}):(0,s.jsx)("div",{className:"space-y-1 pb-1",children:t.flatMap(e=>{var t;let a=n.find(t=>t.dataKey===e.key);return 0===Number(null!==(t=null==a?void 0:a.value)&&void 0!==t?t:0)?[]:(0,s.jsx)(g,{attribute:e,attributeMeta:a,sumValue:l,tooltipFormatter:i,unit:r},e.name)})})})};var v=e=>{let{data:t,name:n,attributes:i,unit:g,yLimit:v,yLeftMargin:y=10,yFormatter:b,yMin:N,tooltipFormatter:w}=e;return(0,s.jsx)("div",{className:"w-full h-[200px]",children:(0,s.jsx)(l.h,{width:"100%",height:200,children:(0,s.jsxs)(o.c,{data:t,margin:{top:0,right:0,left:y,bottom:0},children:[(0,s.jsx)(c.q,{vertical:!1,strokeDasharray:"3 3",className:"stroke-border-stronger"}),(0,s.jsx)(d.K,{dataKey:"periodStartFormatted"}),(0,s.jsx)(u.B,{width:40,axisLine:!1,tickLine:{stroke:"none"},domain:[null!=N?N:0,Math.max(null!=N?N:0,null!=v?v:0)],tickFormatter:b}),(0,s.jsx)(m.u,{content:e=>{let{active:t,payload:l}=e;if(!t||!l||!l.length)return null;{let e=r()(l[0].payload.period_start),t=e.startOf("day").isAfter(r()().startOf("day"));return(0,s.jsxs)("div",{className:(0,a.default)("border bg-surface-100 rounded-md px-2 py-2",i.length>1&&!t?"w-[250px]":"w-[170px]"),children:[i.length>1?(0,s.jsx)(j,{attributes:i,values:l,isAfterToday:t,tooltipFormatter:w,unit:g}):(0,s.jsx)(f,{name:n,unit:g,value:l[0].value,tooltipFormatter:w,isAfterToday:t}),(0,s.jsx)("p",{className:"text-xs text-foreground-light mt-1",children:e.format("DD MMM YYYY")})]})}}}),null==i?void 0:i.map(e=>(0,s.jsx)(h.$,{dataKey:e.key,stackId:"a",children:t.map(t=>(0,s.jsx)(p.b,{className:x.bm[e.color].bar},"".concat(t.period_start)))},e.key))]})})})}},95837:function(e,t,n){"use strict";n.d(t,{yV:function(){return n6},IV:function(){return tO},d2:function(){return at},q$:function(){return tH},iB:function(){return t5},ny:function(){return nr},G3:function(){return np},ZI:function(){return sT},cN:function(){return s3},l1:function(){return nG}});var s,a,i=n(52322),r=n(74178),l=n(14528),o=n(59491),c=n(99959),d=n(2784),u=n(62202),m=n(62277),h=n(750),p=n(62284),x=n(56006),f=n(14698),g=n(14782),j=n(41679),v=n(36492),y=n(88354),b=n(99248),N=n(91160);async function w(e,t){let{slug:n}=e;if(!n)throw Error("slug is required");let s=await (0,y.U2)("".concat(b.T5,"/organizations/").concat(n,"/customer"),{signal:t});if(s.error)throw s.error;return s}let _=function(e){let{slug:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(N.O.customerProfile(t),e=>{let{signal:n}=e;return w({slug:t},n)},{enabled:n&&void 0!==t,...s})};var C=n(85945),S=n(48228);async function k(e){let{slug:t,address:n,invoice_settings:s}=e;if(!t)return console.error("Slug is required");let a={};n&&(a.address=n),s&&(a.invoice_settings=s);let i=await (0,y.r$)("".concat(b.T5,"/organizations/").concat(t,"/customer"),a);if(i.error)throw i.error;return i}let E=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>k(e),{async onSuccess(t,n,a){let{slug:i}=n;await s.invalidateQueries(N.O.customerProfile(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to update customer profile: ".concat(e.message)):t(e,n,s)},...n})},A=[{code:"AF",name:"Afghanistan"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"IO",name:"British Indian Ocean Territory"},{code:"VG",name:"British Virgin Islands"},{code:"BN",name:"Brunei Darussalam"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"CV",name:"Cape Verde"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CC",name:"Cocos (Keeling) Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CW",name:"Cura\xe7ao"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"CI",name:"C\xf4te d'Ivoire"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"SZ",name:"Eswatini"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard & McDonald Islands"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macao"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"KP",name:"North Korea"},{code:"MK",name:"North Macedonia"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestinian Territories"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn Islands"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"RE",name:"R\xe9union"},{code:"BL",name:"Saint Barth\xe9lemy"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome and Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SX",name:"Sint Maarten"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"KR",name:"South Korea"},{code:"SS",name:"South Sudan"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SH",name:"St Helena"},{code:"KN",name:"St Kitts and Nevis"},{code:"LC",name:"St Lucia"},{code:"MF",name:"St Martin"},{code:"PM",name:"St Pierre and Miquelon"},{code:"VC",name:"St Vincent and the Grenadines"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard & Jan Mayen"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad & Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks & Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"VI",name:"US Virgin Islands"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States of America"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VA",name:"Vatican City"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"WF",name:"Wallis & Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"},{code:"AX",name:"\xc5land Islands"}];var T=()=>{var e;let{slug:t}=(0,c.UO)(),{data:n,error:s,isLoading:a,isSuccess:v,isError:y}=_({slug:t}),{mutate:b,isLoading:N}=E(),w="billing-address-form",{city:C,country:S,line1:k,line2:T,postal_code:I,state:Z}=null!==(e=null==n?void 0:n.address)&&void 0!==e?e:{},z=(0,l.Xo)(o.KA.BILLING_READ,"stripe.customer"),P=(0,l.Xo)(o.KA.BILLING_WRITE,"stripe.customer"),R=async(e,n)=>{let{resetForm:s}=n;if(!t)return console.error("Slug is required");b({slug:t,address:e},{onSuccess:()=>{u.ZP.success("Successfully updated billing address"),s({values:e,initialValues:e})}})};return(0,i.jsxs)(r.jX,{children:[(0,i.jsx)(r.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Billing Address"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"This will be reflected in every upcoming invoice, past invoices are not affected"})]})}),(0,i.jsx)(r.Lc,{children:z?(0,i.jsxs)(i.Fragment,{children:[a&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),y&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve organization customer profile",error:s}),v&&(0,i.jsx)(m.Z,{validateOnBlur:!0,id:w,initialValues:{city:C,country:S,line1:k,line2:T,postal_code:I,state:Z},validate:e=>{let t={};return(e.line1||e.line2||e.postal_code||e.state||e.city)&&!e.country&&(t.country="Please select a country"),t},onSubmit:R,children:e=>{let{values:t,initialValues:s,handleReset:a,resetForm:r}=e,l=JSON.stringify(t)!==JSON.stringify(s);return(0,d.useEffect)(()=>{if(v&&void 0!==n){var e;let{city:t,country:s,line1:a,line2:i,postal_code:l,state:o}=null!==(e=null==n?void 0:n.address)&&void 0!==e?e:{},c={city:t,country:s,line1:a,line2:i,postal_code:l,state:o};r({values:c,initialValues:c})}},[v]),(0,i.jsx)(f.by,{footer:(0,i.jsx)("div",{className:"flex py-4 px-8",children:(0,i.jsx)(f.iN,{form:w,isSubmitting:N,hasChanges:l,handleReset:a,helper:P?void 0:"You need additional permissions to manage this organization's billing address"})}),children:(0,i.jsx)(f.hj,{children:(0,i.jsxs)(f.B4,{fullWidth:!0,loading:!1,className:"!gap-2",children:[(0,i.jsx)(h.Z,{id:"line1",name:"line1",placeholder:"Address line 1",disabled:!P}),(0,i.jsx)(h.Z,{id:"line2",name:"line2",placeholder:"Address line 2",disabled:!P}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsxs)(p.Z,{className:"w-full",id:"country",name:"country",placeholder:"Country",disabled:!P,children:[(0,i.jsx)(p.Z.Option,{label:"---",value:"",children:"---"},"empty"),A.map(e=>(0,i.jsx)(p.Z.Option,{label:e.name,value:e.code,children:e.name},e.code))]}),(0,i.jsx)(h.Z,{className:"w-full",id:"postal_code",name:"postal_code",placeholder:"Postal code",disabled:!P})]}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsx)(h.Z,{className:"w-full",id:"city",name:"city",placeholder:"City",disabled:!P}),(0,i.jsx)(h.Z,{className:"w-full",id:"state",name:"state",placeholder:"State",disabled:!P})]})]})})})}})]}):(0,i.jsx)(g.Z,{resourceText:"view this organization's billing address"})})]})},I=n(28879),Z=n.n(I),z=n(93463),P=n(6277),R=n(31696),L=n(17436);async function O(e,t){let{orgSlug:n}=e;if(!n)throw Error("orgSlug is required");let{data:s,error:a}=await (0,R.U2)("/platform/organizations/{slug}/billing/invoices/upcoming",{params:{path:{slug:n}},headers:{Version:"2"},signal:t});return a&&(0,R.S3)(a),s}let D=function(e){let{orgSlug:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(L.Y.orgUpcomingPreview(t),e=>{let{signal:n}=e;return O({orgSlug:t},n)},{enabled:n&&void 0!==t,...s})};var F=n(32079),U=n(11992),M=n(52905),q=n(84605),B=n(24990),W=n(86418);let G=[W.tk.DATABASE_SIZE,W.tk.EGRESS,W.tk.STORAGE_SIZE],H=(e,t)=>G.includes(e)?+(t/1e9).toFixed(2).toLocaleString():t.toLocaleString(),Y=e=>G.includes(e)?"GB":e.startsWith("COMPUTE_HOURS")?"Hours":null,V=(e,t)=>{let n=["Current plan limits are not enough for me","I want better customer support from Supabase","I am migrating from a previous project"];return void 0===e||void 0===t||("free"===e&&"pro"===t?(n.push("Need more compute"),n.push("I want access to additional features like branching, daily backups, custom domain and PITR")):"team"===t&&n.push("I want access to SOC2 and HIPAA compliance")),n.push("None of the above"),n};var K=n(39097),X=n.n(K),Q=n(82667);let $=[{identifier:"COMPUTE",text:"Every project is a dedicated server and database. For every hour your project is active, it incurs compute costs based on the instance size of your project. Paused projects do not incur compute costs.",linkRef:"https://supabase.com/docs/guides/platform/org-based-billing#usage-based-billing-for-compute"}],J=e=>{let{text:t,linkRef:n}=e;return(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{children:(0,i.jsx)(q.Z,{size:12,strokeWidth:2})}),(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background min-w-[300px] max-w-[450px] max-h-[300px] overflow-y-auto",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:(0,i.jsxs)("p",{children:[t," ",n&&(0,i.jsx)(X(),{href:n,target:"_blank",className:"transition text-brand hover:text-brand-600 underline",children:"Read more"})]})})})]})})]})};var ee=e=>{var t,n;let{slug:s}=e,{data:a,error:r,isLoading:l,isError:o,isSuccess:c}=D({orgSlug:s}),[u,m]=(0,d.useState)([]),h=(0,d.useMemo)(()=>((null==a?void 0:a.lines)||[]).find(e=>e.description.startsWith("Compute Credits")),[a]),p=(0,d.useMemo)(()=>((null==a?void 0:a.lines)||[]).filter(e=>e!==h&&!e.breakdown).sort((e,t)=>Number(e.proration)-Number(t.proration)),[a,h]),f=(0,d.useMemo)(()=>((null==a?void 0:a.lines)||[]).filter(e=>{var t;return null===(t=e.breakdown)||void 0===t?void 0:t.length}).sort((e,t)=>Number(e.usage_based)-Number(t.usage_based)||t.amount-e.amount),[a]),g=e=>{m([...u,e])},v=e=>{m(u.filter(t=>t!==e))},y=(0,d.useMemo)(()=>f.length===u.length,[f,u]);return(0,i.jsxs)(i.Fragment,{children:[l&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),o&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve upcoming invoice",error:r}),c&&(0,i.jsxs)("div",{children:[f.length>0&&(0,i.jsx)("div",{className:"mb-2",children:(0,i.jsx)(F.z,{size:"tiny",type:"default",onClick:()=>{y?m([]):m(f.map(e=>e.description))},children:y?"Collapse All":"Expand All"})}),(0,i.jsxs)("table",{className:"w-full",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"border-b",children:[(0,i.jsx)("th",{className:"py-2 font-medium text-left text-sm text-foreground-light max-w-[200px]",children:"Item"}),(0,i.jsx)("th",{className:"py-2 font-medium text-right text-sm text-foreground-light pr-4",children:"Usage"}),(0,i.jsx)("th",{className:"py-2 font-medium text-left text-sm text-foreground-light",children:"Unit price"}),(0,i.jsx)("th",{className:"py-2 font-medium text-right text-sm text-foreground-light",children:"Cost"})]})}),(0,i.jsx)("tbody",{children:p.map(e=>{var t,n;return(0,i.jsxs)("tr",{className:"border-b",children:[(0,i.jsx)("td",{className:"py-2 text-sm max-w-[200px]",colSpan:e.proration?3:1,children:null!==(n=e.description)&&void 0!==n?n:"Unknown"}),!e.proration&&(0,i.jsx)("td",{className:"py-2 text-sm text-right pr-4",children:null===(t=e.quantity)||void 0===t?void 0:t.toLocaleString()}),!e.proration&&(0,i.jsx)("td",{className:"py-2 text-sm",children:0===e.unit_price?"FREE":e.unit_price?(0,Q.xG)(e.unit_price):null}),(0,i.jsx)("td",{className:"py-2 text-sm text-right",children:(0,Q.xG)(e.amount)})]},e.description)})}),f.length>0&&f.map(e=>{var t,n;return(0,i.jsx)(U.ZP,{asChild:!0,open:u.includes(e.description),onOpenChange:t=>t?g(e.description):v(e.description),children:(0,i.jsxs)("tbody",{children:[(0,i.jsx)(U.ZP.Trigger,{asChild:!0,children:(0,i.jsxs)("tr",{className:u.includes(e.description)?"":"border-b",style:{WebkitAppearance:"initial"},children:[(0,i.jsxs)("td",{className:"py-2 text-sm max-w-[200px]",children:[(0,i.jsx)(F.z,{type:"text",className:"!px-1",icon:(0,i.jsx)(M.Z,{className:(0,P.default)("transition",u.includes(e.description)&&"rotate-90")})})," ",(0,i.jsxs)("span",{className:"mr-2",children:[e.description,e.usage_metric&&Y(e.usage_metric)&&" (".concat(Y(e.usage_metric),")")]}),(()=>{let t=$.find(t=>{var n;return null===(n=e.usage_metric)||void 0===n?void 0:n.startsWith(t.identifier)});return t?(0,i.jsx)(J,{text:t.text,linkRef:t.linkRef}):null})()]}),(0,i.jsx)("td",{className:"py-2 pr-4 text-sm text-right tabular-nums max-w-[100px]",children:e.usage_original?"".concat(H(e.usage_metric,e.usage_original)):e.quantity?e.quantity:null}),(0,i.jsx)("td",{className:"py-2 text-sm",children:e.unit_price_desc?"".concat(e.unit_price_desc):e.unit_price?(0,Q.xG)(e.unit_price):null}),(0,i.jsx)("td",{className:"py-2 text-sm text-right max-w-[70px]",children:null!==(n=(0,Q.xG)(e.amount))&&void 0!==n?n:(0,Q.xG)(0)})]},e.description)}),(0,i.jsx)(U.ZP.Content,{asChild:!0,children:(0,i.jsx)(i.Fragment,{children:null===(t=e.breakdown)||void 0===t?void 0:t.map(t=>(0,i.jsxs)("tr",{className:"last:border-b cursor-pointer",style:{WebkitAppearance:"initial"},children:[(0,i.jsx)("td",{className:"pb-1 text-xs pl-8 max-w-[200px]",children:t.project_name}),(0,i.jsx)("td",{className:"pb-1 text-xs tabular-nums text-right pr-4",children:H(e.usage_metric,t.usage)}),(0,i.jsx)("td",{}),(0,i.jsx)("td",{})]},t.project_ref))})})]})},e.description)}),h&&(0,i.jsx)("tbody",{children:(0,i.jsxs)("tr",{className:"border-b",children:[(0,i.jsxs)("td",{className:"py-2 text-sm max-w-[200px]",children:[(0,i.jsx)("span",{className:"mr-2",children:h.description}),(0,i.jsx)(J,{text:"Paid plans come with $10 in Compute Credits to cover one Micro instance or parts of any other instance. Compute Credits are given to you every month and do not stack up while you are on a paid plan.",linkRef:"https://supabase.com/docs/guides/platform/org-based-billing#compute-credits"})]}),(0,i.jsx)("td",{className:"py-2 text-sm text-right",colSpan:3,children:(0,Q.xG)(h.amount)})]})}),(0,i.jsxs)("tfoot",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{className:"py-4 text-sm font-medium",children:[(0,i.jsx)("span",{className:"mr-2",children:"Current Costs"}),(0,i.jsx)(J,{text:"Costs accumulated from the beginning of the billing cycle up to now."})]}),(0,i.jsx)("td",{className:"py-4 text-sm text-right font-medium",colSpan:3,children:null!==(t=(0,Q.xG)(null==a?void 0:a.amount_total))&&void 0!==t?t:"-"})]}),(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{className:"text-sm font-medium",children:[(0,i.jsx)("span",{className:"mr-2",children:"Projected Costs"}),(0,i.jsx)(J,{text:"Estimated costs at the end of the billing cycle. Final amounts may vary depending on your usage."})]}),(0,i.jsx)("td",{className:"text-sm text-right font-medium",colSpan:3,children:null!==(n=(0,Q.xG)(null==a?void 0:a.amount_projected))&&void 0!==n?n:"-"})]})]})]})]})]})},et=()=>{var e,t;let{slug:n}=(0,c.UO)(),{data:s,error:a,isLoading:o,isError:d}=(0,z.G)({orgSlug:n}),u=(0,l.N3)("billing:invoices"),m=Z().unix(null!==(e=null==s?void 0:s.current_period_start)&&void 0!==e?e:0).utc(),h=Z().unix(null!==(t=null==s?void 0:s.current_period_end)&&void 0!==t?t:0).utc();return(0,i.jsxs)(r.jX,{children:[(0,i.jsx)(r.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Billing Breakdown"}),(0,i.jsxs)("p",{className:"text-sm text-foreground-light m-0",children:["Current billing cycle: ",m.format("MMM DD")," -"," ",h.format("MMM DD")]})]})}),(0,i.jsxs)(r.Lc,{children:[o&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),d&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve subscription",error:a}),u&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{className:"text-sm",children:"Upcoming cost for next invoice"}),(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["The following table shows your upcoming costs excluding credits. Depending on your usage, the final amount may vary. Next invoice on"," ",(0,i.jsx)("span",{className:"text-foreground-light whitespace-nowrap",children:h.format("MMM DD, YYYY")}),". See"," ",(0,i.jsx)(X(),{className:"text-green-900 transition hover:text-green-1000",href:"/org/".concat(n,"/usage"),children:"usage page"})," ","for a more detailed usage breakdown."]}),(0,i.jsx)(ee,{slug:n})]})]})]})};async function en(e){let{slug:t,name:n,billing_email:s,opt_in_tags:a}=e,i={};n&&(i.name=n),s&&(i.billing_email=s),a&&(i.opt_in_tags=a);let{data:r,error:l}=await (0,R.r$)("/platform/organizations/{slug}",{params:{path:{slug:t}},body:i});return l&&(0,R.S3)(l),r}let es=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>en(e),{async onSuccess(t,n,a){await s.invalidateQueries(N.O.list()),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to update organization: ".concat(e.message)):t(e,n,s)},...n})};var ea=n(31310),ei=()=>{let{slug:e}=(0,c.UO)(),t=(0,C.NL)(),n=(0,l.lL)(),{name:s,billing_email:a}=null!=n?n:{},p="org-billing-email",x=(0,l.Xo)(o.KA.UPDATE,"organizations"),g=(0,l.Xo)(o.KA.READ,"organizations"),{mutate:j,isLoading:v}=es(),y=async(n,a)=>{let{resetForm:i}=a;return x?e?s?void j({slug:e,name:s,billing_email:n.billing_email},{onSuccess:e=>{let{billing_email:n}=e;i({values:{billing_email:n},initialValues:{billing_email:n}}),(0,ea.aL)(t),u.ZP.success("Successfully saved settings")}}):console.error("Organization name is required"):console.error("Slug is required"):u.ZP.error("You do not have the required permissions to update this organization")};return(0,i.jsxs)(r.jX,{children:[(0,i.jsx)(r.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Email Recipient"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"All billing correspondence will go to this email"})]})}),(0,i.jsx)(r.Lc,{children:(0,i.jsx)(m.Z,{id:p,initialValues:{billing_email:null!=a?a:""},onSubmit:y,children:t=>{let{handleReset:n,values:s,initialValues:r,resetForm:l}=t,o=JSON.stringify(s)!==JSON.stringify(r);return(0,d.useEffect)(()=>{let e={billing_email:null!=a?a:""};l({values:e,initialValues:e})},[e]),(0,i.jsx)(f.by,{footer:(0,i.jsx)("div",{className:"flex py-4 px-8",children:(0,i.jsx)(f.iN,{form:p,isSubmitting:v,hasChanges:o,handleReset:n,helper:x?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,i.jsx)(f.hj,{children:(0,i.jsx)(f.B4,{fullWidth:!0,loading:!1,children:(0,i.jsx)(h.Z,{id:"billing_email",size:"small",label:"Email address",type:g?"text":"password",disabled:!x})})})})}})})]})},er=n(6659),el=n(11774),eo=n(32830),ec=n(48869),ed=n(95492),eu=n(59629),em=n(2320),eh=n(96577),ep=n.n(eh),ex=n(5632),ef=n(15735),eg=n(94896),ej=n(99445);async function ev(e){let{slug:t,tier:n,paymentMethod:s}=e;if(!t)throw Error("slug is required");if(!n)throw Error("tier is required");let a={tier:n};void 0!==s&&(a.payment_method=s);let{error:i,data:r}=await (0,R.gz)("/platform/organizations/{slug}/billing/subscription",{body:{payment_method:a.payment_method,tier:a.tier},params:{path:{slug:t}}});return i&&(0,R.S3)(i),r}let ey=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>ev(e),{async onSuccess(t,n,a){let{slug:i}=n;await new Promise(e=>setTimeout(e,2e3)),await Promise.all([s.invalidateQueries(eg.U.orgSubscription(i)),s.invalidateQueries(eg.U.orgPlans(i)),s.invalidateQueries(ej.Z.orgUsage(i)),s.invalidateQueries(L.Y.orgUpcomingPreview(i))]),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to update subscription: ".concat(e.message)):t(e,n,s)},...n})};var eb=n(28020),eN=n(11682),ew=n(49251),e_=n(54383);let eC=[{name:"Spend cap enabled",value:"on",imageUrl:"".concat(b.GW,"/img/spend-cap-on.png"),imageUrlLight:"".concat(b.GW,"/img/spend-cap-on--light.png")},{name:"Spend cap disabled",value:"off",imageUrl:"".concat(b.GW,"/img/spend-cap-off.png"),imageUrlLight:"".concat(b.GW,"/img/spend-cap-off--light.png")}];var eS=()=>{var e;let t=(0,ex.useRouter)(),{slug:n}=(0,c.UO)(),{resolvedTheme:s}=(0,er.F)(),[a,r]=(0,d.useState)(!1),[m,h]=(0,d.useState)(),p=(0,l.Xo)(o.KA.BILLING_WRITE,"stripe.subscriptions"),x=(0,el.Wu)(),f="costControl"===x.panelKey,g=()=>x.setPanelKey(void 0),{data:j,isLoading:v}=(0,z.G)({orgSlug:n}),{mutate:y,isLoading:N}=ey({onSuccess:()=>{u.ZP.success("Successfully ".concat(C?"enabled":"disabled"," spend cap")),g()},onError:e=>{u.ZP.error("Failed to toggle spend cap: ".concat(e.message))}}),w=(null==j?void 0:null===(e=j.plan)||void 0===e?void 0:e.id)==="free",_=!(null==j?void 0:j.usage_billing_enabled),C=!_&&"on"===m,S=m!==(_?"on":"off");(0,d.useEffect)(()=>{f&&void 0!==j&&(h(_?"on":"off"),eb.Z.sendActivity({activity:"Side Panel Viewed",source:"Dashboard",data:{title:"Spend cap",section:"Cost Control"},...n&&{orgSlug:n}},t))},[f,v,j,_]);let k=async()=>{if(!n)return console.error("Org slug is required");y({slug:n,tier:"on"===m?b.ev.PRO:b.ev.PAYG})};return(0,i.jsx)(ew.ZP,{size:"large",loading:v||N,disabled:w||v||!S||N||!p,visible:f,onCancel:g,onConfirm:k,header:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h4",{children:"Spend cap"}),(0,i.jsx)(F.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(X(),{href:"https://supabase.com/docs/guides/platform/spend-cap",target:"_blank",rel:"noreferrer",children:"About spend cap"})})]}),tooltip:p?void 0:"You do not have permission to update spend cap",children:(0,i.jsx)(ew.ZP.Content,{children:(0,i.jsxs)("div",{className:"py-6 space-y-4",children:[(0,i.jsx)("p",{className:"text-sm",children:"Use the spend cap to manage project usage and costs, and control whether the project can exceed the included quota allowance of any billed line item in a billing cycle"}),(0,i.jsxs)(U.ZP,{open:a,onOpenChange:r,children:[(0,i.jsx)(U.ZP.Trigger,{asChild:!0,children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,i.jsx)(M.Z,{strokeWidth:1.5,size:16,className:a?"rotate-90":""}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"How are each resource charged after exceeding the included quota?"})]})}),(0,i.jsx)(U.ZP.Content,{asChild:!0,children:(0,i.jsx)(ef.Z,{className:"mt-4",head:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ef.Z.th,{children:(0,i.jsx)("p",{className:"text-xs",children:"Item"})}),(0,i.jsx)(ef.Z.th,{children:(0,i.jsx)("p",{className:"text-xs",children:"Rate"})})]}),body:["database","auth","storage","realtime","edge_functions"].map(e=>{let t=eN.D[e],n=t.features.filter(e=>e.usage_based);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ef.Z.tr,{children:[(0,i.jsx)(ef.Z.td,{children:(0,i.jsx)("p",{className:"text-xs text-foreground",children:t.title})}),(0,i.jsx)(ef.Z.td,{children:null})]},e),n.map(e=>(0,i.jsxs)(ef.Z.tr,{children:[(0,i.jsx)(ef.Z.td,{children:(0,i.jsx)("p",{className:"text-xs pl-4",children:e.title})}),(0,i.jsx)(ef.Z.td,{children:(0,i.jsx)("p",{className:"text-xs pl-4",children:e.plans.pro})})]},e.title))]})})})})]}),w&&(0,i.jsx)(ec.b,{withIcon:!0,variant:"info",title:"Toggling of the spend cap is only available on the Pro plan",actions:(0,i.jsx)(F.z,{type:"default",onClick:()=>x.setPanelKey("subscriptionPlan"),children:"View available plans"}),children:"Upgrade your plan to disable the spend cap"}),(0,i.jsx)("div",{className:"!mt-8 pb-4",children:(0,i.jsx)("div",{className:"flex gap-3",children:eC.map(e=>{let a=m===e.value;return(0,i.jsxs)("div",{className:(0,e_.cn)("col-span-4 group space-y-1",w&&"opacity-75"),onClick:()=>{w||h(e.value),eb.Z.sendActivity({activity:"Option Selected",source:"Dashboard",data:{title:"Spend cap",section:"Cost Control",option:e.name},...n&&{orgSlug:n}},t)},children:[(0,i.jsx)(ep(),{alt:"Spend Cap",className:(0,e_.cn)("relative rounded-xl transition border bg-no-repeat bg-center bg-cover w-[160px] h-[96px]",a?"border-foreground":"border-foreground-muted opacity-50 group-hover:border-foreground-lighter group-hover:opacity-100",!w&&"cursor-pointer",!w&&!a&&"group-hover:border-foreground-light"),width:160,height:96,src:(null==s?void 0:s.includes("dark"))?e.imageUrl:e.imageUrlLight}),(0,i.jsx)("p",{className:(0,e_.cn)("text-sm transition",!w&&"group-hover:text-foreground",a?"text-foreground":"text-foreground-light"),children:e.name})]},e.value)})})}),"on"===m?(0,i.jsx)(ec.b,{withIcon:!0,variant:"warning",title:"Your projects could become unresponsive or enter read only mode",children:"Exceeding the included quota allowance with spend cap enabled can cause your projects to become unresponsive or enter read only mode."}):(0,i.jsx)(ec.b,{withIcon:!0,variant:"info",title:"Charges apply for usage beyond included quota allowance",children:"Your projects will always remain responsive and active, and charges only apply when exceeding the included quota limit."}),S&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("p",{className:"text-sm",children:"on"===m?"Upon clicking confirm, spend cap will be enabled for your organization and you will no longer be charged any extra for usage.":"Upon clicking confirm, spend cap will be disabled for your organization and you will be charged for any usage beyond the included quota."})})]})})})};async function ek(e){let{slug:t}=e,{data:n,error:s}=await (0,R.IV)("/platform/organizations/{slug}/billing/subscription/schedule",{params:{path:{slug:t}}});return s&&(0,R.S3)(s),n}let eE=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>ek(e),{async onSuccess(t,n,a){await s.invalidateQueries(eg.U.orgSubscription(n.slug)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to cancel subscription schedule: ".concat(e.message)):t(e,n,s)},...n})};var eA=e=>{var t,n,s,a;let{}=e,{slug:o}=(0,c.UO)(),{resolvedTheme:d}=(0,er.F)(),u=(0,el.Wu)(),m=(0,l.P5)("disableProjectCreationAndUpdate"),{data:h,error:p,isLoading:f,isSuccess:g,isError:v}=(0,z.G)({orgSlug:o}),y=null==h?void 0:h.plan,N=null!==(a=null==h?void 0:h.usage_billing_enabled)&&void 0!==a&&a,w=!m&&!["team","enterprise"].includes((null==y?void 0:y.id)||""),{mutate:_,isLoading:C}=eE();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.jX,{children:[(0,i.jsx)(r.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-6 top-12",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Cost Control"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Control whether to use beyond your plans included quota"})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"More information"}),(0,i.jsx)("div",{children:(0,i.jsx)(X(),{href:"https://supabase.com/docs/guides/platform/spend-cap",target:"_blank",rel:"noreferrer",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,i.jsx)("p",{className:"text-sm m-0",children:"Spend cap"}),(0,i.jsx)(eo.Z,{size:16,strokeWidth:1.5})]})})})]})]})}),(0,i.jsxs)(r.Lc,{children:[f&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),v&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve subscription",error:p}),g&&(0,i.jsxs)("div",{className:"space-y-6",children:[["team","enterprise"].includes((null==y?void 0:y.id)||"")?(0,i.jsxs)(ec.b,{withIcon:!0,variant:"info",title:"You will be charged for any additional usage on the ".concat((null==y?void 0:y.name)||""," plan"),children:[(null==y?void 0:y.name)||""," plan requires you to have spend cap off at all times. Your projects will never become unresponsive. Only when your"," ",(0,i.jsx)(X(),{href:"/org/".concat(o,"/usage"),className:"text-green-900 transition hover:text-green-1000",children:"included usage"})," ","is exceeded will you be charged for any additional usage."]}):(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["You can control whether your organization is charged for additional usage beyond the"," ",(0,i.jsx)(X(),{href:"/org/".concat(o,"/usage"),className:"text-green-900 transition hover:text-green-1000",children:"included quota"})," ","of your subscription plan. If you need to go beyond the included quota, simply switch off your spend cap to pay for additional usage."]}),(null==h?void 0:null===(t=h.scheduled_plan_change)||void 0===t?void 0:t.target_plan)==="pro"&&(null==h?void 0:null===(n=h.scheduled_plan_change)||void 0===n?void 0:n.usage_billing_enabled)===!1&&(null==h?void 0:h.plan.id)==="pro"&&(0,i.jsxs)(ed.bZ,{className:"mb-2",title:"Scheduled downgrade",children:[(0,i.jsx)(eu.Z,{className:"h-4 w-4"}),(0,i.jsx)(ed.Cd,{children:"Scheduled change"}),(0,i.jsxs)(ed.X,{className:"flex flex-col gap-3",children:[(0,i.jsxs)("div",{children:["Your spend cap will be enabled on"," ",Z()(null==h?void 0:null===(s=h.scheduled_plan_change)||void 0===s?void 0:s.at).format("MMMM D, YYYY"),". You will not be charged for any over-usage moving on. If you would like to keep the spend cap disabled and scale as you go, you may still cancel the scheduled change."]}),(0,i.jsx)("div",{children:(0,i.jsx)(F.z,{type:"default",loading:C,onClick:()=>_({slug:o}),children:"Cancel"})})]})]}),(0,i.jsxs)("div",{className:"flex space-x-6",children:[(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"rounded-md bg-surface-200 w-[160px] h-[96px] shadow",children:(0,i.jsx)(ep(),{alt:"Spend Cap",width:160,height:96,src:N?"".concat(b.GW,"/img/spend-cap-off").concat((null==d?void 0:d.includes("dark"))?"":"--light",".png?v=3"):"".concat(b.GW,"/img/spend-cap-on").concat((null==d?void 0:d.includes("dark"))?"":"--light",".png?v=3")})})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"mb-1",children:["Spend cap is ",N?"disabled":"enabled"]}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:N?(0,i.jsx)("span",{children:"You will be charged for any usage above the included quota."}):(0,i.jsx)("span",{children:"You won't be charged any extra for usage. However, your projects could become unresponsive or enter read only mode if you exceed the included quota."})}),N&&(0,i.jsx)("p",{className:"text-sm text-foreground-light mt-1",children:"Your projects will never become unresponsive. Only when your usage reaches the quota limit will you be charged for any excess usage."}),(0,i.jsx)(em.Z,{projectUpdateDisabled:m,children:(0,i.jsx)(F.z,{type:"default",className:"mt-4 pointer-events-auto",disabled:!w,onClick:()=>u.setPanelKey("costControl"),children:"Change spend cap"})})]})]})]})]})]}),(0,i.jsx)(eS,{})]})},eT=n(81076),eI=()=>{var e;let{slug:t}=(0,c.UO)(),{data:n,error:s,isLoading:a,isError:l,isSuccess:o}=_({slug:t}),d=(null!==(e=null==n?void 0:n.balance)&&void 0!==e?e:0)/100,u=d<0,m=d>0,h=u&&0!==d?d.toFixed(2).toString().replace("-",""):d.toFixed(2);return(0,i.jsxs)(r.jX,{children:[(0,i.jsx)(r.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Credit Balance"}),u&&(0,i.jsx)(eT.C,{children:"You have credits available"}),m&&(0,i.jsx)(eT.C,{variant:"destructive",children:"Outstanding payments"})]}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Charges will be deducted from your balance first"})]})}),(0,i.jsxs)(r.Lc,{children:[a&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),l&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve organization customer profile",error:s}),o&&(0,i.jsxs)("div",{className:"flex items-end space-x-1",children:[m&&(0,i.jsx)("h4",{className:"opacity-50",children:"-"}),(0,i.jsx)("h4",{className:"opacity-50",children:"$"}),(0,i.jsx)("h2",{className:"text-4xl relative top-[2px]",children:h}),u&&(0,i.jsx)("h4",{className:"opacity-50",children:"/credits"})]})]})]})},eZ=n(31654),ez=n(151),eP=n(2515),eR=function(e){return(0,i.jsx)(eP.Z,{icon:ez.Z,...e})},eL=n(34503),eO=n(82),eD=n(43544);async function eF(e,t){let{slug:n}=e;if(!n)throw Error("slug is required");let s=await (0,y.U2)("".concat(b.T5,"/organizations/").concat(n,"/payments"),{signal:t});if(s.error)throw s.error;return s.data}let eU=function(e){let{slug:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(N.O.paymentMethods(t),e=>{let{signal:n}=e;return eF({slug:t},n)},{enabled:n,...s})};var eM=n(47852),eq=e=>{let{selectedPaymentMethod:t,onClose:n}=e,{slug:s}=(0,c.UO)(),{data:a}=(0,z.G)({orgSlug:s}),{mutate:r,isLoading:l}=ey({onSuccess:()=>{u.ZP.success("Successfully changed payment method to the card ending with ".concat(t.card.last4)),n()},onError:e=>{u.ZP.error("Failed to change payment method: ".concat(e.message))}}),o=async()=>s?a?t?void r({slug:s,tier:"pro"===a.plan.id&&a.usage_billing_enabled?"tier_payg":"tier_".concat(a.plan.id),paymentMethod:t.id}):console.error("Card ID is required"):console.error("Subscription is required"):console.error("Slug is required");return(0,i.jsx)(eM.C,{visible:void 0!==t,size:"medium",header:"Confirm to use payment method ending with ".concat(null==t?void 0:t.card.last4),onCancel:()=>n(),customFooter:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(F.z,{type:"default",disabled:l,onClick:()=>n(),children:"Cancel"}),(0,i.jsx)(F.z,{type:"primary",disabled:l,loading:l,onClick:o,children:"Confirm"})]}),children:(0,i.jsx)("div",{className:"py-4",children:(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("p",{className:"text-sm",children:["Upon clicking confirm, all future charges will be deducted from the card ending with"," ",null==t?void 0:t.card.last4,". There are no immediate charges."]})})})})};async function eB(e){let{slug:t,cardId:n}=e,s=await (0,y.$v)("".concat(b.T5,"/organizations/").concat(t,"/payments"),{card_id:n});if(s.error)throw s.error;return s}let eW=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>eB(e),{async onSuccess(t,n,a){let{slug:i}=n;await s.invalidateQueries(N.O.paymentMethods(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to delete payment method: ".concat(e.message)):t(e,n,s)},...n})};var eG=e=>{let{selectedPaymentMethod:t,onClose:n}=e,{slug:s}=(0,c.UO)(),{mutate:a,isLoading:r}=eW({onSuccess:()=>{u.ZP.success("Successfully removed payment method ending with ".concat(t.card.last4)),n()}}),l=async()=>s?t?void a({slug:s,cardId:t.id}):console.error("Card ID is required"):console.error("Slug is required");return(0,i.jsx)(eM.C,{visible:void 0!==t,size:"medium",header:"Confirm to delete payment method ending with ".concat(null==t?void 0:t.card.last4),onCancel:()=>n(),customFooter:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(F.z,{type:"default",disabled:r,onClick:()=>n(),children:"Cancel"}),(0,i.jsx)(F.z,{type:"primary",disabled:r,loading:r,onClick:l,children:"Confirm"})]}),children:(0,i.jsx)("div",{className:"py-4",children:(0,i.jsx)(eM.C.Content,{children:(0,i.jsx)(ec.b,{withIcon:!0,variant:"info",title:"This will permanently delete your payment method.",children:(0,i.jsx)("p",{children:"You can re-add the payment method any time."})})})})})},eH=()=>{var e;let{slug:t}=(0,c.UO)(),n=(0,C.NL)(),[s,a]=(0,d.useState)(),[m,h]=(0,d.useState)(),[p,v]=(0,d.useState)(!1),{data:y}=(0,z.G)({orgSlug:t}),{data:w,error:_,isLoading:S,isError:k,isSuccess:E}=eU({slug:t}),A=(0,l.Xo)(o.KA.BILLING_READ,"stripe.payment_methods"),T=(0,l.Xo)(o.KA.BILLING_WRITE,"stripe.payment_methods");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.jX,{children:[(0,i.jsx)(r.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Payment Methods"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light mb-2 pr-4 m-0",children:"After adding a payment method, make sure to mark it as active to use it for billing. You can remove unused cards."})]})}),(0,i.jsx)(r.Lc,{children:A?(0,i.jsxs)(i.Fragment,{children:[S&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),k&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve payment methods",error:_}),E&&(0,i.jsxs)(i.Fragment,{children:[(null==y?void 0:y.payment_method_type)==="invoice"&&(0,i.jsx)(ec.b,{withIcon:!0,variant:"info",title:"Payment is currently by invoice",actions:[(0,i.jsx)(F.z,{asChild:!0,type:"default",children:(0,i.jsx)(X(),{href:"/support/new?category=billing&subject=Request%20to%20change%20payment%20method",target:"_blank",rel:"noreferrer",className:"ml-3",children:"Contact support"})},"payment-method-support")],children:"You get a monthly invoice and payment link via email. To change your payment method, please contact us via our support form."}),(0,i.jsx)(f.by,{footer:(0,i.jsxs)("div",{className:"flex items-center justify-between py-4 px-8",children:[T?(0,i.jsx)("div",{}):(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"You need additional permissions to manage payment methods"}),(0,i.jsx)(F.z,{type:"default",icon:(0,i.jsx)(eZ.Z,{}),disabled:!T,onClick:()=>v(!0),children:"Add new card"})]}),children:(0,i.jsx)(f.hj,{children:(0,i.jsx)(f.B4,{fullWidth:!0,loading:!1,children:(null!==(e=null==w?void 0:w.length)&&void 0!==e?e:0)===0?(0,i.jsxs)("div",{className:"flex items-center space-x-2 opacity-50",children:[(0,i.jsx)(eR,{}),(0,i.jsx)("p",{className:"text-sm",children:"No payment methods"})]}):(0,i.jsx)("div",{className:"space-y-3",children:null==w?void 0:w.map(e=>{let t=(null==y?void 0:y.payment_method_id)===e.id;return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,i.jsx)("img",{alt:"Credit card brand",src:"".concat(b.GW,"/img/payment-methods/").concat(e.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,i.jsxs)("p",{className:"prose text-sm font-mono",children:["**** **** **** ",e.card.last4]}),(0,i.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",e.card.exp_month,"/",e.card.exp_year]})]}),t&&(0,i.jsx)(eT.C,{variant:"brand",children:"Active"}),T&&!t?(0,i.jsxs)(eL.h_,{children:[(0,i.jsx)(eL.$F,{asChild:!0,children:(0,i.jsx)(F.z,{type:"outline",className:"hover:border-muted px-1",children:(0,i.jsx)(eO.Z,{})})}),(0,i.jsxs)(eL.AW,{align:"end",children:[(null==y?void 0:y.plan.id)!=="free"&&(null==y?void 0:y.payment_method_type)==="card"&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eL.Xi,{onClick:()=>a(e),children:(0,i.jsx)("p",{children:"Use this card"})},"make-default"),(0,i.jsx)(eL.VD,{})]}),(0,i.jsx)(eL.Xi,{onClick:()=>h(e),children:(0,i.jsx)("p",{children:"Delete card"})},"delete-method")]})]}):null]},e.id)})})})})})]})]}):(0,i.jsx)(g.Z,{resourceText:"view this organization's payment methods"})})]}),(0,i.jsx)(eD.Z,{visible:p,returnUrl:"".concat((0,Q.Ax)(),"/org/").concat(t,"/billing"),onCancel:()=>v(!1),onConfirm:async()=>{v(!1),u.ZP.success("Successfully added new payment method"),await n.invalidateQueries(N.O.paymentMethods(t))}}),(0,i.jsx)(eq,{selectedPaymentMethod:s,onClose:()=>a(void 0)}),(0,i.jsx)(eG,{selectedPaymentMethod:m,onClose:()=>h(void 0)})]})},eY=n(48699),eV=n(17172),eK=n(82718),eX=n(70847);let eQ=()=>{let e=(0,l.lL)(),{data:t,isSuccess:n}=(0,eK.v)({orgSlug:null==e?void 0:e.slug}),{data:s,isSuccess:a}=(0,z.G)({orgSlug:null==e?void 0:e.slug}),r=!!(null==t?void 0:t.usages.find(e=>{var t;return!e.unlimited&&e.capped&&e.usage>(null!==(t=null==e?void 0:e.pricing_free_units)&&void 0!==t?t:0)}));if(!n||!a||!e)return null;let o=null;return(s&&r&&!(null==e?void 0:e.restriction_status)?o="exceededLimits":(null==e?void 0:e.restriction_status)==="grace_period"?o="gracePeriod":(null==e?void 0:e.restriction_status)==="grace_period_over"?o="gracePeriodOver":(null==e?void 0:e.restriction_status)==="restricted"&&(o="restricted"),null===o)?null:(0,i.jsxs)(i.Fragment,{children:["exceededLimits"===o&&(0,i.jsxs)(ed.bZ,{variant:"destructive",children:[(0,i.jsx)(eX.ku,{}),(0,i.jsx)(ed.Cd,{children:"Your organization's usage has exceeded its included quota"}),(0,i.jsxs)(ed.X,{children:[(0,i.jsxs)("p",{children:["Your projects can become unresponsive or enter read-only mode."," ","free"===s.plan.id?"Please upgrade to the Pro plan to ensure that your projects remain available.":"Please disable spend cap to ensure that your projects remain available."]}),(0,i.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,i.jsx)(F.z,{asChild:!0,type:"default",children:(0,i.jsx)(X(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=").concat("free"===s.plan.id?"subscriptionPlan":"costControl"),children:"free"===s.plan.id?"Upgrade plan":"Change spend cap"})},"upgrade-button"),(0,i.jsx)(F.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eV.Z,{size:14}),children:(0,i.jsx)("a",{href:"https://supabase.com/docs/guides/platform/spend-cap",children:"About spend cap"})})]})]})]}),"gracePeriod"===o&&(0,i.jsxs)(ed.bZ,{variant:"warning",children:[(0,i.jsx)(eX.aN,{}),(0,i.jsx)(ed.Cd,{children:"Your grace period has started."}),(0,i.jsxs)(ed.X,{children:[(0,i.jsxs)("p",{className:"leading-tight",children:["Your organization is over its quota. You can continue with projects until your grace period ends on"," ",(0,i.jsx)("span",{className:"text-foreground",children:Z()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". After that, requests that go over your quota will no longer be served. Reduce your usage below your plan's quota or upgrade your plan."]}),(0,i.jsx)("div",{className:"flex items-center gap-x-2 mt-3",children:(0,i.jsx)(F.z,{asChild:!0,type:"default",children:(0,i.jsx)(X(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})},"upgrade-button")})]})]}),"gracePeriodOver"===o&&(0,i.jsxs)(ed.bZ,{variant:"warning",children:[(0,i.jsx)(eX.aN,{}),(0,i.jsx)(ed.Cd,{children:"Your grace period is over."}),(0,i.jsxs)(ed.X,{children:[(0,i.jsxs)("p",{children:["You have exceeded your plans quota in the past and your grace period ended on"," ",(0,i.jsx)("span",{className:"text-foreground",children:Z()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". Service restrictions will apply if your usage is above your quota. If service restrictions are active, your projects will no longer be able to serve requests. Reduce your usage below your plans quota or upgrade your plan."]}),(0,i.jsx)("div",{className:"flex items-center gap-x-2 mt-3",children:(0,i.jsx)(F.z,{asChild:!0,type:"default",children:(0,i.jsx)(X(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})},"upgrade-button")})]})]}),"restricted"===o&&(0,i.jsxs)(ed.bZ,{variant:"destructive",children:[(0,i.jsx)(eX.ku,{}),(0,i.jsx)(ed.Cd,{children:"All services are restricted."}),(0,i.jsxs)(ed.X,{children:[(0,i.jsxs)("p",{children:["Your projects are currently under service restrictions and are not able to serve requests. You have exceeded your plans quota and your grace period ended on"," ",(0,i.jsx)("span",{className:"text-foreground",children:Z()(e.restriction_data.grace_period_end).format("DDMMM,YYYY")}),". Upgrade to lift restrictions or wait until your quota refills."]}),(0,i.jsx)("div",{className:"flex items-center gap-x-2 mt-3",children:(0,i.jsx)(F.z,{asChild:!0,type:"default",children:(0,i.jsx)(X(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})},"upgrade-button")})]})]})]})};var e$=n(86152),eJ=n.n(e$),e0=n(61531),e1=n(28119);async function e2(e){let{organizationSlug:t,tier:n}=e;if(!t)throw Error("organizationSlug is required");if(!n)throw Error("tier is required");let{data:s,error:a}=await (0,R.v_)("/platform/organizations/{slug}/billing/subscription/preview",{params:{path:{slug:t}},body:{tier:n},headers:{Version:"2"}});return a&&(0,R.S3)(a),s}let e4=function(e){let{organizationSlug:t,tier:n}=e,{enabled:s=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(N.O.subscriptionPreview(t,n),()=>e2({organizationSlug:t,tier:n}),{enabled:s&&void 0!==t&&void 0!==n,...a,retry:(e,t)=>("object"!=typeof t||null===t||!("code"in t)||400!==t.code)&&e<3})};var e3=n(26198);async function e5(e,t){let{orgSlug:n}=e;if(!n)throw Error("orgSlug is required");let{error:s,data:a}=await (0,R.U2)("/platform/organizations/{slug}/billing/plans",{params:{path:{slug:n}},signal:t});return s&&(0,R.S3)(s),a}let e8=function(e){let{orgSlug:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(eg.U.orgPlans(t),e=>{let{signal:n}=e;return e5({orgSlug:t},n)},{enabled:n&&void 0!==t,...s})};var e6=n(46988),e9=n(90488),e7=n(25633),te=n(70913),tt=function(e){return(0,i.jsx)(eP.Z,{icon:te.Z,...e})},tn=n(53605);let ts=e=>{let{projectAddon:t}=e,n=t.addons.find(e=>"compute_instance"===e.type),s=t.addons.map(e=>"compute_instance"===e.type?"".concat(e.variant.name," Compute Instance"):e.variant.name);return(0,i.jsxs)("li",{className:"list-disc ml-6",children:[t.name,": ",s.join(", ")," will be removed.",n?(0,i.jsxs)(i.Fragment,{children:[" ","Project will also ",(0,i.jsx)("span",{className:"font-bold",children:"need to be restarted"})," due to change in compute instance"]}):""]})};var ta=e=>{var t;let{visible:n,selectedPlan:s,subscription:a,onClose:r,onConfirm:l,projects:o}=e,c=(null==a?void 0:a.project_addons.flatMap(e=>{let t=e.addons.filter(e=>"ci_micro"!==e.variant.identifier);return t.length?{...e,addons:t}:[]}))||[],d=o.some(e=>"micro"===e.infra_compute_size),u=(null==a?void 0:a.nano_enabled)===!0;return(0,i.jsx)(eM.C,{size:"large",alignFooter:"right",visible:n,onCancel:r,onConfirm:l,header:"Confirm to downgrade to ".concat(null==s?void 0:s.name," plan"),children:(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("div",{className:"py-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(ec.b,{withIcon:!0,variant:"warning",title:"Downgrading to the Free plan will lead to reductions in your organization's quota",children:(0,i.jsx)("p",{children:"If you're already past the limits of the Free plan, your projects could become unresponsive or enter read only mode."})}),((null!==(t=c.length)&&void 0!==t?t:0)>0||d&&u)&&(0,i.jsx)(ec.b,{title:"Projects affected by the downgrade",variant:"warning",withIcon:!0,children:(0,i.jsxs)("ul",{className:"space-y-1 max-h-[100px] overflow-y-auto",children:[c.map(e=>(0,i.jsx)(ts,{projectAddon:e},e.ref)),o.filter(e=>"micro"===e.infra_compute_size).map(e=>(0,i.jsxs)("li",{className:"list-disc ml-6",children:[e.name,": Compute will be downgraded. Project will also"," ",(0,i.jsx)("span",{className:"font-bold",children:"need to be restarted"}),"."]},e.id))]})})]}),(0,i.jsxs)("ul",{className:"mt-4 space-y-5 text-sm",children:[(0,i.jsxs)("li",{className:"flex gap-3",children:[(0,i.jsx)("div",{children:(0,i.jsx)(e7.Z,{})}),(0,i.jsx)("span",{children:"Projects will be paused after a week of inactivity"})]}),(0,i.jsx)("li",{children:(0,i.jsxs)("div",{className:"flex gap-3 mb-2",children:[(0,i.jsx)("div",{children:(0,i.jsx)(tt,{})}),(0,i.jsx)("span",{children:"Add ons from all projects under this organization will be removed."})]})}),(0,i.jsxs)("li",{className:"flex gap-3",children:[(0,i.jsx)(tn.Z,{w:14,className:"flex-shrink-0"}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:["Before you downgrade to the ",null==s?void 0:s.name," plan, consider:"]}),(0,i.jsxs)("ul",{className:"space-y-2 mt-2",children:[(0,i.jsx)("li",{className:"list-disc ml-4",children:"Your projects no longer require their respective add ons."}),(0,i.jsxs)("li",{className:"list-disc ml-4",children:["Your resource consumption are well within the ",null==s?void 0:s.name," plan's quota."]}),(0,i.jsx)("li",{className:"list-disc ml-4",children:"Alternatively, you may also transfer projects across organizations."})]})]})]})]}),(null==a?void 0:a.billing_via_partner)===!0&&"fly"===a.billing_partner&&(0,i.jsx)("p",{className:"mt-4 text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]})})})},ti=e=>{let{plan:t,isCurrentPlan:n,billingPartner:s}=e,a=(0,e6.g_)(t,s);return(0,i.jsxs)("div",{className:(0,P.default)("grid grid-cols-1 md:grid-cols-3 border rounded-md bg-studio","py-4 col-span-12 justify-between gap-x-8"),children:[(0,i.jsxs)("div",{className:"flex flex-col justify-center px-4",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:(0,P.default)("text-brand text-sm uppercase"),children:t.name}),n?(0,i.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):t.nameBadge?(0,i.jsx)("div",{className:"text-xs bg-surface-200 text-brand rounded px-2 py-0.5",children:t.nameBadge}):null]}),(0,i.jsx)("p",{className:"text-sm mt-2 mb-4",children:t.description}),(0,i.jsx)("a",{href:t.href,className:"hidden md:block",target:"_blank",children:(0,i.jsx)(F.z,{block:!0,type:"default",size:"tiny",children:t.cta})})]}),(0,i.jsxs)("div",{className:"flex flex-col justify-center col-span-2 px-4 md:px-0",children:[(0,i.jsx)("ul",{role:"list",className:"text-xs text-foreground-light md:grid md:grid-cols-2 md:gap-x-10",children:a.map(e=>(0,i.jsxs)("li",{className:"flex items-center py-2 first:mt-0",children:[(0,i.jsx)(e9.Z,{className:"text-brand h-4 w-4","aria-hidden":"true",strokeWidth:3}),(0,i.jsx)("span",{className:"text-foreground mb-0 ml-3 ",children:"string"==typeof e?e:e[0]})]},"string"==typeof e?e:e[0]))}),(0,i.jsx)("a",{href:t.href,className:"visible md:hidden mt-8",target:"_blank",children:(0,i.jsx)(F.z,{block:!0,type:"default",size:"tiny",children:t.cta})})]})]},t.id)},tr=n(12333),tl=n(11886),to=n.n(tl),tc=n(67304),td=n.n(tc),tu=n(29887);let tm=["Pricing","My project isn't getting traction","Poor customer service","Missing feature","I didn't see the value","Supabase didn't meet my needs","Dashboard is too complicated","Postgres is too complicated","Problem not solved","Too many bugs/issues","I decided to use something else","My work has finished/discontinued","Im migrating to/starting a new project","None of the above"];var th=e=>{let{visible:t,subscription:n,projects:s,onClose:a}=e,{slug:r}=(0,c.UO)(),o=(0,d.useRef)(null),[m,p]=(0,d.useState)(""),[x,f]=(0,d.useState)(null),[g,j]=(0,d.useReducer)(function(e,t){return to()(e,t.target.value)?td()(e,t.target.value):[...e,t.target.value]},[]),v=(0,l.P5)("disableProjectCreationAndUpdate"),{mutateAsync:y,isLoading:b}=(0,tu.S)(),{mutateAsync:N,isLoading:w}=ey({onError:e=>{u.ZP.error("Failed to downgrade project: ".concat(e.message))}}),_=w||b,C=s.filter(e=>{let t=["nano"];return(null==n?void 0:n.nano_enabled)===!1&&t.push("micro"),!t.includes(e.infra_compute_size)}),S=C.length>0,k=(null==n?void 0:n.billing_via_partner)===!1||(null==n?void 0:n.billing_partner)!=="fly",E=()=>{var e;f(null),null===(e=o.current)||void 0===e||e.resetCaptcha()},A=async()=>{if(0===g.length)return u.ZP.error("Please select at least one reason for canceling your subscription");let e=x;if(!e){var t,n;let s=await (null===(t=o.current)||void 0===t?void 0:t.execute({async:!0}));e=null!==(n=null==s?void 0:s.response)&&void 0!==n?n:null,await T()}},T=async()=>{if(!r)return console.error("Slug is required");await N({slug:r,tier:"tier_free"}),E(),await y({orgSlug:r,reasons:g.reduce((e,t)=>"".concat(e,"- ").concat(t,"\n"),""),message:m,exitAction:"downgrade"}),u.ZP.success(k?S?"Successfully downgraded organization to the Free plan. Your projects are currently restarting to update their compute instances.":"Successfully downgraded organization to the Free plan":"Your organization is scheduled for the downgrade at the end of your current billing cycle",{duration:S?8e3:4e3}),a(!0),window.scrollTo({top:0,left:0,behavior:"smooth"})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"self-center",children:(0,i.jsx)(tr.Z,{ref:o,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onVerify:e=>{f(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>f(null),onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{void 0!==document&&document.body.classList.remove("!pointer-events-auto")}})}),(0,i.jsxs)(eM.C,{hideFooter:!0,size:"xlarge",visible:t,onCancel:a,header:"We're sad that you're leaving",children:[(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("div",{className:"py-6 space-y-4",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"We always strive to improve Supabase as much as we can. Please let us know the reasons you are canceling your subscription so that we can improve in the future."}),(0,i.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,i.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:tm.map(e=>{let t=g.find(t=>t===e);return(0,i.jsxs)("label",{className:"\n                      flex cursor-pointer items-center space-x-2 rounded-md py-1 \n                      pl-2 pr-3 text-center text-sm\n                      shadow-sm transition-all duration-100\n                      ".concat(t?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50","\n                  "),children:[(0,i.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:j}),(0,i.jsx)("div",{children:e})]},e)})}),(0,i.jsx)("div",{className:"text-area-text-sm",children:(0,i.jsx)(h.Z.TextArea,{id:"message",name:"message",value:m,onChange:e=>p(e.target.value),label:"Anything else that we can improve on?"})})]}),S&&(0,i.jsxs)(ec.b,{withIcon:!0,variant:"warning",title:"".concat(C.length," of your projects will be restarted ").concat(k?"upon clicking confirm":"once the downgrade takes effect at the end of your current billing cycle"),children:["This is due to changes in compute instances from the downgrade. Affected projects include ",C.map(e=>e.name).join(", "),"."]})]})}),(0,i.jsxs)("div",{className:"flex items-center justify-between border-t px-4 py-4",children:[k&&(0,i.jsx)("p",{className:"text-xs text-foreground-lighter",children:"The unused amount for the remaining of your billing cycle will be refunded as credits"}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(F.z,{type:"default",onClick:()=>a(),children:"Cancel"}),(0,i.jsx)(em.Z,{projectUpdateDisabled:v,children:(0,i.jsx)(F.z,{type:"danger",className:"pointer-events-auto",loading:_,disabled:v||_,onClick:A,children:"Confirm downgrade"})})]})]})]})]})};async function tp(e){let{orgSlug:t,prevPlan:n,currentPlan:s,reasons:a,message:i}=e,{data:r,error:l}=await (0,R.v_)("/platform/feedback/upgrade",{body:{...void 0!==t&&{orgSlug:t},...void 0!==n&&{prevPlan:n},...void 0!==s&&{currentPlan:s},reasons:a,...void 0!==i&&{additionalFeedback:i}}});return l&&(0,R.S3)(l),r}let tx=function(){let{onError:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,S.D)(e=>tp(e),{async onError(t,n,s){void 0===e?u.ZP.error("Failed to submit upgrade survey: ".concat(t.message)):e(t,n,s)},...t})};var tf=e=>{let{visible:t,originalPlan:n,subscription:s,onClose:a}=e,{slug:r}=(0,c.UO)(),[l,o]=(0,d.useState)(""),[m,p]=(0,d.useReducer)(function(e,t){return to()(e,t.target.value)?td()(e,t.target.value):[...e,t.target.value]},[]),x=V(n,null==s?void 0:s.plan.id),{mutate:f,isLoading:g}=tx({onError:e=>{u.ZP.error("Failed to submit survey: ".concat(e.message))},onSuccess:()=>{a(!0),window.scrollTo({top:0,left:0,behavior:"smooth"})}}),j=async()=>{var e;if(0===m.length)return u.ZP.error("Please select at least one reason for upgrading your subscription");f({orgSlug:r,prevPlan:n,currentPlan:null==s?void 0:null===(e=s.plan)||void 0===e?void 0:e.id,reasons:m,message:l.trim()||void 0})};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(eM.C,{alignFooter:"right",size:"xlarge",loading:g,visible:t,onCancel:a,onConfirm:j,cancelText:"Skip",header:"We're excited for your upgrade",children:(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("div",{className:"py-6 space-y-4",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"What reasons motivated your decision to upgrade? Your feedback helps us improve Supabase as much as we can."}),(0,i.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,i.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:x.map(e=>{let t=m.find(t=>t===e);return(0,i.jsxs)("label",{className:"\n                      flex cursor-pointer items-center space-x-2 rounded-md py-1 \n                      pl-2 pr-3 text-center text-sm\n                      shadow-sm transition-all duration-100\n                      ".concat(t?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50","\n                  "),children:[(0,i.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:p}),(0,i.jsx)("div",{children:e})]},e)})}),(0,i.jsx)("div",{className:"text-area-text-sm",children:(0,i.jsx)(h.Z.TextArea,{id:"message",name:"message",value:l,onChange:e=>o(e.target.value),label:"Anything else that we can improve on?"})})]})]})})})})},tg=e=>{let{visible:t,onClose:n}=e,s=(0,l.lL)(),a=null==s?void 0:s.slug,{data:r}=(0,e1.u)({slug:a});return(0,i.jsx)(eM.C,{hideFooter:!0,visible:t,size:"medium",header:"Your organization has members who have exceeded their free project limits",onCancel:n,children:(0,i.jsxs)("div",{className:"py-4 space-y-4",children:[(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"The following members have reached their maximum limits for the number of active free plan projects within organizations where they are an administrator or owner:"}),(0,i.jsx)("ul",{className:"pl-5 text-sm list-disc text-foreground-light",children:(r||[]).map((e,t)=>(0,i.jsxs)("li",{children:[e.username||e.primary_email," (Limit: ",e.free_project_limit," free projects)"]},"member-".concat(t)))}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"These members will need to either delete, pause, or upgrade one or more of these projects before you're able to downgrade this project."})]})}),(0,i.jsx)(eM.C.Separator,{}),(0,i.jsx)(eM.C.Content,{children:(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)(F.z,{htmlType:"button",type:"default",onClick:n,block:!0,children:"Understood"})})})]})})},tj=n(84447),tv=n(39459),ty=e=>{let{selectedPaymentMethod:t,onSelectPaymentMethod:n,layout:s="vertical"}=e,a=(0,l.lL)(),r=null==a?void 0:a.slug,[c,m]=(0,d.useState)(!1),{data:h,isLoading:x,isSuccess:f,refetch:g}=eU({slug:r}),j=(0,d.useMemo)(()=>null!=h?h:[],[h]),{data:v,isSuccess:y}=_({slug:r}),N=(0,l.Xo)(o.KA.BILLING_WRITE,"stripe.payment_methods");return(0,d.useEffect)(()=>{if(f&&y&&j.length>0){let e=j.some(e=>e.id===t);if(!t||!e){let e=j.find(e=>e.id===v.invoice_settings.default_payment_method);void 0!==e?n(e.id):n(j[0].id)}}},[f,y,t,v,j,n]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:x?(0,i.jsxs)("div",{className:"flex items-center px-4 py-2 space-x-4 border rounded-md border-strong bg-surface-200",children:[(0,i.jsx)(tj.Z,{className:"animate-spin",size:14}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"Retrieving payment methods"})]}):0===j.length?(0,i.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border border-dashed rounded-md bg-alternative",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4 text-foreground-light",children:[(0,i.jsx)(tv.Z,{size:16,strokeWidth:1.5}),(0,i.jsx)("p",{className:"text-sm",children:"No saved payment methods"})]}),(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{asChild:!0,children:(0,i.jsx)(F.z,{type:"default",disabled:!N,icon:(0,i.jsx)(eR,{}),onClick:()=>m(!0),htmlType:"button",children:"Add new"})}),!N&&(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-48 border border-background text-center",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to add new payment methods to this organization"})})]})})]})]}):(0,i.jsxs)(p.Z,{layout:s,label:"Payment method",value:t,onChange:n,className:"flex items-center",children:[j.map(e=>{let t="   ".concat(e.card.last4);return(0,i.jsx)(p.Z.Option,{label:t,value:e.id,addOnBefore:()=>(0,i.jsx)("img",{alt:"Credit Card Brand",src:"".concat(b.GW,"/img/payment-methods/").concat(e.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),children:(0,i.jsx)("div",{children:t})},e.id)}),(0,i.jsxs)("div",{className:"flex items-center px-3 py-2 space-x-2 transition cursor-pointer group hover:bg-surface-300",onClick:()=>m(!0),children:[(0,i.jsx)(eZ.Z,{size:16}),(0,i.jsx)("p",{className:"transition text-foreground-light group-hover:text-foreground",children:"Add new payment method"})]})]})}),(0,i.jsx)(eD.Z,{visible:c,returnUrl:"".concat((0,Q.Ax)(),"/org/").concat(null==a?void 0:a.slug,"/billing?panel=subscriptionPlan"),onCancel:()=>m(!1),onConfirm:async()=>{m(!1),u.ZP.success("Successfully added new payment method");let{data:e}=await g();(null==e?void 0:e.length)&&n(e.reduce((e,t)=>e.created>t.created?e:t,e[0]).id)}})]})},tb=n(34750),tN=()=>{var e,t,n,s;let a=(0,ex.useRouter)(),r=(0,l.lL)(),c=null==r?void 0:r.slug,m=(0,d.useRef)(),[h,p]=(0,d.useState)(!1),[f,g]=(0,d.useState)(!1),[v,y]=(0,d.useState)(),[N,w]=(0,d.useState)(!1),[_,C]=(0,d.useState)(),[S,k]=(0,d.useState)([]),E=(0,l.Xo)(o.KA.BILLING_WRITE,"stripe.subscriptions"),{data:A}=(0,e3.Sy)(),T=(A||[]).filter(e=>e.organization_id===(null==r?void 0:r.id)),I=(0,el.Wu)(),Z="subscriptionPlan"===I.panelKey,P=()=>{let{panel:e,...t}=a.query;a.push({pathname:a.pathname,query:t},void 0,{shallow:!0}),I.setPanelKey(void 0)},{data:R,isSuccess:L}=(0,z.G)({orgSlug:c}),{data:O,isLoading:D}=e8({orgSlug:c}),{data:U}=(0,e1.u)({slug:c}),{mutate:W,isLoading:G}=ey({onSuccess:()=>{u.ZP.success("Successfully updated subscription to ".concat(null==es?void 0:es.name,"!")),C(void 0),P(),window.scrollTo({top:0,left:0,behavior:"smooth"}),g(!0)},onError:e=>{u.ZP.error("Unable to update subscription: ".concat(e.message))}}),H=(null==R?void 0:R.billing_via_partner)===!0,Y=null==R?void 0:R.billing_partner,V=(null==R?void 0:R.payment_method_type)==="invoice",{data:K,error:$,isLoading:J,isSuccess:ee}=e4({tier:_,organizationSlug:c}),et=null!==(n=null==O?void 0:O.plans)&&void 0!==n?n:[],en=(U||[]).length>0,es=e6.z5.find(e=>e.id===_),ea=e=>{k([...S,e])},ei=e=>{k(S.filter(t=>t!==e))};(0,d.useEffect)(()=>{Z&&(C(void 0),eb.Z.sendActivity({activity:"Side Panel Viewed",source:"Dashboard",data:{title:"Change Subscription Plan",section:"Subscription plan"},...c&&{orgSlug:c}},a))},[Z]),(0,d.useEffect)(()=>{Z&&L&&(m.current=R.plan.id)},[Z,L]);let er=async()=>{var e;return c?_?v||V?void W({slug:c,tier:(null==R?void 0:null===(e=R.plan)||void 0===e?void 0:e.id)==="team"&&_===b.ev.PRO?b.ev.PAYG:_,paymentMethod:v}):u.ZP.error("Please select a payment method"):console.error("Selected plan is required"):console.error("org slug is required")},ec=_?et.find(e=>e.id===_.split("tier_")[1]):null;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ew.ZP,{hideFooter:!0,size:"xxlarge",visible:Z,onCancel:()=>P(),header:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("h4",{children:["Change subscription plan for ",null==r?void 0:r.name]}),(0,i.jsx)(F.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(X(),{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer",children:"Pricing"})})]}),children:(0,i.jsx)(ew.ZP.Content,{children:(0,i.jsx)("div",{className:"py-6 grid grid-cols-12 gap-3",children:e6.z5.map(e=>{var t,n,s;let r=et.find(t=>t.id===e.id.split("tier_")[1]),l=null!==(s=null==r?void 0:r.price)&&void 0!==s?s:0,o=(null==r?void 0:r.change_type)==="downgrade",d=(null==r?void 0:r.id)===(null==R?void 0:null===(t=R.plan)||void 0===t?void 0:t.id),u=(0,e6.g_)(e,Y),m=(0,e6.nq)(e,Y);return"tier_enterprise"===e.id?(0,i.jsx)(ti,{plan:e,isCurrentPlan:d,billingPartner:Y},e.id):(0,i.jsxs)("div",{className:"border rounded-md px-4 py-4 flex flex-col items-start justify-between col-span-12 md:col-span-4 bg-surface-200",children:[(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:(0,e_.cn)("text-brand text-sm uppercase"),children:e.name}),d?(0,i.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):e.nameBadge?(0,i.jsx)("div",{className:"text-xs bg-brand-400 text-brand-600 rounded px-2 py-0.5",children:e.nameBadge}):(0,i.jsx)(i.Fragment,{})]}),(0,i.jsxs)("div",{className:"mt-4 flex items-center space-x-1 mb-4",children:[(null!=l?l:0)>0&&(0,i.jsx)("p",{className:"text-foreground-light text-sm",children:"From"}),D?(0,i.jsx)("div",{className:"h-[28px] flex items-center justify-center",children:(0,i.jsx)(j.Z,{className:"w-[30px] h-[24px]"})}):(0,i.jsx)("p",{className:"text-foreground text-lg",children:(0,Q.xG)(l)}),(0,i.jsx)("p",{className:"text-foreground-light text-sm",children:e.costUnit})]}),d?(0,i.jsx)(F.z,{block:!0,disabled:!0,type:"default",children:"Current plan"}):(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{asChild:!0,children:(0,i.jsx)("div",{children:(0,i.jsxs)(F.z,{block:!0,disabled:(null==R?void 0:null===(n=R.plan)||void 0===n?void 0:n.id)==="enterprise"||!E,type:o?"default":"primary",onClick:()=>{C(e.id),eb.Z.sendActivity({activity:"Popup Viewed",source:"Dashboard",data:{title:o?"Downgrade":"Upgrade to "+e.name,section:"Subscription plan"},...c&&{orgSlug:c}},a)},children:[o?"Downgrade":"Upgrade"," to ",e.name]})})}),E?null:(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"You do not have permission to change the subscription plan."})})]})})]}),(0,i.jsx)("div",{className:"border-t my-4"}),(0,i.jsx)("ul",{role:"list",children:u.map(e=>(0,i.jsxs)("li",{className:"flex py-2",children:[(0,i.jsx)("div",{className:"w-[12px]",children:(0,i.jsx)(e9.Z,{className:"h-3 w-3 text-brand translate-y-[2.5px]","aria-hidden":"true",strokeWidth:3})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"ml-3 text-xs text-foreground-light",children:"string"==typeof e?e:e[0]}),eJ()(e)&&(0,i.jsx)("p",{className:"ml-3 text-xs text-foreground-lighter",children:e[1]})]})]},"string"==typeof e?e:e[0]))})]}),m&&(0,i.jsx)("div",{className:"border-t pt-4 mt-4",children:(0,i.jsx)("p",{className:"text-foreground-light text-xs",children:m})})]},e.id)})})})}),(0,i.jsx)(ta,{visible:"tier_free"===_,selectedPlan:es,subscription:R,onClose:()=>C(void 0),onConfirm:()=>{C(void 0),en?w(!0):p(!0)},projects:T}),(0,i.jsxs)(eM.C,{loading:G,alignFooter:"right",size:"xlarge",visible:void 0!==_&&"tier_free"!==_,onCancel:()=>C(void 0),onConfirm:er,overlayClassName:"pointer-events-none",header:"Confirm ".concat((null==ec?void 0:ec.change_type)==="downgrade"?"downgrade":"upgrade"," to ").concat(null==es?void 0:es.name),children:[(0,i.jsxs)(eM.C.Content,{className:"mt-4",children:[$&&(0,i.jsx)(x.Z,{error:$,subject:"Failed to preview subscription."}),J&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("span",{className:"text-sm",children:"Estimating monthly costs..."}),(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),ee&&(0,i.jsxs)("div",{children:[(0,i.jsx)(ef.Z,{className:"mt-2",borderless:!0,head:[(0,i.jsx)(ef.Z.th,{children:"Item"},"header-item"),(0,i.jsx)(ef.Z.th,{className:"text-right pr-4",children:"Usage"},"header-count"),(0,i.jsx)(ef.Z.th,{children:"Unit Price"},"header-unit-price"),(0,i.jsx)(ef.Z.th,{className:"text-right",children:"Cost"},"header-price")],body:(0,i.jsxs)(i.Fragment,{children:[K.breakdown.map(e=>{var t,n;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ef.Z.tr,{children:[(0,i.jsxs)(ef.Z.td,{children:[e.breakdown&&e.breakdown.length>0&&(0,i.jsx)(F.z,{type:"text",className:"!pl-0 !pr-1",icon:(0,i.jsx)(M.Z,{className:(0,e_.cn)("transition",S.includes(e.description)&&"rotate-90")}),onClick:()=>S.includes(e.description)?ei(e.description):ea(e.description)}),null!==(n=e.description)&&void 0!==n?n:"Unknown"," ",e.description.endsWith("Compute")&&" (Hours)"]}),(0,i.jsx)(ef.Z.td,{className:"text-right pr-4 tabular-nums",children:null===(t=e.quantity)||void 0===t?void 0:t.toLocaleString()}),(0,i.jsx)(ef.Z.td,{children:e.unit_price_desc?e.unit_price_desc:0===e.unit_price?"FREE":e.unit_price?"".concat((0,Q.xG)(e.unit_price)):""}),(0,i.jsx)(ef.Z.td,{className:"text-right",children:(0,Q.xG)(e.total_price)})]},e.description),S.includes(e.description)&&e.breakdown&&e.breakdown.length>0&&e.breakdown.map(e=>(0,i.jsxs)(ef.Z.tr,{children:[(0,i.jsx)(ef.Z.td,{className:"!pl-12",children:e.project_name}),(0,i.jsx)(ef.Z.td,{className:"text-right pr-4 tabular-nums",children:e.usage}),(0,i.jsx)(ef.Z.td,{}),(0,i.jsx)(ef.Z.td,{})]},e.project_ref))]})}),(0,i.jsxs)(ef.Z.tr,{children:[(0,i.jsx)(ef.Z.td,{className:"font-medium",children:"Monthly Costs (excluding over-usage and credits)"}),(0,i.jsx)(ef.Z.td,{}),(0,i.jsx)(ef.Z.td,{}),(0,i.jsx)(ef.Z.td,{className:"text-right font-medium",children:(0,Q.xG)(null!==(s=Math.round(K.breakdown.reduce((e,t)=>e+t.total_price,0)))&&void 0!==s?s:0)})]})]})}),(0,i.jsx)(e0.Z,{className:"mt-4",title:"Usage-billing for Compute",icon:(0,i.jsx)(q.Z,{}),defaultVisibility:!0,hideCollapse:!0,description:(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm mt-2",children:"Each project is a dedicated server and database. Paid plans come with $10 of Compute Credits to cover one project on the default Micro Compute size or parts of any compute addon. Additional unpaused projects on paid plans will incur compute usage costs starting at $10 per month, billed hourly."}),(null==R?void 0:null===(e=R.plan)||void 0===e?void 0:e.id)==="free"&&(0,i.jsx)("p",{className:"text-sm mt-2",children:"Mixing paid and non-paid projects in a single organization is not possible. If you want projects to be on the free plan, use self-serve project transfers."}),(0,i.jsxs)("div",{className:"space-x-3 mt-2",children:[(0,i.jsx)(F.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(X(),{href:"https://supabase.com/docs/guides/platform/org-based-billing",target:"_blank",rel:"noreferrer",children:"How billing works"})}),(null==R?void 0:null===(t=R.plan)||void 0===t?void 0:t.id)==="free"&&(0,i.jsx)(F.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(X(),{href:"https://supabase.com/docs/guides/platform/project-transfer",target:"_blank",rel:"noreferrer",children:"Project transfers"})})]})]})})]})]}),(0,i.jsx)(eM.C.Content,{children:H?(0,i.jsxs)("div",{className:"py-4 space-y-2",children:[(0,i.jsxs)("p",{className:"text-sm",children:["This organization is billed through our partner"," ",(0,tb.Gh)(Y),"."," ","aws"===Y?(0,i.jsx)(i.Fragment,{children:"The organization's credit balance will be decreased accordingly."}):(0,i.jsx)(i.Fragment,{children:"You will be charged by them directly."})]}),H&&"fly"===Y&&(null==K?void 0:K.plan_change_type)==="downgrade"&&(0,i.jsx)("p",{className:"text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]}):(0,i.jsxs)("div",{className:"py-4 space-y-2",children:[(0,i.jsx)("p",{className:"text-sm",children:"Upon clicking confirm, your monthly invoice will be adjusted and your credit card will be charged immediately. Changing the plan resets your billing cycle and may result in a prorated charge for previous usage."}),(0,i.jsx)("div",{className:"!mt-4",children:(0,i.jsx)(ty,{selectedPaymentMethod:v,onSelectPaymentMethod:y})})]})})]}),(0,i.jsx)(tg,{visible:N,onClose:()=>w(!1)}),(0,i.jsx)(th,{visible:h,subscription:R,projects:T,onClose:e=>{p(!1),e&&P()}}),(0,i.jsx)(tf,{visible:f,originalPlan:m.current,subscription:R,onClose:e=>{g(!1),e&&P()}})]})},tw=()=>{var e,t,n,s,a,o,d,u;let{slug:m}=(0,c.UO)(),h=(0,el.Wu)(),p=(0,l.P5)("disableProjectCreationAndUpdate"),{data:f,error:g,isLoading:v,isError:y,isSuccess:b}=(0,z.G)({orgSlug:m}),{mutate:N,isLoading:w}=eE(),_=null==f?void 0:f.plan,C=null!==(s=null==_?void 0:_.name)&&void 0!==s?s:"Unknown",S=Z().unix(null!==(a=null==f?void 0:f.current_period_start)&&void 0!==a?a:0).utc(),k=Z().unix(null!==(o=null==f?void 0:f.current_period_end)&&void 0!==o?o:0).utc(),E=k.diff(Z()(),"days"),A=k.diff(S,"days"),T=!p&&!["enterprise"].includes(null!==(d=null==_?void 0:_.id)&&void 0!==d?d:"");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.jX,{children:[(0,i.jsx)("div",{className:"col-span-12 pb-2",children:(0,i.jsx)(eQ,{})}),(0,i.jsx)(r.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Subscription Plan"}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"More information"}),(0,i.jsx)("div",{children:(0,i.jsx)(X(),{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,i.jsx)("p",{className:"text-sm m-0",children:"Pricing"}),(0,i.jsx)(eV.Z,{size:16,strokeWidth:1.5})]})})})]})]})}),(0,i.jsxs)(r.Lc,{children:[v&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),y&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve subscription",error:g}),b&&(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm",children:"This organization is currently on the plan:"}),(0,i.jsx)("p",{className:"text-2xl text-brand uppercase",children:null!==(u=null==_?void 0:_.name)&&void 0!==u?u:"Unknown"})]}),(null==f?void 0:f.scheduled_plan_change)&&(null==f?void 0:null===(e=f.scheduled_plan_change)||void 0===e?void 0:e.target_plan)!==f.plan.id&&(0,i.jsxs)(ed.bZ,{className:"mb-2",title:"Scheduled downgrade",children:[(0,i.jsx)(eu.Z,{className:"h-4 w-4"}),(0,i.jsx)(ed.Cd,{children:"Scheduled downgrade"}),(0,i.jsxs)(ed.X,{className:"flex flex-col gap-3",children:[(0,i.jsxs)("div",{children:["Your organization will automatically be downgraded from the"," ",(0,i.jsx)("span",{children:f.plan.name})," plan to the"," ",(0,i.jsx)("span",{className:"capitalize",children:null==f?void 0:null===(t=f.scheduled_plan_change)||void 0===t?void 0:t.target_plan})," ","plan on"," ",Z()(null==f?void 0:null===(n=f.scheduled_plan_change)||void 0===n?void 0:n.at).format("MMMM D, YYYY"),". If you would like to stay on the ",(0,i.jsx)("span",{children:f.plan.name})," plan, cancel the scheduled downgrade."]}),(0,i.jsx)("div",{children:(0,i.jsx)(F.z,{type:"default",loading:w,onClick:()=>N({slug:m}),children:"Cancel downgrade"})})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(em.Z,{projectUpdateDisabled:p,children:(0,i.jsx)(F.z,{type:"default",className:"pointer-events-auto",disabled:!T,onClick:()=>h.setPanelKey("subscriptionPlan"),children:"Change subscription plan"})}),!T&&(p?(0,i.jsx)(ec.b,{className:"mt-2",withIcon:!0,variant:"info",title:"Unable to update plan from ".concat(C),children:"We have temporarily disabled project and subscription changes - our engineers are working on a fix."}):(0,i.jsx)(ec.b,{withIcon:!0,className:"mt-2",variant:"info",title:"Unable to update plan from ".concat(C),actions:[(0,i.jsx)("div",{children:(0,i.jsx)(F.z,{asChild:!0,type:"default",children:(0,i.jsx)(X(),{href:"/support/new?category=sales&subject=Change%20plan%20away%20from%20".concat(C),children:"Contact support"})})},"contact-support")],children:"Please contact us if you'd like to change your plan."}))]}),!(null==f?void 0:f.usage_billing_enabled)&&(0,i.jsx)(ec.b,{withIcon:!0,variant:"info",title:"This organization is limited by the included usage",actions:(null==_?void 0:_.id)==="free"?(0,i.jsx)(F.z,{type:"default",onClick:()=>h.setPanelKey("subscriptionPlan"),children:"Upgrade Plan"}):(0,i.jsx)(F.z,{type:"default",onClick:()=>h.setPanelKey("costControl"),children:"Adjust Spend Cap"}),children:(0,i.jsxs)("div",{className:"text-sm text-foreground-light mr-2",children:["When this organization exceeds its"," ",(0,i.jsx)(X(),{href:"/org/".concat(m,"/usage"),className:"text-sm text-green-900 transition hover:text-green-1000",children:"included usage quotas"}),", its projects may become unresponsive."," ",(null==_?void 0:_.id)==="free"?(0,i.jsx)("p",{className:"pr-4 mt-1",children:"If you wish to exceed the included usage, you should upgrade to a paid plan."}):(0,i.jsx)("p",{className:"pr-4 mt-1",children:"You currently have Spend Cap enabled - when you exceed your plan's limit, you will experience restrictions. To scale seamlessly and pay for over-usage, you can adjust your Cost Control settings."})]})}),(0,i.jsx)(eY.Z,{type:"horizontal",value:A-E,max:A,barClass:"bg-foreground",labelBottom:"Current billing cycle (".concat(S.format("MMM DD")," - ").concat(k.format("MMM DD"),")"),bgClass:"bg-surface-300",labelBottomClass:"!text-foreground-light pb-1",labelTop:"".concat(E," days remaining")})]})]})]}),(0,i.jsx)(tN,{})]})};async function t_(e,t){let{slug:n}=e;if(!n)throw Error("slug is required");let s=await (0,y.U2)("".concat(b.T5,"/organizations/").concat(n,"/tax-ids"),{signal:t});if(s.error)throw s.error;return s.data}let tC=function(e){let{slug:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(N.O.taxIds(t),e=>{let{signal:n}=e;return t_({slug:t},n)},{enabled:n&&void 0!==t,...s})};async function tS(e){let{slug:t,existingIds:n,newIds:s}=e;if(!t)return console.error("Slug is required"),{};n.length>0&&await Promise.all(n.map(async e=>await (0,y.$v)("".concat(b.T5,"/organizations/").concat(t,"/tax-ids"),{id:e.id})));let a=await Promise.all(s.map(async e=>{let n=await (0,y.v_)("".concat(b.T5,"/organizations/").concat(t,"/tax-ids"),{type:e.type,value:e.value});return{id:e.id,result:n}})),i=a.filter(e=>{if(e.result.error)return e});return{created:a.filter(e=>!e.result.error).map(e=>e.result),errors:i}}let tk=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>tS(e),{async onSuccess(t,n,a){let{slug:i}=n;await s.invalidateQueries(N.O.taxIds(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to update tax IDs: ".concat(e.message)):t(e,n,s)},...n})};var tE=n(61373);let tA=[{name:"AE TRN",code:"ae_trn",country:"United Arab Emirates",placeholder:"123456789012345"},{name:"AT VAT",code:"eu_vat",country:"Austria",placeholder:"ATU12345678",vatPrefix:"ATU"},{name:"AD NRT",code:"ad_nrt",country:"Andorra",placeholder:"A-123456-Z"},{name:"AR CUIT",code:"ar_cuit",country:"Argentina",placeholder:"12-3456789-01"},{name:"AU ABN",code:"au_abn",country:"Australia",placeholder:"12345678912"},{name:"AU ARN",code:"au_arn",country:"Australia",placeholder:"123456789123"},{name:"BE VAT",code:"eu_vat",country:"Belgium",placeholder:"BE0123456789",vatPrefix:"BE"},{name:"BO TIN",code:"bo_tin",country:"Bolivia",placeholder:"123456789"},{name:"BG VAT",code:"eu_vat",country:"Bulgaria",placeholder:"BG0123456789",vatPrefix:"BG"},{name:"BR CNPJ",code:"br_cnpj",country:"Brazil",placeholder:"01.234.456/5432-10"},{name:"BR CPF",code:"br_cpf",country:"Brazil",placeholder:"123.456.789-87"},{name:"CA BN",code:"ca_bn",country:"Canada",placeholder:"123456789"},{name:"CA GST/HST",code:"ca_gst_hst",country:"Canada",placeholder:"123456789RT0002"},{name:"CA PST-BC",code:"ca_pst_bc",country:"Canada",placeholder:"PST-1234-5678"},{name:"CA PST-MB",code:"ca_pst_mb",country:"Canada",placeholder:"123456-7"},{name:"CA PST-SK",code:"ca_pst_mb",country:"Canada",placeholder:"1234567"},{name:"CA QST",code:"ca_qst",country:"Canada",placeholder:"1234567890TQ1234"},{name:"CH VAT",code:"ch_vat",country:"Switzerland",placeholder:"CHE-123.456.789 MWST",vatPrefix:"CHE"},{name:"CL TIN",code:"cl_tin",country:"Chile",placeholder:"12.345.678-K"},{name:"CN TIN",code:"cn_tin",country:"China",placeholder:"123456789012345678"},{name:"CO NIT",code:"co_nit",country:"Colombia",placeholder:"123.456.789-0"},{name:"CR TIN",code:"cr_tin",country:"Costa Rica",placeholder:"1-234-567890"},{name:"CY VAT",code:"eu_vat",country:"Cyprus",placeholder:"CY12345678Z",vatPrefix:"CY"},{name:"CZ VAT",code:"eu_vat",country:"Czech Republic",placeholder:"CZ1234567890",vatPrefix:"CZ"},{name:"DE VAT",code:"eu_vat",country:"Germany",placeholder:"DE123456789",vatPrefix:"DE"},{name:"DK VAT",code:"eu_vat",country:"Denmark",placeholder:"DK12345678",vatPrefix:"DK"},{name:"DO RCN",code:"do_rcn",country:"Dominican Republic",placeholder:"123-4567890-1"},{name:"EE VAT",code:"eu_vat",country:"Estonia",placeholder:"EE123456789",vatPrefix:"EE"},{name:"ES CIF",code:"es_cif",country:"Spain",placeholder:"A12345678"},{name:"ES VAT",code:"eu_vat",country:"Spain",placeholder:"ESX1234567Z",vatPrefix:"ES"},{name:"FI VAT",code:"eu_vat",country:"Finland",placeholder:"FI12345678",vatPrefix:"FI"},{name:"FR VAT",code:"eu_vat",country:"France",placeholder:"FRAB123456789",vatPrefix:"FR"},{name:"GB VAT",code:"eu_vat",country:"United Kingdom",placeholder:"GB123456789",vatPrefix:"GB"},{name:"GE VAT",code:"ge_vat",country:"Georgia",placeholder:"123456789"},{name:"EL VAT",code:"eu_vat",country:"Greece",placeholder:"EL123456789",vatPrefix:"EL"},{name:"HK BR",code:"hk_br",country:"Hong Kong SAR China",placeholder:"12345678"},{name:"HR VAT",code:"eu_vat",country:"Croatia",placeholder:"HR12345678912",vatPrefix:"HR"},{name:"HU VAT",code:"eu_vat",country:"Hungary",placeholder:"HU12345678912",vatPrefix:"HU"},{name:"ID NPWP",code:"id_npwp",country:"Indonesia",placeholder:"12.345.678.9-012.345"},{name:"IE VAT",code:"eu_vat",country:"Ireland",placeholder:"IE1234567AB",vatPrefix:"IE"},{name:"IL VAT",code:"il_vat",country:"Israel",placeholder:"000012345"},{name:"IN GST",code:"in_gst",country:"India",placeholder:"12ABCDE3456FGZH"},{name:"IS VAT",code:"is_vat",country:"Iceland",placeholder:"123456"},{name:"IT VAT",code:"eu_vat",country:"Italy",placeholder:"IT12345678912",vatPrefix:"IT"},{name:"JP CN",code:"jp_cn",country:"Japan",placeholder:"1234567891234"},{name:"KE PIN",code:"ke_pin",country:"Kenya",placeholder:"P000111111A"},{name:"JP RN",code:"jp_rn",country:"Japan",placeholder:"12345"},{name:"KR BRN",code:"kr_brn",country:"Korea",placeholder:"123-45-67890"},{name:"LI UID",code:"li_uid",country:"Liechtenstein",placeholder:"CHE123456789"},{name:"LT VAT",code:"eu_vat",country:"Lithuania",placeholder:"LT123456789123",vatPrefix:"LT"},{name:"LU VAT",code:"eu_vat",country:"Luxembourg",placeholder:"LU12345678",vatPrefix:"LU"},{name:"LV VAT",code:"eu_vat",country:"Latvia",placeholder:"LV12345678912",vatPrefix:"LV"},{name:"MT VAT",code:"eu_vat",country:"Malta",placeholder:"MT12345678",vatPrefix:"MT"},{name:"MX RFC",code:"mx_rfc",country:"Mexico",placeholder:"ABC010203AB9"},{name:"MY FRP",code:"my_frp",country:"Malaysia",placeholder:"12345678"},{name:"MY ITN",code:"my_itn",country:"Malaysia",placeholder:"C 1234567890"},{name:"MY SST",code:"my_sst",country:"Malaysia",placeholder:"A12-3456-78912345"},{name:"NL VAT",code:"eu_vat",country:"Netherlands",placeholder:"NL123456789B12",vatPrefix:"NL"},{name:"NO VAT",code:"no_vat",country:"Norway",placeholder:"123456789MVA"},{name:"PE RUC",code:"pe_ruc",country:"Peru",placeholder:"12345678901"},{name:"PH TIN",code:"ph_tin",country:"Philippines",placeholder:"123456789012"},{name:"NZ GST",code:"nz_gst",country:"New Zealand",placeholder:"123456789"},{name:"PL VAT",code:"eu_vat",country:"Poland",placeholder:"PL1234567890",vatPrefix:"PL"},{name:"PT VAT",code:"eu_vat",country:"Portugal",placeholder:"PT123456789",vatPrefix:"PT"},{name:"RO VAT",code:"eu_vat",country:"Romania",placeholder:"RO1234567891",vatPrefix:"RO"},{name:"RU INN",code:"ru_inn",country:"Russia",placeholder:"1234567891"},{name:"RU KPP",code:"ru_kpp",country:"Russia",placeholder:"123456789"},{name:"SA VAT",code:"sa_vat",country:"Saudi Arabia",placeholder:"123456789012345"},{name:"RS PIB",code:"rs_pib",country:"Serbia",placeholder:"123456789"},{name:"SE VAT",code:"eu_vat",country:"Sweden",placeholder:"SE123456789123",vatPrefix:"SE"},{name:"SG GST",code:"sg_gst",country:"Singapore",placeholder:"M12345678X"},{name:"SG UEN",code:"sg_uen",country:"Singapore",placeholder:"123456789F"},{name:"SI VAT",code:"eu_vat",country:"Slovenia",placeholder:"SI12345678",vatPrefix:"SI"},{name:"SK VAT",code:"eu_vat",country:"Slovakia",placeholder:"SK1234567891",vatPrefix:"SK"},{name:"TH VAT",code:"th_vat",country:"Thailand",placeholder:"1234567891234"},{name:"TR TIN",code:"tr_tin",country:"Turkey",placeholder:"0123456789"},{name:"TW VAT",code:"tw_vat",country:"Taiwan",placeholder:"12345678"},{name:"UA VAT",code:"ua_vat",country:"Ukraine",placeholder:"123456789"},{name:"US EIN",code:"us_ein",country:"United States",placeholder:"12-3456789"},{name:"XI VAT",code:"eu_vat",country:"United Kingdom (Northern Ireland)",placeholder:"XI123456789",vatPrefix:"XI"},{name:"ZA VAT",code:"za_vat",country:"South Africa",placeholder:"4123456789"},{name:"UY RUC",code:"uy_ruc",country:"Uruguay",placeholder:"123456789012"},{name:"VE RIF",code:"ve_rif",country:"Venezuela",placeholder:"A-12345678-9"},{name:"VN TIN",code:"vn_tin",country:"Vietnam",placeholder:"1234567890"}];var tT=n(18149),tI=n.n(tT),tZ=n(829),tz=n.n(tZ);let tP=e=>{let t=tA.find(t=>t.name===e.name),n=null==t?void 0:t.vatPrefix;return n&&!e.value.startsWith(n)&&(e.value="".concat(n).concat(e.value)),e},tR=(e,t)=>{let n=e.map(e=>({type:e.type,value:e.value,name:e.name})),s=t.map(e=>({type:e.type,value:e.value,name:e.name}));return tI()(tz()(n,"name"),tz()(s,"name"))};var tL=()=>{var e;let{slug:t}=(0,c.UO)(),{data:n,error:s,isLoading:a,isSuccess:v,isError:y}=tC({slug:t}),{mutate:b,isLoading:N}=tk({onSuccess:e=>{var t,n;let{created:s,errors:a}=e;_(null!==(t=null==a?void 0:a.map(e=>e.id))&&void 0!==t?t:[]),S(null!==(n=null==s?void 0:s.map(e=>{var t,n;return{id:e.id,type:e.type,value:e.value,name:"eu_vat"===e.type?"".concat(e.country," VAT"):null!==(n=null===(t=tA.find(t=>t.code===e.type))||void 0===t?void 0:t.name)&&void 0!==n?n:""}}))&&void 0!==n?n:[]),void 0!==a&&a.length>0?a.forEach(e=>{u.ZP.error(e.result.error.message)}):u.ZP.success("Successfully updated tax IDs")}}),[w,_]=(0,d.useState)([]),[C,S]=(0,d.useState)([]),k=null!==(e=null==n?void 0:n.map(e=>{var t,n;return{id:e.id,type:e.type,value:e.value,name:"eu_vat"===e.type?"".concat(e.country," VAT"):null!==(n=null===(t=tA.find(t=>t.code===e.type))||void 0===t?void 0:t.name)&&void 0!==n?n:""}}))&&void 0!==e?e:[],E="tax-id-form",A=!tR(C,k),T=(0,l.Xo)(o.KA.BILLING_READ,"stripe.tax_ids"),I=(0,l.Xo)(o.KA.BILLING_WRITE,"stripe.tax_ids");(0,d.useEffect)(()=>{if(v){if(0===C.length)S(k);else{let e=C.filter(e=>w.includes(e.id));S(k.concat(e))}}},[v]);let Z=(e,t,n)=>{S(C.map(s=>{if(s.id===e){if("name"!==t)return{...s,[t]:n};{let e=tA.find(e=>e.name===n);return{...s,[t]:n,type:null==e?void 0:e.code}}}return s}))},z=()=>{let e={id:(0,Q.k$)(),type:tA[0].code,value:"",name:tA[0].name};S(C.concat([e]))},P=e=>{S(C.filter(t=>t.id!==e))},R=()=>{S(k)},L=async e=>t?void 0===n?console.error("Tax IDs are required"):void b({slug:t,existingIds:n,newIds:C.map(e=>tP(e))}):console.error("Slug is required");return(0,i.jsxs)(r.jX,{children:[(0,i.jsx)(r.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Tax ID"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light pr-4 m-0",children:"Add tax ID(s) to have them appear in your invoices. Old invoices are not affected."}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Make sure the tax ID looks exactly like the placeholder text."})]})}),(0,i.jsx)(r.Lc,{children:T?(0,i.jsxs)(i.Fragment,{children:[a&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),y&&(0,i.jsx)(x.Z,{error:s,subject:"Failed to retrieve organization tax IDs"}),v&&(0,i.jsx)(m.Z,{validateOnBlur:!0,id:E,initialValues:{},onSubmit:L,children:()=>(0,i.jsx)(f.by,{footer:(0,i.jsx)("div",{className:"flex py-4 px-8",children:(0,i.jsx)(f.iN,{form:E,isSubmitting:N,hasChanges:A,handleReset:()=>R(),helper:I?void 0:"You need additional permissions to manage this organization's tax IDs"})}),children:(0,i.jsx)(f.hj,{children:(0,i.jsxs)(f.B4,{fullWidth:!0,loading:!1,children:[C.length>=1?(0,i.jsx)("div",{className:"w-full space-y-2",children:C.map((e,t)=>{var n;let s=tA.find(t=>t.name===e.name);return(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(p.Z,{value:null==s?void 0:s.name,onChange:t=>Z(e.id,"name",t),disabled:!I,className:"w-[200px]",children:tA.sort((e,t)=>e.country.localeCompare(t.country)).map(e=>(0,i.jsxs)(p.Z.Option,{value:e.name,label:e.name,children:[e.country," - ",e.name]},e.name))}),(0,i.jsx)(h.Z,{value:e.value,placeholder:null!==(n=null==s?void 0:s.placeholder)&&void 0!==n?n:"",onChange:t=>Z(e.id,"value",t.target.value),disabled:!I}),I&&(0,i.jsx)(F.z,{type:"text",className:"px-1",icon:(0,i.jsx)(tE.Z,{}),onClick:()=>P(e.id)})]},"tax-id-".concat(t))})}):(0,i.jsx)("div",{children:(0,i.jsx)("p",{className:"flex items-center space-x-2 text-sm text-foreground-lighter",children:"No tax IDs"})}),I&&(0,i.jsxs)("div",{className:"flex cursor-pointer items-center space-x-2 opacity-50 transition hover:opacity-100",onClick:()=>z(),children:[(0,i.jsx)(eZ.Z,{size:14}),(0,i.jsx)("p",{className:"text-sm",children:"Add another ID"})]})]})})})})]}):(0,i.jsx)(g.Z,{resourceText:"view this organization's tax IDs"})})]})},tO=()=>{var e;let{billingAccountData:t,billingPaymentMethods:n,billingCredits:s}=(0,l.N3)(["billing:account_data","billing:payment_methods","billing:credits"]),{slug:a}=(0,c.UO)(),{data:o}=(0,z.G)({orgSlug:a}),d=!(null==o?void 0:o.billing_via_partner),u=t&&d,m=n&&d;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r._S,{id:"subscription",children:(0,i.jsx)(tw,{})}),(0,i.jsx)(r.I7,{}),(0,i.jsx)(r._S,{id:"cost-control",children:(0,i.jsx)(eA,{})}),(0,i.jsx)(r.I7,{}),(0,i.jsx)(r._S,{id:"breakdown",children:(0,i.jsx)(et,{})}),s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.I7,{}),(0,i.jsx)(r._S,{id:"credits-balance",children:(0,i.jsx)(eI,{})})]}),m&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.I7,{}),(0,i.jsx)(r._S,{id:"payment-methods",children:(0,i.jsx)(eH,{})})]}),u&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.I7,{}),(0,i.jsx)(r._S,{id:"email",children:(0,i.jsx)(ei,{})}),(0,i.jsx)(r.I7,{}),(0,i.jsx)(r._S,{id:"address",children:(0,i.jsx)(T,{})}),(0,i.jsx)(r.I7,{}),(0,i.jsx)(r._S,{id:"taxId",children:(0,i.jsx)(tL,{})})]})]})},tD=n(46216),tF=n(22854),tU=n(64306),tM=n(28414);async function tq(e){let{slug:t}=e,{data:n,error:s}=await (0,R.IV)("/platform/organizations/{slug}",{params:{path:{slug:t}}});return s&&(0,R.S3)(s),n}let tB=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>tq(e),{async onSuccess(t,n,a){await Promise.all([s.invalidateQueries(N.O.list()),s.invalidateQueries(tM.F.list())]),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to delete organization: ".concat(e.message)):t(e,n,s)},...n})};var tW=()=>{let e=(0,ex.useRouter)(),t=(0,l.lL)(),{slug:n,name:s}=null!=t?t:{},[a,r]=(0,d.useState)(!1),[c,p]=(0,d.useState)(""),x=(0,l.Xo)(o.KA.UPDATE,"organizations"),{mutate:f,isLoading:g}=tB({onSuccess:()=>{u.ZP.success("Successfully deleted ".concat(s)),e.push("/projects")}}),j=async e=>x?n?void f({slug:n}):console.error("Org slug is required"):u.ZP.error("You do not have the required permissions to delete this organization");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)(F.z,{loading:!n,onClick:()=>r(!0),type:"danger",children:"Delete organization"})}),(0,i.jsx)(eM.C,{closable:!0,hideFooter:!0,size:"small",visible:a,onCancel:()=>r(!1),header:(0,i.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,i.jsx)("h5",{className:"text-sm text-foreground",children:"Delete organization"}),(0,i.jsx)("span",{className:"text-xs text-foreground-lighter",children:"Are you sure?"})]}),children:(0,i.jsx)(m.Z,{validateOnBlur:!0,initialValues:{orgName:""},onSubmit:j,validate:e=>{let t={};return e.orgName||(t.orgName="Enter the name of the organization."),e.orgName!==n&&(t.orgName="Value entered does not match the value above."),t},children:()=>(0,i.jsxs)("div",{className:"space-y-4 py-3",children:[(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["This action ",(0,i.jsx)("span",{className:"text-foreground",children:"cannot"})," be undone. This will permanently delete the ",(0,i.jsx)("span",{className:"text-foreground",children:s})," ","organization and remove all of its projects."]})}),(0,i.jsx)(eM.C.Separator,{}),(0,i.jsx)(eM.C.Content,{children:(0,i.jsx)(h.Z,{id:"orgName",label:(0,i.jsxs)("span",{children:["Please type ",(0,i.jsx)("span",{className:"font-bold",children:n})," to confirm"]}),onChange:e=>p(e.target.value),value:c,placeholder:"Enter the string above",className:"w-full"})}),(0,i.jsx)(eM.C.Separator,{}),(0,i.jsx)(eM.C.Content,{children:(0,i.jsx)(F.z,{block:!0,size:"small",type:"danger",htmlType:"submit",loading:g,disabled:g,children:"I understand, delete this organization"})})]})})})]})},tG=()=>(0,i.jsx)(tU.Z,{title:(0,i.jsx)("p",{className:"uppercase",children:"Danger Zone"},"panel-title"),children:(0,i.jsx)(tU.Z.Content,{children:(0,i.jsxs)(ed.bZ,{variant:"destructive",children:[(0,i.jsx)(eX.ku,{}),(0,i.jsx)(ed.Cd,{children:"Deleting this organization will also remove its projects"}),(0,i.jsx)(ed.X,{children:"Make sure you have made a backup if you want to keep your data"}),(0,i.jsx)(tW,{})]})})}),tH=()=>{let{slug:e}=(0,c.UO)(),t=(0,C.NL)(),[n,s]=(0,d.useState)(!1),a=(0,l.lL)(),{name:p,opt_in_tags:x}=null!=a?a:{},g="org-general-settings",j=null==x?void 0:x.includes(b.PV.AI_SQL),v=(0,l.N3)("organizations:delete"),y=(0,l.Xo)(o.KA.UPDATE,"organizations"),N=(0,l.Xo)(o.KA.UPDATE,"organizations"),{mutate:w,isLoading:_}=es(),S=async(n,s)=>{var i;let{resetForm:r}=s;if(!y)return u.ZP.error("You do not have the required permissions to update this organization");if(!e)return console.error("Slug is required");let l=null!==(i=null==a?void 0:a.opt_in_tags)&&void 0!==i?i:[],o=n.isOptedIntoAi&&!l.includes(b.PV.AI_SQL)?l.concat([b.PV.AI_SQL]):!n.isOptedIntoAi&&l.includes(b.PV.AI_SQL)?l.filter(e=>e!==b.PV.AI_SQL):l;w({slug:e,name:n.name,opt_in_tags:o},{onSuccess:()=>{r({values:n,initialValues:n}),(0,ea.aL)(t),u.ZP.success("Successfully saved settings")}})};return(0,i.jsxs)(r.gW,{children:[(0,i.jsx)(tD.Z,{organization:a}),(0,i.jsx)(m.Z,{id:g,initialValues:{name:null!=p?p:"",isOptedIntoAi:j},onSubmit:S,children:e=>{let{handleReset:t,values:r,initialValues:l,resetForm:o}=e,c=JSON.stringify(r)!==JSON.stringify(l);return(0,d.useEffect)(()=>{let e={name:null!=p?p:"",isOptedIntoAi:j};o({values:e,initialValues:e})},[null==a?void 0:a.slug]),(0,i.jsx)(f.by,{footer:(0,i.jsx)("div",{className:"flex py-4 px-8",children:(0,i.jsx)(f.iN,{form:g,isSubmitting:_,hasChanges:c,handleReset:t,helper:y?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,i.jsx)(f.hj,{header:(0,i.jsx)(f.S0,{children:"General settings"}),children:(0,i.jsxs)(f.B4,{loading:!1,children:[(0,i.jsx)(h.Z,{id:"name",size:"small",label:"Organization name",disabled:!y}),(0,i.jsx)(h.Z,{copy:!0,disabled:!0,id:"slug",size:"small",label:"Organization slug",value:null==a?void 0:a.slug}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)(tF.Z,{id:"isOptedIntoAi",name:"isOptedIntoAi",disabled:!y,size:"small",label:"Opt-in to sending anonymous data to OpenAI",descriptionText:"By opting into sending anonymous data, Supabase AI can improve the answers it shows you"}),(0,i.jsxs)(U.ZP,{open:n,onOpenChange:s,children:[(0,i.jsx)(U.ZP.Trigger,{asChild:!0,children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 ml-16 cursor-pointer",children:[(0,i.jsx)(M.Z,{strokeWidth:2,size:16,className:(0,e_.cn)("transition-all",n?"rotate-90":"")}),(0,i.jsx)("p",{className:"text-sm text-foreground-light underline",children:"Important information regarding opting in"})]})}),(0,i.jsx)(U.ZP.Content,{children:(0,i.jsxs)("div",{className:"space-y-2 py-4 ml-16 text-sm text-foreground-light",children:[(0,i.jsx)("p",{children:"Supabase AI is a chatbot support tool powered by OpenAI. Supabase will share the query you submit and information about the databases you manage through Supabase with OpenAI, L.L.C. and its affiliates in order to provide the Supabase AI tool."}),(0,i.jsx)("p",{children:"OpenAI will only access information about the structure of your databases, such as table names, column and row headings. OpenAI will not access the contents of the database itself."}),(0,i.jsx)("p",{children:"OpenAI uses this information to generate responses to your query, and does not retain or use the information to train its algorithms or otherwise improve its products and services."}),(0,i.jsx)("p",{children:"If you have your own individual account on Supabase, we will use any personal information collected through [Supabase AI] to provide you with the [Supabase AI] tool. If you are in the UK, EEA or Switzerland, the processing of this personal information is necessary for the performance of a contract between you and us."}),(0,i.jsx)("p",{children:"Supabase collects information about the queries you submit through Supabase AI and the responses you receive to assess the performance of the Supabase AI tool and improve our services. If you are in the UK, EEA or Switzerland, the processing is necessary for our legitimate interests, namely informing our product development and improvement."}),(0,i.jsxs)("p",{children:["For more information about how we use personal information, please see our"," ",(0,i.jsx)(X(),{href:"https://supabase.com/privacy",target:"_blank",rel:"noreferrer",className:"text-brand border-b border-brand",children:"privacy policy"}),"."]})]})})]})]})]})})})}}),v&&N&&(0,i.jsx)(tG,{})]})},tY=n(84247),tV=n(80435),tK=n(55579),tX=n(16014),tQ=n(61660),t$=n(26205),tJ=n(47342),t0=n(36660),t1=n(78855),t2=n(40624),t4=n(11881);let t3=e=>{let{title:t}=e;return(0,i.jsx)("img",{className:"border rounded-lg shadow w-48 mt-6 border-body",src:"".concat(b.GW,"/img/integrations/covers/").concat(t,"-cover.png"),alt:"".concat(t," cover")})};var t5=()=>{let e=(0,l.lL)(),t=(0,l.P5)("branchManagement"),{data:n,isLoading:s}=(0,t2.x)(),{data:a}=(0,tQ.q)({organizationId:null==e?void 0:e.id}),{mutate:o}=(0,tX.n)({onSuccess:()=>{u.ZP.success("Successfully deleted Github connection")}}),c=(0,t$.x5)(),m=(0,d.useCallback)(()=>{c.setGithubConnectionsOpen(!0)},[c]),h=(0,d.useCallback)(async t=>{if(!(null==e?void 0:e.id))throw Error("Organization not found");o({connectionId:t.id,organizationId:e.id})},[o,null==e?void 0:e.id]),p=n?"You are authorized with Supabase GitHub App. You can configure your GitHub App installations and repository access [here](".concat(t4.Xw,"). You can revoke your authorization [here](").concat(t4.H4,")."):"";return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(()=>(0,i.jsx)(r._S,{children:(0,i.jsxs)(r.jX,{children:[(0,i.jsxs)(r.g$,{title:"GitHub Connections",children:[(0,i.jsx)(tV.U,{content:"\nConnect any of your GitHub repositories to a project.\n"}),(0,i.jsx)(t3,{title:"github"})]}),(0,i.jsxs)(r.Lc,{children:[(0,i.jsx)(tV.U,{content:"\n\n### How will GitHub connections work?\n\nYou will be able to connect a GitHub repository to a Supabase project.\nThe GitHub app will watch for changes in your repository such as file changes, branch changes as well as pull request activity.\n"}),(0,i.jsx)("ul",{className:"flex flex-col gap-y-2",children:null==a?void 0:a.map(e=>{var t,n,s,a,r;return(0,i.jsx)(tJ.z,{connection:{id:String(e.id),added_by:{id:String(null===(t=e.user)||void 0===t?void 0:t.id),primary_email:null!==(a=null===(n=e.user)||void 0===n?void 0:n.primary_email)&&void 0!==a?a:"",username:null!==(r=null===(s=e.user)||void 0===s?void 0:s.username)&&void 0!==r?r:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name}},type:"GitHub",onDeleteConnection:h},e.id)})}),t?(0,i.jsx)(tY.FP,{onClick:m,orgSlug:null==e?void 0:e.slug,showNode:!1,children:"Add new project connection"}):(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["Access to"," ",(0,i.jsx)("a",{href:"https://supabase.com/docs/guides/platform/branching",target:"_blank",rel:"noreferrer",className:"text-foreground",children:"branching"})," ","is required to add GitHub connections."]}),p&&(0,i.jsx)(tV.U,{content:p,className:"text-foreground-lighter"})]})]})}),{}),(0,i.jsx)(r.I7,{}),(0,i.jsx)(tK.Z,{isProjectScoped:!1}),(0,i.jsx)(t1.Z,{}),(0,i.jsx)(t0.Z,{})]})},t8=n(49639),t6=n(23418),t9=n(52253);(s=a||(a={})).DRAFT="draft",s.PAID="paid",s.VOID="void",s.UNCOLLECTIBLE="uncollectible",s.OPEN="open";let t7={[a.DRAFT]:{label:"Upcoming",badgeVariant:"warning"},[a.PAID]:{label:"Paid",badgeVariant:"brand"},[a.VOID]:{label:"Forgiven",badgeVariant:"brand"},[a.UNCOLLECTIBLE]:{label:"Outstanding",badgeVariant:"destructive"},[a.OPEN]:{label:"Outstanding",badgeVariant:"destructive"}};var ne=e=>{let{status:t}=e,n=t7[t];return(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{children:(0,i.jsx)(eT.C,{size:"small",className:"capitalize",variant:(null==n?void 0:n.badgeVariant)||"default",children:(null==n?void 0:n.label)||t})}),(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-[300px] space-y-2 border border-background",children:[[a.OPEN,a.UNCOLLECTIBLE].includes(t)&&(0,i.jsx)("p",{className:"text-xs text-foreground",children:'We were not able to collect the money. Make sure you have a valid payment method and enough funds. Outstanding invoices may cause restrictions. You can manually pay the using the "Pay Now" button.'}),t===a.DRAFT&&(0,i.jsx)("p",{className:"text-xs text-foreground",children:"The invoice will soon be finalized and charged for."}),t===a.PAID&&(0,i.jsx)("p",{className:"text-xs text-foreground",children:"The invoice has been paid successfully. No action is required on your side."}),t===a.VOID&&(0,i.jsx)("p",{className:"text-xs text-foreground",children:"This invoice has been forgiven. No action is required on your side."})]})]})})]})};async function nt(e,t){let{invoiceId:n,slug:s}=e;if(!n)throw Error("Invoice ID is required");if(!s)throw Error("Slug is required");let{data:a,error:i}=await (0,R.U2)("/platform/organizations/{slug}/billing/invoices/{invoiceId}",{params:{path:{invoiceId:n,slug:s}},signal:t});return i&&(0,R.S3)(i),a}async function nn(e,t){let{slug:n}=e;if(!n)throw Error("Slug is required");let s=await (0,R.YM)("/platform/organizations/{slug}/billing/invoices",{params:{path:{slug:n}},signal:t,parseAs:"text"});if(s.error)throw s.error;return Number(s.response.headers.get("X-Total-Count"))}let ns=function(e){let{slug:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(L.Y.count(t),e=>{let{signal:n}=e;return nn({slug:t},n)},{enabled:n&&void 0!==t,...s})};async function na(e,t){let{slug:n,offset:s=0,limit:a=10}=e;if(!n)throw Error("Org slug is required");let{data:i,error:r}=await (0,R.U2)("/platform/organizations/{slug}/billing/invoices",{params:{path:{slug:n},query:{offset:s.toString(),limit:a.toString()}},signal:t});return r&&(0,R.S3)(r),i}let ni=function(e){let{slug:t,offset:n,limit:s}=e,{enabled:a=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(L.Y.list(t,n),e=>{let{signal:a}=e;return na({slug:t,offset:n,limit:s},a)},{enabled:a&&void 0!==t,...i})};var nr=()=>{let[e,t]=(0,d.useState)(1),n=(0,l.lL)(),{slug:s}=null!=n?n:{},c=(e-1)*10,m=(0,l.Xo)(o.KA.READ,"invoices"),{data:h,isError:p}=ns({slug:s}),{data:f,error:v,isLoading:y,isError:b,isSuccess:N}=ni({slug:s,offset:c,limit:10}),w=f||[];(0,d.useEffect)(()=>{t(1)},[s]);let _=async e=>{try{let t=await nt({invoiceId:e,slug:s});(null==t?void 0:t.invoice_pdf)&&window.open(t.invoice_pdf,"_blank")}catch(e){u.ZP.error("Failed to fetch the selected invoice: ".concat(e.message))}};return m?(0,i.jsxs)(r.gW,{children:[y&&(0,i.jsx)(j.A,{}),b&&(0,i.jsx)(x.Z,{error:v,subject:"Failed to retrieve invoices"}),N&&(0,i.jsx)(ef.Z,{head:[(0,i.jsx)(ef.Z.th,{},"header-icon"),(0,i.jsx)(ef.Z.th,{children:"Date"},"header-date"),(0,i.jsx)(ef.Z.th,{children:"Amount due"},"header-amount"),(0,i.jsx)(ef.Z.th,{children:"Invoice number"},"header-invoice"),(0,i.jsx)(ef.Z.th,{className:"flex items-center",children:"Status"},"header-status"),(0,i.jsx)(ef.Z.th,{className:"text-right"},"header-download")],body:0===w.length?(0,i.jsx)(ef.Z.tr,{children:(0,i.jsx)(ef.Z.td,{colSpan:6,className:"p-3 py-12 text-center",children:(0,i.jsx)("p",{className:"text-foreground-light",children:y?"Checking for invoices":"No invoices for this organization yet"})})}):(0,i.jsxs)(i.Fragment,{children:[w.map(e=>(0,i.jsxs)(ef.Z.tr,{children:[(0,i.jsx)(ef.Z.td,{children:(0,i.jsx)(t8.Z,{size:"xxl"})}),(0,i.jsx)(ef.Z.td,{children:(0,i.jsx)("p",{children:new Date(1e3*e.period_end).toLocaleString()})}),(0,i.jsx)(ef.Z.td,{children:(0,i.jsx)("p",{children:(0,Q.xG)(e.subtotal/100)})}),(0,i.jsx)(ef.Z.td,{children:(0,i.jsx)("p",{children:e.number})}),(0,i.jsx)(ef.Z.td,{children:(0,i.jsx)(ne,{status:e.status})}),(0,i.jsx)(ef.Z.td,{className:"align-right",children:(0,i.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[[a.UNCOLLECTIBLE,a.OPEN].includes(e.status)&&(0,i.jsx)(F.z,{asChild:!0,children:(0,i.jsx)(X(),{href:"https://redirect.revops.supabase.com/pay-invoice/".concat(e.id),target:"_blank",rel:"noreferrer",children:"Pay Now"})}),(0,i.jsx)(F.z,{type:"outline",icon:(0,i.jsx)(t6.Z,{size:16,strokeWidth:1.5}),onClick:()=>_(e.id)})]})})]},e.id)),(0,i.jsx)(ef.Z.tr,{children:(0,i.jsx)(ef.Z.td,{colSpan:6,children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("p",{className:"text-sm opacity-50",children:p?"Failed to retrieve total number of invoices":"Showing ".concat(c+1," to ").concat(c+w.length," out of ").concat(h," invoices")}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(F.z,{icon:(0,i.jsx)(t9.Z,{}),type:"default",size:"tiny",disabled:1===e,onClick:async()=>t(e-1)}),(0,i.jsx)(F.z,{icon:(0,i.jsx)(M.Z,{}),type:"default",size:"tiny",disabled:10*e>=(null!=h?h:0),onClick:async()=>t(e+1)})]})]})})},"navigation")]})})]}):(0,i.jsx)(g.Z,{resourceText:"view invoices"})},nl=n(66432),no=n(66855),nc=e=>{let{visible:t,onHide:n}=e;return(0,i.jsx)(eM.C,{hideFooter:!0,visible:t,size:"xlarge",header:"Spend cap",onCancel:()=>n(),children:(0,i.jsxs)("div",{className:"py-4 space-y-4",children:[(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("p",{className:"text-sm",children:"Enabling the spend cap sets a limit on your usage to stay within your plan's quota, which controls costs but can limit service. Disabling the spend cap removes these limits, but any extra usage beyond the plan's limit will be charged per usage."}),(0,i.jsx)("p",{className:"text-sm",children:"Take a look at the following table to see which resources are chargeable and how they are charged:"}),(0,i.jsxs)("div",{className:"border rounded border-control bg-overlay-hover",children:[(0,i.jsxs)("div",{className:"flex items-center px-4 pt-2 pb-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm text-foreground-light",children:"Item"}),(0,i.jsx)("p",{className:"w-[25%] text-sm text-foreground-light",children:"Limit"}),(0,i.jsx)("p",{className:"w-[25%] text-sm text-foreground-light",children:"Rate"})]}),(0,i.jsxs)("div",{className:"py-2",children:[(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Database size"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"8GB"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$0.125 per GB"})]}),(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Egress"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"250GB"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$0.09 per GB"})]})]}),(0,i.jsxs)("div",{className:"py-2",children:[(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsxs)("div",{className:"flex w-[50%] items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-sm",children:"Auth MAUs"}),(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{children:(0,i.jsx)(no.Z,{size:16,strokeWidth:1.5,className:"transition opacity-50 cursor-pointer hover:opacity-100"})}),(0,i.jsx)(B.h_,{children:(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"Monthly Active Users: A user that has made an API request in the last month"})})]})})})]})]}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"100,000"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$0.00325 per user"})]}),(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsxs)("div",{className:"flex w-[50%] items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-sm",children:"Single Sign-On (SAML 2.0) MAUs"}),(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{children:(0,i.jsx)(no.Z,{size:16,strokeWidth:1.5,className:"transition opacity-50 cursor-pointer hover:opacity-100"})}),(0,i.jsx)(B.h_,{children:(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"Single Sign-On Monthly Active Users: A user that has made an API request in the last month"})})]})})})]})]}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"50"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$0.015 per user"})]})]}),(0,i.jsxs)("div",{className:"py-2",children:[(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Storage size"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"100GB"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$0.021 per GB"})]}),(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Storage Image Transformations"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"100 origin images"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$5 per 1000 origin images"})]})]}),(0,i.jsxs)("div",{className:"py-2",children:[(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Realtime concurrent peak connections"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"500"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$10 per 1000"})]}),(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Realtime messages"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"5 Million"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$2.50 per Million"})]})]}),(0,i.jsxs)("div",{className:"py-2",children:[(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Function invocations"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"2 Million"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$2 per Million"})]}),(0,i.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,i.jsx)("p",{className:"w-[50%] text-sm",children:"Function count"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"100 functions"}),(0,i.jsx)("p",{className:"w-[25%] text-sm",children:"$10 per 100 functions"})]})]})]}),(0,i.jsxs)("p",{className:"text-sm",children:["See"," ",(0,i.jsx)(X(),{href:"https://supabase.com/pricing",className:"text-brand",target:"_blank",rel:"noreferrer",children:(0,i.jsx)("span",{children:"pricing page"})})," ","for a full overview."]})]})}),(0,i.jsx)(eM.C.Separator,{}),(0,i.jsx)(eM.C.Content,{children:(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)(F.z,{block:!0,type:"primary",onClick:()=>n(),children:"Understood"})})})]})})},nd=n(78388),nu=n(62795);let nm={PERSONAL:"Personal",EDUCATIONAL:"Educational",STARTUP:"Startup",AGENCY:"Agency",COMPANY:"Company",UNDISCLOSED:"N/A"},nh={1:"1 - 10",10:"10 - 49",50:"50 - 99",100:"100 - 299",300:"More than 300"};var np=e=>{let{onPaymentMethodReset:t}=e,n=(0,ex.useRouter)(),s=(0,nl.useStripe)(),a=(0,nl.useElements)(),r=(0,C.NL)(),{plan:l,name:o,kind:m,size:x,spend_cap:f}=(0,c.UO)(),[g,j]=(0,d.useState)(o||""),[v,y]=(0,d.useState)(m&&Object.keys(nm).includes(m)?m:"PERSONAL"),[N,w]=(0,d.useState)(x||"1"),[_,S]=(0,d.useState)(!1),[k,E]=(0,d.useState)(),[A,T]=(0,d.useState)(l&&["free","team","pro"].includes(l)?l.toUpperCase():"FREE"),[I,Z]=(0,d.useState)(!1),[z,P]=(0,d.useState)(!f||!!f);(0,d.useEffect)(()=>{let e={};e.plan=A.toLowerCase(),g&&(e.name=g),v&&(e.kind=v),N&&(e.size=N),z&&(e.spend_cap=z.toString()),n.push({query:e})},[A,g,v,N,z]);let{mutate:R}=(0,nd.T)({onSuccess:async e=>{await (0,ea.aL)(r),n.push("/new/".concat(e.slug))},onError:()=>{D(),S(!1)}});async function L(e){R({name:g,kind:v,tier:"tier_"+("PRO"!==A||z?A:"PAYG").toLowerCase(),..."COMPANY"==v?{size:N}:{},payment_method:e})}let O=async e=>{var t;if(e.preventDefault(),!((g?g.trim():"").length>=1))return u.ZP.error("Organization name is empty");if(!s||!a)return console.error("Stripe.js has not loaded");if(S(!0),"FREE"===A)await L();else if(k)L(k.id);else{let{error:e,setupIntent:n}=await s.confirmSetup({elements:a,redirect:"if_required",confirmParams:{return_url:"".concat((0,Q.Ax)(),"/new"),expand:["payment_method"]}});if(e||!n.payment_method){u.ZP.error(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:" Failed to save card details"),S(!1);return}let i=n.payment_method;E(i),L(i.id)}},D=()=>(E(void 0),t());return(0,i.jsx)("form",{onSubmit:O,children:(0,i.jsxs)(tU.Z,{title:(0,i.jsx)("div",{children:(0,i.jsx)("h4",{children:"Create a new organization"})},"panel-title"),footer:(0,i.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,i.jsx)(F.z,{type:"default",disabled:_,onClick:()=>n.push("/projects"),children:"Cancel"}),(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("p",{className:"text-xs text-foreground-lighter",children:"You can rename your organization later"}),(0,i.jsx)(F.z,{htmlType:"submit",type:"primary",loading:_,disabled:_,children:"Create organization"})]})]},"panel-footer"),children:[(0,i.jsxs)(tU.Z.Content,{children:[(0,i.jsx)("p",{className:"text-sm",children:"This is your organization within Supabase."}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"For example, you can use the name of your company or department."})]}),(0,i.jsx)(tU.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,i.jsx)(h.Z,{autoFocus:!0,label:"Name",type:"text",layout:"horizontal",placeholder:"Organization name",descriptionText:"What's the name of your company or team?",value:g,onChange:function(e){j(e.target.value)}})}),(0,i.jsx)(tU.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,i.jsx)(p.Z,{label:"Type of organization",layout:"horizontal",value:v,onChange:function(e){y(e)},descriptionText:"What would best describe your organization?",children:Object.entries(nm).map(e=>{let[t,n]=e;return(0,i.jsx)(p.Z.Option,{label:n,value:t,children:n},t)})})}),"COMPANY"==v?(0,i.jsx)(tU.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,i.jsx)(p.Z,{label:"Company size",layout:"horizontal",value:N,onChange:function(e){w(e)},descriptionText:"How many people are in your company?",children:Object.entries(nh).map(e=>{let[t,n]=e;return(0,i.jsx)(p.Z.Option,{label:n,value:t,children:n},t)})})}):(0,i.jsx)(i.Fragment,{}),(0,i.jsx)(tU.Z.Content,{children:(0,i.jsx)(p.Z,{label:"Pricing Plan",layout:"horizontal",value:A,onChange:function(e){T(e)},descriptionText:(0,i.jsxs)(i.Fragment,{children:["Select a plan that suits your needs.\xa0",(0,i.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:"https://supabase.com/pricing",children:"More details"})]}),children:Object.entries(b.f6).map(e=>{let[t,n]=e;return(0,i.jsx)(p.Z.Option,{label:n,value:t,children:n},t)})})}),"PRO"===A&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tU.Z.Content,{className:"border-b border-panel-border-interior-light dark:border-panel-border-interior-dark",children:(0,i.jsx)(tF.Z,{id:"spend-cap",layout:"horizontal",label:(0,i.jsxs)("div",{className:"flex space-x-4",children:[(0,i.jsx)("span",{children:"Spend Cap"}),(0,i.jsx)(no.Z,{size:16,strokeWidth:1.5,className:"transition opacity-50 cursor-pointer hover:opacity-100",onClick:()=>Z(!0)})]}),checked:z,onChange:()=>P(!z),descriptionText:(0,i.jsx)("div",{children:(0,i.jsx)("p",{children:"By default, Pro plan organizations have a spend cap to control costs. When enabled, usage is limited to the plan's quota, with restrictions when limits are exceeded. To scale beyond Pro limits without restrictions, disable the spend cap and pay for over-usage beyond the quota."})})})}),(0,i.jsx)(nc,{visible:I,onHide:()=>Z(!1)})]}),"FREE"!==A&&(0,i.jsx)(tU.Z.Content,{children:(null==k?void 0:k.card)!==void 0?(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,i.jsx)("img",{alt:"Card",src:"".concat(b.GW,"/img/payment-methods/").concat(k.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,i.jsx)(h.Z,{readOnly:!0,className:"w-64",size:"small",value:"   ".concat(k.card.last4)}),(0,i.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",k.card.exp_month,"/",k.card.exp_year]})]}),(0,i.jsx)("div",{children:(0,i.jsx)(F.z,{type:"outline",icon:(0,i.jsx)(nu.Z,{}),onClick:()=>D(),disabled:_,className:"hover:border-muted"})})]},k.id):(0,i.jsx)(nl.PaymentElement,{})})]})})},nx=n(48472),nf=n(58995),ng=e=>{let{title:t,description:n}=e;return(0,i.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-14",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-xl",children:t}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:n})]})})},nj=n(97072),nv=n(78804),ny=n(20758),nb=e=>{let{section:t,includedInPlan:n,children:s}=e,{name:a,description:l,links:o}=t;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r._S,{children:(0,i.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-16",children:(0,i.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,i.jsx)("div",{className:"col-span-12 lg:col-span-5",children:(0,i.jsxs)("div",{className:"sticky top-32 space-y-6",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-base capitalize",children:a}),!1===n&&(0,i.jsx)(eT.C,{children:"Not included"})]}),(0,i.jsx)("div",{className:"grid gap-4",children:l.split("\n").map((e,t)=>(0,i.jsx)("p",{className:"text-sm text-foreground-light pr-8",children:e},"desc-".concat(t)))})]}),o&&o.length>0&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground mb-2",children:"More information"}),o.map(e=>(0,i.jsx)("div",{children:(0,i.jsx)(X(),{href:e.url,target:"_blank",rel:"noreferrer",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,i.jsx)("p",{className:"text-sm",children:e.name}),(0,i.jsx)(eo.Z,{size:16,strokeWidth:1.5})]})})},e.url))]})]})}),(0,i.jsx)("div",{className:"col-span-12 lg:col-span-7 space-y-6",children:s})]})})}),(0,i.jsx)(r.I7,{})]})};let nN=(e,t)=>{var n;return t?(null==t?void 0:null===(n=t.plan)||void 0===n?void 0:n.id)==="pro"&&(null==t?void 0:t.usage_billing_enabled)===!1?"/org/".concat(e,"/billing#cost-control"):"/org/".concat(e,"/billing?panel=subscriptionPlan"):"/org/".concat(e,"/billing")},nw=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}),n_=(e,t)=>{if("string"==typeof e)return e;if("bytes"!==t)return nw.format(e);{let t=nk(e).replace(/\s/g,"");return"0bytes"===t?"0":t}},nC=(e,t)=>{if("string"==typeof e)return e;if("bytes"!==t)return nw.format(e);{let t=nE(e).replace(/\s/g,"");return"0bytes"===t?"0":t}},nS=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],nk=e=>{if(0===e||void 0===e)return"0 bytes";let t=Math.floor(Math.log(e)/Math.log(1024)),n=nS[t],s=2;return["bytes","KB","MB"].includes(n)?s=0:["GB"].includes(n)&&(s=1),parseFloat((e/Math.pow(1024,t)).toFixed(s))+" "+n},nE=e=>{if(0===e||void 0===e)return"0 bytes";let t=Math.floor(Math.log(e)/Math.log(1024)),n=nS[t];return parseFloat((e/Math.pow(1024,t)).toFixed(3))+" "+n};var nA=n(52683),nT=e=>{var t,n,s,a,r,l,o,c,u,m,h,p,f;let{slug:g,projectRef:v,attribute:y,usage:N,usageMeta:w,chartMeta:_,subscription:C,error:S,isLoading:k,isError:E,isSuccess:A,currentBillingCycleSelected:T}=e,I=nN(null!=g?g:"",C),Z=(null!==(s=null==w?void 0:w.usage)&&void 0!==s?s:0)/(null!==(a=null==w?void 0:w.pricing_free_units)&&void 0!==a?a:0),z=(null!==(r=null==w?void 0:w.usage)&&void 0!==r?r:0)-(null!==(l=null==w?void 0:w.pricing_free_units)&&void 0!==l?l:0),R=null==C?void 0:C.usage_billing_enabled,L=R?"text-amber-900":"text-red-900",O=(0,d.useMemo)(()=>{var e,t;return null!==(t=null===(e=_[y.key])||void 0===e?void 0:e.data)&&void 0!==t?t:[]},[y.key,_]),D=void 0===v&&T&&!1===R&&Z>=b.wc,U=(0,d.useMemo)(()=>{var e,t;return null!==(t=null===(e=y.attributes)||void 0===e?void 0:e.map(e=>O.some(t=>0!==Number(t[e.key]))).some(e=>!!e))&&void 0!==t&&t},[y.attributes,O]);return(0,i.jsx)("div",{id:y.anchor,className:"scroll-my-12",children:(0,i.jsxs)(nb,{section:y,children:[k&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),E&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve usage data",error:S}),A&&(0,i.jsx)(i.Fragment,{children:(null==w?void 0:w.available_in_plan)?(0,i.jsxs)(i.Fragment,{children:[!v&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsxs)("p",{className:"text-sm",children:[y.name," usage"]}),D&&(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{asChild:!0,children:Z>=1?(0,i.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,i.jsx)(nv.Z,{size:14,strokeWidth:2,className:L}),(0,i.jsx)("p",{className:"text-sm ".concat(L),children:"Exceeded limit"})]}):Z>=b.wc&&(0,i.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,i.jsx)(nv.Z,{size:14,strokeWidth:2,className:"text-amber-900"}),(0,i.jsx)("p",{className:"text-sm text-amber-900",children:"Approaching limit"})]})}),(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:[(0,i.jsx)("p",{className:"text-xs text-foreground",children:"Exceeding your plans included usage will lead to restrictions to your project."}),(0,i.jsx)("p",{className:"text-xs text-foreground",children:"Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})]})]})})]})]})}),T&&!w.unlimited&&(0,i.jsx)(eY.Z,{type:"horizontal",barClass:(0,P.default)(Z>=1?R?"bg-foreground-light":"bg-red-900":!1===R&&Z>=b.wc?"bg-amber-900":"bg-foreground-light"),bgClass:"bg-surface-300",value:null!==(o=null==w?void 0:w.usage)&&void 0!==o?o:0,max:(null==w?void 0:w.pricing_free_units)||1}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between border-b py-1",children:[(0,i.jsxs)("p",{className:"text-xs text-foreground-light",children:["Included in ",null==C?void 0:null===(t=C.plan)||void 0===t?void 0:t.name.toLowerCase()," plan"]}),w.unlimited?(0,i.jsx)("p",{className:"text-xs",children:"Unlimited"}):(0,i.jsx)("p",{className:"text-xs",children:"bytes"===y.unit?"".concat(null!==(c=w.pricing_free_units)&&void 0!==c?c:0," GB"):(null!==(u=w.pricing_free_units)&&void 0!==u?u:0).toLocaleString()})]}),T&&(0,i.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,i.jsxs)("p",{className:"text-xs text-foreground-light",children:[y.chartPrefix||"Used "," in period"]}),(0,i.jsx)("p",{className:"text-xs",children:"bytes"===y.unit?"".concat((null!==(m=null==w?void 0:w.usage)&&void 0!==m?m:0).toFixed(2)," GB"):(null!==(h=null==w?void 0:w.usage)&&void 0!==h?h:0).toLocaleString()})]}),T&&(null!==(p=null==w?void 0:w.pricing_free_units)&&void 0!==p?p:0)>0&&(0,i.jsxs)("div",{className:"flex items-center justify-between border-t py-1",children:[(0,i.jsx)("p",{className:"text-xs text-foreground-light",children:"Overage in period"}),(0,i.jsx)("p",{className:"text-xs",children:(null!==(f=null==w?void 0:w.pricing_free_units)&&void 0!==f?f:0)===-1||z<0?"0".concat("bytes"===y.unit?" GB":""):"bytes"===y.unit?"".concat(z.toFixed(2)," GB"):z.toLocaleString()})]})]})]}),null===(n=y.additionalInfo)||void 0===n?void 0:n.call(y,C,N),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsxs)("p",{className:"text-sm",children:[y.chartPrefix||""," ",y.name," ",y.chartSuffix||"per day"]}),y.chartDescription.split("\n").map((e,t)=>(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:e},"para-".concat(t)))]}),_[y.key].isLoading?(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}):O.length>0&&U?(0,i.jsx)(nA.Z,{name:"".concat(y.chartPrefix||"").concat(y.name),unit:y.unit,attributes:y.attributes,data:O,yLeftMargin:_[y.key].margin,yFormatter:e=>n_(e,y.unit),tooltipFormatter:e=>nC(e,y.unit)}):(0,i.jsx)(tU.Z,{children:(0,i.jsx)(tU.Z.Content,{children:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,i.jsx)(ny.Z,{className:"text-foreground-light mb-2"}),(0,i.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to 24 hours to show"})]})})})]}):(0,i.jsx)(tU.Z,{children:(0,i.jsx)(tU.Z.Content,{children:(0,i.jsxs)("div",{className:"flex w-full items-center flex-col justify-center space-y-2 md:flex-row md:justify-between",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("p",{className:"text-sm",children:"Not included in plan"}),(0,i.jsx)("div",{children:(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"You need to be on a higher plan in order to use this feature."})})]}),(0,i.jsx)(F.z,{type:"primary",asChild:!0,children:(0,i.jsx)(X(),{href:I,children:"Upgrade plan"})})]})})})})]})})},nI=e=>{let{orgSlug:t,projectRef:n,categoryKey:s,chartMeta:a,subscription:l,currentBillingCycleSelected:o}=e,{data:c,error:d,isLoading:u,isError:m,isSuccess:h}=(0,eK.v)({orgSlug:t}),p=nj.ty.find(e=>e.key===s);return p?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r._S,{children:(0,i.jsx)(ng,{title:p.name,description:p.description})}),(0,i.jsx)(r.I7,{}),p.attributes.map(e=>(0,i.jsx)(nT,{slug:t,projectRef:n,attribute:e,usage:c,usageMeta:null==c?void 0:c.usages.find(t=>t.metric===e.key),chartMeta:a,subscription:l,error:d,isLoading:u,isError:m,isSuccess:h,currentBillingCycleSelected:o},e.name))]}):null},nZ=e=>{var t,n,s,a,r,l;let{orgSlug:o,projectRef:c,subscription:d,startDate:u,endDate:m,currentBillingCycleSelected:h}=e,{data:p,isLoading:x}=(0,W.L6)({orgSlug:o,projectRef:c,metric:W.tk.MONTHLY_ACTIVE_USERS,interval:"1d",startDate:u,endDate:m}),{data:f,isLoading:g}=(0,W.L6)({orgSlug:o,projectRef:c,metric:W.tk.MONTHLY_ACTIVE_SSO_USERS,interval:"1d",startDate:u,endDate:m}),{data:j,isLoading:v}=(0,W.L6)({orgSlug:o,projectRef:c,metric:W.tk.STORAGE_IMAGES_TRANSFORMED,interval:"1d",startDate:u,endDate:m}),{data:y,isLoading:b}=(0,W.L6)({orgSlug:o,projectRef:c,metric:W.tk.FUNCTION_INVOCATIONS,interval:"1d",startDate:u,endDate:m}),{data:N,isLoading:w}=(0,W.L6)({orgSlug:o,projectRef:c,metric:W.tk.REALTIME_MESSAGE_COUNT,interval:"1d",startDate:u,endDate:m}),{data:_,isLoading:C}=(0,W.L6)({orgSlug:o,projectRef:c,metric:W.tk.REALTIME_PEAK_CONNECTIONS,interval:"1d",startDate:u,endDate:m}),S={[W.tk.MONTHLY_ACTIVE_USERS]:{data:null!==(t=null==p?void 0:p.data)&&void 0!==t?t:[],margin:18,isLoading:x},[W.tk.MONTHLY_ACTIVE_SSO_USERS]:{data:null!==(n=null==f?void 0:f.data)&&void 0!==n?n:[],margin:20,isLoading:g},[W.tk.STORAGE_IMAGES_TRANSFORMED]:{data:null!==(s=null==j?void 0:j.data)&&void 0!==s?s:[],margin:0,isLoading:v},[W.tk.FUNCTION_INVOCATIONS]:{data:null!==(a=null==y?void 0:y.data)&&void 0!==a?a:[],margin:26,isLoading:b},[W.tk.REALTIME_MESSAGE_COUNT]:{data:null!==(r=null==N?void 0:N.data)&&void 0!==r?r:[],margin:38,isLoading:w},[W.tk.REALTIME_PEAK_CONNECTIONS]:{data:null!==(l=null==_?void 0:_.data)&&void 0!==l?l:[],margin:0,isLoading:C}};return(0,i.jsx)(nI,{orgSlug:o,projectRef:c,categoryKey:"activity",chartMeta:S,subscription:d,currentBillingCycleSelected:h})},nz=e=>{var t;let{orgSlug:n,projectRef:s,subscription:a,startDate:r,endDate:l,currentBillingCycleSelected:o}=e,{data:c,isLoading:d}=(0,W.L6)({orgSlug:n,projectRef:s,metric:W.tk.EGRESS,interval:"1d",startDate:r,endDate:l}),u={[W.tk.EGRESS]:{data:null!==(t=null==c?void 0:c.data)&&void 0!==t?t:[],margin:16,isLoading:d}};return(0,i.jsx)(nI,{orgSlug:n,projectRef:s,categoryKey:"bandwidth",chartMeta:u,subscription:a,currentBillingCycleSelected:o})},nP=n(64883);async function nR(e,t){let{orgSlug:n,startDate:s,endDate:a,projectRef:i}=e;if(!n)throw Error("Org slug is required");if(!s)throw Error("Start date is required");if(!a)throw Error("End date is required");"/platform/organizations/{slug}/daily-stats/compute?&startDate=".concat(encodeURIComponent(s),"&endDate=").concat(encodeURIComponent(a));let{data:r,error:l}=await (0,R.U2)("/platform/organizations/{slug}/daily-stats/compute",{params:{path:{slug:n},query:{projectRef:i,startDate:s,endDate:a}},signal:t});return l&&(0,R.S3)(l),r}let nL=function(e){let{orgSlug:t,startDate:n,endDate:s,projectRef:a,dateFormat:i="DD MMM"}=e,{enabled:r=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(nP.d.orgDailyComputeStats(t,{startDate:n,endDate:s,projectRef:a}),e=>{let{signal:i}=e;return nR({orgSlug:t,startDate:n,endDate:s,projectRef:a},i)},{enabled:r&&void 0!==t&&void 0!==n&&void 0!==s,select:e=>({...e,data:e.data.map(e=>({...e,periodStartFormatted:Z()(e.period_start).format(i)}))}),staleTime:36e5,...l})};var nO=e=>{var t;let{orgSlug:n,projectRef:s,startDate:a,endDate:r}=e,l=Object.values(W.Hz).map(e=>e.toLowerCase()),{data:o,isLoading:c,error:u,isSuccess:m}=nL({orgSlug:n,projectRef:s,startDate:a,endDate:r}),h=null!==(t=null==o?void 0:o.data)&&void 0!==t?t:[],p={[W.Hz.COMPUTE_HOURS_BRANCH]:"blue",[W.Hz.COMPUTE_HOURS_XS]:"white",[W.Hz.COMPUTE_HOURS_SM]:"green",[W.Hz.COMPUTE_HOURS_MD]:"dark-green",[W.Hz.COMPUTE_HOURS_L]:"yellow",[W.Hz.COMPUTE_HOURS_XL]:"dark-yellow",[W.Hz.COMPUTE_HOURS_2XL]:"orange",[W.Hz.COMPUTE_HOURS_4XL]:"dark-orange",[W.Hz.COMPUTE_HOURS_8XL]:"red",[W.Hz.COMPUTE_HOURS_12XL]:"dark-red",[W.Hz.COMPUTE_HOURS_16XL]:"purple"},f=Object.keys(W.Hz).map(e=>({key:e.toLowerCase(),color:p[e]||"white",name:(0,W.p5)(e)})),g=(0,d.useMemo)(()=>l.filter(e=>h.some(t=>t[e])),[h]),v=(0,d.useMemo)(()=>g.length>0,[g]);return(0,i.jsx)("div",{id:"compute",className:"scroll-my-12",children:(0,i.jsxs)(nb,{section:{name:"Compute Hours",description:"Amount of hours your projects were active. Each project is a dedicated server and database.\nPaid plans come with $10 in Compute Credits to cover one project running on Micro Compute or parts of any compute add-on.\nBilling is based on the sum of Compute Hours used. Paused projects do not count towards usage.",links:[{name:"Compute Add-ons",url:"https://supabase.com/docs/guides/platform/compute-add-ons"},{name:"Usage-billing for Compute",url:"https://supabase.com/docs/guides/platform/org-based-billing#usage-based-billing-for-compute"}]},children:[c&&(0,i.jsx)(j.A,{}),null!=u&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve usage data",error:u}),m&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"space-y-1",children:[h.length>0&&(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsx)("div",{className:"flex items-center space-x-4",children:(0,i.jsx)("p",{className:"text-sm",children:"Compute Hours usage"})})}),g.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between border-b last:border-b-0 py-1 last:py-0",children:[(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:[(0,i.jsx)("span",{className:"font-medium",children:(0,W.p5)(e.toUpperCase())})," ","Compute Hours usage in period"]}),(0,i.jsxs)("p",{className:"text-sm",children:[h.reduce((t,n)=>{var s;return t+(null!==(s=n[e])&&void 0!==s?s:0)},0)," hours"]})]},e))]}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("p",{className:"text-sm",children:"Compute Hours usage per day"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"The data refreshes every hour."})]}),c?(0,i.jsx)(j.A,{}):h.length>0&&v?(0,i.jsx)(nA.Z,{name:"Compute Hours usage",unit:"hours",attributes:f,data:h,yMin:24}):(0,i.jsx)(tU.Z,{children:(0,i.jsx)(tU.Z.Content,{children:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,i.jsx)(ny.Z,{className:"text-foreground-light mb-2"}),(0,i.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to one hour to show"})]})})})]})]})})},nD=e=>{var t,n,s;let{orgSlug:a,projectRef:r,startDate:l,endDate:o,subscription:c,currentBillingCycleSelected:d}=e,{data:u,isLoading:m}=(0,W.L6)({orgSlug:a,projectRef:r,metric:W.tk.DATABASE_SIZE,interval:"1d",startDate:l,endDate:o}),{data:h,isLoading:p}=(0,W.L6)({orgSlug:a,projectRef:r,metric:W.tk.STORAGE_SIZE,interval:"1d",startDate:l,endDate:o}),{data:x,isLoading:f}=(0,W.L6)({orgSlug:a,projectRef:r,metric:W.tk.FUNCTION_COUNT,interval:"1d",startDate:l,endDate:o}),g={[W.tk.DATABASE_SIZE]:{isLoading:m,margin:14,data:null!==(t=null==u?void 0:u.data)&&void 0!==t?t:[]},[W.tk.STORAGE_SIZE]:{isLoading:p,margin:14,data:null!==(n=null==h?void 0:h.data)&&void 0!==n?n:[]},[W.tk.FUNCTION_COUNT]:{isLoading:f,margin:0,data:null!==(s=null==x?void 0:x.data)&&void 0!==s?s:[]}};return(0,i.jsx)(nI,{orgSlug:a,projectRef:r,categoryKey:"sizeCount",chartMeta:g,subscription:c,currentBillingCycleSelected:d})},nF=n(44145),nU=function(e){return(0,i.jsx)(eP.Z,{icon:nF.Z,...e})};let nM=[{key:W.tk.DATABASE_SIZE,name:"Database Size",units:"bytes",anchor:"dbSize",category:"Database",unitName:"GB"},{key:W.tk.EGRESS,name:"Egress",units:"bytes",anchor:"egress",category:"Database",unitName:"GB"},{key:W.tk.MONTHLY_ACTIVE_USERS,name:"Monthly Active Users",units:"absolute",anchor:"mau",category:"Authentication",unitName:"MAU"},{key:W.tk.MONTHLY_ACTIVE_SSO_USERS,name:"Monthly Active SSO Users",units:"absolute",anchor:"mauSso",category:"Authentication",unitName:"MAU"},{key:W.tk.STORAGE_SIZE,name:"Storage Size",units:"bytes",anchor:"storageSize",category:"Storage",unitName:"GB"},{key:W.tk.STORAGE_IMAGES_TRANSFORMED,name:"Storage Image Transformations",units:"absolute",anchor:"storageImageTransformations",category:"Storage",unitName:"image"},{key:W.tk.REALTIME_PEAK_CONNECTIONS,name:"Realtime Peak Connections",units:"absolute",anchor:"realtimePeakConnections",category:"Realtime",unitName:"connection"},{key:W.tk.REALTIME_MESSAGE_COUNT,name:"Realtime Messages",units:"absolute",anchor:"realtimeMessageCount",category:"Realtime",unitName:"message"},{key:W.tk.FUNCTION_INVOCATIONS,name:"Edge Function Invocations",units:"absolute",anchor:"funcInvocations",category:"Edge Functions",unitName:"invocation"},{key:W.tk.FUNCTION_COUNT,name:"Edge Function Count",units:"absolute",anchor:"funcCount",category:"Edge Functions",unitName:"function"}];var nq=e=>{var t;let{slug:n,metric:s,usage:a,subscription:r,relativeToSubscription:l}=e,o=a.usages.find(e=>e.metric===s.key),c=(0,d.useMemo)(()=>{var e,t,n,a;return o?l&&!1===o.available_in_plan?"Unavailable in plan":o.cost&&o.cost>0||!l||o.unlimited?"bytes"===s.units?"".concat(null!==(e=o.usage.toLocaleString())&&void 0!==e?e:0," GB"):o.usage.toLocaleString():"bytes"===s.units?"".concat(null!==(n=o.usage.toLocaleString())&&void 0!==n?n:0," / ").concat(null!==(a=o.pricing_free_units)&&void 0!==a?a:0," GB"):"".concat(o.usage.toLocaleString()," / ").concat(null===(t=o.pricing_free_units)||void 0===t?void 0:t.toLocaleString()):""},[o,l,s]);if(!o)return null;let u=o.usage/(null!==(t=o.pricing_free_units)&&void 0!==t?t:0),m=(null==r?void 0:r.usage_billing_enabled)===!0,h=!1==!!o.unlimited,p=h&&u>=.8,x=l&&h&&u>=1,f=Y(o.metric),g=u<.01?"<1%":"".concat((+(100*u).toFixed(0)).toLocaleString(),"%");return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(X(),{href:"/org/".concat(n,"/usage#").concat(s.anchor),children:(0,i.jsxs)("div",{className:"group flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:s.name}),(0,i.jsx)(M.Z,{strokeWidth:1.5,size:16,className:"transition"})]})}),(0,i.jsx)("span",{className:"text-sm",children:c}),"\xa0",o.cost&&o.cost>0?(0,i.jsxs)("span",{className:"text-sm",children:["(",(0,Q.xG)(o.cost),")"]}):o.available_in_plan&&!o.unlimited&&l?(0,i.jsxs)("span",{className:"text-sm",children:["(",g,")"]}):null]}),o.available_in_plan?(0,i.jsx)("div",{children:(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{children:l&&!o.unlimited?(0,i.jsxs)("svg",{className:"h-8 w-8 -rotate-90 transform",children:[(0,i.jsx)("circle",{cx:15,cy:15,r:12,fill:"transparent",stroke:"currentColor",strokeWidth:4,className:"text-background-surface-300"}),(0,i.jsx)("circle",{cx:15,cy:15,r:12,fill:"transparent",stroke:"currentColor",strokeDasharray:75.398,strokeDashoffset:"calc(75.39822 - ".concat(u<1?100*u:100," / 100 * 75.39822)"),strokeWidth:4,className:m?"text-gray-dark-800":x?"text-red-900":p?"text-yellow-1000":"text-gray-dark-800"})]}):(0,i.jsx)(nU,{className:"h-8 w-8 p-1"})}),(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background min-w-[300px] max-w-[450px] max-h-[300px] overflow-y-auto",children:(0,i.jsxs)("div",{className:"text-xs text-foreground space-y-2",children:[(0,i.jsx)("p",{className:"font-medium",children:o.unit_price_desc}),o.project_allocations&&o.project_allocations.length>0&&(0,i.jsxs)("table",{className:"list-disc w-full",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"text-left",children:"Project"}),(0,i.jsx)("th",{className:"text-right",children:"Usage"})]})}),(0,i.jsxs)("tbody",{children:[o.project_allocations.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.name}),(0,i.jsx)("td",{className:"text-right",children:H(o.metric,e.usage)})]},"".concat(o.metric,"_").concat(e.ref))),(0,i.jsx)("tr",{})]}),(0,i.jsx)("tfoot",{children:(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{className:"py-2 border-t text-left",children:["Total",f&&(0,i.jsxs)("span",{children:[" (",f,")"]})]}),(0,i.jsxs)("td",{className:"py-2 border-t text-right",children:[H(o.metric,o.usage_original)," "]})]})})]}),!1===r.usage_billing_enabled&&l&&(p||x)&&(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)("p",{className:"text-xs",children:"Exceeding your plans included usage will lead to restrictions to your project. Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})})]})})]})})]})}):(0,i.jsx)("div",{children:(0,i.jsx)(F.z,{type:"default",asChild:!0,children:(0,i.jsx)(X(),{href:"/org/".concat(n,"/billing?panel=subscriptionPlan"),children:"Upgrade"})})})]})},nB=e=>{let{slug:t,metric:n,usage:s,relativeToSubscription:a}=e,r=s.usages.find(e=>e.metric===n.key),l=(0,d.useMemo)(()=>{var e,t,n,s,a;return(null==r?void 0:r.cost)&&r.cost>0?"".concat(null!==(t=null==r?void 0:null===(e=r.usage)||void 0===e?void 0:e.toLocaleString())&&void 0!==t?t:0," hours"):"".concat(null!==(s=null==r?void 0:null===(n=r.usage)||void 0===n?void 0:n.toLocaleString())&&void 0!==s?s:0," / ").concat(null!==(a=null==r?void 0:r.pricing_free_units)&&void 0!==a?a:0," hours")},[r]);return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(X(),{href:"/org/".concat(t,"/usage#").concat(n.anchor),children:(0,i.jsxs)("div",{className:"group flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:n.name}),(0,i.jsx)(M.Z,{strokeWidth:1.5,size:16,className:"transition"})]})}),(0,i.jsx)("span",{className:"text-sm",children:l}),"\xa0",a&&(null==r?void 0:r.cost)&&r.cost>0?(0,i.jsxs)("span",{className:"text-sm",children:["(",(0,Q.xG)(null==r?void 0:r.cost),")"]}):null]}),(0,i.jsx)("div",{children:(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{children:(0,i.jsx)(nU,{className:"h-8 w-8 p-1"})}),(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background min-w-[300px] max-w-[450px] max-h-[300px] overflow-y-auto",children:(0,i.jsxs)("div",{className:"text-xs text-foreground space-y-2",children:[(0,i.jsx)("p",{className:"font-medium",children:null==r?void 0:r.unit_price_desc}),(null==r?void 0:r.project_allocations)&&r.project_allocations.length>0&&(0,i.jsxs)("table",{className:"list-disc w-full",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"text-left",children:"Project"}),(0,i.jsx)("th",{className:"text-right",children:"Usage"})]})}),(0,i.jsxs)("tbody",{children:[r.project_allocations.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.name}),(0,i.jsx)("td",{className:"text-right",children:H(r.metric,e.usage)})]},"".concat(r.metric,"_").concat(e.ref))),(0,i.jsx)("tr",{})]}),(0,i.jsx)("tfoot",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"py-2 border-t text-left",children:"Total (Hours)"}),(0,i.jsx)("td",{className:"py-2 border-t text-right",children:H(r.metric,r.usage_original)})]})})]}),(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsxs)("p",{className:"text-xs",children:["Every project is a dedicated server and database. For every hour your project is active, it incurs compute costs based on the instance size of your project. Paused projects do not incur compute costs."," ",(0,i.jsx)(X(),{href:"https://supabase.com/docs/guides/platform/org-based-billing#usage-based-billing-for-compute",target:"_blank",className:"transition text-brand hover:text-brand-600 underline",children:"Read more"})]})})]})})]})})]})})]})},nW=e=>{var t,n;let{orgSlug:s,projectRef:a,subscription:r,startDate:l,endDate:o,currentBillingCycleSelected:c}=e,u=null==r?void 0:r.usage_billing_enabled,{data:m,error:h,isLoading:p,isError:f,isSuccess:g}=(0,eK.v)({orgSlug:s,projectRef:a,start:!c&&l?new Date(l):void 0,end:!c&&o?new Date(o):void 0}),v=c&&!a,y=v&&!!(null==m?void 0:m.usages.find(e=>{var t;return!e.metric.startsWith("COMPUTE_")&&!e.unlimited&&e.usage>(null!==(t=null==e?void 0:e.pricing_free_units)&&void 0!==t?t:0)})),b=(0,d.useMemo)(()=>m?nM.slice().sort((e,t)=>{var n,s,a,i;let r=m.usages.find(t=>t.metric===e.key),l="number"!=typeof r?(null!==(n=null==r?void 0:r.usage)&&void 0!==n?n:0)/(null!==(s=null==r?void 0:r.pricing_free_units)&&void 0!==s?s:0):0,o=m.usages.find(e=>e.metric===t.key),c="number"!=typeof o?(null!==(a=null==o?void 0:o.usage)&&void 0!==a?a:0)/(null!==(i=null==o?void 0:o.pricing_free_units)&&void 0!==i?i:0):0;return Number(null==o?void 0:o.available_in_plan)-Number(null==r?void 0:r.available_in_plan)||c-l}):nM,[m]),N=((null==m?void 0:m.usages)||[]).filter(e=>e.metric.startsWith("COMPUTE")).map(e=>e.metric);return(0,i.jsx)("div",{id:"summary",children:(0,i.jsxs)(nb,{section:{name:"Usage Summary",description:u?"Your plan includes a limited amount of usage. If the usage on your organization exceeds these quotas, your subscription will be charged for the overages. It may take up to 24 hours for usage stats to update.":"Your plan includes a limited amount of usage. If the usage on your organization exceeds these quotas, you may experience restrictions, as you are currently not billed for overages. It may take up to 24 hours for usage stats to update.",links:[{name:"How billing works",url:"https://supabase.com/docs/guides/platform/org-based-billing"},{name:"Supabase Plans",url:"https://supabase.com/pricing"}]},children:[p&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),f&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve usage data",error:h}),g&&r&&(0,i.jsxs)("div",{children:[v&&(0,i.jsx)("p",{className:"text-sm",children:y?y&&(null==r?void 0:null===(t=r.plan)||void 0===t?void 0:t.id)==="free"?(0,i.jsxs)("span",{children:["You have exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," plan quota in this billing cycle. Upgrade your plan to continue using Supabase without restrictions."]}):y&&(null==r?void 0:r.usage_billing_enabled)===!1&&(null==r?void 0:null===(n=r.plan)||void 0===n?void 0:n.id)==="pro"?(0,i.jsxs)("span",{children:["You have exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," plan quota in this billing cycle. Disable your spend cap to continue using Supabase without restrictions."]}):y&&(null==r?void 0:r.usage_billing_enabled)===!0?(0,i.jsxs)("span",{children:["You have exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," plan quota in this billing cycle and will be charged for over-usage."]}):(0,i.jsxs)("span",{children:["You have not exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," plan quota in this billing cycle."]}):(0,i.jsxs)("span",{children:["You have not exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," plan quota in this billing cycle."]})}),(0,i.jsxs)("div",{className:"grid grid-cols-12 mt-3",children:[b.map((e,t)=>(0,i.jsx)("div",{className:(0,P.default)("col-span-12 md:col-span-6 space-y-4 py-4 border-overlay",t%2==0?"md:border-r md:pr-4":"md:pl-4","border-b"),children:(0,i.jsx)(nq,{idx:t,slug:s,metric:e,usage:m,subscription:r,relativeToSubscription:v})},e.key)),N.map((e,t)=>(0,i.jsx)("div",{className:(0,P.default)("col-span-12 md:col-span-6 space-y-4 py-4 border-overlay",t%2==0?"md:border-r md:pr-4":"md:pl-4"),children:(0,i.jsx)(nB,{slug:s,metric:{key:e,name:(0,W.p5)(e)+" Compute Hours",units:"hours",anchor:"compute",category:"Compute",unitName:"GB"},relativeToSubscription:v,usage:m})},e))]})]})]})})},nG=()=>{var e,t;let{slug:n,projectRef:s}=(0,c.UO)(),[a,o]=(0,d.useState)(),[u,m]=(0,d.useState)(),h=(0,l.lL)(),{data:f,isSuccess:g}=(0,e3.Sy)(),{data:v,error:y,isLoading:b,isError:N,isSuccess:w}=(0,z.G)({orgSlug:n}),_=null==f?void 0:f.filter(e=>e.organization_id===(null==h?void 0:h.id));(0,d.useEffect)(()=>{s&&g&&void 0!==_&&_.find(e=>e.ref===s)&&m(s)},[s,g]);let C=Z().unix(null!==(e=null==v?void 0:v.current_period_start)&&void 0!==e?e:0).utc(),S=Z().unix(null!==(t=null==v?void 0:v.current_period_end)&&void 0!==t?t:0).utc(),k=(0,d.useMemo)(()=>{if(!(null==a?void 0:a.period_start)||!(null==a?void 0:a.period_end)||!v)return!0;let{current_period_start:e,current_period_end:t}=v;return Z()(a.period_start.date).isSame(new Date(1e3*e))&&Z()(a.period_end.date).isSame(new Date(1e3*t))},[a,v]),E=(0,d.useMemo)(()=>{var e,t;if(null==a?void 0:null===(e=a.period_start)||void 0===e?void 0:e.date)return new Date(null==a?void 0:null===(t=a.period_start)||void 0===t?void 0:t.date).toISOString().slice(0,-5)+"Z"},[a,v]),A=(0,d.useMemo)(()=>{var e,t;return(null==a?void 0:null===(e=a.period_end)||void 0===e?void 0:e.date)&&Z()(a.period_end.date).isAfter(Z()())?Z()().endOf("day").toISOString().slice(0,-5)+"Z":(null==a?void 0:null===(t=a.period_end)||void 0===t?void 0:t.date)?new Date(a.period_end.date).toISOString().slice(0,-5)+"Z":void 0},[a,v]),T=u?null==_?void 0:_.find(e=>e.ref===u):void 0;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r._S,{className:"sticky top-0 border-b bg-studio z-10 overflow-hidden",children:(0,i.jsxs)("div",{className:"py-4 flex items-center space-x-4",children:[b&&(0,i.jsx)(j.Z,{className:"w-[250px]"}),N&&(0,i.jsx)(x.Z,{className:"w-full",subject:"Failed to retrieve usage data",error:y}),w&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(nx.Z,{onChange:o,value:nf.eB[0].key,options:[...nf.eB,...nf._T],loading:b,currentBillingPeriodStart:null==v?void 0:v.current_period_start,currentBillingPeriodEnd:null==v?void 0:v.current_period_end}),(0,i.jsxs)(p.Z,{size:"tiny",name:"schema",className:"w-[180px]",value:u,onChange:e=>{"all-projects"===e?m(void 0):m(e)},children:[(0,i.jsx)(p.Z.Option,{id:"all-projects",label:"All projects",value:"all-projects",children:"All projects"},"all-projects"),null==_?void 0:_.map(e=>(0,i.jsx)(p.Z.Option,{id:e.ref,value:e.ref,label:e.name,children:e.name},e.ref))]}),(0,i.jsxs)("div",{className:"flex flex-col xl:flex-row xl:gap-3",children:[(0,i.jsxs)("p",{className:(0,P.default)("text-sm transition",b&&"opacity-50"),children:["Organization is on the ",v.plan.name," plan"]}),(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:[C.format("DD MMM YYYY")," -"," ",S.format("DD MMM YYYY")]})]})]})]})}),u?(0,i.jsx)(r._S,{className:"mt-5",children:(0,i.jsx)(e0.Z,{title:"Usage filtered by project",description:(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("p",{children:['You are currently viewing usage for the "',(null==T?void 0:T.name)||u,'" project. Since your organization is using the new organization-based billing, the included quota is for your whole organization and not just this project. For billing purposes, we sum up usage from all your projects. To view your usage quota, set the project filter above back to "All Projects".']}),(0,i.jsx)("div",{children:(0,i.jsx)(F.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(X(),{href:"https://supabase.com/docs/guides/platform/org-based-billing",target:"_blank",rel:"noreferrer",children:"Documentation"})})})]}),defaultVisibility:!0,hideCollapse:!0,icon:(0,i.jsx)(q.Z,{})})}):(0,i.jsx)(r._S,{id:"restriction",className:"mt-5",children:(0,i.jsx)(eQ,{})}),(0,i.jsx)(nW,{orgSlug:n,projectRef:u,subscription:v,startDate:E,endDate:A,currentBillingCycleSelected:k}),(0,i.jsx)(nO,{orgSlug:n,projectRef:u,subscription:v,startDate:E,endDate:A}),(0,i.jsx)(nz,{orgSlug:n,projectRef:u,subscription:v,startDate:E,endDate:A,currentBillingCycleSelected:k}),(0,i.jsx)(nD,{orgSlug:n,projectRef:u,subscription:v,startDate:E,endDate:A,currentBillingCycleSelected:k}),(0,i.jsx)(nZ,{orgSlug:n,projectRef:u,subscription:v,startDate:E,endDate:A,currentBillingCycleSelected:k})]})},nH=n(38421),nY=n.n(nH),nV=n(49893),nK=n(20229),nX=n(63913),nQ=n(49541),n$=n(82366),nJ=n(13252),n0=n(46666);async function n1(e,t){let{slug:n,iso_timestamp_start:s,iso_timestamp_end:a,project_refs:i}=e;if(!n)throw Error("slug is required");let r=await (0,y.U2)("".concat(b.T5,"/organizations/").concat(n,"/audit?iso_timestamp_start=").concat(s,"&iso_timestamp_end=").concat(a),{signal:t});if(r.error)throw r.error;return r}let n2=function(e){let{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{slug:s,iso_timestamp_start:a,iso_timestamp_end:i}=e,r=Z()(a).utc().format("YYYY-MM-DD"),l=Z()(i).utc().format("YYYY-MM-DD");return(0,v.a)(N.O.auditLogs(s,{date_start:r,date_end:l}),t=>{let{signal:n}=t;return n1(e,n)},{enabled:t&&void 0!==s,...n})};async function n4(e,t){let{slug:n}=e;if(!n)throw Error("slug is required");let[s,a]=await Promise.all([(0,R.U2)("/platform/organizations/{slug}/members",{params:{path:{slug:n}},signal:t}),(0,R.U2)("/platform/organizations/{slug}/members/invite",{params:{path:{slug:n}},signal:t})]),{data:i,error:r}=s,{data:l,error:o}=a;return r&&(0,R.S3)(r),o&&(0,R.S3)(o),[...i,...l.map(e=>({invited_at:e.invited_at,invited_id:e.invited_id,mfa_enabled:!1,username:e.invited_email.slice(0,1),primary_email:e.invited_email,role_ids:[e.role_id]}))]}let n3=function(e){let{slug:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(N.O.members(t),e=>{let{signal:n}=e;return n4({slug:t},n)},{enabled:n&&void 0!==t,...s})};async function n5(e,t){let{slug:n}=e;if(!n)throw Error("slug is required");let s=await (0,y.U2)("".concat(b.T5,"/organizations/").concat(n,"/roles"),{signal:t});if(s.error)throw s.error;return{roles:s}}let n8=function(e){let{slug:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(N.O.roles(t),e=>{let{signal:n}=e;return n5({slug:t},n)},{enabled:n&&void 0!==t,...s})};var n6=()=>{var e,t,n,s,a,l,o;let{slug:u}=(0,c.UO)(),m=Z()().utc().set("millisecond",0),[h,p]=(0,d.useState)(!0),[f,g]=(0,d.useState)({from:m.subtract(1,"day").toISOString(),to:m.toISOString()}),[v,y]=(0,d.useState)(),[b,N]=(0,d.useState)({users:[],projects:[]}),{data:w}=(0,e3.Sy)(),{data:_}=(0,ea.tl)(),{data:C}=n3({slug:u}),{data:S}=n8({slug:u}),{data:k,error:E,isLoading:A,isSuccess:T,isError:I,isRefetching:z,refetch:P}=n2({slug:u,iso_timestamp_start:f.from,iso_timestamp_end:f.to},{retry:(e,t)=>!t.message.endsWith("upgrade to team or enterprise plan to access audit logs."),retryOnMount:!1,refetchOnWindowFocus:!1});(0,d.useEffect)(()=>{let e=Z()(f.from).diff(Z()(f.to)),t=setInterval(()=>{let t=Z()().utc().set("millisecond",0);g({from:t.add(e).toISOString(),to:t.toISOString()})},3e5);return()=>clearInterval(t)},[f.from,f.to]);let R=null!==(n=null==S?void 0:S.roles)&&void 0!==n?n:[],L=null!==(s=null==k?void 0:k.retention_period)&&void 0!==s?s:0,O=null!==(a=null==k?void 0:k.result)&&void 0!==a?a:[],D=null==O?void 0:null===(t=O.sort((e,t)=>h?Number(new Date(t.occurred_at))-Number(new Date(e.occurred_at)):Number(new Date(e.occurred_at))-Number(new Date(t.occurred_at))))||void 0===t?void 0:null===(e=t.filter(e=>b.users.length>0?b.users.includes(e.actor.id):e))||void 0===e?void 0:e.filter(e=>b.projects.length>0?b.projects.includes(e.target.metadata.project_ref||""):e),U=null==_?void 0:_.find(e=>e.slug===u);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.gW,{children:(0,i.jsxs)("div",{className:"space-y-4 flex flex-col",children:[A&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),I?E.message.endsWith("upgrade to team or enterprise plan to access audit logs.")?(0,i.jsxs)(ed.bZ,{variant:"default",title:"Organization Audit Logs are not available on Free or Pro plans",children:[(0,i.jsx)(nv.Z,{className:"h-4 w-4 mt-3"}),(0,i.jsxs)("div",{className:"flex flex-row pt-3 pb-2",children:[(0,i.jsxs)("div",{className:"grow",children:[(0,i.jsx)(ed.Cd,{children:"Organization Audit Logs are not available on Free or Pro plans"}),(0,i.jsx)(ed.X,{className:"flex flex-row justify-between gap-3",children:(0,i.jsx)("p",{children:"Upgrade to Team or Enterprise to view up to 28 days of Audit Logs for your organization."})})]}),(0,i.jsx)("div",{className:"flex items-center",children:(0,i.jsx)(F.z,{type:"primary",asChild:!0,children:(0,i.jsx)(X(),{href:"/org/".concat(u,"/billing?panel=subscriptionPlan"),children:"Upgrade subscription"})})})]})]}):(0,i.jsx)(x.Z,{error:E,subject:"Failed to retrieve audit logs"}):null,T&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-xs prose",children:"Filter by"}),(0,i.jsx)(n0.E,{name:"Users",options:null!=C?C:[],labelKey:"username",valueKey:"gotrue_id",activeOptions:b.users,onSaveFilters:e=>N({...b,users:e})}),(0,i.jsx)(n0.E,{name:"Projects",options:null!==(l=null==w?void 0:w.filter(e=>e.organization_id===(null==U?void 0:U.id)))&&void 0!==l?l:[],labelKey:"name",valueKey:"ref",activeOptions:b.projects,onSaveFilters:e=>N({...b,projects:e})}),(0,i.jsx)(nJ.M,{hideTime:!0,hideClear:!0,triggerButtonType:"dashed",triggerButtonTitle:"",from:f.from,to:f.to,minDate:Z()().subtract(L,"days").toDate(),maxDate:Z()().toDate(),onChange:e=>{if(null!==e.from&&null!==e.to){let t=Z()().utc();g({from:Z()(e.from).utc().hour(t.hour()).minute(t.minute()).second(t.second()).toISOString(),to:Z()(e.to).utc().hour(t.hour()).minute(t.minute()).second(t.second()).toISOString()})}},renderFooter:()=>(0,i.jsxs)(ec.b,{title:"",variant:"info",className:"mx-3 pl-2 pr-2 pt-1 pb-2",children:["Your organization has a log retention period of"," ",(0,i.jsxs)("span",{className:"text-brand",children:[L," day",L>1?"s":""]}),". You may only view logs from"," ",Z()().subtract(L,"days").format("DD MMM YYYY")," as the earliest date."]})}),T&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"h-[20px] border-r border-strong !ml-4 !mr-2"}),(0,i.jsxs)("p",{className:"prose text-xs",children:["Viewing ",D.length," logs in total"]})]})]}),(0,i.jsx)(F.z,{type:"default",disabled:A||z,icon:(0,i.jsx)(nV.Z,{className:z?"animate-spin":""}),onClick:()=>P(),children:z?"Refreshing":"Refresh"})]}),0===O.length?(0,i.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,i.jsx)("p",{className:"prose text-sm",children:"Your organization does not have any audit logs available yet"})}):O.length>0&&0===D.length?(0,i.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,i.jsx)("p",{className:"prose text-sm",children:"No audit logs found based on the filters applied"})}):(0,i.jsx)(ef.Z,{head:[(0,i.jsx)(ef.Z.th,{className:"py-2",children:"User"},"user"),(0,i.jsx)(ef.Z.th,{className:"py-2",children:"Action"},"action"),(0,i.jsx)(ef.Z.th,{className:"py-2",children:"Target"},"target"),(0,i.jsx)(ef.Z.th,{className:"py-2",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{children:"Date"}),(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{asChild:!0,children:(0,i.jsx)(F.z,{type:"text",className:"px-1",icon:h?(0,i.jsx)(nK.Z,{strokeWidth:1.5,size:14}):(0,i.jsx)(nX.Z,{strokeWidth:1.5,size:14}),onClick:()=>p(!h)})}),(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"right",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:h?"Sort latest first":"Sort earliest first"})})]})})]})]})},"date"),(0,i.jsx)(ef.Z.th,{className:"py-2"},"actions")],body:null!==(o=null==D?void 0:D.map(e=>{var t,n,s,a,r,l,o,c,d;let u=(null!=C?C:[]).find(t=>t.gotrue_id===e.actor.id),m=R.find(e=>{var t;return(null==u?void 0:null===(t=u.role_ids)||void 0===t?void 0:t[0])===e.id}),h=null==w?void 0:w.find(t=>t.ref===e.target.metadata.project_ref),p=null==_?void 0:_.find(t=>t.slug===e.target.metadata.org_slug),x=(null===(t=e.action.metadata[0])||void 0===t?void 0:t.status)!==void 0,f=void 0===u?(0,i.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center border-2 rounded-full border-strong",children:(0,i.jsx)("p",{children:"?"})}):(null==u?void 0:u.invited_id)||(null==u?void 0:u.username)===(null==u?void 0:u.primary_email)?(0,i.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center border-2 rounded-full border-strong",children:(0,i.jsx)(nQ.Z,{size:18,strokeWidth:2})}):(0,i.jsx)(nY(),{alt:null==u?void 0:u.username,src:"https://github.com/".concat(null!==(n=null==u?void 0:u.username)&&void 0!==n?n:"",".png?size=80"),width:"30",height:"30",className:"border rounded-full"});return(0,i.jsxs)(ef.Z.tr,{onClick:()=>y(e),className:"cursor-pointer hover:!bg-alternative transition duration-100",children:[(0,i.jsx)(ef.Z.td,{children:(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("div",{children:f}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-foreground-light",children:null!==(s=null==u?void 0:u.username)&&void 0!==s?s:"-"}),m&&(0,i.jsx)("p",{className:"mt-0.5 text-xs text-foreground-light",children:null==m?void 0:m.name})]})]})}),(0,i.jsx)(ef.Z.td,{className:"max-w-[250px]",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[x&&(0,i.jsx)("p",{className:"bg-surface-200 rounded px-1 flex items-center justify-center text-xs font-mono border",children:e.action.metadata[0].status}),(0,i.jsx)("p",{className:"truncate",title:e.action.name,children:e.action.name})]})}),(0,i.jsxs)(ef.Z.td,{children:[(0,i.jsxs)("p",{className:"text-foreground-light max-w-[230px] truncate",title:null!==(r=null!==(a=null==h?void 0:h.name)&&void 0!==a?a:null==p?void 0:p.name)&&void 0!==r?r:"-",children:[(null==h?void 0:h.name)?"Project: ":(null==p?void 0:p.name)?"Organization: ":null,null!==(o=null!==(l=null==h?void 0:h.name)&&void 0!==l?l:null==p?void 0:p.name)&&void 0!==o?o:"Unknown"]}),(0,i.jsxs)("p",{className:"text-foreground-light text-xs mt-0.5 truncate",title:null!==(c=e.target.metadata.project_ref)&&void 0!==c?c:e.target.metadata.org_slug,children:[e.target.metadata.project_ref?"Ref: ":e.target.metadata.org_slug?"Slug: ":null,null!==(d=e.target.metadata.project_ref)&&void 0!==d?d:e.target.metadata.org_slug]})]}),(0,i.jsx)(ef.Z.td,{children:Z()(e.occurred_at).format("DD MMM YYYY, HH:mm:ss")}),(0,i.jsx)(ef.Z.td,{align:"right",children:(0,i.jsx)(F.z,{type:"default",children:"View details"})})]},e.occurred_at)}))&&void 0!==o?o:[]})]})]})}),(0,i.jsx)(n$.h,{selectedLog:v,onClose:()=>y(void 0)})]})};let n9=e=>[e,"oauth-apps"],n7=e=>[e,"authorized-apps"];async function se(e,t){let{slug:n}=e;if(!n)throw Error("Organization slug is required");let s=await (0,y.U2)("".concat(b.T5,"/organizations/").concat(n,"/oauth/apps?type=authorized"),{signal:t});if(s.error)throw s.error;return s}let st=function(e){let{slug:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(n7(t),e=>{let{signal:n}=e;return se({slug:t},n)},{enabled:n&&void 0!==t,...s})};async function sn(e,t){let{slug:n}=e;if(!n)throw Error("Organization slug is required");let s=await (0,y.U2)("".concat(b.T5,"/organizations/").concat(n,"/oauth/apps?type=published"),{signal:t});if(s.error)throw s.error;return s}let ss=function(e){let{slug:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,v.a)(n9(t),e=>{let{signal:n}=e;return sn({slug:t},n)},{enabled:n&&void 0!==t,...s})};var sa=n(62134),si=e=>{let{app:t,onSelectRevoke:n}=e;return(0,i.jsxs)(ef.Z.tr,{children:[(0,i.jsx)(ef.Z.td,{children:(0,i.jsx)("div",{className:"w-[30px] h-[30px] rounded-full bg-no-repeat bg-cover bg-center border border-control flex items-center justify-center",style:{backgroundImage:t.icon?"url('".concat(t.icon,"')"):"none"},children:t.icon?"":"".concat(t.name[0])})}),(0,i.jsx)(ef.Z.td,{children:t.name}),(0,i.jsx)(ef.Z.td,{children:Z()(t.authorized_at).format("DD/MM/YYYY, HH:mm:ss")}),(0,i.jsx)(ef.Z.td,{align:"right",children:(0,i.jsx)(F.z,{type:"default",icon:(0,i.jsx)(sa.Z,{}),className:"px-1",onClick:()=>n()})})]})};async function sr(e){let{id:t,slug:n}=e;if(!t)throw Error("OAuth app ID is required");if(!n)throw Error("Organization slug is required");let s=await (0,y.$v)("".concat(b.T5,"/organizations/").concat(n,"/oauth/apps/").concat(t,"?type=published"));if(s.error)throw s.error;return s}let sl=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>sr(e),{async onSuccess(t,n,a){let{slug:i}=n;await s.invalidateQueries(n9(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to delete application: ".concat(e.message)):t(e,n,s)},...n})};var so=n(89689),sc=e=>{let{selectedApp:t,onClose:n}=e,{slug:s}=(0,c.UO)(),{mutate:a,isLoading:r}=sl({onSuccess:()=>{u.ZP.success('Successfully deleted the app "'.concat(null==t?void 0:t.name,'"')),n()}}),l=async()=>s?(null==t?void 0:t.id)?void a({slug:s,id:null==t?void 0:t.id}):console.error("App ID is required"):console.error("Slug is required");return(0,i.jsx)(eM.C,{size:"medium",alignFooter:"right",header:"Confirm to delete ".concat(null==t?void 0:t.name),visible:void 0!==t,loading:r,onCancel:n,onConfirm:l,children:(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("div",{className:"py-4",children:[(0,i.jsxs)(ec.b,{withIcon:!0,variant:"warning",title:"This action cannot be undone",children:["Deleting ",null==t?void 0:t.name," will invalidate any access tokens from this application that were authorized by users."]}),(0,i.jsx)("ul",{className:"mt-4 space-y-5",children:(0,i.jsxs)("li",{className:"flex gap-3 text-sm",children:[(0,i.jsx)(so.Z,{w:14,className:"flex-shrink-0"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Before you remove this application, consider:"}),(0,i.jsx)("ul",{className:"space-y-2 mt-2",children:(0,i.jsx)("li",{className:"list-disc ml-4",children:"No users are currently using this application. It will no longer be available for use after deletion."})})]})]})})]})})})},sd=n(54506),su=n(23056),sm=n(74559),sh=e=>{let{app:t,onSelectEdit:n,onSelectDelete:s}=e,[a,r]=(0,d.useState)(!1);return(0,i.jsxs)(ef.Z.tr,{children:[(0,i.jsx)(ef.Z.td,{children:(0,i.jsx)("div",{className:"w-[30px] h-[30px] rounded-full bg-no-repeat bg-cover bg-center border border-control flex items-center justify-center",style:{backgroundImage:t.icon?"url('".concat(t.icon,"')"):"none"},children:t.icon?"":"".concat(t.name[0])})}),(0,i.jsx)(ef.Z.td,{children:(0,i.jsx)("p",{title:t.name,className:"truncate",children:t.name})}),(0,i.jsx)(ef.Z.td,{children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("p",{className:"font-mono truncate w-[220px]",title:t.client_id,children:t.client_id}),(0,i.jsx)(F.z,{type:"default",icon:a?(0,i.jsx)(e9.Z,{className:"text-brand",strokeWidth:3}):(0,i.jsx)(sd.Z,{}),className:"ml-2 px-1",onClick:()=>{(0,Q.vQ)(t.client_id),r(!0),setTimeout(()=>{r(!1)},3e3)}})]})}),(0,i.jsx)(ef.Z.td,{children:(0,i.jsxs)("span",{className:"font-mono",title:t.client_secret_alias,children:[t.client_secret_alias,"..."]})}),(0,i.jsx)(ef.Z.td,{children:Z()(t.created_at).format("DD/MM/YYYY, HH:mm:ss")}),(0,i.jsx)(ef.Z.td,{align:"right",children:(0,i.jsxs)(eL.h_,{children:[(0,i.jsx)(eL.$F,{asChild:!0,children:(0,i.jsx)(F.z,{type:"default",icon:(0,i.jsx)(su.Z,{}),className:"px-1"})}),(0,i.jsxs)(eL.AW,{align:"end",side:"bottom",children:[(0,i.jsxs)(eL.Xi,{className:"space-x-2",onClick:()=>n(),children:[(0,i.jsx)(sm.Z,{}),(0,i.jsx)("p",{children:"Edit app"})]},"edit"),(0,i.jsx)(eL.VD,{}),(0,i.jsxs)(eL.Xi,{className:"space-x-2",onClick:()=>s(),children:[(0,i.jsx)(sa.Z,{}),(0,i.jsx)("p",{children:"Delete app"})]},"delete")]})]})})]})};async function sp(e){let{slug:t,name:n,website:s,icon:a,scopes:i,redirect_uris:r}=e,l=await (0,y.v_)("".concat(b.T5,"/organizations/").concat(t,"/oauth/apps"),{name:n,website:s,icon:a,scopes:i,redirect_uris:r});if(l.error)throw l.error;return l}let sx=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>sp(e),{async onSuccess(t,n,a){let{slug:i}=n;await s.invalidateQueries(n9(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to create OAuth application: ".concat(e.message)):t(e,n,s)},...n})};async function sf(e){let{id:t,slug:n,name:s,website:a,icon:i,scopes:r,redirect_uris:l}=e;if(!t)throw Error("OAuth app ID is required");if(!n)throw Error("Organization slug is required");if(!s)throw Error("OAuth app name is required");if(!a)throw Error("OAuth app URL is required");if(!l||0===l.length)throw Error("Redirect URIs are required");let o=await (0,y.gz)("".concat(b.T5,"/organizations/").concat(n,"/oauth/apps/").concat(t),{name:s,website:a,icon:i,scopes:r,redirect_uris:l});if(o.error)throw o.error;return o}let sg=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>sf(e),{async onSuccess(t,n,a){let{slug:i}=n;await s.invalidateQueries(n9(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to update application: ".concat(e.message)):t(e,n,s)},...n})};var sj=n(20364);let sv=async function(e,t,n){let s=!(arguments.length>3)||void 0===arguments[3]||arguments[3],a=(0,sj.eI)("https://obuldanrptloktxcffvn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9idWxkYW5ycHRsb2t0eGNmZnZuIiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTIyNjkzMjYsImV4cCI6MjAwNzg0NTMyNn0.1S6qpBbHtEmGuMsIx5UOhRiFd4YbVv-yLTrLk6tVGmM",{auth:{persistSession:!1,autoRefreshToken:!1,multiTab:!1,detectSessionInUrl:!1,localStorage:{getItem:e=>void 0,setItem:(e,t)=>{},removeItem:e=>{}}}}),{data:i,error:r}=await a.storage.from(e).upload(t,n,{cacheControl:"3600"});if(r){console.error("Failed to upload:",r);return}if(i&&s){let{data:t}=await a.storage.from(e).getPublicUrl(i.path);return null==t?void 0:t.publicUrl}};var sy=n(97305),sb=n(41421),sN=n(43687);let sw=e=>{let{children:t,scopeName:n,scopes:s,onChange:a}=e;return(0,i.jsx)(eL.bO,{checked:s.includes(n),onCheckedChange:e=>{e?a([...s,n]):a([...s.filter(e=>e!==n)])},children:t})},s_=e=>{let{title:t,description:n,readScopeName:s,writeScopeName:a,scopes:r,setScopes:l}=e,o="Access: No access";return r.includes(s)&&(o="Access: Read-only"),r.includes(a)&&(o="Access: Write-only"),r.includes(s)&&r.includes(a)&&(o="Access: Read and write"),(0,i.jsxs)("div",{className:"flex flex-row justify-between p-4 border first:rounded-t last:rounded-b",children:[(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("span",{className:"text-foreground text-sm",children:t}),(0,i.jsx)("span",{className:"text-foreground-light text-xs",children:n})]}),(0,i.jsxs)(eL.h_,{children:[(0,i.jsx)(eL.$F,{asChild:!0,children:(0,i.jsx)(F.z,{type:"default",iconRight:(0,i.jsx)(sN.Z,{}),children:(0,i.jsx)("p",{children:o})})}),(0,i.jsxs)(eL.AW,{align:"end",children:[(0,i.jsx)(eL.Ju,{children:"Select an access level"}),(0,i.jsx)(eL.VD,{}),(0,i.jsx)(sw,{scopeName:s,scopes:r,onChange:l,children:"Read"}),(0,i.jsx)(sw,{scopeName:a,scopes:r,onChange:l,children:"Write"})]})]})]},t)},sC=e=>{let{scopes:t,setScopes:n}=e;return(0,i.jsxs)("div",{className:"-space-y-px",children:[(0,i.jsx)(s_,{title:"Auth",description:"Auth configurations and SSO providers.",readScopeName:o.YX.AUTH_READ,writeScopeName:o.YX.AUTH_WRITE,scopes:t,setScopes:n}),(0,i.jsx)(s_,{title:"Database",description:"Postgres configurations, SQL snippets, SSL enforcement configurations and Typescript schema types.",readScopeName:o.YX.DATABASE_READ,writeScopeName:o.YX.DATABASE_WRITE,scopes:t,setScopes:n}),(0,i.jsx)(s_,{title:"Domains",description:"Custom domains and vanity subdomains.",readScopeName:o.YX.DOMAINS_READ,writeScopeName:o.YX.DOMAINS_WRITE,scopes:t,setScopes:n}),(0,i.jsx)(s_,{title:"Edge Functions",description:"Edge functions.",readScopeName:o.YX.EDGE_FUNCTIONS_READ,writeScopeName:o.YX.EDGE_FUNCTIONS_WRITE,scopes:t,setScopes:n}),(0,i.jsx)(s_,{title:"Environment",description:"Environments/branches.",readScopeName:o.YX.ENVIRONMENT_READ,writeScopeName:o.YX.ENVIRONMENT_WRITE,scopes:t,setScopes:n}),(0,i.jsx)(s_,{title:"Organizations",description:"Organizations and all its members.",readScopeName:o.YX.ORGANIZATIONS_READ,writeScopeName:o.YX.ORGANIZATIONS_WRITE,scopes:t,setScopes:n}),(0,i.jsx)(s_,{title:"Projects",description:"Metadata, upgrade status, network restrictions and network bans.",readScopeName:o.YX.PROJECTS_READ,writeScopeName:o.YX.PROJECTS_WRITE,scopes:t,setScopes:n}),(0,i.jsx)(s_,{title:"REST",description:"PostgREST configurations.",readScopeName:o.YX.REST_READ,writeScopeName:o.YX.REST_WRITE,scopes:t,setScopes:n}),(0,i.jsx)(s_,{title:"Secrets",description:"API keys, secrets and pgsodium configurations.",readScopeName:o.YX.SECRETS_READ,writeScopeName:o.YX.SECRETS_WRITE,scopes:t,setScopes:n}),(0,i.jsx)(s_,{title:"Storage",description:"Storage buckets and files.",readScopeName:o.YX.STORAGE_READ,writeScopeName:o.YX.STORAGE_WRITE,scopes:t,setScopes:n})]})};var sS=e=>{let{visible:t,selectedApp:n,onClose:s,onCreateSuccess:a}=e,{slug:r}=(0,c.UO)(),l=(0,d.useRef)(),{mutate:o}=sx({onSuccess:(e,t)=>{u.ZP.success('Successfully created OAuth app "'.concat(t.name,'"!')),s(),a(e),f(!1)},onError:e=>{u.ZP.error("Failed to create OAuth application: ".concat(e.message)),f(!1)}}),{mutate:p}=sg({onSuccess:(e,t)=>{u.ZP.success('Successfully updated OAuth app "'.concat(t.name,'"!')),s(),f(!1)},onError:e=>{u.ZP.error("Failed to update OAuth application: ".concat(e.message)),f(!1)}}),[x,f]=(0,d.useState)(!1),[g,j]=(0,d.useState)(!1),[v,y]=(0,d.useState)(),[b,N]=(0,d.useState)(),[w,_]=(0,d.useState)({}),[C,S]=(0,d.useState)([{id:(0,Q.k$)(),value:""}]),[k,E]=(0,d.useState)([]);(0,d.useEffect)(()=>{t&&(_({}),f(!1),y(void 0),void 0!==n?(S(n.redirect_uris.map(e=>({id:(0,Q.k$)(),value:e}))),E(n.scopes),N(null===n.icon?void 0:n.icon)):(S([{id:(0,Q.k$)(),value:""}]),E([]),N(void 0)))},[t,n]);let A=(e,t)=>{S(C.map(n=>n.id===e?{id:e,value:t}:n)),_({})},T=e=>{S(C.filter(t=>t.id!==e))},I=async e=>{e.persist();let[t]=e.target.files||e.dataTransfer.items;y(t),N(URL.createObjectURL(t)),e.target.value=""},Z=async e=>{if(!r)return console.error("Slug is required");let t=C.filter(e=>e.value.length>0).map(e=>e.value);if(0===t.length){_({urls:"Please provide at least one URL"});return}_({}),f(!0);let{name:s,website:a}=e,i=void 0!==v?await sv("oauth-app-icons","".concat(r,"/").concat((0,Q.k$)(),".png"),v):b;void 0===n?o({slug:r,name:s,website:a,redirect_uris:t,scopes:k,icon:i}):p({id:n.id,slug:r,name:s,website:a,redirect_uris:t,scopes:k,icon:void 0===i?null:i})};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(ew.ZP,{hideFooter:!0,size:"large",visible:t,header:void 0!==n?"Update OAuth application":"Publish a new OAuth application",onCancel:()=>s(),children:(0,i.jsx)(m.Z,{validateOnBlur:!0,className:"h-full",initialValues:{name:"",website:""},validate:e=>{let t={};return e.name||(t.name="Please provide a name for your application"),e.website||(t.website="Please provide a URL for your site"),(0,Q.HH)(e.website)||(t.website="Please provide a valid URL for your site"),t},onSubmit:Z,children:e=>{let{resetForm:a,values:r}=e;return(0,d.useEffect)(()=>{if(t&&void 0!==n){let e={name:n.name,website:n.website};a({values:e,initialValues:e})}},[t,n]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"h-full flex flex-col",children:[(0,i.jsxs)("div",{className:"flex-grow",children:[(0,i.jsx)(ew.ZP.Content,{children:(0,i.jsxs)("div",{className:"py-4 flex items-start justify-between gap-10",children:[(0,i.jsxs)("div",{className:"space-y-4 w-full",children:[(0,i.jsx)(h.Z,{id:"name",label:"Application name",descriptionText:(null==n?void 0:n.id)&&"ID: ".concat(n.id)}),(0,i.jsx)(h.Z,{id:"website",label:"Website URL",placeholder:"https://my-website.com"})]}),(0,i.jsxs)("div",{children:[void 0!==b?(0,i.jsx)("div",{className:(0,e_.cn)("shadow transition group relative","bg-center bg-cover bg-no-repeat","mt-4 mr-4 space-y-2 rounded-full h-[120px] w-[120px] flex flex-col items-center justify-center"),style:{backgroundImage:b?'url("'.concat(b,'")'):"none"},children:(0,i.jsx)("div",{className:"absolute bottom-1 right-1",children:(0,i.jsxs)(eL.h_,{children:[(0,i.jsx)(eL.$F,{asChild:!0,children:(0,i.jsx)(F.z,{type:"default",className:"px-1",children:(0,i.jsx)(sm.Z,{})})}),(0,i.jsxs)(eL.AW,{align:"end",side:"bottom",children:[(0,i.jsx)(eL.Xi,{onClick:()=>{l.current&&l.current.click()},children:(0,i.jsx)("p",{children:"Upload image"})},"upload"),(0,i.jsx)(eL.Xi,{onClick:()=>{y(void 0),N(void 0)},children:(0,i.jsx)("p",{children:"Remove image"})},"remove")]})]})})}):(0,i.jsxs)("div",{className:(0,e_.cn)("border border-strong transition opacity-75 hover:opacity-100","mt-4 mr-4 space-y-2 rounded-full h-[120px] w-[120px] flex flex-col items-center justify-center cursor-pointer"),onClick:()=>{l.current&&l.current.click()},children:[(0,i.jsx)(sy.Z,{size:18,strokeWidth:1.5,className:"text-foreground"}),(0,i.jsx)("p",{className:"text-xs text-foreground-light",children:"Upload logo"})]}),(0,i.jsx)("input",{multiple:!0,type:"file",ref:l,className:"hidden",accept:"image/png, image/jpeg",onChange:I})]})]})}),(0,i.jsx)(ew.ZP.Separator,{}),(0,i.jsxs)(ew.ZP.Content,{className:"py-4",children:[(0,i.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"prose text-sm",children:"Authorization callback URLs"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"All URLs must use HTTPS, except for localhost"})]}),(0,i.jsx)(F.z,{onClick:()=>S(C.concat({id:(0,Q.k$)(),value:""})),children:"Add URL"})]}),(0,i.jsxs)("div",{className:"space-y-2 pb-2",children:[C.map(e=>(0,i.jsx)(h.Z,{value:e.value,onChange:t=>A(e.id,t.target.value),placeholder:"e.g https://my-website.com",actions:[C.length>1?(0,i.jsx)(F.z,{type:"default",onClick:()=>T(e.id),children:"Remove"},"remove-url"):null]},e.id)),w.urls&&(0,i.jsx)("p",{className:"text-red-900 text-sm",children:w.urls})]})]}),(0,i.jsx)(ew.ZP.Separator,{}),(0,i.jsxs)("div",{className:"p-6 ",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between space-x-4 pb-4",children:[(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("span",{className:"prose text-sm",children:"Application permissions"}),(0,i.jsx)("span",{className:"text-sm text-foreground-light",children:"The application permissions are organized in scopes and will be presented to the user when adding an app to their organization and all of its projects."})]}),(0,i.jsx)(F.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{}),children:(0,i.jsx)(X(),{href:"https://supabase.com/docs/guides/platform/oauth-apps/oauth-scopes",target:"_blank",rel:"noreferrer",children:"Documentation"})})]}),(0,i.jsx)(sC,{scopes:k,setScopes:E})]})]}),(0,i.jsx)(ew.ZP.Separator,{}),(0,i.jsx)(ew.ZP.Content,{children:(0,i.jsxs)("div",{className:"pt-2 pb-3 flex items-center justify-between",children:[(0,i.jsx)(F.z,{type:"default",onClick:()=>j(!0),disabled:0===r.name.length||0===r.website.length,children:"Preview consent for users"}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(F.z,{type:"default",disabled:x,onClick:()=>s(),children:"Cancel"}),(0,i.jsx)(F.z,{htmlType:"submit",loading:x,disabled:x,children:"Confirm"})]})]})})]}),(0,i.jsxs)(eM.C,{hideFooter:!0,className:"!max-w-[600px]",visible:g,onCancel:()=>j(!1),children:[(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("div",{className:"pt-4 pb-2 px-2 flex items-center justify-between",children:[(0,i.jsxs)("p",{children:["Authorize API access for ",r.name]}),(0,i.jsx)(eT.C,{variant:"brand",children:"Preview"})]})}),(0,i.jsx)(eM.C.Separator,{}),(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("div",{className:"px-2 py-4",children:[(0,i.jsx)(sb.Z,{icon:b||null,name:r.name,domain:r.website,scopes:k}),(0,i.jsxs)("div",{className:"pt-4 space-y-2",children:[(0,i.jsx)("p",{className:"prose text-sm",children:"Select an organization to grant API access to"}),(0,i.jsx)("div",{className:"border border-control text-foreground-light rounded px-4 py-2 text-sm bg-surface-200",children:"Organizations that you have access to will be listed here"})]})]})}),(0,i.jsx)(eM.C.Separator,{}),(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("div",{className:"pt-2 pb-3 flex items-center justify-between",children:[(0,i.jsx)("p",{className:"prose text-xs",children:"This is what your users will see when authorizing with your app"}),(0,i.jsx)(F.z,{type:"default",onClick:()=>j(!1),children:"Close"})]})})]})]})}})})})};async function sk(e){let{id:t,slug:n}=e;if(!t)throw Error("App ID is required");if(!n)throw Error("Organization slug is required");let s=await (0,y.v_)("".concat(b.T5,"/organizations/").concat(n,"/oauth/apps/").concat(t,"/revoke"),{});if(s.error)throw s.error;return s}let sE=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>sk(e),{async onSuccess(t,n,a){let{slug:i}=n;await s.invalidateQueries(n7(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to revoke application: ".concat(e.message)):t(e,n,s)},...n})};var sA=e=>{let{selectedApp:t,onClose:n}=e,{slug:s}=(0,c.UO)(),{mutate:a,isLoading:r}=sE({onSuccess:()=>{u.ZP.success('Successfully revoked the app "'.concat(null==t?void 0:t.name,'"')),n()}}),l=async()=>s?(null==t?void 0:t.id)?void a({slug:s,id:null==t?void 0:t.id}):console.error("App ID is required"):console.error("Slug is required");return(0,i.jsx)(eM.C,{size:"medium",alignFooter:"right",header:"Confirm to revoke ".concat(null==t?void 0:t.name),visible:void 0!==t,loading:r,onCancel:n,onConfirm:l,children:(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("div",{className:"py-4",children:[(0,i.jsxs)(ec.b,{withIcon:!0,variant:"warning",title:"This action cannot be undone",children:[null==t?void 0:t.name," application will no longer have access to your organization's settings and projects."]}),(0,i.jsx)("ul",{className:"mt-4 space-y-5",children:(0,i.jsxs)("li",{className:"flex gap-3 text-sm",children:[(0,i.jsx)(so.Z,{w:14,className:"flex-shrink-0"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Before you remove this app, consider:"}),(0,i.jsx)("ul",{className:"space-y-2 mt-2",children:(0,i.jsx)("li",{className:"list-disc ml-4",children:"No users are currently using this application. The application will no longer have access to your organization after being revoked."})})]})]})})]})})})},sT=()=>{var e,t,n,s;let{slug:a}=(0,c.UO)(),[l,o]=(0,d.useState)(!1),[u,m]=(0,d.useState)(),[p,f]=(0,d.useState)(),[g,v]=(0,d.useState)(),[y,b]=(0,d.useState)(),{data:N,error:w,isLoading:_,isSuccess:C,isError:S}=ss({slug:a}),k=null==N?void 0:N.sort((e,t)=>Number(new Date(e.created_at))-Number(new Date(t.created_at))),{data:E,isLoading:A,isSuccess:T,isError:I}=st({slug:a}),Z=null==E?void 0:E.sort((e,t)=>Number(new Date(e.authorized_at))-Number(new Date(t.authorized_at)));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.gW,{children:[(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:"Published Apps"}),(0,i.jsx)("p",{className:"text-foreground-light text-sm",children:"Build integrations that extend Supabase's functionality"})]}),(0,i.jsx)(F.z,{type:"primary",onClick:()=>o(!0),children:"Add application"})]}),_&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),S&&(0,i.jsx)(x.Z,{error:w,subject:"Failed to retrieve published OAuth apps"}),void 0!==u&&(0,i.jsxs)(ec.b,{withIcon:!0,variant:"success",title:"Successfully published a new application!",children:[(0,i.jsx)("div",{className:"absolute top-4 right-4",children:(0,i.jsx)(F.z,{type:"text",icon:(0,i.jsx)(tE.Z,{size:18}),className:"px-1",onClick:()=>m(void 0)})}),(0,i.jsxs)("div",{className:"w-full space-y-4",children:[(0,i.jsx)("p",{className:"text-sm",children:"Ensure that you store the client secret securely - you will not be able to see it again."}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)(h.Z,{copy:!0,readOnly:!0,size:"small",label:"Client ID",className:"max-w-xl input-mono",value:u.client_id,onChange:()=>{}}),(0,i.jsx)(h.Z,{copy:!0,readOnly:!0,size:"small",label:"Client secret",className:"max-w-xl input-mono",value:u.client_secret,onChange:()=>{}})]})]})]}),C&&(0,i.jsx)(i.Fragment,{children:(null!==(e=null==N?void 0:N.length)&&void 0!==e?e:0)===0?(0,i.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between mt-4",children:(0,i.jsx)("p",{className:"prose text-sm",children:"You do not have any published applications yet"})}):(0,i.jsx)(ef.Z,{head:[(0,i.jsx)(ef.Z.th,{className:"w-[30px]"},"icon"),(0,i.jsx)(ef.Z.th,{children:"Name"},"name"),(0,i.jsx)(ef.Z.th,{children:"Client ID"},"client-id"),(0,i.jsx)(ef.Z.th,{children:"Client Secret"},"client-secret"),(0,i.jsx)(ef.Z.th,{children:"Created at"},"created-at"),(0,i.jsx)(ef.Z.th,{},"delete-action")],body:null!==(t=null==k?void 0:k.map(e=>(0,i.jsx)(sh,{app:e,onSelectEdit:()=>{o(!0),f(e)},onSelectDelete:()=>v(e)},e.id)))&&void 0!==t?t:[]})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:"Authorized Apps"}),(0,i.jsx)("p",{className:"text-foreground-light text-sm",children:"Applications that have access to your organization's settings and projects"}),(0,i.jsxs)("div",{className:"mt-4",children:[A&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),I&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve authorized apps"}),T&&(0,i.jsx)(i.Fragment,{children:(null!==(n=E.length)&&void 0!==n?n:0)===0?(0,i.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,i.jsx)("p",{className:"prose text-sm",children:"You do not have any authorized applications yet"})}):(0,i.jsx)(ef.Z,{className:"mt-4",head:[(0,i.jsx)(ef.Z.th,{className:"w-[30px]"},"icon"),(0,i.jsx)(ef.Z.th,{children:"Name"},"name"),(0,i.jsx)(ef.Z.th,{children:"Authorized at"},"authorized-at"),(0,i.jsx)(ef.Z.th,{},"delete-action")],body:null!==(s=null==Z?void 0:Z.map(e=>(0,i.jsx)(si,{app:e,onSelectRevoke:()=>b(e)},e.id)))&&void 0!==s?s:[]})})]})]})]}),(0,i.jsx)(sS,{visible:l,selectedApp:p,onClose:()=>{f(void 0),o(!1)},onCreateSuccess:m}),(0,i.jsx)(sc,{selectedApp:g,onClose:()=>v(void 0)}),(0,i.jsx)(sA,{selectedApp:y,onClose:()=>b(void 0)})]})},sI=n(68806);async function sZ(e){let{slug:t,gotrueId:n}=e,s=await (0,y.$v)("".concat(b.T5,"/organizations/").concat(t,"/members/").concat(n));if(s.error)throw s.error;return s}let sz=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>sZ(e),{async onSuccess(t,n,a){let{slug:i}=n;await Promise.all([s.invalidateQueries(N.O.members(i)),s.invalidateQueries(N.O.roles(i))]),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to remove member: ".concat(e.message)):t(e,n,s)},...n})};var sP=n(96551),sR=n(74067),sL=n(74138),sO=n(1842),sD=n.n(sO),sF=n(48601);async function sU(e){let{slug:t,invitedEmail:n,ownerId:s,roleId:a}=e,i=await (0,y.v_)("".concat(b.T5,"/organizations/").concat(t,"/members/invite"),{invited_email:n,owner_id:s,role_id:a});if(i.error)throw i.error;return i}let sM=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>sU(e),{async onSuccess(t,n,a){let{slug:i}=n;await Promise.all([s.invalidateQueries(N.O.members(i)),s.invalidateQueries(N.O.roles(i))]),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to invite member: ".concat(e.message)):t(e,n,s)},...n})};var sq=n(4191),sB=e=>{let{orgId:t,userId:n,members:s=[],roles:a=[],rolesAddable:r=[]}=e,{slug:x}=(0,c.UO)(),[f,g]=(0,d.useState)(!1),{permissions:j}=(0,l.Rc)(),v=a.some(e=>{let{id:n}=e;return(0,l.G8)(j,o.KA.CREATE,"user_invites",{resource:{role_id:n}},t)}),y={email:"",role:""},b=(0,sF.object)({email:(0,sF.string)().email("Must be a valid email address").required("Email is required"),role:(0,sF.string)().required("Role is required")}),{mutate:N,isLoading:w}=sM(),_=async(e,t)=>{let{resetForm:a}=t;if(!x)throw Error("slug is required");let i=s.find(t=>t.primary_email===e.email.toLowerCase());if(void 0!==i)return i.invited_id?(0,u.ZP)("User has already been invited to this organization"):(0,u.ZP)("User is already in this organization");let r=Number(e.role);N({slug:x,invitedEmail:e.email.toLowerCase(),ownerId:n,roleId:r},{onSuccess:e=>{sD()(e)?u.ZP.error("Failed to add member"):(u.ZP.success("Successfully added new member"),g(!f),a({initialValues:{...y,role:r}}))}})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{asChild:!0,children:(0,i.jsx)(F.z,{disabled:!v,onClick:()=>g(!0),children:"Invite"})}),!v&&(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to invite a member to this organization"})})]})})]}),(0,i.jsx)(eM.C,{hideFooter:!0,size:"medium",layout:"vertical",className:"!overflow-visible",visible:f,onCancel:()=>g(!1),header:"Invite a member to this organization",children:(0,i.jsx)(m.Z,{validationSchema:b,initialValues:y,onSubmit:_,children:e=>{let{values:t,resetForm:n}=e;(0,d.useEffect)(()=>{if(a){var e,t;n({values:{...y,role:null===(e=a.find(e=>"Developer"===e.name))||void 0===e?void 0:e.id},initialValues:{...y,role:null===(t=a.find(e=>"Developer"===e.name))||void 0===t?void 0:t.id}})}},[a]);let s=a.find(e=>e.id===Number(t.role)),l=t.role&&!r.includes(Number(t.role));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eM.C.Content,{children:(0,i.jsx)("div",{className:"w-full py-4",children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("div",{className:"space-y-2",children:a&&(0,i.jsx)(p.Z,{id:"role",name:"role",label:"Member role",error:l?"You need additional permissions to assign users the role of ".concat(null==s?void 0:s.name):"",children:a.map(e=>(0,i.jsx)(p.Z.Option,{value:e.id,label:e.name,children:e.name},e.id))})}),(0,i.jsx)(h.Z,{autoFocus:!0,id:"email",icon:(0,i.jsx)(sq.Z,{}),placeholder:"Enter email address",label:"Email address"})]})})}),(0,i.jsx)(eM.C.Separator,{}),(0,i.jsx)(eM.C.Content,{children:(0,i.jsx)("div",{className:"pt-2 pb-3",children:(0,i.jsx)(F.z,{block:!0,size:"medium",htmlType:"submit",disabled:w||l,loading:w,children:"Invite new member"})})})]})}})})]})};async function sW(e){let{slug:t,gotrueId:n,roleId:s}=e,a=await (0,y.r$)("".concat(b.T5,"/organizations/").concat(t,"/members/").concat(n),{role_id:s});if(a.error)throw a.error;return a}let sG=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>sW(e),{async onSuccess(t,n,a){let{slug:i}=n;await Promise.all([s.invalidateQueries(N.O.members(i)),s.invalidateQueries(N.O.roles(i))]),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to update member: ".concat(e.message)):t(e,n,s)},...n})};var sH=n(55446);function sY(e){let t=new Date(e);return!((new Date().valueOf()-t.valueOf())/1e3/60/60<24)}let sV=e=>{if(!e)return"";let{username:t,primary_email:n,invited_id:s}=e||{};return void 0!==s?n:t||""};async function sK(e){let{slug:t,invitedId:n}=e,s=await (0,y.$v)("".concat(b.T5,"/organizations/").concat(t,"/members/invite?invited_id=").concat(n),{});if(s.error)throw s.error;return s}let sX=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,S.D)(e=>sK(e),{async onSuccess(t,n,a){let{slug:i,invalidateDetail:r}=n;await Promise.all([...null==r||r?[s.invalidateQueries(N.O.members(i))]:[],s.invalidateQueries(N.O.roles(i))]),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?u.Am.error("Failed to revoke invitation: ".concat(e.message)):t(e,n,s)},...n})},sQ=(e,t,n)=>{let{permissions:s,organizationId:a}=(0,l.Rc)(n,e,void 0!==n&&void 0!==e),i=[],r=[];return t&&e&&t.forEach(e=>{(0,l.G8)(s,o.KA.CREATE,"auth.subject_roles",{resource:{role_id:e.id}},a)&&i.push(e.id),(0,l.G8)(s,o.KA.DELETE,"auth.subject_roles",{resource:{role_id:e.id}},a)&&r.push(e.id)}),{rolesAddable:i,rolesRemovable:r}},s$=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter(e=>{var n;let[s]=null!==(n=e.role_ids)&&void 0!==n?n:[],a=t.find(e=>e.id===s);return(null==a?void 0:a.name)==="Owner"&&!e.invited_at}).length>1};var sJ=e=>{var t,n,s;let{member:a,roles:r}=e,{slug:m}=(0,c.UO)(),h=(0,l.N3)("organization_members:delete"),p=(0,l.lL)(),{data:x}=(0,sP.j)(),{rolesRemovable:f}=sQ(null==p?void 0:p.id,r,null!=x?x:[]),g=a.invited_id,j=null!==(n=null===(t=a.role_ids)||void 0===t?void 0:t[0])&&void 0!==n?n:-1,v=f.includes((null!==(s=null==a?void 0:a.role_ids)&&void 0!==s?s:[-1])[0]),y=(0,l.Xo)(o.KA.CREATE,"user_invites",{resource:{role_id:j}}),b=(0,l.Xo)(o.KA.DELETE,"user_invites",{resource:{role_id:j}}),[N,w]=(0,d.useState)(!1),{mutate:_,isLoading:C}=sz({onSuccess:()=>{u.ZP.success("Successfully removed ".concat(a.primary_email)),w(!1)}}),{mutate:S,isLoading:k}=sM({onSuccess:()=>{u.ZP.success("Resent the invitation.")},onError:e=>{u.ZP.error("Failed to resend invitation: ".concat(e.message))}}),{mutate:E,isLoading:A}=sX(),T=async()=>m?a.gotrue_id?void _({slug:m,gotrueId:a.gotrue_id}):console.error("gotrue_id is required"):console.error("slug is required"),I=async e=>{var t;let n=(null!==(t=null==e?void 0:e.role_ids)&&void 0!==t?t:[])[0],s=e.invited_id;return m?s?void E({slug:m,invitedId:s,invalidateDetail:!1},{onSuccess:()=>{S({slug:m,invitedEmail:e.primary_email,ownerId:s,roleId:n})}}):console.error("Member invited ID is required"):console.error("Slug is required")},Z=async e=>{let t=e.invited_id;return m?t?void E({slug:m,invitedId:t},{onSuccess:()=>{u.ZP.success("Successfully revoked the invitation.")}}):console.error("Member invited ID is required"):console.error("Slug is required")};if(!v||g&&!y&&!b)return(0,i.jsx)("div",{className:"flex items-center justify-end",children:(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{asChild:!0,children:(0,i.jsx)(F.z,{type:"text",icon:(0,i.jsx)(eO.Z,{})})}),(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to manage this team member"})})]})})]})});let z=C||A||k;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"flex items-center justify-end",children:(0,i.jsxs)(eL.h_,{children:[(0,i.jsx)(eL.$F,{asChild:!0,children:(0,i.jsx)(F.z,{type:"text",disabled:z,loading:z,children:(0,i.jsx)(eO.Z,{})})}),(0,i.jsx)(eL.AW,{side:"bottom",align:"end",children:(0,i.jsx)(i.Fragment,{children:g?(0,i.jsxs)(i.Fragment,{children:[b&&(0,i.jsx)(eL.Xi,{onClick:()=>Z(a),children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("p",{children:"Cancel invitation"}),(0,i.jsx)("p",{className:"block opacity-50",children:"Revoke this invitation."})]})}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eL.VD,{}),(0,i.jsx)(eL.Xi,{onClick:()=>I(a),children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("p",{children:"Resend invitation"}),(0,i.jsx)("p",{className:"block opacity-50",children:"Invites expire after 24hrs."})]})})]})]}):h&&(0,i.jsxs)(eL.Xi,{className:"space-x-2",onClick:()=>{w(!0)},children:[(0,i.jsx)(sa.Z,{size:16}),(0,i.jsx)("p",{children:"Remove member"})]})})})]})}),(0,i.jsx)(sL.Z,{visible:N,title:"Confirm to remove",confirmLabel:"Remove",onCancel:()=>w(!1),onConfirm:()=>{T()},children:(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to remove ",a.primary_email]})})]})},s0=e=>{var t,n;let{member:s,roles:a,isLoadingRoles:r=!1,showMfaEnabledColumn:o=!1,setUserRoleChangeModalVisible:c,setSelectedMember:m}=e,{profile:h}=(0,sR.Un)(),x=(0,l.lL)(),{data:f}=(0,sP.j)(),{rolesAddable:g,rolesRemovable:j}=sQ(null==x?void 0:x.id,a,null!=f?f:[]),[v]=null!==(n=s.role_ids)&&void 0!==n?n:[],y=(a||[]).find(e=>e.id===v),b=s.primary_email==(null==h?void 0:h.primary_email),N=!!s.invited_id,w=j.includes(v),_=!w||b||N,C=s.username===s.primary_email,S=!!(null===(t=s.primary_email)||void 0===t?void 0:t.endsWith("customer.fly.io")),[k,E]=(0,d.useState)(!1);return(0,i.jsxs)(ef.Z.tr,{children:[(0,i.jsx)(ef.Z.td,{children:(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("div",{children:N||C||S||k?(0,i.jsx)("div",{className:"w-[40px] h-[40px] bg-surface-100 border border-overlay rounded-full text-foreground-lighter flex items-center justify-center",children:(0,i.jsx)(nQ.Z,{strokeWidth:1.5})}):(0,i.jsx)(nY(),{alt:s.username,src:"https://github.com/".concat(s.username,".png?size=80"),width:"40",height:"40",className:"border rounded-full",onError:()=>{E(!0)}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-foreground",children:sV(s)}),void 0===N&&(0,i.jsx)("p",{className:"text-foreground-light",children:s.primary_email})]})]})}),(0,i.jsx)(ef.Z.td,{children:N&&s.invited_at&&(0,i.jsx)(eT.C,{variant:sY(s.invited_at)?"destructive":"warning",children:sY(s.invited_at)?"Expired":"Invited"})}),o&&(0,i.jsx)(ef.Z.td,{children:(0,i.jsx)("div",{className:"flex items-center justify-center",children:s.mfa_enabled?(0,i.jsx)(e9.Z,{className:"text-brand",strokeWidth:2}):(0,i.jsx)(tE.Z,{className:"text-foreground-light",strokeWidth:1.5})})}),(0,i.jsx)(ef.Z.td,{children:r?(0,i.jsx)("div",{className:"w-[140px]",children:(0,i.jsx)(tj.Z,{className:"animate-spin",size:16,strokeWidth:1.5})}):void 0!==y?(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{className:"w-[140px]",asChild:!0,children:(0,i.jsx)("div",{children:(0,i.jsx)(p.Z,{className:_?"pointer-events-none":"",disabled:_,value:y.id,onChange:e=>{var t;if(!y||y.id===e)return;let n=(a||[]).find(t=>t.id===e);if(!g.includes(null!==(t=null==n?void 0:n.id)&&void 0!==t?t:-1))return u.ZP.error("You do not have permission to update this team member to ".concat(n.name));c(!0),m({...s,oldRoleId:y.id,newRoleId:e})},children:a.map(e=>(0,i.jsx)(p.Z.Option,{value:e.id,label:e.name,disabled:_,className:"w-36",children:e.name},e.id))})})}),N?(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"Role can only be changed after the user has accepted the invite"})})]})}):b||w?(0,i.jsx)(i.Fragment,{}):(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to manage this team member"})})]})})]}):(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"Invalid role"}),(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{children:(0,i.jsx)(tv.Z,{size:16,strokeWidth:1.5})}),(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"This user has an invalid role, please reach out to us via support"})})]})})]})]})}),(0,i.jsx)(ef.Z.td,{children:!b&&(0,i.jsx)(sJ,{member:s,roles:a})})]})};let s1=[{title:"Organization",actions:[{description:"Can change organization name",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!1}},{description:"Can delete organization",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!1}}]},{title:"Members",actions:[{description:"Can add an Owner",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!1}},{description:"Can remove an Owner",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!1}},{description:"Can add an Adminstrator",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can remove an Administrator",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can add a Developer",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can remove a Developer",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can revoke an invite",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can resend an invite",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}}]},{title:"Billing",actions:[{description:"Can read invoices",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can read billing email",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can change billing email",permissions:{owner:!0,admin:!1,developer:!1,read_only:!1,billing_only:!0}},{description:"Can view subscription",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can update subscription",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!0}},{description:"Can read billing address",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can update billing address",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!0}},{description:"Can read tax codes",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can update tax codes",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!0}},{description:"Can read payment methods",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!0}},{description:"Can update payment methods",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!0}}]},{title:"Projects",actions:[{description:"Can view projects",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can delete a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can update a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can pause a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can resume a project",permissions:{owner:!0,admin:!0,developer:!1,read_only:!1,billing_only:!1}},{description:"Can restart a project",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read API anon keys",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can read API secret keys",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read JWT secret",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can generate new JWT secret",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can update API settings",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}}]},{title:"Database",actions:[{description:"Can read tables",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update/delete tables",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read RLS policies",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can read create/update/delete RLS policies",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database extensions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can read update database extensions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read scheduled database backups",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can trigger a scheduled database backup",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read PITR database backups",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can trigger a PITR database backup",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database publications",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can update database publications",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database triggers",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update/delete database triggers",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database functions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update/delete database functions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read database webhooks",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update/delete database webhooks",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}}]},{title:"SQL Editor",actions:[{description:"Can run a SELECT-based query",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can run all other types of queries",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can create/update/delete queries",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}}]},{title:"Storage",actions:[{description:"Can access storage",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}}]},{title:"Authentication",actions:[{description:"Can view users",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can remove users",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can invite users",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can read authentication settings",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can update authentication settings",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}},{description:"Can view authentication logs",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}}]},{title:"Edge Functions",actions:[{description:"Can view edge functions",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}}]},{title:"Logs Explorer",actions:[{description:"Can view logs explorer",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create queries in the logs explorer",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}}]},{title:"Reports",actions:[{description:"Can view reports",permissions:{owner:!0,admin:!0,developer:!0,read_only:!0,billing_only:!1}},{description:"Can create/update a report",permissions:{owner:!0,admin:!0,developer:!0,read_only:!1,billing_only:!1}}]}];var s2=()=>{let[e,t]=(0,d.useState)(!1),n="w-[40%] text-sm pl-4 font-bold",s="w-[12%] text-sm h-8 flex items-center justify-center border-l border-control font-bold",a=(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{children:(0,i.jsx)(q.Z,{size:14,strokeWidth:2})}),(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"top",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"Only available in Team/Enterprise plan."})})]})})]});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(no.Z,{size:16,strokeWidth:1.5,className:"cursor-pointer transition hover:text-foreground",onClick:()=>t(!e)}),(0,i.jsx)(eM.C,{closable:!0,hideFooter:!0,visible:e,size:"xxlarge",header:"Permissions for each role",onCancel:()=>t(!e),children:(0,i.jsxs)("div",{className:"space-y-4 py-4",children:[(0,i.jsx)(eM.C.Content,{children:(0,i.jsx)("p",{className:"text-sm",children:"The following table shows the corresponding permissions for each available role in the dashboard."})}),(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("div",{className:"rounded border border-default bg-surface-200",children:[(0,i.jsxs)("div",{className:"flex items-center border-b border-control",children:[(0,i.jsx)("div",{className:n,children:"Permissions"}),(0,i.jsx)("div",{className:s,children:"Owner"}),(0,i.jsx)("div",{className:s,children:"Administrator"}),(0,i.jsx)("div",{className:s,children:"Developer"}),(0,i.jsxs)("div",{className:s,children:["Read-only\xa0",a]}),(0,i.jsxs)("div",{className:s,children:["Billing-only\xa0",a]})]}),(0,i.jsx)("div",{className:"max-h-[425px] overflow-y-auto",children:s1.map(e=>(0,i.jsxs)(d.Fragment,{children:[(0,i.jsx)("div",{className:"flex items-center border-b border-control py-2 px-4 last:border-none",children:(0,i.jsx)("div",{className:"w-[100%] text-sm",children:e.title})}),e.actions.map((t,a)=>(0,i.jsxs)("div",{className:"flex items-center border-b border-control bg-overlay-hover last:border-none",children:[(0,i.jsx)("div",{className:n,children:t.description}),(0,i.jsx)("div",{className:s,children:t.permissions.owner&&(0,i.jsx)(e9.Z,{size:14,strokeWidth:2})}),(0,i.jsx)("div",{className:s,children:t.permissions.admin&&(0,i.jsx)(e9.Z,{size:14,strokeWidth:2})}),(0,i.jsx)("div",{className:s,children:t.permissions.developer&&(0,i.jsx)(e9.Z,{size:14,strokeWidth:2})}),(0,i.jsx)("div",{className:s,children:t.permissions.read_only&&(0,i.jsx)(e9.Z,{size:14,strokeWidth:2})}),(0,i.jsx)("div",{className:s,children:t.permissions.billing_only&&(0,i.jsx)(e9.Z,{size:14,strokeWidth:2})})]},"".concat(e.title,"-").concat(a)))]},e.title))})]})})]})})]})},s4=e=>{var t;let{searchString:n}=e,{slug:s}=(0,c.UO)(),{data:a,error:r,isLoading:l,isError:o,isSuccess:m}=n3({slug:s}),{data:h,error:p,isLoading:f,isError:g}=n8({slug:s}),{mutate:v,isLoading:y}=sG({onSuccess(){k(!1),u.ZP.success("Successfully updated role for ".concat(sV(_)))},onError(e){u.ZP.error("Failed to update role for ".concat(sV(_),": ").concat(e.message))}}),b=null!=a?a:[],N=null!==(t=null==h?void 0:h.roles)&&void 0!==t?t:[],w=b.some(e=>void 0!==e.gotrue_id&&void 0!==e.mfa_enabled),[_,C]=(0,d.useState)(),[S,k]=(0,d.useState)(!1),E=(n?b.filter(e=>{var t,s;return e.invited_at?null===(t=e.primary_email)||void 0===t?void 0:t.includes(n):e.gotrue_id?e.username.includes(n)||(null===(s=e.primary_email)||void 0===s?void 0:s.includes(n)):void 0}):b).slice().sort((e,t)=>e.username.localeCompare(t.username)),A=e=>{var t;return N?null===(t=N.find(t=>t.id===e))||void 0===t?void 0:t.name:e},T=async()=>{if(!_)return;let{gotrue_id:e,newRoleId:t}=_;return s?e?void v({slug:s,gotrueId:e,roleId:t}):console.error("gotrue_id is required"):console.error("slug is required")};return(0,i.jsxs)(i.Fragment,{children:[l&&(0,i.jsx)(j.A,{}),o&&(0,i.jsx)(x.Z,{error:r,subject:"Failed to retrieve organization members"}),g&&(0,i.jsx)(x.Z,{error:p,subject:"Failed to retrieve organization roles"}),m&&(0,i.jsx)("div",{className:"rounded w-full",children:(0,i.jsx)(sH.Z,{active:!E,children:(0,i.jsx)(ef.Z,{head:[(0,i.jsx)(ef.Z.th,{children:"User"},"header-user"),(0,i.jsx)(ef.Z.th,{},"header-status"),...w?[(0,i.jsx)(ef.Z.th,{className:"text-center",children:"Enabled MFA"},"header-mfa")]:[],(0,i.jsxs)(ef.Z.th,{className:"flex items-center space-x-2",children:[(0,i.jsx)("span",{children:"Role"}),(0,i.jsx)(s2,{})]},"header-role"),(0,i.jsx)(ef.Z.th,{},"header-action")],body:[...E.map(e=>(0,i.jsx)(s0,{member:e,roles:N,isLoadingRoles:f,showMfaEnabledColumn:w,setUserRoleChangeModalVisible:k,setSelectedMember:C},e.gotrue_id)),...n.length>0&&0===E.length?[(0,i.jsx)(ef.Z.tr,{className:"bg-panel-secondary-light",children:(0,i.jsx)(ef.Z.td,{colSpan:12,children:(0,i.jsxs)("div",{className:"flex items-center space-x-3 opacity-75",children:[(0,i.jsx)(tv.Z,{size:16,strokeWidth:2}),(0,i.jsxs)("p",{className:"text-foreground-light",children:['No users matched the search query "',n,'"']})]})})},"no-results")]:[],(0,i.jsx)(ef.Z.tr,{className:"bg-panel-secondary-light",children:(0,i.jsx)(ef.Z.td,{colSpan:12,children:(0,i.jsxs)("p",{className:"text-foreground-light",children:[n?"".concat(E.length," of "):"",b.length||"0"," ",1==b.length?"user":"users"]})})},"footer")]})})}),(0,i.jsx)(eM.C,{hideFooter:!0,size:"medium",visible:S,onCancel:()=>k(!1),header:"Change role of member",children:(0,i.jsxs)("div",{className:"flex flex-col gap-2 py-4",children:[(0,i.jsxs)(eM.C.Content,{children:[(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["You are changing the role of"," ",(0,i.jsx)("span",{className:"text-foreground",children:sV(_)})," from"," ",(0,i.jsx)("span",{className:"text-foreground",children:A(null==_?void 0:_.oldRoleId)})," ","to"," ",(0,i.jsx)("span",{className:"text-foreground",children:A(null==_?void 0:_.newRoleId)})]}),(0,i.jsx)("p",{className:"mt-3 text-sm text-foreground",children:"By changing the role of this member their permissions will change."})]}),(0,i.jsx)(eM.C.Separator,{}),(0,i.jsx)(eM.C.Content,{children:(0,i.jsxs)("div",{className:"flex gap-3",children:[(0,i.jsx)(F.z,{type:"default",block:!0,size:"medium",onClick:()=>k(!1),children:"Cancel"}),(0,i.jsx)(F.z,{block:!0,type:"warning",size:"medium",disabled:y,loading:y,onClick:()=>T(),children:"Confirm"})]})})]})})]})},s3=()=>{var e;let{slug:t}=(0,c.UO)(),{organizationMembersCreate:n,organizationMembersDelete:s}=(0,l.N3)(["organization_members:create","organization_members:delete"]),{profile:a}=(0,sR.Un)(),o=(0,l.lL)(),m=null==o?void 0:o.is_owner,{data:p}=(0,sP.j)(),{data:x}=n8({slug:t}),{data:f}=n3({slug:t}),g=null!==(e=null==x?void 0:x.roles)&&void 0!==e?e:[],{rolesAddable:j}=sQ(null==o?void 0:o.id,g,null!=p?p:[]),[v,y]=(0,d.useState)(!1),[b,N]=(0,d.useState)(""),w=j.length>0,_=!m||m&&s$(f,g),{mutate:C}=sz({onSuccess:()=>{var e;y(!1),k(!1),null===(e=window)||void 0===e||e.location.replace("/")},onError:e=>{y(!1),u.ZP.error("Failed to leave organization: ".concat(null==e?void 0:e.message))}}),[S,k]=(0,d.useState)(!1),E=async()=>{if(!t)return console.error("Org slug is required");y(!0),C({slug:t,gotrueId:a.gotrue_id})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.gW,{children:(0,i.jsxs)(r.tM,{children:[(0,i.jsxs)(r.Wv,{className:"justify-between",children:[(0,i.jsx)(h.Z,{icon:(0,i.jsx)(sI.Z,{size:12}),size:"small",value:b,onChange:e=>N(e.target.value),name:"email",id:"email",placeholder:"Filter members"}),(0,i.jsxs)(r.ur,{children:[n&&w&&void 0!==a&&void 0!==o&&(0,i.jsx)("div",{children:(0,i.jsx)(sB,{orgId:o.id,userId:a.id,members:null!=f?f:[],roles:g,rolesAddable:j})}),s&&(0,i.jsx)("div",{children:(0,i.jsxs)(B.fC,{delayDuration:0,children:[(0,i.jsx)(B.xz,{asChild:!0,children:(0,i.jsx)(F.z,{type:"default",disabled:!_,onClick:()=>k(!0),loading:v,children:"Leave team"})}),!_&&(0,i.jsx)(B.h_,{children:(0,i.jsxs)(B.VY,{side:"bottom",children:[(0,i.jsx)(B.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"An organization requires at least 1 owner"})})]})})]})})]})]}),(0,i.jsx)(r.Lc,{className:"w-full",children:(0,i.jsx)(s4,{searchString:b})})]})}),(0,i.jsx)(sL.Z,{visible:S,title:"Are you sure?",confirmLabel:"Leave",onCancel:()=>k(!1),onConfirm:()=>{E()},children:(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to leave this organization? This is permanent."})})]})},s5=()=>(0,i.jsxs)(r.jX,{children:[(0,i.jsxs)(r.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"Data Processing Addendum (DPA)"}),(0,i.jsxs)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:[(0,i.jsx)("p",{children:"All organizations can access and use our DPA as part of their GDPR compliance. This is only to access the document. Please ignore this if you have sent the signed document to us."}),(0,i.jsxs)("p",{children:["Please review these details and add data specific to user processing where required. Sign and return the signed DPA document to"," ",(0,i.jsx)("a",{href:"mailto:privacy@supabase.com",target:"_blank",className:"text-brand hover:text-brand",children:"privacy@supabase.com"})," ","for the document to be considered executed."]})]})]}),(0,i.jsx)(r.Lc,{className:"flex items-center justify-center h-full",children:(0,i.jsx)("a",{href:"https://supabase.com/downloads/docs/Supabase+DPA+231211.pdf",target:"_blank",rel:"noreferrer noopener",download:!0,children:(0,i.jsx)(F.z,{type:"default",iconRight:(0,i.jsx)(eo.Z,{}),children:"View DPA"})})})]}),s8=()=>(0,i.jsxs)(r.jX,{children:[(0,i.jsxs)(r.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"Transfer Impact Assessment (TIA)"}),(0,i.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,i.jsx)("p",{children:"All organizations can access and use our TIA as part of their GDPR-compliant data transfer process."})})]}),(0,i.jsx)(r.Lc,{className:"flex items-center justify-center h-full",children:(0,i.jsx)("a",{href:"https://supabase.com/downloads/docs/Supabase+TIA+240510.pdf",target:"_blank",rel:"noreferrer noopener",download:!0,children:(0,i.jsx)(F.z,{type:"default",iconRight:(0,i.jsx)(eo.Z,{}),children:"View TIA"})})})]});async function s6(e,t){let{orgSlug:n,docType:s}=e;if(!n)throw Error("orgSlug is required");if("standard-security-questionnaire"===s){let{data:e,error:s}=await (0,R.U2)("/platform/organizations/{slug}/documents/standard-security-questionnaire",{params:{path:{slug:n}},signal:t});return s&&(0,R.S3)(s),e}if("soc2-type-2-report"===s){let{data:e,error:s}=await (0,R.U2)("/platform/organizations/{slug}/documents/soc2-type-2-report",{params:{path:{slug:n}},signal:t});if(s)throw s;return e}}var s9=()=>{let{slug:e}=(0,c.UO)(),{data:t,error:n,isLoading:s,isError:a,isSuccess:l}=(0,z.G)({orgSlug:e}),o=null==t?void 0:t.plan,d=async e=>{try{let t=await s6({orgSlug:e,docType:"standard-security-questionnaire"});(null==t?void 0:t.fileUrl)&&window.open(t.fileUrl,"_blank")}catch(e){u.ZP.error("Failed to download Security Questionnaire: ".concat(e.message))}};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(r.jX,{children:[(0,i.jsxs)(r.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"Standard Security Questionnaire"}),(0,i.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,i.jsx)("p",{children:"Organizations on Teams plan or above have access to our standard security questionnaire."})})]}),(0,i.jsxs)(r.Lc,{children:[s&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),a&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve subscription",error:n}),l&&(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(null==o?void 0:o.id)==="free"||(null==o?void 0:o.id)==="pro"?(0,i.jsx)(X(),{href:"/org/".concat(e,"/billing?panel=subscriptionPlan"),children:(0,i.jsx)(F.z,{type:"default",children:"Upgrade to Teams"})}):(0,i.jsx)(F.z,{type:"default",iconRight:(0,i.jsx)(t6.Z,{}),onClick:()=>{e&&d(e)},children:"Download Questionnaire"})})]})]})})},s7=()=>{let{slug:e}=(0,c.UO)(),{data:t,error:n,isLoading:s,isError:a,isSuccess:l}=(0,z.G)({orgSlug:e}),o=null==t?void 0:t.plan,[m,h]=(0,d.useState)(!1),p=async e=>{try{let t=await s6({orgSlug:e,docType:"soc2-type-2-report"});(null==t?void 0:t.fileUrl)&&window.open(t.fileUrl,"_blank"),h(!1)}catch(e){u.ZP.error("Failed to download SOC2 report: ".concat(e.message))}};return(0,i.jsxs)(r.jX,{children:[(0,i.jsxs)(r.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"SOC2 Type 2"}),(0,i.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,i.jsx)("p",{children:"Organizations on Teams plan or above have access to our most recent SOC2 Type 2 report."})})]}),(0,i.jsxs)(r.Lc,{children:[s&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(j.Z,{}),(0,i.jsx)(j.Z,{className:"w-3/4"}),(0,i.jsx)(j.Z,{className:"w-1/2"})]}),a&&(0,i.jsx)(x.Z,{subject:"Failed to retrieve subscription",error:n}),l&&(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(null==o?void 0:o.id)==="free"||(null==o?void 0:o.id)==="pro"?(0,i.jsx)(X(),{href:"/org/".concat(e,"/billing?panel=subscriptionPlan"),children:(0,i.jsx)(F.z,{type:"default",children:"Upgrade to Teams"})}):(0,i.jsx)(F.z,{type:"default",iconRight:(0,i.jsx)(t6.Z,{}),onClick:()=>h(!0),children:"Download SOC2 Type 2 Report"})}),(0,i.jsx)(sL.Z,{visible:m,size:"large",title:"Non-Disclosure Agreement to access Supabase's SOC2 Report",confirmLabel:"I agree",confirmLabelLoading:"Downloading",onCancel:()=>h(!1),onConfirm:()=>{e&&p(e)},children:(0,i.jsxs)("ol",{className:"list-decimal list-inside text-sm text-foreground-light pl-30",children:[(0,i.jsx)("li",{children:"The information that you are about to access is confidential."}),(0,i.jsx)("li",{children:'Your access to our SOC 2 materials is governed by confidentiality obligations contained in the agreement between Supabase, Inc ("Supabase", "we", "our" or "us") and the Supabase customer that has authorized you to access our platform to obtain this information (our "Customer").'}),(0,i.jsx)("li",{children:"You must ensure that you treat the information in our SOC 2 materials in accordance with those confidentiality obligations, as communicated to you by the Customer."}),(0,i.jsxs)("li",{children:['By clicking "I agree" below or otherwise accessing our SOC 2 materials, you:',(0,i.jsxs)("ol",{className:"list-[lower-roman] list-inside pl-4",children:[(0,i.jsx)("li",{children:"acknowledge that you have read and understood this Confidentiality Notice;"}),(0,i.jsx)("li",{children:"confirm that you have been authorized by the Customer to access this information, and your use of our SOC 2 materials is subject to the confidentiality obligations owed by the Customer to us."})]})]}),(0,i.jsx)("li",{children:"This Confidentiality Notice does not substitute or supersede any agreement between us and the Customer, or any internal rules or policies that the Customer requires you to comply with in your access to and use of confidential information. However, your failure to comply with this Confidentiality Notice may be used to determine whether the Customer has complied with its confidentiality obligations to us."})]})})]})]})},ae=()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(r.jX,{children:[(0,i.jsxs)(r.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"HIPAA"}),(0,i.jsxs)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:[(0,i.jsx)("p",{children:"This is only for HIPAA requests. Please ignore this if you already have HIPAA enabled."}),(0,i.jsx)("p",{children:"Organizations on the Teams plan or above are eligible for a paid HIPAA compliance add-on. You can submit a request here and we will get back to you on the pricing and process for your use case."}),(0,i.jsx)("p",{children:"Organizations on the Free or Pro plan can also submit a request for HIPAA. Note that you are still required to upgrade to the Teams plan after your request is approved."})]})]}),(0,i.jsx)(r.Lc,{children:(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,i.jsx)("a",{href:"https://forms.supabase.com/hipaa2",target:"_blank",rel:"noreferrer noopener",children:(0,i.jsx)(F.z,{type:"default",iconRight:(0,i.jsx)(eo.Z,{}),children:"Request HIPAA"})})})})]})}),at=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r._S,{id:"dpa",children:(0,i.jsx)(s5,{})}),(0,i.jsx)(r.I7,{}),(0,i.jsx)(r._S,{id:"tia",children:(0,i.jsx)(s8,{})}),(0,i.jsx)(r.I7,{}),(0,i.jsx)(r._S,{id:"soc2",children:(0,i.jsx)(s7,{})}),(0,i.jsx)(r.I7,{}),(0,i.jsx)(r._S,{id:"hipaa",children:(0,i.jsx)(ae,{})}),(0,i.jsx)(r.I7,{}),(0,i.jsx)(r._S,{id:"security-questionnaire",children:(0,i.jsx)(s9,{})}),(0,i.jsx)(r.I7,{}),(0,i.jsx)(r._S,{children:(0,i.jsx)(r.jX,{children:(0,i.jsxs)("p",{className:"sticky space-y-6 top-12 text-sm text-foreground-light m-0 whitespace-nowrap",children:[(0,i.jsx)(X(),{href:"/support/new",className:"hover:underline",children:"Submit a support request"})," ","if you require additional documents for financial or tax reasons, such as a W-9 form."]})})})]})},17159:function(e,t,n){"use strict";n.d(t,{m:function(){return h}});var s=n(52322),a=n(5632),i=n(62202),r=n(79044),l=n(14528),o=n(82667),c=n(47852),d=n(62277),u=n(750),m=n(32079);let h=e=>{var t;let{visible:n,onCancel:h,afterSubmit:p}=e,x=(0,a.useRouter)(),f=(0,l.Vm)(),g=null!==(t=null==f?void 0:f.ref)&&void 0!==t?t:"default",{mutate:j,isLoading:v}=(0,r.T)({onSuccess:e=>{i.ZP.success("Successfully created new report");let t=e[0].id;x.push("/project/".concat(g,"/reports/").concat(t)),p()},onError:e=>{i.ZP.error("Failed to create report: ".concat(e.message))}});async function y(e){let{name:t,description:n}=e;g&&j({projectRef:g,payload:{id:(0,o.k$)(),type:"report",name:t,description:n||"",visibility:"project",content:{schema_version:1,period_start:{time_period:"7d",date:""},period_end:{time_period:"today",date:""},interval:"1d",layout:[]}}})}return(0,s.jsx)(c.C,{visible:n,onCancel:h,hideFooter:!0,header:"Create a custom report",size:"small",children:(0,s.jsx)(d.Z,{onReset:h,validateOnBlur:!0,initialValues:{name:"",description:""},validate:e=>{let t={};return e.name||(t.name="Required"),t},onSubmit:e=>y(e),children:()=>(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsx)(c.C.Content,{children:(0,s.jsx)(u.Z,{label:"Name",id:"name",name:"name"})}),(0,s.jsx)(c.C.Content,{children:(0,s.jsx)(u.Z.TextArea,{label:"Description",id:"description",placeholder:"Describe your custom report",size:"medium",textAreaClassName:"resize-none"})}),(0,s.jsx)(c.C.Separator,{}),(0,s.jsx)(c.C.Content,{children:(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,s.jsx)(m.z,{htmlType:"reset",type:"default",onClick:h,disabled:v,children:"Cancel"}),(0,s.jsx)(m.z,{htmlType:"submit",loading:v,disabled:v,children:"Create report"})]})})]})})})}},29779:function(e,t,n){"use strict";n.d(t,{Of:function(){return f},QZ:function(){return m},oo:function(){return p},s8:function(){return v},uE:function(){return h},xY:function(){return x}});var s=n(55281),a=n.n(s),i=n(18149),r=n.n(i),l=n(25877),o=n.n(l),c=n(68871),d=n(82667);let u=e=>{if(["CURRENT_DATE"].includes(e)||"("===e[0]&&")"===e[e.length-1])return!0;let t=e.indexOf("("),n=e.indexOf(")");return!(e.indexOf(" ")>=0)&&t>=0&&n>t},m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{name:t,table:n,schema:s,format:a}=e;return{id:(0,d.k$)(),name:t||"",table:n||"",schema:s||"",comment:"",format:a||"",defaultValue:null,foreignKey:void 0,check:null,isNullable:!0,isUnique:!1,isArray:!1,isPrimaryKey:!1,isIdentity:!1,isNewColumn:!0,isEncrypted:!1}},h=(e,t,n)=>{var s,a;let{primary_keys:i}=t,r=i.map(e=>e.name),l=g(e,t,n),o=(null==e?void 0:e.data_type)==="ARRAY";return{foreignKey:l,id:null!==(s=null==e?void 0:e.id)&&void 0!==s?s:(0,d.k$)(),table:e.table,schema:e.schema,name:e.name,comment:null!==(a=null==e?void 0:e.comment)&&void 0!==a?a:"",format:o?e.format.slice(1):e.format,defaultValue:null==e?void 0:e.default_value,check:e.check,isArray:o,isNullable:e.is_nullable,isIdentity:e.is_identity,isUnique:e.is_unique,isNewColumn:!1,isEncrypted:!1,isPrimaryKey:r.includes(e.name)}},p=(e,t)=>{var n,s;let a=!!t.format.includes("int")&&t.isIdentity,i=t.defaultValue;return{tableId:e,isIdentity:a,name:t.name.trim(),comment:null===(n=t.comment)||void 0===n?void 0:n.trim(),type:t.isArray?"".concat(t.format,"[]"):t.format,check:(null===(s=t.check)||void 0===s?void 0:s.trim())||void 0,isUnique:t.isUnique,isPrimaryKey:t.isPrimaryKey,...!t.isPrimaryKey&&!a&&{isNullable:t.isNullable},...!a&&{defaultValue:t.isArray&&i?j(i):i},...!a&&i&&{defaultValueFormat:o()(i)||u(i)?"expression":"literal"}}},x=(e,t,n)=>{var s,a,i,l,c;let d=t.primary_keys.map(e=>e.name).includes(e.name),m=n.isArray?"".concat(n.format,"[]"):n.format,h=(null!==(l=null===(s=n.comment)||void 0===s?void 0:s.length)&&void 0!==l?l:"")===0?null:n.comment,p={};if(r()(e.name,n.name)||(p.name=n.name),r()(e.comment,h)||(p.comment=h),r()(null===(a=e.check)||void 0===a?void 0:a.trim(),null===(i=n.check)||void 0===i?void 0:i.trim())||(p.check=null===(c=n.check)||void 0===c?void 0:c.trim()),r()(e.format,m)||(p.type=m),!r()(e.default_value,n.defaultValue)){let e=n.defaultValue;p.defaultValue=e,p.defaultValueFormat=o()(e)||u(e)?"expression":"literal"}return r()(e.is_identity,n.isIdentity)||(p.isIdentity=n.isIdentity),r()(e.is_nullable,n.isNullable)||(p.isNullable=n.isNullable),r()(e.is_unique,n.isUnique)||(p.isUnique=n.isUnique),r()(d,n.isPrimaryKey)||(p.isPrimaryKey=n.isPrimaryKey),p},f=e=>{let t={};return 0===e.name.length&&(t.name="Please assign a name for your column"),0===e.format.length&&(t.format="Please select a type for your column"),t},g=(e,t,n)=>{let{relationships:s}=t,i=a()(s,t=>t.source_schema===e.schema&&t.source_table_name===e.table&&t.source_column_name===e.name);if(void 0===i)return i;{var r,l;let e=n.find(e=>e.id===i.id);return{...i,deletion_action:null!==(r=null==e?void 0:e.deletion_action)&&void 0!==r?r:c.N.NO_ACTION,update_action:null!==(l=null==e?void 0:e.update_action)&&void 0!==l?l:c.N.NO_ACTION}}},j=e=>e?e.replaceAll("[","{").replaceAll("]","}"):null,v=e=>{switch(e){case c.N.CASCADE:return"Cascade";case c.N.RESTRICT:return"Restrict";case c.N.SET_DEFAULT:return"Set default";case c.N.SET_NULL:return"Set NULL";default:return}}},55274:function(e,t,n){"use strict";n.d(t,{BB:function(){return c},DL:function(){return x},Ks:function(){return d},N0:function(){return g},VP:function(){return f},XO:function(){return m},YF:function(){return o},ji:function(){return l},lb:function(){return u},nA:function(){return h},vH:function(){return p}});var s=n(829),a=n.n(s),i=n(22487),r=n.n(i);let l=["int2","int4","int8","float4","float8","numeric","double precision"],o=["json","jsonb"],c=["text","varchar"],d=["timestamp","timestamptz"],u=["date"],m=["time","timetz"],h=r()(d,u,m),p=["uuid","bool","vector"],x=a()(r()(l,o,c,h,p)),f={varchar:{alternative:"text",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_varchar.28n.29_by_default"},json:{alternative:"jsonb",reference:"https://www.postgresql.org/docs/current/datatype-json.html"},timetz:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timetz"},timestamp:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timestamp_.28without_time_zone.29"}},g=[{name:"int2",description:"Signed two-byte integer",type:"number"},{name:"int4",description:"Signed four-byte integer",type:"number"},{name:"int8",description:"Signed eight-byte integer",type:"number"},{name:"float4",description:"Single precision floating-point number (4 bytes)",type:"number"},{name:"float8",description:"Double precision floating-point number (8 bytes)",type:"number"},{name:"numeric",description:"Exact numeric of selectable precision",type:"number"},{name:"json",description:"Textual JSON data",type:"json"},{name:"jsonb",description:"Binary JSON data, decomposed",type:"json"},{name:"text",description:"Variable-length character string",type:"text"},{name:"varchar",description:"Variable-length character string",type:"text"},{name:"uuid",description:"Universally unique identifier",type:"text"},{name:"date",description:"Calendar date (year, month, day)",type:"time"},{name:"time",description:"Time of day (no time zone)",type:"time"},{name:"timetz",description:"Time of day, including time zone",type:"time"},{name:"timestamp",description:"Date and time (no time zone)",type:"time"},{name:"timestamptz",description:"Date and time, including time zone",type:"time"},{name:"bool",description:"Logical boolean (true/false)",type:"bool"}]},34420:function(e,t,n){"use strict";n.d(t,{R:function(){return s}});let s=(e,t,n,s,a)=>{let i=(null==s?void 0:s.find(s=>{var i,r;return(null==s?void 0:null===(i=s.metadata)||void 0===i?void 0:i.name)===e&&(null==s?void 0:null===(r=s.metadata)||void 0===r?void 0:r.schema)===a&&(null==s?void 0:s.name)===t&&n.includes(null==s?void 0:s.level)}))||null;return{hasLint:null!==i,count:i?1:0,matchingLint:i}}},24923:function(e,t,n){"use strict";n.d(t,{Z:function(){return G}});var s=n(52322),a=n(59491),i=n(5632),r=n(14782),l=n(34056),o=n(14528),c=n(7929),d=n(99248);let u=(e,t)=>{var n,s,a,i;let r=null!==(n=null==e?void 0:e.ref)&&void 0!==n?n:"default",l=null===(s=null==t?void 0:t.auth)||void 0===s||s,o=null===(a=null==t?void 0:t.storage)||void 0===a||a,c=null===(i=null==t?void 0:t.realtime)||void 0===i||i;return[{title:"Logs Explorer",items:[{key:"explorer",name:"Query",root:!0},d.Qy?{key:"saved",name:"Saved Queries"}:null,{key:"recent",name:"Recent Queries"},{key:"templates",name:"Templates"}].filter(e=>e).map(e=>{let{key:t,name:n,root:s}=e;return{name:n,key:t,url:"/project/".concat(r,"/logs/explorer").concat(s?"":"/"+t),items:[]}})},{title:"Infrastructure",items:[{name:"API Gateway",key:"edge-logs",url:"/project/".concat(r,"/logs/edge-logs"),items:[]},{name:"Postgres",key:"postgres-logs",url:"/project/".concat(r,"/logs/postgres-logs"),items:[]},{name:"PostgREST",key:"postgrest-logs",url:"/project/".concat(r,"/logs/postgrest-logs"),items:[]},d.Qy?{name:"Pooler",key:"pooler-logs",url:"/project/".concat(r,"/logs/pooler-logs"),items:[]}:null,,l?{name:"Auth",key:"auth-logs",url:"/project/".concat(r,"/logs/auth-logs"),items:[]}:null,o?{name:"Storage",key:"storage-logs",url:"/project/".concat(r,"/logs/storage-logs"),items:[]}:null,c?{name:"Realtime",key:"realtime-logs",url:"/project/".concat(r,"/logs/realtime-logs"),items:[]}:null].filter(e=>e)}]};var m=n(3085),h=n(81076),p=n(99959),x=n(18799),f=n(89404),g=n(2784),j=n(62202),v=n(32079),y=n(47852),b=n(22574),N=n(750),w=n(63955),_=n(88883),C=n(30195),S=n(87668);let k=()=>{let[e,t]=(0,g.useState)(!1),n=(0,i.useRouter)(),{ref:a}=(0,p.UO)(),{mutate:r,isLoading:l}=(0,x.$J)({onSuccess:e=>{t(!1),n.push("/project/".concat(a,"/logs/collections/").concat(null==e?void 0:e.token))},onError:e=>{j.ZP.error(e.message)}}),o=C.z.object({name:C.z.string().min(1)}),c=(0,w.cI)({resolver:(0,_.F)(o)});(0,g.useEffect)(()=>{e||c.reset()},[e,c]);let d=c.handleSubmit(async e=>{if(!a){j.ZP.error("Project ref not found");return}r({projectRef:a,name:e.name})});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.z,{type:"default",className:"justify-start flex-grow w-full",icon:(0,s.jsx)(f.Z,{size:"14"}),onClick:()=>t(!e),children:"New collection"}),(0,s.jsx)(y.C,{size:"medium",onCancel:()=>t(!e),header:"Create an event collection",visible:e,hideFooter:!0,children:(0,s.jsx)(b.l0,{...c,children:(0,s.jsxs)("form",{onSubmit:d,children:[(0,s.jsxs)(y.C.Content,{className:"py-4",children:[(0,s.jsx)("p",{className:"pb-5 text-foreground-light text-sm",children:"An event collection stores generic timeseries events and metadata in Supabase-managed analytics infrastructure. Events can be then be queried using SQL, without impacting transactional workloads."}),(0,s.jsx)(b.Wi,{control:c.control,name:"name",render:e=>{let{field:t}=e;return(0,s.jsx)(S.E,{label:"Collection name",layout:"horizontal",children:(0,s.jsx)(b.NI,{children:(0,s.jsx)(N.Z,{...t,placeholder:"Events"})})})}}),(0,s.jsx)(b.zG,{})]}),(0,s.jsxs)(y.C.Content,{className:"py-4 border-t flex items-center justify-end gap-2",children:[(0,s.jsx)(v.z,{size:"tiny",type:"default",onClick:()=>t(!e),children:"Cancel"}),(0,s.jsx)(v.z,{size:"tiny",loading:l,disabled:l,htmlType:"submit",children:"Create table"})]})]})})})]})};var E=n(16208),A=n(65644),T=n(3536),I=n(39097),Z=n.n(I),z=n(54383),P=n(34503),R=n(42070),L=n(71640);let O=e=>{let{item:t}=e,n=(0,i.useRouter)(),{ref:a,collectionToken:r}=(0,p.UO)(),l=a||"default",[o,c]=(0,g.useState)(!1),[d,u]=(0,g.useState)(!1),m=(0,x.vU)({onSuccess:()=>{j.ZP.success("Collection updated successfully"),c(!1)}}),h=(0,x.BY)({onSuccess:()=>{t.token===r&&n.push("/project/".concat(l,"/logs/explorer")),u(!1),j.ZP.success("Collection deleted successfully")}}),f=m.isLoading||h.isLoading,N=C.z.object({name:C.z.string().min(1,{message:"Collection name is required"})}),k=(0,w.cI)({resolver:(0,_.F)(N)}),I=C.z.object({confirm:C.z.boolean()}),O=(0,w.cI)({resolver:(0,_.F)(I)});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(Z(),{className:(0,z.cn)("pr-1 h-7 pl-3 mt-1 text-foreground-light group-hover:text-foreground/80 text-sm","flex items-center justify-between rounded-md group relative",t.token===n.query.collectionToken?"bg-surface-300 text-foreground":"hover:bg-surface-200"),href:"/project/".concat(l,"/logs/collections/").concat(t.token),children:[(0,s.jsx)("div",{children:t.name}),(0,s.jsxs)(P.h_,{children:[(0,s.jsx)(P.$F,{asChild:!0,children:(0,s.jsx)(v.z,{loading:f,type:"text",className:"px-1 opacity-50 hover:opacity-100 !bg-transparent",icon:(0,s.jsx)(E.Z,{})})}),(0,s.jsxs)(P.AW,{onClick:e=>{e.stopPropagation()},align:"start",className:"w-52 *:space-x-2",children:[(0,s.jsxs)(P.Xi,{onClick:()=>{c(!0)},children:[(0,s.jsx)(A.Z,{size:"14"}),(0,s.jsx)("div",{children:"Rename"})]}),(0,s.jsx)(P.VD,{}),(0,s.jsxs)(P.Xi,{onClick:async()=>{u(!0)},children:[(0,s.jsx)(T.Z,{size:"14"}),(0,s.jsx)("div",{children:"Delete"})]})]})]})]},t.token+"-collection-item"),(0,s.jsx)(y.C,{size:"medium",visible:o,onCancel:()=>c(!1),hideFooter:!0,header:'Update collection "'.concat(t.name,'"'),children:(0,s.jsx)(b.l0,{...k,children:(0,s.jsxs)("form",{id:"update-collection-form",onSubmit:k.handleSubmit(e=>m.mutate({projectRef:l,collectionToken:t.token,name:e.name})),children:[(0,s.jsx)(y.C.Content,{className:"space-y-6 py-6",children:(0,s.jsx)(b.Wi,{control:k.control,name:"name",render:e=>{let{field:t}=e;return(0,s.jsx)(S.E,{label:"Collection name",children:(0,s.jsx)(b.NI,{children:(0,s.jsx)(R.I,{type:"text",...t})})})}})}),(0,s.jsx)(b.zG,{}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end p-3 border-t",children:[(0,s.jsx)(v.z,{disabled:f,type:"outline",onClick:()=>{c(!1)},htmlType:"reset",children:"Cancel"}),(0,s.jsx)(v.z,{htmlType:"submit",loading:f,children:"Update collection"})]})]})})}),(0,s.jsx)(y.C,{visible:d,onCancel:()=>u(!1),hideFooter:!0,header:'Remove collection "'.concat(t.name,'"'),size:"small",children:(0,s.jsx)(b.l0,{...O,children:(0,s.jsxs)("form",{id:"delete-collection-form",onSubmit:O.handleSubmit(()=>{h.mutate({projectRef:l,collectionToken:t.token})}),children:[(0,s.jsxs)("div",{className:"p-3 space-y-4",children:[(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to delete the selected collection?",(0,s.jsx)("br",{})," This action cannot be undone."]}),(0,s.jsx)("div",{className:"flex items-center my-2",children:(0,s.jsx)(b.Wi,{control:O.control,name:"confirm",render:e=>{let{field:n}=e;return(0,s.jsxs)(S.E,{children:[(0,s.jsx)(b.NI,{children:(0,s.jsx)(L.X,{checked:n.value,onCheckedChange:n.onChange})}),(0,s.jsxs)(b.lX,{className:"p-2",children:["Yes, I want to delete ",(0,s.jsx)("span",{className:"font-medium",children:t.name}),"."]}),(0,s.jsx)(b.zG,{})]})}})})]}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end p-3 border-t",children:[(0,s.jsx)(v.z,{disabled:f,type:"outline",onClick:()=>{u(!1)},htmlType:"reset",children:"Cancel"}),(0,s.jsx)(v.z,{type:"primary",htmlType:"submit",loading:f,children:"Delete"})]})]})})})]})};var D=n(75424),F=n(36492),U=n(64883),M=n(31696);async function q(e,t){let{projectRef:n}=e;if(!n)throw Error("projectRef is required");let{data:s,error:a}=await (0,M.U2)("/platform/projects/{ref}/analytics/warehouse/tenant",{params:{path:{ref:n}},signal:t});return a&&(0,M.S3)(a),s}let B=function(e){let{projectRef:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,F.a)(U.d.warehouseTenant(t),e=>{let{signal:n}=e;return q({projectRef:t},n)},{enabled:n&&void 0!==t,staleTime:1/0,cacheTime:72e5,refetchOnMount:!1,refetchInterval:!1,...s})};var W=n(81384),G=(0,o.QO)(e=>{let{title:t,children:n}=e,d=(0,i.useRouter)().pathname.split("/"),x=d[d.length-1],{projectAuthAll:f,projectStorageAll:g,realtimeAll:j}=(0,o.N3)(["project_storage:all","project_auth:all","realtime:all"]),v=(0,o.P5)("warehouse"),y=(0,o.Vm)(),{ref:b}=(0,p.UO)(),N=b||"default",{data:w}=B({projectRef:N},{enabled:v}),{data:_,isLoading:C}=(0,D.O)({projectRef:w?N:"undefined"},{enabled:!!w});return(0,o.Xo)(a.KA.ANALYTICS_READ,"logflare")?(0,s.jsx)(c.AM,{title:t,product:"Logs",productMenu:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Q,{page:x,menu:u(y,{auth:f,storage:g,realtime:j})}),v&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-px w-full bg-overlay"}),(0,s.jsxs)("div",{className:"py-6",children:[(0,s.jsx)("div",{className:"px-6 uppercase font-mono",children:(0,s.jsx)(m.ZP.Group,{title:(0,s.jsxs)("div",{children:["Events",(0,s.jsx)(h.C,{variant:"warning",size:"small",className:"ml-2",children:"New"})]})})}),(0,s.jsx)("div",{className:"px-3 flex flex-col",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(k,{}),(0,s.jsx)("div",{className:"py-3",children:C?(0,s.jsx)(W.A,{}):null==_?void 0:_.map(e=>(0,s.jsx)(O,{item:e},e.id+"-collection-item"))})]})})]})]})]}),children:(0,s.jsx)("main",{style:{maxHeight:"100vh"},className:"flex-1 overflow-y-auto",children:n})}):(0,s.jsx)(c.AM,{children:(0,s.jsx)("main",{style:{maxHeight:"100vh"},className:"flex-1 overflow-y-auto",children:(0,s.jsx)(r.Z,{isFullPage:!0,resourceText:"access your project's logs explorer"})})})})},74178:function(e,t,n){"use strict";n.d(t,{CG:function(){return p},FW:function(){return d},I7:function(){return m},Lc:function(){return f},Wv:function(){return j},_S:function(){return u},g$:function(){return x},gW:function(){return y},jX:function(){return h},q7:function(){return c},tM:function(){return g},tU:function(){return o},ur:function(){return v}});var s=n(52322),a=n(2784),i=n(54383);let r="mx-auto w-full max-w-[1600px]",l="px-6 lg:px-14 xl:px-28 2xl:px-32",o=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("header",{...a,ref:t,className:(0,i.cn)("w-full","flex-col gap-3 py-6",n)})}),c=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("h1",{ref:t,...a,className:(0,i.cn)("text-2xl",n)})}),d=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("span",{ref:t,...a,className:(0,i.cn)("text-sm text-foreground-light",n)})}),u=a.forwardRef((e,t)=>{let{className:n,bottomPadding:a,...o}=e;return(0,s.jsx)("div",{ref:t,...o,className:(0,i.cn)(r,l,a&&"pb-16",n)})}),m=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("w-full h-px bg-border",n)})}),h=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("flex flex-col gap-3 py-6","lg:grid md:grid-cols-12 lg:py-12",n)})}),p=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("flex flex-col gap-3","min-w-[420px]",n)})}),x=a.forwardRef((e,t)=>{let{className:n,children:a,title:r,...l}=e;return(0,s.jsxs)("div",{ref:t,...l,className:(0,i.cn)("col-span-4 xl:col-span-5 prose text-sm",n),children:[r&&(0,s.jsx)("h2",{children:r}),a]})}),f=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",n)})}),g=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("flex flex-col gap-3 items-center",n)})}),j=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("flex w-full items-center",n)})}),v=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)("flex flex-row gap-3",n)})}),y=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)("div",{ref:t,...a,className:(0,i.cn)(r,l,"my-8 flex flex-col gap-8",n)})});o.displayName="ScaffoldHeader",c.displayName="ScaffoldTitle",d.displayName="ScaffoldDescription",u.displayName="ScaffoldContainer",m.displayName="ScaffoldDivider",h.displayName="ScaffoldSection",p.displayName="ScaffoldColumn",x.displayName="ScaffoldSectionDetail",f.displayName="ScaffoldSectionContent",g.displayName="ScaffoldFilterAndContent",j.displayName="ScaffoldActionsContainer",v.displayName="ScaffoldActionsGroup",y.displayName="ScaffoldContainerLegacy"},54266:function(e,t,n){"use strict";var s=n(52322),a=n(97729),i=n.n(a),r=n(99248),l=n(95392);t.Z=e=>{let{children:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i(),{children:(0,s.jsx)("title",{children:"Supabase + Vercel"})}),(0,s.jsxs)("main",{className:"flex flex-col w-full h-full",children:[(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"mx-auto px-4 sm:px-6",children:(0,s.jsx)("div",{className:"max-w-xl flex justify-between items-center mx-auto py-4",children:(0,s.jsx)("div",{className:"flex justify-start lg:w-0 lg:flex-1",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"sr-only",children:"Supabase"}),(0,s.jsx)("img",{className:"h-6 w-auto sm:h-6",src:"".concat(r.GW,"/img/supabase-logo.svg"),alt:""})]})})})})}),(0,s.jsx)(l.Z,{}),(0,s.jsx)("div",{className:"flex-grow overflow-y-auto",children:(0,s.jsx)("div",{className:"max-w-7xl h-full mx-auto px-4 sm:px-6",children:(0,s.jsx)("div",{className:"max-w-xl h-full mx-auto py-10",children:t})})})]})]})}},69532:function(e,t,n){"use strict";n.d(t,{p:function(){return m}});var s=n(52322),a=n(39097),i=n.n(a),r=n(14528),l=n(99248),o=n(52905),c=n(89160),d=n(87886);let u=e=>{let{organization:t,project:n,children:a}=e;return(0,s.jsxs)("div",{className:"flex w-full flex-col",children:[(0,s.jsx)(h,{organization:t,project:n}),(0,s.jsx)("div",{className:"overflow-auto",children:(0,s.jsx)("section",{className:"has-slide-in slide-in relative mx-auto my-10 max-w-2xl",children:a})})]})};t.Z=(0,r.QO)(u);let m=u,h=e=>{let{organization:t,project:n}=e,a=t?1:n?2:0;return(0,s.jsx)("div",{className:"border-b p-3 border-default",children:(0,s.jsx)("div",{className:"PageHeader",children:(0,s.jsxs)("div",{className:"Breadcrumbs flex justify-between",children:[(0,s.jsx)("div",{className:"flex items-center text-sm",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(i(),{href:"/projects",children:(0,s.jsx)("img",{src:"".concat(l.GW,"/img/supabase-logo.svg"),alt:"Supabase",className:"rounded border p-1 hover:border-white border-default",style:{height:24}})}),(0,s.jsx)(o.Z,{size:"small",className:"text-foreground-light"}),(0,s.jsx)("p",{className:"text-sm",children:t?"Organization: ".concat(t.name):"Create an organization"}),(0,s.jsx)(o.Z,{size:"small",className:"text-foreground-light"}),(0,s.jsx)("p",{className:"text-sm ".concat(a<1?"text-foreground-light":""),children:n?n.name:"Create a new project"}),(0,s.jsx)(o.Z,{size:"small",className:"text-foreground-light"}),(0,s.jsx)("p",{className:"text-sm ".concat(a<2?"text-foreground-light":""),children:n?n.name:"Extend your database"})]})}),(0,s.jsx)("div",{className:"flex"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(d.Z,{}),(0,s.jsx)(c.v,{})]})]})})})}},7929:function(e,t,n){"use strict";n.d(t,{p0:function(){return O},g1:function(){return G},_h:function(){return $},zt:function(){return ei},gm:function(){return tz},Uj:function(){return er.Z},Ix:function(){return eu},AM:function(){return em.Z},li:function(){return ez},Vk:function(){return tA},dU:function(){return ep},_J:function(){return tD},ro:function(){return nl},lz:function(){return nP},Ru:function(){return nR.Z}});var s=n(52322),a=n(97729),i=n.n(a),r=n(5632),l=n(2784),o=n(31310),c=n(14528),d=n(33750),u=n(99248),m=n(99959),h=n(39428),p=n(60417),x=n.n(p),f=n(6277),g=n(39097),j=n.n(g),v=e=>{let{href:t,label:n,isActive:a}=e;return(0,s.jsx)("div",{children:(0,s.jsx)(j(),{href:t,className:(0,f.default)("text-sm",a?"text-foreground":"text-foreground-light hover:text-foreground transition"),children:n})})},y=()=>{let e=(0,r.useRouter)(),t=x()([{label:"Preferences",pathname:"/account/me"},{label:"Access Tokens",pathname:"/account/tokens"},{label:"Security",pathname:"/account/security"},{label:"Audit logs",pathname:"/account/audit"}]);return(0,s.jsx)("div",{className:"space-y-10",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Account Settings"}),t.map(t=>(0,s.jsx)(v,{label:t.label,href:t.pathname,isActive:t.pathname===e.pathname},t.label))]})})},b=()=>{let e=(0,r.useRouter)(),t=(0,c.lL)();return(0,s.jsx)("div",{className:"space-y-10",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Organization"}),[{label:"General",pathname:"/org/[slug]/general"},{label:"Members",pathname:"/org/[slug]/team"},{label:"Integrations",pathname:"/org/[slug]/integrations"},{label:"Billing",pathname:"/org/[slug]/billing"},{label:"Usage",pathname:"/org/[slug]/usage"},{label:"Invoices",pathname:"/org/[slug]/invoices"},{label:"OAuth Apps",pathname:"/org/[slug]/apps"},{label:"Audit Logs",pathname:"/org/[slug]/audit"},{label:"Legal Documents",pathname:"/org/[slug]/documents"}].map(n=>(0,s.jsx)(v,{label:n.label,href:void 0!==t?n.pathname.replace("[slug]",t.slug):"/",isActive:n.pathname===e.pathname},n.label))]})})},N=e=>{let{children:t}=e,n=(0,r.useRouter)(),{ref:a,slug:i}=(0,m.UO)();return(0,s.jsx)(h.Z,{children:(0,s.jsxs)("div",{className:"flex h-full",children:["/projects"!==n.pathname&&(0,s.jsx)("div",{className:"h-full overflow-y-auto min-w-[280px] border-r px-8 py-8",children:void 0===i&&void 0===a?(0,s.jsx)(y,{}):(0,s.jsx)(b,{})}),(0,s.jsx)("div",{className:"h-full overflow-y-auto flex-grow",children:t})]})})},w=n(84336),_=n.n(w),C=n(3085),S=n(81076),k=n(73193),E=n(2515),A=function(e){return(0,s.jsx)(E.Z,{icon:k.Z,...e})},T=n(2760),I=function(e){return(0,s.jsx)(E.Z,{icon:T.Z,...e})},Z=n(3837),z=e=>{let{title:t,header:n,breadcrumbs:a=[],children:i,sections:r,subitems:l,subitemsParentKey:o,hideSidebar:d=!1,customSidebarContent:u}=e,m=!r&&!u,h=(0,c.P5)("navigationLayoutV2");return(0,s.jsxs)("div",{className:"flex h-full",children:[!d&&!m&&(0,s.jsxs)("div",{id:"with-sidebar",className:"h-full bg-studio hide-scrollbar w-64 overflow-auto border-r border-default",children:[t&&(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)("div",{className:"flex h-12 max-h-12 items-center border-b px-6 border-default",children:(0,s.jsx)("h4",{className:"mb-0 text-lg truncate",title:t,children:t})})}),n&&n,(0,s.jsx)("div",{className:"-mt-1",children:(0,s.jsxs)(C.ZP,{children:[u,r.map(e=>e.heading?(0,s.jsx)(P,{section:e,subitems:l,subitemsParentKey:o},e.key):(0,s.jsx)("div",{className:"border-b py-5 px-6 border-default",children:(0,s.jsx)(R,{links:e.links,subitems:l,subitemsParentKey:o})},e.key))]})})]}),(0,s.jsxs)("div",{className:"flex flex-1 flex-col",children:[!h&&(0,s.jsx)(Z.N,{breadcrumbs:a}),(0,s.jsx)("div",{className:"flex-1 flex-grow overflow-y-auto",children:i})]})]})};let P=e=>{let{section:t,subitems:n,subitemsParentKey:a}=e;return(0,s.jsxs)("div",{className:"border-b py-5 px-6 border-default",children:[t.heading&&(0,s.jsx)(C.ZP.Group,{title:t.heading}),t.versionLabel&&(0,s.jsx)("div",{className:"mb-1 px-3",children:(0,s.jsx)(S.C,{variant:"warning",children:t.versionLabel})}),(0,s.jsx)(R,{links:t.links,subitems:n,subitemsParentKey:a})]},t.heading)},R=e=>{let{links:t,subitems:n,subitemsParentKey:a}=e;return(0,s.jsx)("ul",{className:"space-y-1",children:t.map((e,t)=>{let i=e.isActive&&!n,r=(0,s.jsx)(L,{id:"".concat(e.key,"-").concat(t),isActive:i,label:e.label,href:e.href,onClick:e.onClick,isExternal:e.isExternal||!1},"".concat(e.key,"-").concat(t,"-sidebarItem"));return n&&e.subitemsKey===a&&(r=[r,...n.map((t,n)=>(0,s.jsx)(L,{id:"".concat(t.key||t.as,"-").concat(n),isSubitem:!0,label:t.label,onClick:t.onClick,isExternal:e.isExternal||!1},"".concat(t.key||t.as,"-").concat(n,"-sidebarItem")))]),r})})},L=e=>{let{id:t,label:n,href:a,isActive:i,isSubitem:r,isExternal:l,onClick:o}=e;if(_()(a)){let e;return l&&(e=(0,s.jsx)(A,{size:"tiny"})),"Log out"===n&&(e=(0,s.jsx)(I,{size:"tiny"})),(0,s.jsx)(C.ZP.Item,{rounded:!0,style:{marginLeft:r?".5rem":"0rem"},active:!!i,onClick:o||(()=>{}),icon:e,children:r?(0,s.jsx)("p",{className:"text-sm",children:n}):n},t)}return(0,s.jsx)(j(),{href:a||"",className:"block",target:l?"_blank":"_self",children:(0,s.jsxs)("span",{className:"group flex max-w-full cursor-pointer items-center space-x-2 border-default py-1 font-normal outline-none ring-foreground focus-visible:z-10 focus-visible:ring-1 group-hover:border-foreground-muted",children:[l&&(0,s.jsx)("span",{className:"truncate text-sm text-foreground-lighter transition group-hover:text-foreground-light",children:(0,s.jsx)(A,{size:"tiny"})}),(0,s.jsx)("span",{title:n,className:"w-full truncate text-sm text-foreground-light transition group-hover:text-foreground",children:r?(0,s.jsx)("p",{children:n}):n})]})})};var O=(0,c.QO)(e=>{let{children:t,title:n,breadcrumbs:a}=e,m=(0,r.useRouter)(),{data:h}=(0,o.tl)(),p=(0,c.lL)(),x=(0,c.P5)("navigationLayoutV2"),f=(0,d.QJ)(),g=async()=>{await f(),await m.push("/sign-in")};(0,l.useEffect)(()=>{u.Qy||m.push("/project/default")},[m]);let j=(null!=h?h:[]).map(e=>({isActive:m.pathname.startsWith("/org/")&&(null==p?void 0:p.slug)===e.slug,label:e.name,href:"/org/".concat(e.slug,"/general"),key:e.slug})).sort((e,t)=>e.label.localeCompare(t.label)),v=[{heading:"Projects",key:"projects",links:[{isActive:"/projects"===m.pathname,label:"All projects",href:"/projects",key:"all-projects-item"}]},...u.Qy&&(null==j?void 0:j.length)>0?[{heading:"Organizations",key:"organizations",links:j}]:[],...u.Qy?[{heading:"Account",key:"account",links:[{isActive:"/account/me"===m.pathname,icon:"".concat(m.basePath,"/img/user.svg"),label:"Preferences",href:"/account/me",key:"/account/me"},{isActive:"/account/tokens"===m.pathname,icon:"".concat(m.basePath,"/img/user.svg"),label:"Access Tokens",href:"/account/tokens",key:"/account/tokens"},{isActive:"/account/security"===m.pathname,icon:"".concat(m.basePath,"/img/user.svg"),label:"Security",href:"/account/security",key:"/account/security"},{isActive:"/account/audit"===m.pathname,icon:"".concat(m.basePath,"/img/user.svg"),label:"Audit Logs",href:"/account/audit",key:"/account/audit"}]}]:[],{heading:"Documentation",key:"documentation",links:[{key:"ext-guides",icon:"".concat(m.basePath,"/img/book.svg"),label:"Guides",href:"https://supabase.com/docs",isExternal:!0},{key:"ext-guides",icon:"".concat(m.basePath,"/img/book-open.svg"),label:"API Reference",href:"https://supabase.com/docs/guides/api",isExternal:!0}]},...u.Qy?[{key:"logout-link",links:[{key:"logout",icon:"/icons/feather/power.svg",label:"Log out",href:void 0,onClick:g}]}]:[]];return x?(0,s.jsx)(N,{children:t}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i(),{children:[(0,s.jsx)("title",{children:n?"".concat(n," | Supabase"):"Supabase"}),(0,s.jsx)("meta",{name:"description",content:"Supabase Studio"})]}),(0,s.jsx)("div",{className:"h-screen min-h-[0px] basis-0 flex-1",children:(0,s.jsx)(z,{hideSidebar:x,title:n,breadcrumbs:a,sections:v,children:t})})]})}),D=n(63910),F=n(34056),U=n(33635),M=n(95492),q=n(32079);let B=e=>[{title:"Manage",items:[{name:"Users",key:"users",url:"/project/".concat(e,"/auth/users"),items:[]}]},{title:"Configuration",items:[{name:"Policies",key:"policies",url:"/project/".concat(e,"/auth/policies"),items:[]},...u.Qy?[{name:"Providers",key:"providers",url:"/project/".concat(e,"/auth/providers"),items:[]},{name:"Rate Limits",key:"rate-limits",url:"/project/".concat(e,"/auth/rate-limits"),items:[]},{name:"Email Templates",key:"templates",url:"/project/".concat(e,"/auth/templates"),items:[]},{name:"URL Configuration",key:"url-configuration",url:"/project/".concat(e,"/auth/url-configuration"),items:[]},{name:"Hooks",key:"hooks",url:"/project/".concat(e,"/auth/hooks"),items:[],label:"BETA"}]:[]]}],W=()=>{let{ref:e="default"}=(0,m.UO)(),t=(0,D.ar)();(0,U.kM)({projectRef:e});let n=(0,r.useRouter)().pathname.split("/")[4];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.Q,{page:n,menu:B(e)}),t&&(0,s.jsx)("div",{className:"px-3",children:(0,s.jsxs)(M.bZ,{children:[(0,s.jsx)(M.Cd,{className:"text-sm",children:"Column Privileges has been shifted"}),(0,s.jsxs)(M.X,{className:"text-xs",children:[(0,s.jsx)("p",{className:"mb-2",children:"It can now be found in the menu under the database section."}),(0,s.jsx)(q.z,{asChild:!0,type:"default",size:"tiny",children:(0,s.jsx)(j(),{href:"/project/".concat(e,"/database/column-privileges"),children:"Head over to Database"})})]})]})})]})};var G=(0,c.QO)(e=>{let{title:t,children:n}=e;return(0,s.jsx)(em.Z,{title:t||"Authentication",product:"Authentication",productMenu:(0,s.jsx)(W,{}),isBlocking:!1,children:(0,s.jsx)("main",{style:{maxHeight:"100vh"},className:"flex-1 overflow-y-auto",children:n})})}),H=n(61373);(0,c.QO)(e=>{let{children:t}=e,n=(0,c.lL)(),a=(0,c.Vm)();return(0,s.jsx)(em.Z,{hideHeader:!0,hideIconBar:!0,children:(0,s.jsxs)("div",{className:"flex h-full w-full flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4 border-b py-4 px-5 border-default",children:[(0,s.jsx)(j(),{href:"/org/".concat(null==n?void 0:n.slug,"/billing"),className:"text-foreground-lighter transition-colors hover:text-foreground",children:(0,s.jsx)(H.Z,{size:16,strokeWidth:1.5})}),(0,s.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,s.jsx)("h1",{className:"text-sm text-foreground",children:"Customize your plan"}),(0,s.jsx)("div",{className:"h-6 w-px bg-selection"}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:null==n?void 0:n.name}),(0,s.jsx)("span",{className:"text-border-stronger",children:(0,s.jsx)("svg",{viewBox:"0 0 24 24",width:"16",height:"16",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",shapeRendering:"geometricPrecision",children:(0,s.jsx)("path",{d:"M16 3.549L7.12 20.600"})})}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:null==a?void 0:a.name})]})]})]}),(0,s.jsx)("div",{className:"overflow-auto",children:(0,s.jsx)("section",{className:"relative",children:t})})]})})});var Y=n(72081),V=n(69923),K=n(29354);let X=(e,t)=>{var n;let a=null!==(n=null==e?void 0:e.ref)&&void 0!==n?n:"default",{pgNetExtensionExists:i,pitrEnabled:r,columnLevelPrivileges:l}=t||{};return[{title:"Database Management",items:[{name:"Tables",key:"tables",url:"/project/".concat(a,"/database/tables"),items:[]},{name:"Functions",key:"functions",url:"/project/".concat(a,"/database/functions"),items:[]},{name:"Triggers",key:"triggers",url:"/project/".concat(a,"/database/triggers"),items:[]},{name:"Enumerated Types",key:"types",url:"/project/".concat(a,"/database/types"),items:[]},{name:"Extensions",key:"extensions",url:"/project/".concat(a,"/database/extensions"),items:[]},{name:"Indexes",key:"indexes",url:"/project/".concat(a,"/database/indexes"),items:[]},{name:"Publications",key:"publications",url:"/project/".concat(a,"/database/publications"),items:[]}]},{title:"Access Control",items:[{name:"Roles",key:"roles",url:"/project/".concat(a,"/database/roles"),items:[]},...l?[{name:"Column Privileges",key:"column-privileges",url:"/project/".concat(a,"/database/column-privileges"),items:[],label:"ALPHA"}]:[],{name:"Policies",key:"policies",url:"/project/".concat(a,"/auth/policies"),rightIcon:(0,s.jsx)(K.Z,{strokeWidth:1,className:"h-4 w-4"}),items:[]}]},{title:"Platform",items:[...u.Qy?[{name:"Backups",key:"backups",url:r?"/project/".concat(a,"/database/backups/pitr"):"/project/".concat(a,"/database/backups/scheduled"),items:[]}]:[],{name:"Wrappers",key:"wrappers",url:"/project/".concat(a,"/database/wrappers"),items:[]},{name:"Migrations",key:"migrations",url:"/project/".concat(a,"/database/migrations"),items:[]},...i?[{name:"Webhooks",key:"hooks",url:"/project/".concat(a,"/database/hooks"),items:[]}]:[]]},{title:"Tools",items:[{name:"Schema Visualizer",key:"schemas",url:"/project/".concat(a,"/database/schemas"),items:[]},{name:"Query Performance",key:"query-performance",url:"/project/".concat(a,"/database/query-performance"),items:[]},{name:"Security Advisor",key:"security-advisor",url:"/project/".concat(a,"/advisors/security"),rightIcon:(0,s.jsx)(K.Z,{strokeWidth:1,className:"h-4 w-4"}),items:[]},{name:"Performance Advisor",key:"performance-advisor",url:"/project/".concat(a,"/advisors/performance"),rightIcon:(0,s.jsx)(K.Z,{strokeWidth:1,className:"h-4 w-4"}),items:[]}]}]},Q=()=>{let e=(0,c.Vm)(),t=(0,r.useRouter)().pathname.split("/")[4],{data:n}=(0,Y.H)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),{data:a}=(0,V.F)({projectRef:null==e?void 0:e.ref}),i=void 0!==(null!=n?n:[]).find(e=>"pg_net"===e.name),l=(null==a?void 0:a.selected_addons.find(e=>"pitr"===e.type))!==void 0,o=(0,D.ar)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.Q,{page:t,menu:X(e,{pgNetExtensionExists:i,pitrEnabled:l,columnLevelPrivileges:o})}),(0,s.jsx)("div",{className:"px-3",children:(0,s.jsxs)(M.bZ,{children:[(0,s.jsx)(M.Cd,{className:"text-sm",children:"Replication section has been renamed"}),(0,s.jsx)(M.X,{className:"text-xs",children:(0,s.jsxs)("p",{className:"mb-2",children:["It can be now found under"," ",(0,s.jsx)(j(),{href:"/project/".concat(null==e?void 0:e.ref,"/database/publications"),className:"underline",children:"Publications"})]})})]})})]})};var $=(0,c.QO)(e=>{let{children:t}=e;return(0,s.jsx)(em.Z,{product:"Database",productMenu:(0,s.jsx)(Q,{}),isBlocking:!1,children:(0,s.jsx)("main",{style:{maxHeight:"100vh"},className:"flex-1 overflow-y-auto",children:t})})});function J(e){let{error:t}=e;return(0,l.useEffect)(()=>{console.error("Error",t)},[]),(0,s.jsxs)("div",{className:"mx-auto flex h-full w-full flex-col items-center justify-center space-y-6",children:[(0,s.jsxs)("div",{className:"flex w-[320px] flex-col items-center justify-center space-y-3",children:[(0,s.jsx)("h4",{className:"text-lg",children:"Something went wrong \uD83E\uDD15"}),(0,s.jsx)("p",{className:"text-center text-sm text-foreground-light",children:"Sorry about that, please try again later or feel free to reach out to us if the problem persists."})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(q.z,{asChild:!0,children:(0,s.jsx)(j(),{href:"/projects",children:"Head back"})}),(0,s.jsx)(q.z,{asChild:!0,type:"secondary",children:(0,s.jsx)(j(),{href:"/support/new",children:"Submit a support request"})})]}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["Error: [",null==t?void 0:t.code,"] ",null==t?void 0:t.message]})]})}var ee=n(26002),et=n(38183),en=n(97589),es=n(31036);let ea=(e,t,n,a)=>[{title:"Getting Started",items:[{name:"Introduction",key:"introduction",url:"/project/".concat(e,"/api"),items:[]},{name:"Authentication",key:"auth",url:"/project/".concat(e,"/api?page=auth"),items:[]},...(null==a?void 0:a.authEnabled)?[{name:"User Management",key:"users",url:"/project/".concat(e,"/api?page=users"),items:[]}]:[]]},{title:"Tables and Views",items:[{name:"Introduction",key:"tables-intro",url:"/project/".concat(e,"/api?page=tables-intro"),items:[]},...t.sort().map(t=>({name:t,key:t,url:"/project/".concat(e,"/api?resource=").concat(t),items:[]}))]},{title:"Stored Procedures",items:[{name:"Introduction",key:"rpc-intro",url:"/project/".concat(e,"/api?page=rpc-intro"),items:[]},...n.map(t=>({name:t,key:t,url:"/project/".concat(e,"/api?rpc=").concat(t),items:[]}))]},{title:"GraphQL",items:[{name:"GraphiQL",key:"graphiql",url:"/project/".concat(e,"/api/graphiql"),icon:(0,s.jsx)(et.Z,{src:"".concat(u.GW,"/img/graphql.svg"),style:{width:"".concat(16,"px"),height:"".concat(16,"px")},className:"text-foreground",preProcessor:e=>e.replace(/svg/,'svg class="m-auto text-color-inherit"')}),items:[]}]},{title:"More Resources",items:[{name:"Guides",key:"guides",url:"https://supabase.com/docs",icon:(0,s.jsx)(en.Z,{size:14,strokeWidth:2}),items:[],isExternal:!0},{name:"API Reference",key:"api-reference",url:"https://supabase.com/docs/guides/api",icon:(0,s.jsx)(es.Z,{size:14,strokeWidth:2}),items:[],isExternal:!0}]}];var ei=(0,c.QO)(function(e){var t,n,a;let{title:i,children:l}=e,o=(0,r.useRouter)(),{ref:d}=(0,m.UO)(),h=(0,c.Vm)(),p=(null==h?void 0:h.status)===u.S.INACTIVE,{data:x,isLoading:f,error:g}=(0,ee.H)({projectRef:d},{enabled:!p}),j=(0,D.cg)()&&o.pathname.endsWith("/graphiql"),{projectAuthAll:v}=(0,c.N3)(["project_auth:all"]);if(g)return(0,s.jsx)(em.Z,{product:"API Docs",children:(0,s.jsx)(J,{error:g})});let y=null!==(t=null==h?void 0:h.ref)&&void 0!==t?t:"default",b=(null!==(n=null==x?void 0:x.tables)&&void 0!==n?n:[]).map(e=>e.name),N=(null!==(a=null==x?void 0:x.functions)&&void 0!==a?a:[]).map(e=>e.name);return(0,s.jsx)(em.Z,{title:i||"API Docs",isLoading:f,product:"API Docs",productMenu:!j&&(0,s.jsx)(F.Q,{page:(()=>{if(o.pathname.endsWith("graphiql"))return"graphiql";let{page:e,resource:t}=o.query;return e||t?e||t||"":"introduction"})(),menu:ea(y,b,N,{authEnabled:v})}),children:l})}),er=n(24923),el=n(53004),eo=n(74178),ec=n(93463);let ed=()=>{let e=(0,r.useRouter)();return e.isReady?e.asPath.split("?")[0]:""};var eu=e=>{var t,n,a;let{children:i}=e,l=(0,c.lL)();(0,r.useRouter)();let o=ed(),{slug:d}=(0,m.UO)(),u=(0,c.N3)("billing:invoices"),{data:h}=(0,ec.G)({orgSlug:d}),p=!(null==h?void 0:h.billing_via_partner);if((0,c.P5)("navigationLayoutV2"))return(0,s.jsx)(N,{children:i});let x=[{label:"General",href:"/org/".concat(d,"/general")},{label:"Team",href:"/org/".concat(d,"/team")},{label:"Integrations",href:"/org/".concat(d,"/integrations")},{label:"Billing",href:"/org/".concat(d,"/billing")},{label:"Usage",href:"/org/".concat(d,"/usage")},{label:"Invoices",href:"/org/".concat(d,"/invoices"),hidden:!(u&&p)},{label:"OAuth Apps",href:"/org/".concat(d,"/apps")},{label:"Audit Logs",href:"/org/".concat(d,"/audit")},{label:"Legal Documents",href:"/org/".concat(d,"/documents")}].filter(e=>!e.hidden);return(0,s.jsxs)(O,{title:null!==(n=null==l?void 0:l.name)&&void 0!==n?n:"Supabase",breadcrumbs:[{key:"org-settings",label:"Settings"}],children:[(0,s.jsx)(eo.tU,{className:"pb-0",children:(0,s.jsxs)(eo._S,{id:"billing-page-top",children:[(0,s.jsxs)(eo.q7,{className:"pb-3",children:[null!==(a=null==l?void 0:l.name)&&void 0!==a?a:"Organization"," settings"]}),(0,s.jsx)(el.M,{className:"border-none","aria-label":"Organization menu navigation",children:x.map(e=>(0,s.jsx)(el._,{active:o===e.href,children:(0,s.jsx)(j(),{href:e.href,children:e.label})},e.label))})]})}),(0,s.jsx)(eo.I7,{}),i]})},em=n(626);let eh=(e,t,n,s)=>{var a,i,r;let l=(null==t?void 0:t.status)===u.S.COMING_UP,o="/project/".concat(e,"/building"),c=null===(a=null==s?void 0:s.auth)||void 0===a||a,d=null===(i=null==s?void 0:s.edgeFunctions)||void 0===i||i,m=null===(r=null==s?void 0:s.storage)||void 0===r||r;return[{title:"Project Settings",items:[{name:"General",key:"general",url:"/project/".concat(e,"/settings/general"),items:[]},{name:"Infrastructure",key:"infrastructure",url:l?o:"/project/".concat(e,"/settings/infrastructure"),items:[]},...u.Qy?[{name:"Integrations",key:"integrations",url:"/project/".concat(e,"/settings/integrations"),items:[]}]:[],{name:"Add Ons",key:"addons",url:"/project/".concat(e,"/settings/addons"),items:[]},{name:"Vault",key:"vault",url:l?o:"/project/".concat(e,"/settings/vault/secrets"),items:[],label:"BETA"}]},{title:"Configuration",items:[{name:"Database",key:"database",url:l?o:"/project/".concat(e,"/settings/database"),items:[]},{name:"API",key:"api",url:l?o:"/project/".concat(e,"/settings/api"),items:[]},...u.Qy&&c?[{name:"Authentication",key:"auth",url:l?o:"/project/".concat(e,"/settings/auth"),items:[]}]:[],...u.Qy&&m?[{name:"Storage",key:"storage",url:"/project/".concat(e,"/settings/storage"),items:[]}]:[],...u.Qy&&d?[{name:"Edge Functions",key:"functions",url:"/project/".concat(e,"/settings/functions"),items:[]}]:[]]},{title:"Billing",items:[{name:"Subscription",key:"subscription",url:"/org/".concat(null==n?void 0:n.slug,"/billing"),items:[]},{name:"Usage",key:"usage",url:"/org/".concat(null==n?void 0:n.slug,"/usage?projectRef=").concat(e),items:[]}]}]};var ep=(0,c.QO)(e=>{let{title:t,children:n}=e,a=(0,r.useRouter)(),{ref:i}=(0,m.UO)(),o=(0,c.Vm)(),d=(0,c.lL)();(0,l.useEffect)(()=>{u.Qy||a.push("/project/default")},[a]);let h=a.pathname.includes("billing")?a.pathname.split("/")[5]:a.pathname.split("/")[4],{projectAuthAll:p,projectEdgeFunctionAll:x,projectStorageAll:f,billingInvoices:g}=(0,c.N3)(["project_auth:all","project_edge_function:all","project_storage:all","billing:invoices"]),j=eh(i,o,d,{auth:p,edgeFunctions:x,storage:f,invoices:g});return(0,s.jsx)(em.Z,{isBlocking:!1,title:t||"Settings",product:"Settings",productMenu:(0,s.jsx)(F.Q,{page:h,menu:j}),children:(0,s.jsx)("main",{style:{maxHeight:"100vh"},className:"flex-1 overflow-y-auto",children:n})})}),ex=n(89404),ef=n(78232),eg=n(24213),ej=n(3536),ev=n(62202),ey=n(17159),eb=n(13800),eN=n(47852),ew=n(62277),e_=n(750);let eC=e=>{let{selectedReport:t,initialValues:n,onCancel:a}=e,{ref:i}=(0,m.UO)(),{mutate:r}=(0,eb.R)({onSuccess:()=>{ev.ZP.success("Successfully updated report"),a()},onError:e=>{ev.ZP.error("Failed to update report: ".concat(e.message))}});return(0,s.jsx)(eN.C,{visible:void 0!==t,onCancel:a,hideFooter:!0,header:"Update custom report",size:"small",children:(0,s.jsx)(ew.Z,{onReset:a,validateOnBlur:!0,initialValues:n,validate:function(e){let t={};return e.name||(t.name="This field is required"),t},onSubmit:e=>{if(!i)return console.error("Project ref is required");t&&t.id&&t.project_id&&r({projectRef:i,payload:{...t,project_id:t.project_id,id:t.id,name:e.name,description:e.description||""}})},children:e=>{let{isSubmitting:t}=e;return(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsx)(eN.C.Content,{children:(0,s.jsx)(e_.Z,{label:"Name",id:"name",name:"name"})}),(0,s.jsx)(eN.C.Content,{children:(0,s.jsx)(e_.Z.TextArea,{label:"Description",id:"description",placeholder:"Describe your custom report",size:"medium",textAreaClassName:"resize-none"})}),(0,s.jsx)(eN.C.Separator,{}),(0,s.jsx)(eN.C.Content,{children:(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,s.jsx)(q.z,{htmlType:"reset",type:"default",onClick:a,disabled:t,children:"Cancel"}),(0,s.jsx)(q.z,{htmlType:"submit",loading:t,disabled:t,children:"Save custom report"})]})})]})}})})};var eS=n(41679),ek=n(2160),eE=n(31442),eA=n(54383),eT=n(34503),eI=n(74138),eZ=()=>{let e=(0,r.useRouter)(),{ref:t,id:n}=(0,m.UO)(),a=n||e.pathname.split("/")[4],i=(0,c.N3)("project_storage:all"),{data:o,isLoading:d}=(0,eE.I)(t),{mutate:u,isLoading:h}=(0,ek.z)({onSuccess:()=>{x(!1),ev.ZP.success("Successfully deleted report"),e.push("/project/".concat(t,"/reports"))},onError:e=>{ev.ZP.error("Failed to delete report: ".concat(e.message))}}),[p,x]=(0,l.useState)(!1),[f,g]=(0,l.useState)(!1),[v,y]=(0,l.useState)(),[b,N]=(0,l.useState)(),w=function(){if(!o)return[];let e=null==o?void 0:o.content.filter(e=>"report"===e.type);return(null==e?void 0:e.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0)).map((e,n)=>({id:e.id,name:e.name,description:e.description||"",key:e.id||n+"-report",url:"/project/".concat(t,"/reports/").concat(e.id),hasDropdownActions:!0,report:e}))}(),_=[{title:"Built-in reports",key:"builtin-reports",items:[{name:"API",key:"api-overview",url:"/project/".concat(t,"/reports/api-overview")},...i?[{name:"Storage",key:"storage",url:"/project/".concat(t,"/reports/storage")}]:[],{name:"Database",key:"database",url:"/project/".concat(t,"/reports/database")}]}];return(0,s.jsx)(C.ZP,{type:"pills",className:"mt-6",children:d?(0,s.jsxs)("div",{className:"px-5 my-4 space-y-2",children:[(0,s.jsx)(eS.Z,{}),(0,s.jsx)(eS.Z,{className:"w-3/4"}),(0,s.jsx)(eS.Z,{className:"w-1/2"})]}):(0,s.jsxs)("div",{className:"flex flex-col px-2 gap-y-6",children:[(0,s.jsx)("div",{className:"flex px-2",children:(0,s.jsx)(q.z,{type:"default",className:"justify-start flex-grow",onClick:()=>{g(!0)},icon:(0,s.jsx)(ex.Z,{size:12}),children:"New custom report"})}),w.length>0?(0,s.jsxs)("div",{children:[(0,s.jsx)(C.ZP.Group,{title:(0,s.jsx)("span",{className:"uppercase font-mono",children:"Your custom reports"})}),w.map((e,t)=>(0,s.jsxs)(j(),{className:(0,eA.cn)("pr-2 h-7 pl-3 mt-1 text-foreground-light group-hover:text-foreground/80 text-sm","flex items-center justify-between rounded-md group relative",e.key===a?"bg-surface-300 text-foreground":"hover:bg-surface-200"),href:e.url,children:[(0,s.jsx)("div",{children:e.name}),(0,s.jsxs)(eT.h_,{children:[(0,s.jsx)(eT.$F,{children:(0,s.jsx)(q.z,{type:"text",className:"px-1 opacity-50 hover:opacity-100",icon:(0,s.jsx)(ef.Z,{size:12,strokeWidth:2})})}),(0,s.jsxs)(eT.AW,{align:"start",className:"w-52 *:space-x-2",children:[(0,s.jsxs)(eT.Xi,{onClick:()=>{e.id&&N(e.report)},children:[(0,s.jsx)(eg.Z,{size:12}),(0,s.jsx)("div",{children:"Rename"})]}),(0,s.jsx)(eT.VD,{}),(0,s.jsxs)(eT.Xi,{onClick:async()=>{e.id&&(y(e.report),x(!0))},children:[(0,s.jsx)(ej.Z,{size:12}),(0,s.jsx)("div",{children:"Delete"})]})]})]})]},e.key+"-menukey"))]}):null,_.map(e=>(0,s.jsx)("div",{children:e.items?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.ZP.Group,{title:(0,s.jsx)("span",{className:"uppercase font-mono",children:e.title})}),(0,s.jsx)("div",{className:"flex flex-col",children:e.items.map(e=>(0,s.jsx)("li",{className:(0,eA.cn)("pr-2 mt-1 text-foreground-light group-hover:text-foreground/80 text-sm","flex items-center justify-between rounded-md group relative",e.key===a?"bg-surface-300 text-foreground":"hover:bg-surface-200"),children:(0,s.jsx)(j(),{href:e.url,className:"flex-grow h-7 flex items-center pl-3",children:e.name})},e.key))},e.key)]}):null},e.key+"-menu-group")),(0,s.jsxs)(M.bZ,{children:[(0,s.jsx)(M.Cd,{className:"text-sm",children:"Query Performance and Project Linter reports have been shifted"}),(0,s.jsxs)(M.X,{className:"text-xs",children:[(0,s.jsx)("p",{className:"mb-2",children:"They can now be found in the menu under the database section."}),(0,s.jsx)(q.z,{asChild:!0,type:"default",size:"tiny",children:(0,s.jsx)(j(),{href:"/project/".concat(t,"/database/query-performance"),children:"Head over to Database"})})]})]}),(0,s.jsx)(eC,{onCancel:()=>N(void 0),selectedReport:b,initialValues:{name:(null==b?void 0:b.name)||"",description:(null==b?void 0:b.description)||""}}),(0,s.jsx)(eI.Z,{title:"Delete custom report",confirmLabel:"Delete report",confirmLabelLoading:"Deleting report",size:"medium",loading:h,visible:p,onCancel:()=>x(!1),onConfirm:()=>void 0===t?console.error("Project ref is required"):(null==v?void 0:v.id)===void 0?console.error("Report ID is required"):void u({projectRef:t,ids:[v.id]}),children:(0,s.jsx)("div",{className:"text-sm text-foreground-light grid gap-4",children:(0,s.jsx)("div",{className:"grid gap-1",children:(0,s.jsxs)("p",{children:["Are you sure you want to delete '",null==v?void 0:v.name,"'?"]})})})}),(0,s.jsx)(ey.m,{visible:f,onCancel:()=>g(!1),afterSubmit:()=>g(!1)})]})})},ez=(0,c.QO)(e=>{let{title:t,children:n}=e;return(0,s.jsx)(em.Z,{title:t,product:"Reports",productMenu:(0,s.jsx)(eZ,{}),isBlocking:!1,children:(0,s.jsx)("main",{style:{maxHeight:"100vh"},className:"flex-1 overflow-y-auto",children:n})})}),eP=n(59491),eR=n(96795),eL=n.n(eR),eO=n(56902),eD=n(30789),eF=n(56006);function eU(e){return"sql"===e.type}let eM=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,eE.I)(e,{select:e=>({snippets:e.content.filter(eU)}),...t})};var eq=n(82667),eB=n(74067),eW=n(9914),eG=n(2322),eH=n(68806),eY=n(55283),eV=n(42070),eK=n(10304),eX=n(81384);let eQ=(0,l.forwardRef)((e,t)=>{let{...n}=e;return(0,s.jsx)(eY.zF,{...n,className:(0,eA.cn)("w-full px-2",n.className)})}),e$=(0,l.forwardRef)((e,t)=>{let{...n}=e;return(0,s.jsx)(eY.wy,{disabled:!0,ref:t,...n,className:(0,eA.cn)("w-full flex gap-1 items-center group px-3 text-xs font-normal font-mono uppercase text-lighter tracking-wide",n.className),children:(0,s.jsx)("span",{className:"group-hover:not-disabled:text-foreground",children:n.title})})}),eJ=(0,l.forwardRef)((e,t)=>{let{...n}=e;return(0,s.jsx)(eY.Fw,{...n,className:(0,eA.cn)("w-full data-[state=open]:pt-1 flex flex-col gap-2",n.className)})}),e0=(0,l.forwardRef)((e,t)=>(0,s.jsx)("div",{ref:t,...e,className:(0,eA.cn)("h-px bg-border-muted",e.className)})),e1=(0,l.forwardRef)((e,t)=>{let{className:n,isActive:a,forceHoverState:i,...r}=e;return(0,s.jsx)(j(),{ref:t,...r,"aria-current":a,className:(0,eA.cn)("text-sm","h-7 pl-3 pr-2","flex items-center justify-between rounded-md group relative",a?"bg-selection":"hover:bg-surface-200",i&&"bg-surface-200",a?"text-foreground":"text-foreground-light hover:text-foreground",n)})}),e2=(0,l.forwardRef)((e,t)=>(0,s.jsx)("div",{ref:t,...e,className:(0,eA.cn)("flex px-2 gap-2 items-center",e.className)})),e4=(0,l.forwardRef)((e,t)=>{let{children:n,...a}=e;return(0,s.jsxs)("label",{htmlFor:a.name,className:"relative w-full",children:[(0,s.jsx)("span",{className:"sr-only",children:a["aria-labelledby"]}),(0,s.jsx)(eV.I,{ref:t,type:"text",className:(0,eA.cn)("h-[28px] w-full","text-xs","pl-7","pr-7","w-full","rounded",a.className),...a}),n,(0,s.jsx)(eH.Z,{className:"absolute left-2 top-2 text-foreground-muted",size:14,strokeWidth:1.5})]})}),e3=(0,l.forwardRef)((e,t)=>{let{value:n,onValueChange:a,contentClassName:i,triggerClassName:r,...l}=e;return(0,s.jsxs)(eT.h_,{modal:!1,children:[(0,s.jsxs)(eG.u,{delayDuration:0,children:[(0,s.jsx)(eT.$F,{asChild:!0,className:(0,eA.cn)("absolute right-1 top-[.3rem]","text-foreground-muted transition-colors hover:text-foreground data-[state=open]:text-foreground",r),children:(0,s.jsx)(eG.aJ,{children:(0,s.jsx)(eK.Z,{size:18,strokeWidth:1})})}),(0,s.jsx)(eG._v,{side:"bottom",children:"Sort By"})]}),(0,s.jsx)(eT.AW,{side:"bottom",align:"end",className:(0,eA.cn)("w-48",i),children:(0,s.jsx)(eT._x,{value:n,onValueChange:a,children:l.children})})]})}),e5=(0,l.forwardRef)((e,t)=>(0,s.jsx)(eT.qB,{ref:t,...e})),e8=(0,l.forwardRef)((e,t)=>(0,s.jsxs)("div",{ref:t,...e,className:(0,eA.cn)("flex flex-col px-2 gap-1 pb-4",e.className),children:[(0,s.jsx)(eX.Z,{className:"w-full h-7 rounded-md",delayIndex:0}),(0,s.jsx)(eX.Z,{className:"w-full h-7 rounded-md",delayIndex:1}),(0,s.jsx)(eX.Z,{className:"w-full h-7 rounded-md",delayIndex:2})]})),e6=(0,l.forwardRef)((e,t)=>{let{illustration:n,title:a,description:i,actions:r,...l}=e;return(0,s.jsx)("div",{ref:t,...l,className:(0,eA.cn)("border bg-surface-100/50 flex flex-col gap-y-3 items-center justify-center rounded-md px-3 py-4",l.className),children:(0,s.jsxs)("div",{className:"flex flex-col gap-y-1 items-center justify-center",children:[n,a&&(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:a}),i&&(0,s.jsx)("p",{className:"text-xs text-foreground-lighter text-center",children:i}),r&&(0,s.jsx)("div",{className:"mt-2",children:r})]})})});var e9=n(34291),e7=n.n(e9),te=n(59769),tt=n(71640),tn=n(57370),ts=n.n(tn),ta=n(9015),ti=n(58898),tr=n(32830),tl=n(38264),to=n(80435),tc=e=>{let{id:t,...n}=e,a=(0,eW.W2)().snippets[t].snippet,i=ts()(a.name),[r,o]=(0,l.useState)("CLI"),c=[{id:"migration",label:"Migration",title:"Download as migration",description:"Download the snippet in a new migration named `".concat(i,"`"),cli:(0,eD.kL)(t,i),npm:(0,eD.kL)(t,i,!0)},{id:"seed",label:"Seed file",title:"Download as seed file",description:"If your query consists of sample data, append the snippet to the end of `supabase/seed.sql`",cli:(0,eD.YI)(t),npm:(0,eD.YI)(t,!0)},{id:"sql",label:"SQL file",title:"Download as SQL file",description:"Download the snippet directly into a new SQL file named `".concat(i,".sql`"),cli:(0,eD.y4)(t,i),npm:(0,eD.y4)(t,i,!0)}];return(0,s.jsx)(eN.C,{hideFooter:!0,showCloseButton:!0,size:"xlarge",header:(0,s.jsx)("p",{children:"Download snippet as local migration file via the Supabase CLI."}),...n,children:(0,s.jsxs)("div",{className:"flex flex-col items-start justify-between gap-4 py-5 relative",children:[(0,s.jsx)(ta.Z,{type:"underlined",listClassNames:"pl-5",children:c.map(e=>(0,s.jsxs)(ta.Z.Panel,{id:e.id,label:e.label,className:"px-5",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,s.jsx)("h2",{className:"text-lg",children:e.title}),(0,s.jsx)(to.U,{className:"text-sm text-scale-1000 [&>p>code]:!break-normal",content:e.description})]}),(0,s.jsx)(tl.Z,{width:75,options:["CLI","NPM"],activeOption:r,borderOverride:"border-muted",onClickOption:()=>"CLI"===r?o("NPM"):o("CLI")})]}),(0,s.jsx)("pre",{children:(0,s.jsx)(ti.d,{language:"bash",className:"language-bash prose dark:prose-dark max-w-none",children:"CLI"===r?e.cli:e.npm})})]},e.id))}),(0,s.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-xs text-lighter mx-5",children:"Run this command from your project directory"}),(0,s.jsxs)("div",{className:"flex justify-between items-center gap-x-2 mx-5",children:[(0,s.jsx)(q.z,{asChild:!0,type:"default",icon:(0,s.jsx)(tr.Z,{size:14,strokeWidth:1.5}),children:(0,s.jsx)(j(),{href:"https://supabase.com/docs/guides/cli/local-development#database-migrations",target:"_blank",rel:"noreferrer",children:"About migrations"})}),(0,s.jsx)(q.z,{asChild:!0,type:"default",icon:(0,s.jsx)(tr.Z,{size:14,strokeWidth:1.5}),children:(0,s.jsx)(j(),{href:"https://supabase.com/docs/guides/cli/local-development",target:"_blank",rel:"noreferrer",children:"About CLI"})})]})]})]})})},td=n(99430),tu=n(54849),tm=n(34750),th=e=>{let{snippet:t,visible:n,onCancel:a,onComplete:i}=e,{ref:r}=(0,m.UO)(),o=(0,c.lL)(),d=(0,eW.W2)(),{data:u}=(0,ec.G)({orgSlug:null==o?void 0:o.slug}),h=(0,tm.$w)(u),{id:p,name:x,description:f}=t,[g,j]=(0,l.useState)(x),[v,y]=(0,l.useState)(f);(0,l.useEffect)(()=>{j(x)},[x]);let b=async(e,t)=>{let{setSubmitting:n}=t;if(!r)return console.error("Project ref is required");if(!p)return console.error("Snippet ID is required");n(!0);try{return d.renameSnippet(p,g,v),i&&i(),Promise.resolve()}catch(e){ev.ZP.error("Failed to rename query: ".concat(e.message))}},{mutate:N,isLoading:w}=(0,td.g)({onSuccess:e=>{let{title:t,description:n}=e;j(t),v||y(n)},onError:e=>{ev.ZP.error("Failed to rename query: ".concat(e.message))}}),_=!!t.content.sql;return(0,s.jsx)(eN.C,{visible:n,onCancel:a,hideFooter:!0,header:"Rename",size:"small",children:(0,s.jsx)(ew.Z,{onReset:a,validateOnBlur:!0,initialValues:{name:null!=x?x:"",description:null!=f?f:""},validate:()=>{let e={};return g||(e.name="Please enter a query name"),e},onSubmit:b,children:e=>{let{isSubmitting:n}=e;return(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)(eN.C.Content,{children:[(0,s.jsx)(e_.Z,{label:"Name",id:"name",name:"name",value:g,onChange:e=>j(e.target.value)}),(0,s.jsx)("div",{className:"flex w-full justify-end mt-2",children:!h&&_&&(0,s.jsx)(q.z,{type:"default",onClick:()=>N({sql:t.content.sql}),size:"tiny",disabled:w,children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"scale-75",children:(0,s.jsx)(tu.c,{loading:w})}),(0,s.jsx)("span",{children:"Rename with Supabase AI"})]})})})]}),(0,s.jsx)(eN.C.Content,{children:(0,s.jsx)(e_.Z.TextArea,{label:"Description",id:"description",placeholder:"Describe query",size:"medium",textAreaClassName:"resize-none",value:v,onChange:e=>y(e.target.value)})}),(0,s.jsx)(eN.C.Separator,{}),(0,s.jsx)(eN.C.Content,{children:(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,s.jsx)(q.z,{htmlType:"reset",type:"default",onClick:a,disabled:n,children:"Cancel"}),(0,s.jsx)(q.z,{htmlType:"submit",loading:n,disabled:n,children:"Rename query"})]})})]})}})})},tp=n(62614),tx=n(15998),tf=n(50692),tg=n(65644),tj=n(63754),tv=n(94299),ty=n(17913);let tb=e=>{let{tabInfo:t,open:n,setOpen:a,onSelectRenameQuery:i,onSelectDeleteQuery:l,onSelectShareQuery:o,onSelectDownloadQuery:d}=e,{ref:u}=(0,m.UO)(),h=(0,r.useRouter)(),{profile:p}=(0,eB.Un)(),x=(0,eW.W2)(),f=(0,c.Vm)(),{id:g,name:j,visibility:v,content:y}=t||{},b=(0,c.Xo)(eP.KA.CREATE,"user_content",{resource:{type:"sql",owner_id:null==p?void 0:p.id},subject:{id:null==p?void 0:p.id}}),{id:N}=t||{},w=void 0!==N&&x.snippets&&void 0!==x.snippets[N]?x.snippets[N]:null,_=(null==p?void 0:p.id)===(null==w?void 0:w.snippet.owner_id),C=async()=>{if(!u)return console.error("Project ref is required");if(!g)return console.error("Snippet ID is required");try{let e=(0,eD.UA)({id:(0,eq.k$)(),name:j,sql:y.sql,owner_id:null==p?void 0:p.id,project_id:null==f?void 0:f.id});x.addSnippet(e,u),x.addNeedsSaving(e.id),h.push("/project/".concat(u,"/sql/").concat(e.id))}catch(e){ev.ZP.error("Failed to create a personal copy of this query: ".concat(e.message))}};return(0,s.jsx)(s.Fragment,{children:m.Qy?(0,s.jsxs)(eT.h_,{open:n,onOpenChange:a,children:[(0,s.jsx)(eT.$F,{className:"opacity-0 group-hover:opacity-100 group-focus:opacity-100 focus:opacity-100 data-[state=open]:opacity-100",asChild:!0,name:"Query actions",children:(0,s.jsx)(q.z,{type:"text",className:"px-1 text-lighter data-[state=open]:text-foreground",icon:(0,s.jsx)(tf.Z,{size:14,strokeWidth:2}),onClick:e=>e.preventDefault()})}),(0,s.jsxs)(eT.AW,{side:"bottom",align:"start",className:"w-52",children:[_&&(0,s.jsxs)(eT.Xi,{onClick:e=>{e.stopPropagation(),i()},className:"flex gap-2",children:[(0,s.jsx)(tg.Z,{size:14}),"Rename query"]}),"user"===v&&b&&(0,s.jsxs)(eT.Xi,{onClick:e=>{e.stopPropagation(),o()},className:"flex gap-2",children:[(0,s.jsx)(tj.Z,{size:14}),"Share query"]}),"project"===v&&b&&(0,s.jsxs)(eT.Xi,{onClick:C,className:"flex gap-2",children:[(0,s.jsx)(tv.Z,{size:14}),"Duplicate personal copy"]}),m.Qy&&(0,s.jsxs)(eT.Xi,{onClick:()=>d(),className:"flex gap-2",children:[(0,s.jsx)(ty.Z,{size:14}),"Download as migration file"]}),_&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eT.VD,{}),(0,s.jsxs)(eT.Xi,{onClick:e=>{e.stopPropagation(),l()},className:"flex gap-2",children:[(0,s.jsx)(ej.Z,{size:14}),"Delete query"]})]})]})]}):(0,s.jsx)(q.z,{asChild:!0,disabled:!0,type:"text",style:{padding:"3px"},children:(0,s.jsx)("span",{})})})};var tN=n(48188),tw=n(27775),t_=e=>{let{tabInfo:t,isSelected:n=!1,hasQueriesSelected:a=!1,onSelectQuery:i=e7(),onDeleteQuery:r=e7()}=e,[o,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)(!1),[h,p]=(0,l.useState)(!1),[x,f]=(0,l.useState)(!1),[g,j]=(0,l.useState)(!1),{ref:v,id:y}=(0,m.UO)(),b=(0,eW.W2)(),{id:N,name:w,description:_,content:C,visibility:S}=t||{},k=N===y,E=(0,l.useRef)(null),A=o||k||d||h||x||g,{mutate:T,isLoading:I}=(0,ek.z)({onSuccess:e=>{r(e)},onError:(e,t)=>{e.message.includes("Contents not found")?r(t.ids):ev.ZP.error("Failed to delete query: ".concat(e.message))}}),Z=async()=>v?N?void T({projectRef:v,ids:[N]}):console.error("Snippet ID is required"):console.error("Project ref is required");(0,l.useEffect)(()=>{k&&E.current&&setTimeout(()=>{var e;null===(e=E.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"nearest"})},0)});let z=async()=>{if(N)try{return b.shareSnippet(N,"project"),Promise.resolve()}catch(e){ev.ZP.error("Failed to share query: ".concat(e.message))}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(te.zs,{openDelay:200,children:[(0,s.jsx)(te.Yi,{asChild:!0,children:(0,s.jsxs)(e1,{title:_||w,ref:k?E:null,href:"/project/".concat(v,"/sql/").concat(N),className:"flex gap-3 items-center",forceHoverState:o,isActive:k,children:["user"===S&&(0,s.jsx)(tt.X,{className:(0,eA.cn)("transition absolute left-2.5 border-strong",a?"":"opacity-0 group-hover:opacity-100"),checked:n,onCheckedChange:i}),(0,s.jsx)("span",{className:(0,eA.cn)("transition-all","w-full overflow-hidden truncate",a&&"user"===S?"ml-5":"user"===S?"group-hover:ml-5":"","text-ellipsis truncate"),children:w}),!a&&(0,s.jsx)(tb,{tabInfo:t,open:o,setOpen:c,onSelectDeleteQuery:()=>f(!0),onSelectRenameQuery:()=>u(!0),onSelectShareQuery:()=>p(!0),onSelectDownloadQuery:()=>j(!0)})]},N)}),!A&&(0,s.jsx)(te.bZ,{side:"right",align:"center",className:"w-96",animate:"slide-in",children:(0,s.jsxs)(s.Fragment,{children:[C.sql.trim()?(0,s.jsx)(tp.Z,{showCopy:!1,className:"sql",parentClassName:"!p-0 [&>div>span]:text-xs [&>div>span]:tracking-tighter",children:C.sql.replaceAll("\n"," ").replaceAll(/\s+/g," ").slice(0,43)+"".concat(C.sql.length>43?"...":"")}):(0,s.jsx)("p",{className:"text-xs text-foreground-lighter",children:"This query is empty"}),C.sql.trim()&&(0,s.jsx)(tx.Z,{iconOnly:!0,type:"default",className:"px-1 absolute top-1.5 right-1.5",text:C.sql})]})})]}),(0,s.jsx)(th,{snippet:t,visible:d,onCancel:()=>u(!1),onComplete:()=>u(!1)}),(0,s.jsx)(eI.Z,{title:"Confirm to delete query",confirmLabel:"Delete query",confirmLabelLoading:"Deleting query",size:"medium",loading:I,visible:x,variant:"destructive",onCancel:()=>f(!1),onConfirm:Z,alert:"project"===S?{title:"This SQL snippet will be lost forever",description:"Deleting this query will remove it for all members of the project team."}:void 0,children:(0,s.jsxs)("p",{className:"text-sm",children:["Are you sure you want to delete '",w,"'?"]})}),(0,s.jsx)(eI.Z,{title:"Confirm sharing query",size:"medium",confirmLabel:"Share query",confirmLabelLoading:"Sharing query",visible:h,onCancel:()=>p(!1),onConfirm:z,alert:{title:"This SQL query will become public to all team members",description:"Anyone with access to the project can view it"},children:(0,s.jsxs)("ul",{className:"text-sm text-foreground-light space-y-5",children:[(0,s.jsxs)("li",{className:"flex gap-3",children:[(0,s.jsx)(tN.Z,{}),(0,s.jsx)("span",{children:"Project members will have read-only access to this query."})]}),(0,s.jsxs)("li",{className:"flex gap-3",children:[(0,s.jsx)(tw.Z,{}),(0,s.jsx)("span",{children:"Anyone will be able to duplicate it to their personal snippets."})]})]})}),(0,s.jsx)(tc,{id:N,visible:g,onCancel:()=>j(!1)})]})},tC=n(75652),tS=n.n(tC);let tk=(e,t,n)=>{let s=t.findIndex(e=>e.id===n[n.length-1]),a=t.findIndex(t=>t.id===e),i=t.slice(Math.min(a,s),Math.max(a,s)+1);if(a<s&&i.reverse(),!n.includes(e))return tS()(n.concat(i.map(e=>e.id)));{let t=i.map(e=>e.id);return n.filter(n=>n===e||!t.includes(n))}};var tE=()=>{let{ref:e,id:t}=(0,m.UO)(),n=(0,r.useRouter)(),{profile:a}=(0,eB.Un)(),i=(0,c.Vm)(),[o,d]=(0,l.useState)(""),[u,h]=(0,l.useState)(!1),[p,x]=(0,l.useState)([]),f=(0,eW.W2)(),{isLoading:g,isSuccess:j,isError:v,error:y}=eM(e,{refetchOnWindowFocus:!1,staleTime:300,onSuccess(t){e&&f.setRemoteSnippets(t.snippets,e)}}),{mutate:b,isLoading:N}=(0,ek.z)({onSuccess:e=>w(e),onError:(e,t)=>{404===e.code&&e.message.includes("Content not found")?w(t.ids):ev.ZP.error("Failed to delete queries: ".concat(e.message))}}),w=s=>{var a;h(!1),x([]),s.length>0&&s.forEach(e=>f.removeSnippet(e));let i=(null!==(a=f.orders[e])&&void 0!==a?a:[]).filter(e=>!s.includes(e));0===i.length?n.push("/project/".concat(e,"/sql/new")):s.includes(t)&&n.push("/project/".concat(e,"/sql/").concat(i[0]))},_=(0,eW.Fy)(e),C=(0,l.useMemo)(()=>_.filter(e=>"project"===e.visibility),[_]),S=(0,l.useMemo)(()=>o.length>0?C.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())):C,[C,o]),k=(0,l.useMemo)(()=>{let e=_.filter(e=>"user"===e.visibility&&!e.content.favorite);return o.length>0?e.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())):e},[o,_]),E=(0,l.useMemo)(()=>_.filter(e=>e.content.favorite),[_]),A=(0,l.useMemo)(()=>o.length>0?E.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())):E,[E,o]),T=(0,c.Xo)(eP.KA.CREATE,"user_content",{resource:{type:"sql",owner_id:null==a?void 0:a.id},subject:{id:null==a?void 0:a.id}}),I=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0!==e){if(t){let[t,n]=eL()(p,e=>{var t;return null===(t=_.find(t=>t.id===e))||void 0===t?void 0:t.content.favorite}),s=_.find(t=>t.id===e);(null==s?void 0:s.content.favorite)?t.length>0?x(tk(e,A,t).concat(n)):Z(e):n.length>0?x(tk(e,k,n).concat(t)):Z(e)}else Z(e)}},Z=e=>{p.includes(e)?x(p.filter(t=>t!==e)):x(p.concat([e]))},z=async()=>{if(!e)return console.error("Project is required");if(!a)return console.error("Profile is required");if(!T)return(0,ev.ZP)("Your queries will not be saved as you do not have sufficient permissions");try{let t=(0,eD.UA)({id:(0,eq.k$)(),name:eO.$C,owner_id:null==a?void 0:a.id,project_id:null==i?void 0:i.id});f.addSnippet(t,e),n.push("/project/".concat(e,"/sql/").concat(t.id)),d("")}catch(e){ev.ZP.error("Failed to create new query: ".concat(e.message))}},P=async()=>{if(!e)return console.error("Project ref is required");b({projectRef:e,ids:p})};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)(q.z,{type:"default",className:"justify-start mx-4",onClick:()=>z(),icon:(0,s.jsx)(ex.Z,{className:"text-foreground-muted",strokeWidth:1,size:14}),children:"New query"}),(0,s.jsxs)("div",{className:"px-2",children:[(0,s.jsx)(e1,{title:"Templates",isActive:n.asPath==="/project/".concat(e,"/sql/templates"),href:"/project/".concat(e,"/sql/templates"),children:"Templates"}),(0,s.jsx)(e1,{title:"Quickstarts",isActive:n.asPath==="/project/".concat(e,"/sql/quickstarts"),href:"/project/".concat(e,"/sql/quickstarts"),children:"Quickstarts"})]}),g&&(0,s.jsx)(e8,{}),v&&(0,s.jsx)("div",{className:"px-4",children:(0,s.jsx)(eF.Z,{error:y,subject:"Failed to load SQL snippets"})}),j&&(0,s.jsxs)(s.Fragment,{children:[_.length>0&&(0,s.jsx)(e2,{className:"mx-2",children:(0,s.jsx)(e4,{name:"search-queries",placeholder:"Search queries...",onChange:e=>d(e.target.value.trim()),value:o,"aria-labelledby":"Search queries"})}),o.length>0&&0===S.length&&0===A.length&&0===S.length&&(0,s.jsx)(e6,{className:"mx-4",title:"No project queries found",description:"Click the New query button to create a new query",actions:(0,s.jsx)(q.z,{type:"default",onClick:()=>z(),children:"New query"})}),S.length>0&&(0,s.jsxs)(eQ,{className:"editor-product-menu",defaultOpen:!0,children:[(0,s.jsx)(e$,{title:"Project queries"}),(0,s.jsx)(eJ,{children:(0,s.jsx)(s.Fragment,{children:S.map(e=>(0,s.jsx)(t_,{tabInfo:e,onDeleteQuery:w,hasQueriesSelected:p.length>0},e.id))})})]}),p.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e0,{}),(0,s.jsxs)("div",{className:"px-4 flex items-center gap-x-2 py-2",children:[(0,s.jsxs)(q.z,{block:!0,type:"danger",onClick:()=>h(!0),children:["Delete ",p.length.toLocaleString()," quer",p.length>1?"ies":"y"]}),(0,s.jsxs)(eG.u,{delayDuration:100,children:[(0,s.jsx)(eG.aJ,{asChild:!0,children:(0,s.jsx)(q.z,{type:"default",onClick:()=>x([]),children:"Cancel"})}),(0,s.jsx)(eG._v,{side:"bottom",children:"Clear selection"})]})]})]}),A.length>0&&(0,s.jsxs)(eQ,{className:"editor-product-menu",defaultOpen:!0,children:[(0,s.jsx)(e$,{title:"Favorites"}),(0,s.jsx)(eJ,{children:(0,s.jsx)(s.Fragment,{children:A.map(e=>(0,s.jsx)(t_,{tabInfo:e,isSelected:p.includes(e.id),hasQueriesSelected:p.length>0,onSelectQuery:t=>I(e.id,t),onDeleteQuery:w},e.id))})})]}),k.length>0&&(0,s.jsxs)(eQ,{className:"editor-product-menu",defaultOpen:!0,children:[(0,s.jsx)(e$,{title:"Your queries"}),(0,s.jsx)(eJ,{className:"editor-product-menu",children:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"space-y-0.5",children:k.map(e=>(0,s.jsx)(t_,{tabInfo:e,isSelected:p.includes(e.id),hasQueriesSelected:p.length>0,onSelectQuery:t=>I(e.id,t),onDeleteQuery:w},e.id))})})})]})]})]})}),(0,s.jsx)(eI.Z,{title:"Confirm to delete query",confirmLabel:"Delete ".concat(p.length.toLocaleString()," quer").concat(p.length>1?"ies":"y"),confirmLabelLoading:"Deleting query",size:"medium",loading:N,visible:u,onConfirm:P,onCancel:()=>h(!1),variant:"destructive",alert:{title:"This action cannot be undone",description:"The selected SQL snippets cannot be recovered once deleted"},children:(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to delete the selected ",p.length," quer",p.length>1?"ies":"y","?"]})})]})},tA=(0,c.QO)(e=>{let{title:t,children:n}=e,a=(0,l.useMemo)(()=>(0,s.jsx)(tE,{},"sql-editor-menu"),[]);return(0,s.jsx)(em.Z,{title:t||"SQL",product:"SQL Editor",productMenu:a,isBlocking:!1,resizableSidebar:!0,children:n})}),tT=n(6659),tI=n(38421),tZ=n.n(tI),tz=e=>{let{heading:t,subheading:n,logoLinkToMarketingSite:a=!1,showHeadings:i=!0,children:r}=e,{resolvedTheme:l}=(0,tT.F)();return(0,s.jsxs)("div",{className:"flex-1 bg-studio flex flex-col gap-8 lg:gap-16 xl:gap-32",children:[(0,s.jsx)("div",{className:"sticky top-0 mx-auto w-full max-w-7xl px-8 pt-6 sm:px-6 lg:px-8",children:(0,s.jsx)("nav",{className:"relative flex items-center justify-between sm:h-10",children:(0,s.jsx)("div",{className:"flex flex-shrink-0 flex-grow items-center lg:flex-grow-0",children:(0,s.jsx)("div",{className:"flex w-full items-center justify-between md:w-auto",children:(0,s.jsx)(j(),{href:a?"https://supabase.com":"/projects",children:(0,s.jsx)(tZ(),{src:(null==l?void 0:l.includes("dark"))?"".concat(u.GW,"/img/supabase-dark.svg"):"".concat(u.GW,"/img/supabase-light.svg"),alt:"",height:24,width:120})})})})})}),(0,s.jsx)("div",{className:"flex flex-col justify-center items-center",children:(0,s.jsxs)("main",{className:"max-w-[448px] w-full flex flex-col px-5",children:[i&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl lg:text-3xl mt-8 mb-2",children:t}),(0,s.jsx)("h2",{className:"text-foreground-light text-sm",children:n})]}),r]})})]})},tP=n(85945),tR=n(97295),tL=n(20085),tO=n(49639),tD=e=>{let{heading:t,subheading:n,showDisclaimer:a=!0,logoLinkToMarketingSite:i=!1,children:o}=e,d=(0,r.useRouter)(),m=(0,tP.NL)(),{resolvedTheme:h}=(0,tT.F)(),p=(0,c.P5)("ongoingIncident");(0,l.useEffect)(()=>{tR.I8.initialize().then(async e=>{let{error:t}=e;if(!t){if(await (0,tR.hP)()){let{data:e,error:t}=await tR.I8.mfa.getAuthenticatorAssuranceLevel();if(t)return;if(e){if("/sign-in-mfa"===d.pathname)return;if(e.currentLevel!==e.nextLevel){let e=(0,tR.lJ)("/sign-in-mfa");d.replace(e);return}}await m.resetQueries(),d.push((0,tR.nD)())}else{let e=(0,tR.lJ)("/sign-in");d.replace(e);return}}}).catch(()=>{})},[]);let[x,f]=(0,l.useState)(null);return(0,l.useEffect)(()=>{f(tL.UW[Math.floor(Math.random()*tL.UW.length)])},[]),(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex flex-col flex-1 bg-alternative",children:[(0,s.jsx)("div",{className:"absolute top-0 w-full px-8 mx-auto sm:px-6 lg:px-8 ".concat(p?"mt-14":"mt-6"),children:(0,s.jsxs)("nav",{className:"relative flex items-center justify-between sm:h-10",children:[(0,s.jsx)("div",{className:"flex items-center flex-grow flex-shrink-0 lg:flex-grow-0",children:(0,s.jsx)("div",{className:"flex items-center justify-between w-full md:w-auto",children:(0,s.jsx)(j(),{href:i?"https://supabase.com":"/projects",children:(0,s.jsx)(tZ(),{src:(null==h?void 0:h.includes("dark"))?"".concat(u.GW,"/img/supabase-dark.svg"):"".concat(u.GW,"/img/supabase-light.svg"),alt:"Supabase Logo",height:24,width:120})})})}),(0,s.jsx)("div",{className:"items-center hidden space-x-3 md:ml-10 md:flex md:pr-4",children:(0,s.jsx)(q.z,{asChild:!0,type:"default",icon:(0,s.jsx)(tO.Z,{}),children:(0,s.jsx)(j(),{href:"https://supabase.com/docs",target:"_blank",rel:"noreferrer",children:"Documentation"})})})]})}),(0,s.jsxs)("div",{className:"flex flex-1",children:[(0,s.jsxs)("main",{className:"flex flex-col items-center flex-1 flex-shrink-0 px-5 pt-16 pb-8 border-r shadow-lg bg-studio border-default",children:[(0,s.jsxs)("div",{className:"flex-1 flex flex-col justify-center w-[330px] sm:w-[384px]",children:[(0,s.jsxs)("div",{className:"mb-10",children:[(0,s.jsx)("h1",{className:"mt-8 mb-2 text-2xl lg:text-3xl",children:t}),(0,s.jsx)("h2",{className:"text-sm text-foreground-light",children:n})]}),o]}),a&&(0,s.jsx)("div",{className:"sm:text-center",children:(0,s.jsxs)("p",{className:"text-xs text-foreground-lighter sm:mx-auto sm:max-w-sm",children:["By continuing, you agree to Supabase's"," ",(0,s.jsx)(j(),{href:"https://supabase.com/terms",className:"underline hover:text-foreground-light",children:"Terms of Service"})," ","and"," ",(0,s.jsx)(j(),{href:"https://supabase.com/privacy",className:"underline hover:text-foreground-light",children:"Privacy Policy"}),", and to receive periodic emails with updates."]})})]}),(0,s.jsx)("aside",{className:"flex-col items-center justify-center flex-1 flex-shrink hidden basis-1/4 xl:flex",children:null!==x&&(0,s.jsxs)("div",{className:"relative flex flex-col gap-6",children:[(0,s.jsx)("div",{className:"absolute select-none -top-12 -left-11",children:(0,s.jsx)("span",{className:"text-[160px] leading-none text-foreground-muted/30",children:""})}),(0,s.jsx)("blockquote",{className:"z-10 max-w-lg text-3xl",children:x.text}),(0,s.jsxs)("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-4",children:[(0,s.jsx)("img",{src:"https://supabase.com".concat(x.img_url),alt:x.handle,className:"w-12 h-12 rounded-full"}),(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsxs)("cite",{className:"not-italic font-medium text-foreground-light whitespace-nowrap",children:["@",x.handle]})})]})]})})]})]})})},tF=n(53535),tU=n(84255),tM=n(24990),tq=n(91547),tB=n(85642),tW=n(33259),tG=n(48228),tH=n(88354),tY=n(42654);async function tV(e){let{projectRef:t,id:n,isPublic:s,file_size_limit:a,allowed_mime_types:i}=e;if(!t)throw Error("projectRef is required");if(!n)throw Error("Bucket name is requried");let r=await (0,tH.v_)("".concat(u.T5,"/storage/").concat(t,"/buckets"),{id:n,public:s,file_size_limit:a,allowed_mime_types:i});if(r.error)throw r.error;return r}let tK=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,tP.NL)();return(0,tG.D)(e=>tV(e),{async onSuccess(t,n,a){let{projectRef:i}=n;await s.invalidateQueries(tY.m.buckets(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?ev.Am.error("Failed to create bucket: ".concat(e.message)):t(e,n,s)},...n})};var tX=n(22854),tQ=n(48869),t$=n(11992),tJ=n(43687),t0=n(62284),t1=e=>{var t;let{visible:n,onClose:a}=e,{ref:i}=(0,m.UO)(),o=(0,r.useRouter)(),{mutate:c,isLoading:d}=tK({onSuccess:e=>{ev.ZP.success("Successfully created bucket ".concat(e.name)),o.push("/project/".concat(i,"/storage/buckets/").concat(e.name)),a()}}),{data:h}=(0,tW.k)({projectRef:i},{enabled:u.Qy}),{value:p,unit:x}=(0,tB.Ku)(null!==(t=null==h?void 0:h.fileSizeLimit)&&void 0!==t?t:0),f="".concat(p," ").concat(x),[g,v]=(0,l.useState)(tq.b.BYTES),[y,b]=(0,l.useState)(!1),N=async e=>{if(!i)return console.error("Project ref is required");c({projectRef:i,id:e.name,isPublic:e.public,file_size_limit:e.has_file_size_limit?(0,tB.Fm)(e.formatted_size_limit,g):null,allowed_mime_types:e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):null})};return(0,l.useEffect)(()=>{n&&(v(tq.b.BYTES),b(!1))},[n]),(0,s.jsx)(eN.C,{hideFooter:!0,visible:n,size:"medium",header:"Create storage bucket",onCancel:()=>a(),children:(0,s.jsx)(ew.Z,{validateOnBlur:!1,initialValues:{name:"",public:!1,file_size_limit:0,allowed_mime_types:"",has_file_size_limit:!1,formatted_size_limit:0},validate:e=>{let t={};return e.name||(t.name="Please provide a name for your bucket"),e.name&&e.name.endsWith(" ")&&(t.name="The name of the bucket cannot end with a whitespace"),e.has_file_size_limit&&e.formatted_size_limit<0&&(t.formatted_size_limit="File size upload limit has to be at least 0"),"public"===e.name&&(t.name='"public" is a reserved name. Please choose another name'),t},onSubmit:N,children:e=>{let{values:t}=e;return(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)(eN.C.Content,{children:[(0,s.jsx)(e_.Z,{id:"name",name:"name",type:"text",className:"w-full",layout:"vertical",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created.",descriptionText:"Only lowercase letters, numbers, dots, and hyphens"}),(0,s.jsxs)("div",{className:"space-y-2 mt-6",children:[(0,s.jsx)(tX.Z,{id:"public",name:"public",layout:"flex",label:"Public bucket",descriptionText:"Anyone can read any object without any authorization"}),t.public&&(0,s.jsxs)(tQ.b,{title:"Public buckets are not protected",variant:"warning",withIcon:!0,children:[(0,s.jsx)("p",{className:"mb-2",children:"Users can read objects in public buckets without any authorization."}),(0,s.jsx)("p",{children:"Row level security (RLS) policies are still required for other operations such as object uploads and deletes."})]})]})]}),(0,s.jsxs)(t$.ZP,{open:y,onOpenChange:()=>b(!y),children:[(0,s.jsx)(t$.ZP.Trigger,{asChild:!0,children:(0,s.jsxs)("div",{className:"w-full cursor-pointer py-3 px-5 flex items-center justify-between border-t border-default",children:[(0,s.jsx)("p",{className:"text-sm",children:"Additional configuration"}),(0,s.jsx)(tJ.Z,{size:18,strokeWidth:2,className:(0,eA.cn)("text-foreground-light",y&&"rotate-180")})]})}),(0,s.jsx)(t$.ZP.Content,{className:"py-4",children:(0,s.jsxs)("div",{className:"w-full space-y-4 px-5",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(tX.Z,{id:"has_file_size_limit",name:"has_file_size_limit",layout:"flex",label:"Restrict file upload size for bucket",descriptionText:"Prevent uploading of file sizes greater than a specified limit"}),t.has_file_size_limit&&(0,s.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,s.jsx)("div",{className:"col-span-8",children:(0,s.jsx)(e_.Z,{type:"number",step:1,id:"formatted_size_limit",name:"formatted_size_limit",disabled:!1,onKeyPress:e=>{(e.charCode<48||e.charCode>57)&&e.preventDefault()},descriptionText:"Equivalent to ".concat((0,tB.Fm)(t.formatted_size_limit,g).toLocaleString()," bytes.")})}),(0,s.jsx)("div",{className:"col-span-4",children:(0,s.jsx)(t0.Z,{id:"size_limit_units",disabled:!1,value:g,onChange:v,children:Object.values(tq.b).map(e=>(0,s.jsx)(t0.Z.Option,{label:e,value:e,children:(0,s.jsx)("div",{children:e})},e))})}),u.Qy&&(0,s.jsx)("div",{className:"col-span-12",children:(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: The"," ",(0,s.jsx)(j(),{href:"/project/".concat(i,"/settings/storage"),className:"text-brand opacity-80 hover:opacity-100 transition",children:"global upload limit"})," ","takes precedence over this value (",f,")"]})})]})]}),(0,s.jsx)(e_.Z,{id:"allowed_mime_types",name:"allowed_mime_types",layout:"vertical",label:"Allowed MIME types",placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc",labelOptional:"Comma separated values",descriptionText:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type."})]})})]}),(0,s.jsx)("div",{className:"w-full border-t border-default !mt-0"}),(0,s.jsx)(eN.C.Content,{children:(0,s.jsxs)("div",{className:"flex items-center space-x-2 justify-end",children:[(0,s.jsx)(q.z,{type:"default",htmlType:"button",disabled:d,onClick:()=>a(),children:"Cancel"}),(0,s.jsx)(q.z,{type:"primary",htmlType:"submit",loading:d,disabled:d,children:"Save"})]})})]})}})})};async function t2(e){let{projectRef:t,id:n,isPublic:s,file_size_limit:a,allowed_mime_types:i}=e;if(!t)throw Error("projectRef is required");if(!n)throw Error("Bucket name is requried");let r=await (0,tH.r$)("".concat(u.T5,"/storage/").concat(t,"/buckets/").concat(n),{public:s,file_size_limit:a,allowed_mime_types:i});if(r.error)throw r.error;return r}let t4=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,tP.NL)();return(0,tG.D)(e=>t2(e),{async onSuccess(t,n,a){let{projectRef:i}=n;await s.invalidateQueries(tY.m.buckets(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?ev.Am.error("Failed to update bucket: ".concat(e.message)):t(e,n,s)},...n})};var t3=e=>{var t;let{visible:n,bucket:a,onClose:i}=e,{ref:r}=(0,m.UO)(),{mutate:o,isLoading:c}=t4({onSuccess:()=>{ev.ZP.success('Successfully updated bucket "'.concat(null==a?void 0:a.name,'"')),i()}}),{data:d}=(0,tW.k)({projectRef:r},{enabled:u.Qy}),{value:h,unit:p}=(0,tB.Ku)(null!==(t=null==d?void 0:d.fileSizeLimit)&&void 0!==t?t:0),x="".concat(h," ").concat(p),[f,g]=(0,l.useState)(tq.b.BYTES),[v,y]=(0,l.useState)(!1),b=async e=>void 0===a?console.error("Bucket is required"):void 0===r?console.error("Project ref is required"):void o({projectRef:r,id:a.id,isPublic:e.public,file_size_limit:e.has_file_size_limit?(0,tB.Fm)(e.formatted_size_limit,f):null,allowed_mime_types:e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):null});return(0,l.useEffect)(()=>{if(n){var e;let{unit:t}=(0,tB.Ku)(null!==(e=null==a?void 0:a.file_size_limit)&&void 0!==e?e:0);g(t),y(!1)}},[n]),(0,s.jsx)(eN.C,{hideFooter:!0,visible:n,size:"medium",header:'Edit bucket "'.concat(null==a?void 0:a.name,'"'),onCancel:i,children:(0,s.jsx)(ew.Z,{validateOnBlur:!1,initialValues:{},validate:e=>{let t={};return e.has_file_size_limit&&e.formatted_size_limit<0&&(t.formatted_size_limit="File size upload limit has to be at least 0"),t},onSubmit:b,children:e=>{let{values:t,resetForm:o}=e;return(0,l.useEffect)(()=>{if(n&&void 0!==a){var e,t,s;let{value:n}=(0,tB.Ku)(null!==(e=a.file_size_limit)&&void 0!==e?e:0),i={name:null!==(t=a.name)&&void 0!==t?t:"",public:a.public,file_size_limit:a.file_size_limit,allowed_mime_types:(null!==(s=a.allowed_mime_types)&&void 0!==s?s:[]).join(", "),has_file_size_limit:null!==a.file_size_limit,formatted_size_limit:null!=n?n:0};o({values:i,initialValues:i})}},[n]),(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)(eN.C.Content,{children:[(0,s.jsx)(e_.Z,{disabled:!0,id:"name",name:"name",type:"text",className:"w-full",layout:"vertical",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created."}),(0,s.jsxs)("div",{className:"space-y-2 mt-6",children:[(0,s.jsx)(tX.Z,{id:"public",name:"public",layout:"flex",label:"Public bucket",descriptionText:"Anyone can read any object without any authorization"}),(null==a?void 0:a.public)!==t.public&&(0,s.jsx)(tQ.b,{title:(null==a?void 0:a.public)||!t.public?(null==a?void 0:a.public)&&!t.public?"Warning: Making bucket private":"":"Warning: Making bucket public",variant:"warning",withIcon:!0,children:(0,s.jsx)("p",{className:"mb-2",children:(null==a?void 0:a.public)||!t.public?(null==a?void 0:a.public)&&!t.public?'All objects in "'.concat(null==a?void 0:a.name,'" will be made private and will only be accessible via signed URLs or downloaded with the right authorisation headers'):"":'This will make all objects in the bucket "'.concat(null==a?void 0:a.name,'" public')})})]})]}),(0,s.jsxs)(t$.ZP,{open:v,onOpenChange:()=>y(!v),children:[(0,s.jsx)(t$.ZP.Trigger,{asChild:!0,children:(0,s.jsxs)("div",{className:"w-full cursor-pointer py-3 px-5 flex items-center justify-between border-t border-default",children:[(0,s.jsx)("p",{className:"text-sm",children:"Additional configuration"}),(0,s.jsx)(tJ.Z,{size:18,strokeWidth:2,className:(0,eA.cn)("text-foreground-light",v&&"rotate-180")})]})}),(0,s.jsx)(t$.ZP.Content,{className:"py-4",children:(0,s.jsxs)("div",{className:"w-full space-y-4 px-5",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(tX.Z,{id:"has_file_size_limit",name:"has_file_size_limit",layout:"flex",label:"Restrict file upload size for bucket",descriptionText:"Prevent uploading of file sizes greater than a specified limit"}),t.has_file_size_limit&&(0,s.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,s.jsx)("div",{className:"col-span-8",children:(0,s.jsx)(e_.Z,{type:"number",step:1,id:"formatted_size_limit",name:"formatted_size_limit",disabled:!1,onKeyPress:e=>{(e.charCode<48||e.charCode>57)&&e.preventDefault()},descriptionText:"Equivalent to ".concat((0,tB.Fm)(t.formatted_size_limit,f).toLocaleString()," bytes.")})}),(0,s.jsx)("div",{className:"col-span-4",children:(0,s.jsx)(t0.Z,{id:"size_limit_units",disabled:!1,value:f,onChange:g,children:Object.values(tq.b).map(e=>(0,s.jsx)(t0.Z.Option,{label:e,value:e,children:(0,s.jsx)("div",{children:e})},e))})}),u.Qy&&(0,s.jsx)("div",{className:"col-span-12",children:(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: The"," ",(0,s.jsx)(j(),{href:"/project/".concat(r,"/settings/storage"),className:"text-brand opacity-80 hover:opacity-100 transition",children:"global upload limit"})," ","takes precedence over this value (",x,")"]})})]})]}),(0,s.jsx)(e_.Z,{id:"allowed_mime_types",name:"allowed_mime_types",layout:"vertical",label:"Allowed MIME types",placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc",labelOptional:"Comma separated values",descriptionText:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type."})]})})]}),(0,s.jsx)("div",{className:"w-full border-t border-default !mt-0"}),(0,s.jsx)(eN.C.Content,{children:(0,s.jsxs)("div",{className:"flex items-center space-x-2 justify-end",children:[(0,s.jsx)(q.z,{type:"default",disabled:c,onClick:()=>i(),children:"Cancel"}),(0,s.jsx)(q.z,{type:"primary",htmlType:"submit",loading:c,disabled:c,children:"Save"})]})})]})}})})},t5=n(18023),t8=n(31696);async function t6(e){let{projectRef:t,id:n}=e;if(!t)throw Error("projectRef is required");if(!n)throw Error("Bucket name is requried");let{data:s,error:a}=await (0,t8.v_)("/platform/storage/{ref}/buckets/{id}/empty",{params:{path:{id:n,ref:t}}});return a&&(0,t8.S3)(a),s}let t9=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,tP.NL)();return(0,tG.D)(e=>t6(e),{async onSuccess(t,n,a){let{projectRef:i}=n;await s.invalidateQueries(tY.m.buckets(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?ev.Am.error("Failed to empty bucket: ".concat(e.message)):t(e,n,s)},...n})},t7=e=>{let{visible:t=!1,bucket:n,onClose:a}=e,{ref:i}=(0,m.UO)(),{fetchFolderContents:r}=(0,tU.H)(),{mutate:l,isLoading:o}=t9({onSuccess:async()=>{void 0!==n&&(await r(n.id,n.name,-1),ev.ZP.success("Successfully deleted bucket ".concat(n.name)),a())}}),c=async()=>i?n?void l({projectRef:i,id:n.id}):console.error("No bucket is selected"):console.error("Project ref is required");return(0,s.jsx)(eI.Z,{variant:"destructive",size:"small",title:"Confirm to delete all contents from ".concat(null==n?void 0:n.name),confirmLabel:"Empty bucket",visible:t,onCancel:()=>a(),onConfirm:c,alert:{title:"This action cannot be undone",description:"The contents of your bucket cannot be recovered once deleted"},children:(0,s.jsxs)("p",{className:"text-sm",children:['Are you sure you want to empty the bucket "',null==n?void 0:n.name,'"?']})})};var ne=n(88787),nt=n(62795),nn=n(93684),ns=function(e){return(0,s.jsx)(E.Z,{icon:nn.Z,...e})},na=n(62134),ni=e=>{let{bucket:t,projectRef:n="",isSelected:a=!1,onSelectEmptyBucket:i=e7(),onSelectDeleteBucket:r=e7(),onSelectEditBucket:l=e7()}=e,o=(0,c.Xo)(eP.KA.STORAGE_ADMIN_WRITE,"*");return(0,s.jsxs)("div",{className:(0,f.default)("group flex items-center justify-between rounded-md",a&&"text-foreground bg-surface-100"),children:[(0,s.jsx)(j(),{href:"/project/".concat(n,"/storage/buckets/").concat(encodeURIComponent(t.id)),className:(0,eA.cn)("py-1 px-3",a?"w-[88%]":"w-full"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between space-x-2 truncate w-full",children:[(0,s.jsx)("p",{className:"text-sm group-hover:text-foreground transition truncate ".concat(a?"text-foreground":"text-foreground-light"),title:t.name,children:t.name}),t.public&&(0,s.jsx)(S.C,{variant:"warning",children:"Public"})]})}),o&&a?(0,s.jsxs)(eT.h_,{children:[(0,s.jsx)(eT.$F,{asChild:!0,children:(0,s.jsx)(q.z,{type:"text",icon:(0,s.jsx)(tJ.Z,{size:"tiny",strokeWidth:2,className:"text-foreground-light"}),className:"mr-1 p-0.5"})}),(0,s.jsxs)(eT.AW,{side:"bottom",align:"start",children:[(0,s.jsxs)(eT.Xi,{className:"space-x-2",onClick:()=>l(),children:[(0,s.jsx)(nt.Z,{size:"tiny"}),(0,s.jsx)("p",{children:"Edit bucket"})]},"toggle-private"),(0,s.jsx)(eT.VD,{}),(0,s.jsxs)(eT.Xi,{className:"space-x-2",onClick:()=>i(),children:[(0,s.jsx)(ns,{size:"tiny"}),(0,s.jsx)("p",{children:"Empty bucket"})]},"delete-bucket"),(0,s.jsxs)(eT.Xi,{className:"space-x-2",onClick:()=>r(),children:[(0,s.jsx)(na.Z,{size:"tiny"}),(0,s.jsx)("p",{children:"Delete bucket"})]},"delete-bucket")]})]}):(0,s.jsx)("div",{className:"w-5"})]},t.id)},nr=()=>{let e=(0,r.useRouter)(),{ref:t,bucketId:n}=(0,m.UO)(),a=(0,c.Vm)(),i=(null==a?void 0:a.parent_project_ref)!==void 0,[o,d]=(0,l.useState)(!1),[u,h]=(0,l.useState)(),[p,x]=(0,l.useState)(),[f,g]=(0,l.useState)(),v=(0,c.Xo)(eP.KA.STORAGE_ADMIN_WRITE,"*"),y=e.pathname.split("/")[4],{data:b,error:N,isLoading:w,isError:_,isSuccess:S}=(0,ne.K)({projectRef:t}),k=null!=b?b:[],E=(null==N?void 0:N.message.includes("Tenant config"))&&i;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(C.ZP,{type:"pills",className:"my-6 flex flex-grow flex-col px-5",children:[(0,s.jsx)("div",{className:"mb-6 px-2",children:(0,s.jsxs)(tM.fC,{delayDuration:0,children:[(0,s.jsx)(tM.xz,{className:"w-full",children:(0,s.jsx)(q.z,{block:!0,type:"default",icon:(0,s.jsx)("div",{className:"text-foreground-light",children:(0,s.jsx)(tg.Z,{size:14})}),disabled:!v,style:{justifyContent:"start"},onClick:()=>d(!0),children:"New bucket"})}),!v&&(0,s.jsx)(tM.h_,{children:(0,s.jsxs)(tM.VY,{side:"bottom",children:[(0,s.jsx)(tM.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to create buckets"})})]})})]})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(C.ZP.Group,{title:(0,s.jsx)("span",{className:"uppercase font-mono",children:"All buckets"})}),w&&(0,s.jsxs)("div",{className:"space-y-2 mx-2",children:[(0,s.jsx)(eS.Z,{className:"!py-2.5"}),(0,s.jsx)(eS.Z,{className:"!py-2.5"}),(0,s.jsx)(eS.Z,{className:"!py-2.5"})]}),_&&(0,s.jsx)("div",{className:"px-2",children:(0,s.jsxs)(M.bZ,{variant:E?"default":"warning",children:[(0,s.jsx)(M.Cd,{className:"text-xs tracking-normal",children:E?"Storage is not available on preview branches for now":"Failed to fetch buckets"}),(0,s.jsx)(M.X,{className:"text-xs",children:E?"We're actively looking into making this available on preview branches":"Please refresh to try again"})]})}),S&&(0,s.jsxs)(s.Fragment,{children:[0===k.length&&(0,s.jsx)("div",{className:"px-2",children:(0,s.jsxs)(M.bZ,{children:[(0,s.jsx)(M.Cd,{children:"No buckets available"}),(0,s.jsx)(M.X,{children:"Buckets that you create will appear here"})]})}),k.map((e,a)=>{let i=n===e.id;return(0,s.jsx)(ni,{bucket:e,projectRef:t,isSelected:i,onSelectEmptyBucket:()=>x(e),onSelectDeleteBucket:()=>g(e),onSelectEditBucket:()=>h(e)},"".concat(a,"_").concat(e.id))})]})]}),(0,s.jsx)("div",{className:"h-px w-full bg-border"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(C.ZP.Group,{title:(0,s.jsx)("span",{className:"uppercase font-mono",children:"Configuration"})}),(0,s.jsx)(j(),{href:"/project/".concat(t,"/storage/policies"),legacyBehavior:!0,children:(0,s.jsx)(C.ZP.Item,{rounded:!0,active:"policies"===y,children:(0,s.jsx)("p",{className:"truncate",children:"Policies"})})}),(0,s.jsx)(j(),{href:"/project/".concat(t,"/settings/storage"),children:(0,s.jsx)(C.ZP.Item,{rounded:!0,children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"truncate",children:"Settings"}),(0,s.jsx)(K.Z,{strokeWidth:1,className:"h-4 w-4"})]})})})]})]})]}),(0,s.jsx)(t1,{visible:o,onClose:()=>d(!1)}),(0,s.jsx)(t3,{visible:void 0!==u,bucket:u,onClose:()=>h(void 0)}),(0,s.jsx)(t7,{visible:void 0!==p,bucket:p,onClose:()=>x(void 0)}),(0,s.jsx)(t5.Iw,{visible:void 0!==f,bucket:f,onClose:()=>g(void 0)})]})},nl=(0,c.QO)(e=>{let{title:t,children:n}=e,{ref:a}=(0,m.UO)(),i=(0,c.Vm)(),r=(0,tU.H)(),{data:o,isLoading:d}=(0,tF.q)({projectRef:a}),h=null==o?void 0:o.autoApiService,p=(null==i?void 0:i.status)===u.S.INACTIVE;(0,l.useEffect)(()=>{!d&&h&&x(h)},[d,a]);let x=async e=>{p||(e.endpoint?r.initStore(a,e.endpoint,e.serviceApiKey,e.protocol):ev.ZP.error("Failed to fetch project configuration. Try refreshing your browser, or reach out to us at support@supabase.io"),r.setLoaded(!0))};return(0,s.jsx)(em.Z,{title:t||"Storage",product:"Storage",productMenu:(0,s.jsx)(nr,{}),children:n})}),no=n(14782),nc=n(31362),nd=n(11280),nu=n(92286),nm=n(49650),nh=n(94957),np=n(11354),nx=n(53475),nf=n(27570),ng=n(46782),nj=n.n(ng),nv=n(38120),ny=n(90286),nb=n.n(ny),nN=n(69960),nw=n(37603),n_=n(57142),nC=n(6564),nS=n(74559),nk=n(59158),nE=n(89689),nA=n(23418),nT=n(52903),nI=n(34420),nZ=e=>{var t,n,a,i,r,l,o,c;let{id:d,projectRef:u,item:h,isLocked:p}=e,{project:x}=(0,nf.d2)(),f=(0,nx._2)(),g=Number(d)===h.id,{data:v=[]}=(0,nT.U)({projectRef:null==x?void 0:x.ref}),y=(0,nI.R)(h.name,"rls_disabled_in_public",["ERROR"],v,f.selectedSchemaName).hasLint,b=(0,nI.R)(h.name,"security_definer_view",["ERROR","WARN"],v,f.selectedSchemaName).hasLint,N=(0,nI.R)(h.name,"materialized_view_in_api",["ERROR","WARN"],v,f.selectedSchemaName).hasLint,w=async()=>{if(m.Qy&&!(null==x?void 0:x.connectionString))return console.error("Connection string is required");let e=ev.ZP.loading("Exporting ".concat(h.name," as CSV..."));try{var t;let n=await (0,nC.hC)({id:h.id,projectRef:u,connectionString:null==x?void 0:x.connectionString}),s=n&&(0,nN.NK)({table:n,columns:null!==(t=n.columns)&&void 0!==t?t:[],primaryKeys:n.primary_keys,relationships:n.relationships},[]),a=(await (0,n_.wF)({projectRef:u,connectionString:null==x?void 0:x.connectionString,table:s})).map(e=>(Object.keys(e).map(t=>{"object"==typeof e[t]&&null!==e[t]&&(e[t]=JSON.stringify(e[t]))}),e));if(a.length>0){let e=nb().unparse(a,{columns:s.columns.map(e=>e.name)}),t=new Blob([e],{type:"text/csv;charset=utf-8;"});nj()(t,"".concat(h.name,"_rows.csv"))}ev.ZP.success("Successfully exported ".concat(h.name," as CSV"),{id:e})}catch(t){ev.ZP.error("Failed to export table: ".concat(t.message),{id:e})}};return(0,s.jsxs)(j(),{title:h.name,href:"/project/".concat(u,"/editor/").concat(h.id),role:"button","aria-label":"View ".concat(h.name),className:(0,eA.cn)("w-full","flex items-center gap-2","py-1 px-2","text-light","rounded-md",g?"bg-selection":"hover:bg-surface-200 focus:bg-surface-200","group","transition"),children:[(0,s.jsxs)(tM.fC,{delayDuration:0,disableHoverableContent:!0,children:[(0,s.jsx)(tM.xz,{className:"min-w-4",asChild:!0,children:h.type===nw.l.TABLE?(0,s.jsx)(nv.Z,{size:15,strokeWidth:1.5,className:"text-foreground-lighter"}):h.type===nw.l.VIEW?(0,s.jsx)(tN.Z,{size:15,strokeWidth:1.5,className:"text-foreground-lighter"}):(0,s.jsx)("div",{className:(0,eA.cn)("flex items-center justify-center text-xs h-4 w-4 rounded-[2px] font-bold",h.type===nw.l.FOREIGN_TABLE&&"text-yellow-900 bg-yellow-500",h.type===nw.l.MATERIALIZED_VIEW&&"text-purple-1000 bg-purple-500",h.type===nw.l.PARTITIONED_TABLE&&"text-foreground-light bg-border-stronger"),children:null===(a=Object.entries(nw.l).find(e=>{let[,t]=e;return t===h.type}))||void 0===a?void 0:null===(n=a[0])||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.toUpperCase()})}),(0,s.jsx)(tM.h_,{children:(0,s.jsxs)(tM.VY,{side:"bottom",className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background text-xs text-foreground capitalize",children:[(0,s.jsx)(tM.Eh,{className:"radix-tooltip-arrow"}),(i=h.type,null===(c=Object.entries(nw.l).find(e=>{let[,t]=e;return t===i}))||void 0===c?void 0:null===(o=c[0])||void 0===o?void 0:null===(l=o.toLowerCase())||void 0===l?void 0:null===(r=l.split("_"))||void 0===r?void 0:r.join(" "))]})})]}),(0,s.jsxs)("div",{className:(0,eA.cn)("truncate","overflow-hidden text-ellipsis whitespace-nowrap flex items-center gap-2 relative w-full",g&&"text-foreground"),children:[(0,s.jsx)("span",{className:(0,eA.cn)(g?"text-foreground":"text-foreground-light group-hover:text-foreground","text-sm","transition","truncate"),children:h.name}),(0,s.jsx)(e=>{let{entity:t}=e,n=null;switch(t.type){case nw.l.TABLE:y&&(n="RLS Disabled");break;case nw.l.VIEW:b&&(n="Security Definer view");break;case nw.l.MATERIALIZED_VIEW:N&&(n="Security Definer view");break;case nw.l.FOREIGN_TABLE:n="RLS is not enforced on foreign tables"}return n?(0,s.jsxs)(tM.fC,{delayDuration:0,disableHoverableContent:!0,children:[(0,s.jsx)(tM.xz,{className:"min-w-4",asChild:!0,children:(0,s.jsx)(tw.Z,{size:14,strokeWidth:2,className:(0,eA.cn)("min-w-4",g?"text-warning-600":"text-warning-500")})}),(0,s.jsx)(tM.h_,{children:(0,s.jsxs)(tM.VY,{side:"bottom",className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background text-xs text-foreground",children:[(0,s.jsx)(tM.Eh,{className:"radix-tooltip-arrow"}),n]})})]}):null},{entity:h})]}),h.type===nw.l.TABLE&&g&&!p&&(0,s.jsxs)(eT.h_,{children:[(0,s.jsx)(eT.$F,{className:"text-foreground-lighter transition-all hover:text-foreground data-[state=open]:text-foreground",children:(0,s.jsx)(tf.Z,{size:14,strokeWidth:2})}),(0,s.jsxs)(eT.AW,{side:"bottom",align:"start",children:[(0,s.jsxs)(eT.Xi,{className:"space-x-2",onClick:e=>{e.stopPropagation(),f.onEditTable()},children:[(0,s.jsx)(nS.Z,{size:"tiny"}),(0,s.jsx)("span",{children:"Edit Table"})]},"edit-table"),(0,s.jsxs)(eT.Xi,{className:"space-x-2",onClick:e=>{e.stopPropagation(),f.onDuplicateTable()},children:[(0,s.jsx)(nk.Z,{size:"tiny"}),(0,s.jsx)("span",{children:"Duplicate Table"})]},"duplicate-table"),(0,s.jsx)(eT.Xi,{className:"space-x-2",asChild:!0,children:(0,s.jsxs)(j(),{href:"/project/".concat(u,"/auth/policies?schema=").concat(f.selectedSchemaName,"&search=").concat(h.id),children:[(0,s.jsx)(nE.Z,{size:"tiny"}),(0,s.jsx)("span",{children:"View Policies"})]},"view-policies")},"view-policies"),(0,s.jsxs)(eT.Xi,{className:"space-x-2",onClick:e=>{e.stopPropagation(),w()},children:[(0,s.jsx)(nA.Z,{size:"tiny"}),(0,s.jsx)("span",{children:"Export as CSV"})]},"download-table-csv"),(0,s.jsx)(eT.VD,{}),(0,s.jsxs)(eT.Xi,{className:"space-x-2",onClick:e=>{e.stopPropagation(),f.onDeleteTable()},children:[(0,s.jsx)(na.Z,{size:"tiny"}),(0,s.jsx)("span",{children:"Delete Table"})]},"delete-table")]})]})]})},nz=()=>{var e,t,n;let a=(0,r.useRouter)(),{id:i}=(0,m.UO)(),o=(0,nx._2)(),[d,u]=(0,l.useState)(!1),[h,p]=(0,l.useState)(""),[x,f]=(0,c._)("table-editor-sort","alphabetical"),{project:g}=(0,nf.d2)(),{data:j,isLoading:v,isSuccess:y,isError:b,error:N,refetch:w,hasNextPage:_,isFetchingNextPage:C,fetchNextPage:S}=(0,nh.H)({projectRef:null==g?void 0:g.ref,connectionString:null==g?void 0:g.connectionString,schema:o.selectedSchemaName,search:h||void 0,sort:x},{keepPreviousData:!!h}),k=(0,l.useMemo)(()=>null==j?void 0:j.pages.flatMap(e=>e.data.entities),[null==j?void 0:j.pages]),{data:E}=(0,nm.Q)({projectRef:null==g?void 0:g.ref,connectionString:null==g?void 0:g.connectionString}),A=null==E?void 0:E.find(e=>e.name===o.selectedSchemaName),T=(0,c.Xo)(eP.KA.TENANT_SQL_ADMIN_WRITE,"tables"),[I]=eL()((null!=E?E:[]).sort((e,t)=>e.name.localeCompare(t.name)),e=>{var t;return np.F.includes(null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"")}),Z=I.some(e=>e.id===(null==A?void 0:A.id));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"pt-5 flex flex-col flex-grow gap-5 h-full",style:{maxHeight:"calc(100vh - 48px)"},children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)(nu.Z,{className:"mx-4 h-7",selectedSchemaName:o.selectedSchemaName,onSelectSchema:e=>{p(""),o.setSelectedSchemaName(e),a.push("/project/".concat(null==g?void 0:g.ref,"/editor"))},onSelectCreateSchema:()=>o.onAddSchema()}),(0,s.jsx)("div",{className:"grid gap-3 mx-4",children:Z?(0,s.jsxs)(M.bZ,{children:[(0,s.jsx)(M.Cd,{className:"text-sm",children:"Viewing protected schema"}),(0,s.jsxs)(M.X,{className:"text-xs",children:[(0,s.jsx)("p",{className:"mb-2",children:"This schema is managed by Supabase and is read-only through the table editor"}),(0,s.jsx)(q.z,{type:"default",size:"tiny",onClick:()=>u(!0),children:"Learn more"})]})]}):(0,s.jsxs)(tM.fC,{delayDuration:0,children:[(0,s.jsx)(tM.xz,{className:"w-full",asChild:!0,children:(0,s.jsx)(q.z,{title:"Create a new table",name:"New table",block:!0,disabled:!T,size:"tiny",icon:(0,s.jsx)(ex.Z,{size:14,strokeWidth:1.5,className:"text-foreground-muted"}),type:"default",className:"justify-start",onClick:o.onAddTable,children:"New table"})}),!T&&(0,s.jsx)(tM.h_,{children:(0,s.jsxs)(tM.VY,{side:"bottom",children:[(0,s.jsx)(tM.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to create tables"})})]})})]})})]}),(0,s.jsxs)("div",{className:"flex flex-auto flex-col gap-2 pb-4 px-2",children:[(0,s.jsx)(e2,{children:(0,s.jsx)(e4,{name:"search-tables","aria-labelledby":"Search tables",onChange:e=>{p(e.target.value.trim())},value:h,placeholder:"Search tables...",children:(0,s.jsxs)(e3,{value:x,onValueChange:e=>f(e),children:[(0,s.jsx)(e5,{value:"alphabetical",className:"flex gap-2",children:"Alphabetical"},"alphabetical"),(0,s.jsx)(e5,{value:"grouped-alphabetical",children:"Entity Type"},"grouped-alphabetical")]})})}),v&&(0,s.jsx)(e8,{}),b&&(0,s.jsx)(eF.Z,{error:null!=N?N:null,subject:"Failed to retrieve tables"}),y&&(0,s.jsxs)(s.Fragment,{children:[0===h.length&&(null!==(e=null==k?void 0:k.length)&&void 0!==e?e:0)<=0&&(0,s.jsx)(e6,{className:"mx-2",title:"No entities available",description:"This schema has no entities available yet"}),h.length>0&&(null!==(t=null==k?void 0:k.length)&&void 0!==t?t:0)<=0&&(0,s.jsx)(e6,{className:"mx-2",title:"No results found",description:'Your search for "'.concat(h,'" did not return any results')}),(null!==(n=null==k?void 0:k.length)&&void 0!==n?n:0)>0&&(0,s.jsx)("div",{className:"flex flex-1",children:(0,s.jsx)(nd.Z,{items:k,ItemComponent:nZ,itemProps:{projectRef:null==g?void 0:g.ref,id:Number(i),isLocked:Z},getItemSize:()=>28,hasNextPage:_,isLoadingNextPage:C,onLoadNextPage:()=>S()})})]})]})]}),(0,s.jsx)(nc.b,{visible:d,onClose:()=>u(!1)})]})},nP=e=>{let{children:t}=e,n=(0,c.Xo)(eP.KA.TENANT_SQL_ADMIN_READ,"tables"),a=(0,c.N4)(),i=(0,l.useMemo)(()=>(0,s.jsx)(nz,{}),[]);return a&&!n?(0,s.jsx)(em.$,{isBlocking:!1,children:(0,s.jsx)(no.Z,{isFullPage:!0,resourceText:"view tables from this project"})}):(0,s.jsx)(em.$,{product:"Table Editor",productMenu:i,isBlocking:!1,resizableSidebar:!0,children:t})};n(54266);var nR=n(69532)},48472:function(e,t,n){"use strict";var s=n(52322),a=n(28879),i=n.n(a),r=n(2784),l=n(34503),o=n(32079),c=n(43687),d=n(99248);t.Z=e=>{var t;let{onChange:n,value:a,options:u,loading:m,currentBillingPeriodStart:h,currentBillingPeriodEnd:p}=e,[x,f]=(0,r.useState)(a);(0,r.useEffect)(()=>{y(a)},[m]);let g=i()().startOf("month").format(d.zT),j=i()().add(1,"month").startOf("month").format(d.zT),v=i()().format(d.zT);function y(e){switch(f(e),e){case"currentBillingCycle":n({period_start:{date:i().unix(null!=h?h:0).format(d.zT),time_period:"1d"},period_end:{date:i().unix(null!=p?p:0).format(d.zT),time_period:"today"},interval:"1d"});break;case"previousBillingCycle":n({period_start:{date:i().unix(null!=h?h:0).subtract(1,"month").format(d.zT),time_period:"1d"},period_end:{date:i().unix(null!=h?h:0).format(d.zT),time_period:"today"},interval:"1d"});break;case"1d":n({period_start:{date:i()().subtract(24,"hour").format(d.zT),time_period:"1d"},period_end:{date:v,time_period:"today"},interval:"1h"});break;case"3h":n({period_start:{date:i()().subtract(3,"hour").format(d.zT),time_period:"3h"},period_end:{date:v,time_period:"today"},interval:"5m"});break;case"1h":n({period_start:{date:i()().subtract(1,"hour").format(d.zT),time_period:"1h"},period_end:{date:v,time_period:"today"},interval:"5m"});break;case"7d":n({period_start:{date:i()().subtract(7,"day").format(d.zT),time_period:"7d"},period_end:{date:v,time_period:"today"},interval:"1d"});break;case"30d":n({period_start:{date:i()().subtract(30,"day").format(d.zT),time_period:"30d"},period_end:{date:v,time_period:"today"},interval:"1d"});break;case"60d":n({period_start:{date:i()().subtract(60,"day").format(d.zT),time_period:"60d"},period_end:{date:v,time_period:"today"},interval:"3d"});break;case"startMonth":n({period_start:{date:g,time_period:"startMonth"},period_end:{date:j,time_period:"endMonth"},interval:"1d"});break;default:console.warn("Unknown period encountered: ".concat(e))}}return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(l.h_,{children:[(0,s.jsx)(l.$F,{asChild:!0,children:(0,s.jsx)(o.z,{type:"default",iconRight:(0,s.jsx)(c.Z,{}),children:(0,s.jsx)("span",{children:x&&(null===(t=u.find(e=>e.key===x))||void 0===t?void 0:t.label)})})}),(0,s.jsx)(l.AW,{side:"bottom",align:"start",children:(0,s.jsx)(l._x,{value:x,onValueChange:e=>y(e),children:u.map(e=>(0,s.jsx)(l.qB,{value:e.key,children:e.label},e.key))})})]})})}},41543:function(e,t,n){"use strict";var s=n(52322),a=n(38183),i=n(99248);t.Z=()=>(0,s.jsxs)("div",{className:"flex h-64 flex-col items-center justify-center",children:[(0,s.jsx)(a.Z,{src:"".concat(i.GW,"/img/no-search-results.svg"),preProcessor:e=>e.replace(/svg/,'svg className="mb-2 w-16 h-16 text-color-inherit"')}),(0,s.jsx)("p",{className:"w-64 text-center text-sm opacity-50",children:"Hmm, we couldn't find any results that match your query."})]})},62029:function(e,t,n){"use strict";var s=n(52322),a=n(24990),i=n(32079),r=n(32830);t.Z=e=>{let{title:t="",size:n="medium",children:l,ctaButtonLabel:o="",infoButtonLabel:c="",infoButtonUrl:d="",onClickCta:u=()=>{},loading:m=!1,disabled:h=!1,disabledMessage:p=""}=e,x=o&&u||d&&c;return(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,s.jsx)("div",{className:"flex space-x-4 rounded border bg-surface-100 p-6 shadow-md",children:(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsxs)("div",{className:"".concat("medium"===n?"w-80":"w-[400px]"," space-y-4"),children:[(0,s.jsx)("h5",{className:"text-foreground",children:t}),(0,s.jsx)("div",{className:"flex flex-col space-y-2 text-foreground-light",children:l}),x&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[o&&u&&(0,s.jsxs)(a.fC,{delayDuration:0,children:[(0,s.jsx)(a.xz,{asChild:!0,children:(0,s.jsx)(i.z,{type:"primary",onClick:u,loading:m,disabled:m||h,children:o})}),h&&p.length>0&&(0,s.jsx)(a.h_,{children:(0,s.jsxs)(a.VY,{side:"bottom",children:[(0,s.jsx)(a.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:p})})]})})]}),d&&c?(0,s.jsx)(i.z,{type:"default",icon:(0,s.jsx)(r.Z,{size:14,strokeWidth:1.5}),children:(0,s.jsx)("a",{target:"_blank",rel:"noreferrer",href:d,children:c})}):null]})]})})})})}},67875:function(e,t,n){"use strict";n.d(t,{De:function(){return a},Eb:function(){return c},Qo:function(){return s},R9:function(){return o},Ye:function(){return i},fh:function(){return l},l6:function(){return d},sd:function(){return r}});let s={WEEK:604800,MONTH:2592e3,YEAR:31536e3},a={COLUMNS:"COLUMNS",LIST:"LIST"},i={NAME:"name",UPDATED_AT:"updated_at",CREATED_AT:"created_at",LAST_ACCESSED_AT:"last_accessed_at"},r={ASC:"asc",DESC:"desc"},l={BUCKET:"BUCKET",FILE:"FILE",FOLDER:"FOLDER"},o={READY:"READY",LOADING:"LOADING",EDITING:"EDITING"},c={upload:["INSERT"],download:["SELECT"],list:["SELECT"],update:["SELECT","UPDATE"],move:["SELECT","UPDATE"],copy:["SELECT","INSERT"],remove:["SELECT","DELETE"],createSignedUrl:["SELECT"],createSignedUrls:["SELECT"],getPublicUrl:[]},d={STORAGE_COLUMN:"STORAGE_COLUMN",STORAGE_ITEM:"STORAGE_ITEM",STORAGE_FOLDER:"STORAGE_FOLDER"}},91547:function(e,t,n){"use strict";var s,a;n.d(t,{H:function(){return i},b:function(){return s}});let i=53687091200;(a=s||(s={})).BYTES="bytes",a.KB="KB",a.MB="MB",a.GB="GB"},85642:function(e,t,n){"use strict";n.d(t,{Fm:function(){return i},Ku:function(){return a},Vp:function(){return r}});var s=n(91547);let a=(e,t)=>{if(e<=0)return{value:0,unit:s.b.BYTES};let n=void 0!==t?Object.values(s.b).indexOf(t):Math.floor(Math.log(e)/Math.log(1024)),a=void 0!==t?n<0?0:n:n>3?3:n,i=Object.values(s.b)[a];return{value:e/Math.pow(1024,a),unit:i}},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.b.BYTES,n=Object.values(s.b).indexOf(t);return e<0||n<0?0:e*Math.pow(1024,n)};function r(e,t){if(void 0===t)return"";let n=new URL(t?"".concat(t.autoApiService.protocol,"://").concat(t.autoApiService.endpoint):"https://".concat(e,".supabase.co"));return n.pathname="/storage/v1/s3",n.toString()}},18023:function(e,t,n){"use strict";n.d(t,{Iw:function(){return nd},cm:function(){return te},S:function(){return t$},cx:function(){return na}});var s=n(52322),a=n(99959),i=n(60417),r=n.n(i),l=n(72579),o=n.n(l),c=n(45455),d=n.n(c),u=n(84636),m=n.n(u),h=n(46776),p=n(2784),x=n(62202),f=n(44085),g=n(22721),j=n(99248),v=n(82667),y=n(84255),b=n(67875),N=n(34291),w=n.n(N),_=n(47852),C=n(32079),S=n(48869),k=e=>{let{visible:t=!1,selectedItemsToDelete:n=[],onSelectCancel:a=w(),onSelectDelete:i=w()}=e,[r,l]=(0,p.useState)(!1);(0,p.useEffect)(()=>{l(!1)},[t]);let o=n.length>1,c=o?"Confirm deletion of ".concat(n.length," items"):1===n.length?"Confirm deletion of ".concat(n[0].name):"",d=o?"Are you sure you want to delete the selected ".concat(n.length," items?"):1===n.length?"Are you sure you want to delete the selected ".concat(n[0].type.toLowerCase(),"?"):"";return(0,s.jsx)(_.C,{visible:t,header:(0,s.jsx)("span",{className:"break-words",children:c}),size:"medium",onCancel:a,customFooter:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(C.z,{type:"default",disabled:r,onClick:a,children:"Cancel"}),(0,s.jsx)(C.z,{type:"danger",disabled:r,loading:r,onClick:()=>{l(!0),i()},children:r?"Deleting":"Delete"})]}),children:(0,s.jsx)(_.C.Content,{children:(0,s.jsx)("div",{className:"my-4",children:(0,s.jsx)(S.b,{withIcon:!0,variant:"danger",title:"This action cannot be undone.",children:d})})})})},E=n(28879),A=n.n(E),T=n(62277),I=n(750),Z=n(62284);let z={days:86400,weeks:604800,months:2592e3,years:31536e3};var P=(0,h.Pi)(e=>{let{onCopyUrl:t}=e,{getFileUrl:n,selectedFileCustomExpiry:a,setSelectedFileCustomExpiry:i}=(0,y.H)(),r=()=>i(void 0);return(0,s.jsx)(_.C,{hideFooter:!0,size:"small",header:"Custom expiry for signed URL",visible:void 0!==a,alignFooter:"right",confirmText:"Get URL",onCancel:()=>r(),children:(0,s.jsx)(T.Z,{validateOnBlur:!0,initialValues:{expiresIn:"",units:"days"},onSubmit:async(e,s)=>{let{setSubmitting:i}=s;i(!0),t(a.name,await n(a,e.expiresIn*z[e.units])),i(!1),r()},validate:e=>{let t={};return""!==e.expiresIn&&e.expiresIn<=0&&(t.expiresIn="Expiry duration cannot be less than 0"),t},children:e=>{let{values:t,isSubmitting:n}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"pt-4 pb-2",children:(0,s.jsxs)(_.C.Content,{children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light mb-2",children:"Enter the duration for which the URL will be valid for:"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(I.Z,{disabled:n,type:"number",id:"expiresIn",className:"w-full"}),(0,s.jsxs)(Z.Z,{id:"units",className:"w-[150px]",children:[(0,s.jsx)(Z.Z.Option,{id:"days",label:"days",value:"days",children:"days"}),(0,s.jsx)(Z.Z.Option,{id:"weeks",label:"weeks",value:"weeks",children:"weeks"}),(0,s.jsx)(Z.Z.Option,{id:"months",label:"months",value:"months",children:"months"}),(0,s.jsx)(Z.Z.Option,{id:"years",label:"years",value:"years",children:"years"})]})]}),""!==t.expiresIn&&(0,s.jsxs)("p",{className:"text-sm text-foreground-light mt-2",children:["URL will expire on"," ",A()().add(t.expiresIn,t.units).format(j.Cu)]})]})}),(0,s.jsx)(_.C.Separator,{}),(0,s.jsx)(_.C.Content,{children:(0,s.jsxs)("div",{className:"flex items-center justify-end space-x-2 pt-1 pb-3",children:[(0,s.jsx)(C.z,{type:"default",onClick:()=>r(),children:"Cancel"}),(0,s.jsx)(C.z,{disabled:""===t.expiresIn||n,loading:n,htmlType:"submit",type:"primary",children:"Get signed URL"})]})})]})}})})}),R=n(59491),L=n(71623);n(5104);var O=n(14528),D=n(54506),F=n(52905),U=n(74559),M=n(97607),q=n(2515),B=function(e){return(0,s.jsx)(q.Z,{icon:M.Z,...e})},W=n(23418),G=n(70696),H=function(e){return(0,s.jsx)(q.Z,{icon:G.Z,...e})},Y=(0,h.Pi)(e=>{let{id:t="",onCopyUrl:n=w()}=e,{getFileUrl:a,downloadFile:i,selectedBucket:r,setSelectedItemsToDelete:l,setSelectedItemToRename:o,setSelectedItemsToMove:c,setSelectedFileCustomExpiry:d}=(0,y.H)(),u=r.public,m=(0,O.Xo)(R.KA.STORAGE_ADMIN_WRITE,"*"),h=async(e,t,s)=>{if(!t.isCorrupted)switch(e){case"copy":if(void 0!==s&&s<0)return d(t);return n(t.name,await a(t,s));case"rename":return o(t);case"move":return c([t]);case"download":return await i(t)}};return(0,s.jsxs)(L.v2,{id:t,animation:"fade",children:[u?(0,s.jsxs)(L.ck,{onClick:e=>{let{props:t}=e;return h("copy",t.item)},children:[(0,s.jsx)(D.Z,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Get URL"})]}):(0,s.jsxs)(L.rS,{label:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(D.Z,{size:"tiny"}),(0,s.jsx)("span",{className:"text-xs",children:"Get URL"})]}),arrow:(0,s.jsx)(F.Z,{size:"tiny"}),children:[(0,s.jsx)(L.ck,{onClick:e=>{let{props:t}=e;return h("copy",t.item,b.Qo.WEEK)},children:(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Expire in 1 week"})}),(0,s.jsx)(L.ck,{onClick:e=>{let{props:t}=e;return h("copy",t.item,b.Qo.MONTH)},children:(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Expire in 1 month"})}),(0,s.jsx)(L.ck,{onClick:e=>{let{props:t}=e;return h("copy",t.item,b.Qo.YEAR)},children:(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Expire in 1 year"})}),(0,s.jsx)(L.ck,{onClick:e=>{let{props:t}=e;return h("copy",t.item,-1)},children:(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Custom expiry"})})]}),m&&[(0,s.jsxs)(L.ck,{onClick:e=>{let{props:t}=e;return h("rename",t.item)},children:[(0,s.jsx)(U.Z,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Rename"})]},"rename-file"),(0,s.jsxs)(L.ck,{onClick:e=>{let{props:t}=e;return h("move",t.item)},children:[(0,s.jsx)(B,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Move"})]},"move-file"),(0,s.jsxs)(L.ck,{onClick:e=>{let{props:t}=e;return h("download",t.item)},children:[(0,s.jsx)(W.Z,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Download"})]},"download-file"),(0,s.jsx)(L.Z0,{},"file-separator"),(0,s.jsxs)(L.ck,{onClick:e=>{let{props:t}=e;return l([t.item])},children:[(0,s.jsx)(H,{size:"tiny",stroke:"red"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Delete"})]},"delete-file")]]})});let V=(e,t)=>{let n=e.slice(0,t.columnIndex).map(e=>e.name),s=n.length>0?"".concat(n.join("/"),"/").concat(t.name):t.name;(0,v.vQ)(s),x.ZP.success('Copied path to folder "'.concat(t.name,'"'))};var K=e=>{let{id:t=""}=e,{openedFolders:n,downloadFolder:a,setSelectedItemToRename:i,setSelectedItemsToDelete:r}=(0,y.H)(),l=(0,O.Xo)(R.KA.STORAGE_ADMIN_WRITE,"*");return(0,s.jsxs)(L.v2,{id:t,animation:"fade",children:[l&&(0,s.jsxs)(L.ck,{onClick:e=>{let{props:t}=e;return i(t.item)},children:[(0,s.jsx)(U.Z,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Rename"})]}),(0,s.jsxs)(L.ck,{onClick:e=>{let{props:t}=e;return a(t.item)},children:[(0,s.jsx)(W.Z,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Download"})]}),(0,s.jsxs)(L.ck,{onClick:e=>{let{props:t}=e;return V(n,t.item)},children:[(0,s.jsx)(D.Z,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Copy path to folder"})]}),l&&[(0,s.jsx)(L.Z0,{},"separator"),(0,s.jsxs)(L.ck,{onClick:e=>{let{props:t}=e;return r([t.item])},children:[(0,s.jsx)(H,{size:"tiny",stroke:"red"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Delete"})]},"delete")]]})},X=n(78027),Q=function(e){return(0,s.jsx)(q.Z,{icon:X.Z,...e})},$=n(26815),J=n(10304),ee=n(93471),et=function(e){return(0,s.jsx)(q.Z,{icon:ee.Z,...e})},en=e=>{let{id:t=""}=e,{columns:n,selectedItems:a,setSelectedItems:i,setView:l,setSortBy:o,setSortByOrder:c,addNewFolderPlaceholder:d}=(0,y.H)(),u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;d(e)},h=e=>{let t=n[e].items.filter(e=>e.type===b.fh.FILE).map(t=>({...t,columnIndex:e})),s=r()(t.map(e=>e.id));a.filter(e=>s.includes(e.id)).length===t.length?i(a.filter(e=>!s.includes(e.id))):i(m()(a.concat(t),"id"))};return(0,s.jsxs)(L.v2,{id:t,animation:"fade",children:[(0,s.jsxs)(L.ck,{onClick:e=>{let{props:t}=e;return u(t.index)},children:[(0,s.jsx)(Q,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"New folder"})]}),(0,s.jsx)(L.Z0,{}),(0,s.jsxs)(L.ck,{onClick:e=>{let{props:t}=e;return h(t.index)},children:[(0,s.jsx)(D.Z,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Select all items"})]}),(0,s.jsxs)(L.rS,{label:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)($.Z,{size:"tiny"}),(0,s.jsx)("span",{className:"text-xs",children:"View"})]}),arrow:(0,s.jsx)(F.Z,{size:"tiny"}),children:[(0,s.jsx)(L.ck,{onClick:()=>l(b.De.COLUMNS),children:(0,s.jsx)("span",{className:"ml-2 text-xs",children:"As columns"})}),(0,s.jsx)(L.ck,{onClick:()=>l(b.De.LIST),children:(0,s.jsx)("span",{className:"ml-2 text-xs",children:"As list"})})]}),(0,s.jsxs)(L.rS,{label:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(J.Z,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Sort by"})]}),arrow:(0,s.jsx)(F.Z,{size:"tiny"}),children:[(0,s.jsx)(L.ck,{onClick:()=>o(b.Ye.NAME),children:(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Name"})}),(0,s.jsx)(L.ck,{onClick:()=>o(b.Ye.CREATED_AT),children:(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Last created"})}),(0,s.jsx)(L.ck,{onClick:()=>o(b.Ye.UPDATED_AT),children:(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Last modified"})}),(0,s.jsx)(L.ck,{onClick:()=>o(b.Ye.LAST_ACCESSED_AT),children:(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Last accessed"})})]}),(0,s.jsxs)(L.rS,{label:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(et,{size:"tiny"}),(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Sort by order"})]}),arrow:(0,s.jsx)(F.Z,{size:"tiny"}),children:[(0,s.jsx)(L.ck,{onClick:()=>c(b.sd.ASC),children:(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Ascending"})}),(0,s.jsx)(L.ck,{onClick:()=>c(b.sd.DESC),children:(0,s.jsx)("span",{className:"ml-2 text-xs",children:"Descending"})})]})]})},es=n(42114),ea=n(94030),ei=n.n(ea),er=n(97305),el=n(12934),eo=n(11280),ec=n(41679),ed=n(9162),eu=n(4741);let em=(0,ed.sj)({isSearching:!1,setIsSearching:e=>{em.isSearching=e}}),eh=e=>(0,eu.R)(em,e);var ep=n(24990),ex=n(55281),ef=n.n(ex),eg=n(18149),ej=n.n(eg),ev=n(38183),ey=n(84447),eb=n(33286),eN=n(12973),ew=function(e){return(0,s.jsx)(q.Z,{icon:eN.Z,...e})},e_=n(88599),eC=function(e){return(0,s.jsx)(q.Z,{icon:e_.Z,...e})},eS=n(57393),ek=function(e){return(0,s.jsx)(q.Z,{icon:eS.Z,...e})},eE=n(39459),eA=n(34503),eT=n(23056),eI=n(93352),eZ=n.n(eI),ez=e=>{var t;let{item:n,view:a,columnIndex:i}=e,{renameFile:r,renameFolder:l,addNewFolder:o}=(0,y.H)(),c=(0,p.useRef)(null),[d,u]=(0,p.useState)(n.name),m=async(e,t)=>{t&&(t.preventDefault(),t.stopPropagation()),n.type===b.fh.FILE?await r(n,e,i):eZ()(n,"id")?l({...n,columnIndex:i},e,i):o(e,i)};return(0,p.useEffect)(()=>{if(c.current){let e=n.name.lastIndexOf("."),t=-1!==e?e:n.name.length;c.current.setSelectionRange(0,t),c.current.focus()}let e=e=>{"Escape"===e.key&&((null==n?void 0:n.id)!==void 0?m(n.name):o("",i))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,s.jsx)("div",{className:"storage-row flex items-center justify-between rounded bg-gray-500",children:(0,s.jsxs)("div",{className:"flex h-full flex-grow items-center px-2.5",children:[(0,s.jsx)("div",{children:(0,s.jsx)(eP,{view:a,status:n.status,fileType:n.type,mimeType:null===(t=n.metadata)||void 0===t?void 0:t.mimetype})}),(0,s.jsxs)("form",{className:"h-9",onSubmit:e=>m(d,e),children:[(0,s.jsx)("input",{autoFocus:!0,ref:c,className:"storage-row-input ml-3 h-full bg-inherit p-0 px-1 text-sm",type:"text",value:d,onChange:e=>u(e.target.value),onBlur:e=>m(d,e)}),(0,s.jsx)("button",{className:"hidden",type:"submit",onClick:e=>m(d,e)})]})]})})};let eP=e=>{let{view:t,status:n,fileType:a,mimeType:i}=e;if(t===b.De.LIST&&n===b.R9.LOADING)return(0,s.jsx)(ey.Z,{size:16,strokeWidth:2,className:"animate-spin"});if(a===b.fh.BUCKET||a===b.fh.FOLDER){let e=a===b.fh.BUCKET?"".concat(j.GW,"/img/bucket-filled.svg"):a===b.fh.FOLDER?"".concat(j.GW,"/img/folder-filled.svg"):"".concat(j.GW,"/img/file-filled.svg");return(0,s.jsx)(ev.Z,{src:e,preProcessor:e=>e.replace(/svg/,'svg class="w-4 h-4 text-color-inherit opacity-75"')})}return(null==i?void 0:i.includes("image"))?(0,s.jsx)(eb.Z,{size:16,strokeWidth:2}):(null==i?void 0:i.includes("audio"))?(0,s.jsx)(ew,{size:16,strokeWidth:2}):(null==i?void 0:i.includes("video"))?(0,s.jsx)(eC,{size:16,strokeWidth:2}):(0,s.jsx)(ek,{size:16,strokeWidth:2})};var eR=e=>{var t;let{index:n,item:a={},view:i=b.De.COLUMNS,columnIndex:r=0,selectedItems:l=[],openedFolders:o=[],selectedFilePreview:c={},onCopyUrl:u}=e,{getFileUrl:m,popColumnAtIndex:h,pushOpenedFolderAtIndex:p,popOpenedFoldersAtIndex:x,setFilePreview:f,closeFilePreview:g,clearSelectedItems:j,selectedBucket:N,setSelectedItems:w,setSelectedItemsToDelete:_,setSelectedItemToRename:C,setSelectedItemsToMove:S,setSelectedFileCustomExpiry:k,fetchFolderContents:E,downloadFile:A,downloadFolder:T,selectRangeItems:I}=(0,y.H)(),Z=N.public,z={...a,columnIndex:r},P=void 0!==ef()(l,a),F=o.length>r&&ej()(o[r],a),M=!d()(c)&&ej()(c.id,a.id),q=(0,O.Xo)(R.KA.STORAGE_ADMIN_WRITE,"*"),{show:G}=(0,L.av)(),Y=async(e,t)=>{h(e),x(e-1),f(t),j()},K=async(e,t)=>{g(),j(e+1),x(e-1),p(t,e),await E(t.id,t.name,e)},X=e=>{if(e&&0!==l.length){I(r,n);return}void 0!==ef()(l,e=>z.id===e.id)?w(l.filter(e=>z.id!==e.id)):w([...l,z]),g()},Q=a.type===b.fh.FOLDER?[...q?[{name:"Rename",icon:(0,s.jsx)(U.Z,{size:"tiny"}),onClick:()=>C(z)}]:[],{name:"Download",icon:(0,s.jsx)(W.Z,{size:"tiny"}),onClick:()=>T(z)},{name:"Copy path to folder",icon:(0,s.jsx)(D.Z,{size:"tiny"}),onClick:()=>V(o,z)},...q?[{name:"Separator",icon:void 0,onClick:void 0},{name:"Delete",icon:(0,s.jsx)(H,{size:"tiny"}),onClick:()=>_([z])}]:[]]:[...a.isCorrupted?[]:[...Z?[{name:"Get URL",icon:(0,s.jsx)(D.Z,{size:"tiny"}),onClick:async()=>u(z.name,await m(z))}]:[{name:"Get URL",icon:(0,s.jsx)(D.Z,{size:"tiny"}),children:[{name:"Expire in 1 week",onClick:async()=>u(z.name,await m(z,b.Qo.WEEK))},{name:"Expire in 1 month",onClick:async()=>u(z.name,await m(z,b.Qo.MONTH))},{name:"Expire in 1 year",onClick:async()=>u(z.name,await m(z,b.Qo.YEAR))},{name:"Custom expiry",onClick:async()=>k(z)}]}],...q?[{name:"Rename",icon:(0,s.jsx)(U.Z,{size:"tiny"}),onClick:()=>C(z)},{name:"Move",icon:(0,s.jsx)(B,{size:"tiny"}),onClick:()=>S([z])},{name:"Download",icon:(0,s.jsx)(W.Z,{size:"tiny"}),onClick:async()=>await A(z)},{name:"Separator",icon:void 0,onClick:void 0}]:[]],...q?[{name:"Delete",icon:(0,s.jsx)(H,{size:"tiny"}),onClick:()=>_([z])}]:[]],$=a.metadata?(0,v.td)(a.metadata.size):"-",J=a.metadata?a.metadata.mimetype:"-",ee=a.created_at?new Date(a.created_at).toLocaleString():"-",et=a.updated_at?new Date(a.updated_at).toLocaleString():"-",en=(e,t)=>{G(e,{id:t===b.fh.FILE?b.l6.STORAGE_ITEM:b.l6.STORAGE_FOLDER,props:{item:z}})},es=i===b.De.LIST&&a.isCorrupted?"calc(100% - 60px)":i!==b.De.LIST||a.isCorrupted?"100%":"calc(100% - 50px)";return a.status===b.R9.EDITING?(0,s.jsx)(ez,{view:i,item:a,columnIndex:r}):(0,s.jsx)("div",{className:"h-full border-b border-default",onContextMenu:e=>{e.stopPropagation(),a.type===b.fh.FILE?en(e,b.fh.FILE):en(e,b.fh.FOLDER)},children:(0,s.jsxs)("div",{className:["storage-row group flex h-full items-center px-2.5","hover:bg-panel-footer-light [[data-theme*=dark]_&]:hover:bg-panel-footer-dark","".concat(F?"bg-surface-200":""),"".concat(M?"bg-green-500 hover:bg-green-500":""),"".concat(a.status!==b.R9.LOADING?"cursor-pointer":"")].join(" "),onClick:e=>{e.stopPropagation(),e.preventDefault(),a.status===b.R9.LOADING||F||M||(a.type===b.fh.FOLDER||a.type===b.fh.BUCKET?K(r,a):Y(r,a))},children:[(0,s.jsxs)("div",{className:["flex items-center",i===b.De.LIST?"w-[40%] min-w-[250px]":"w-[90%]"].join(" "),children:[(0,s.jsxs)("div",{className:"relative w-[30px]",onClick:e=>e.stopPropagation(),children:[!P&&(0,s.jsx)("div",{className:"absolute ".concat(a.type===b.fh.FILE?"group-hover:hidden":""),style:{top:"2px"},children:(0,s.jsx)(eP,{view:i,status:a.status,fileType:a.type,mimeType:null===(t=a.metadata)||void 0===t?void 0:t.mimetype})}),(0,s.jsx)(el.Z,{label:"",className:"w-full ".concat(a.type!==b.fh.FILE?"invisible":""," ").concat(P?"opacity-100":"opacity-0 group-hover:opacity-100"),checked:P,onChange:e=>{e.stopPropagation(),X(e.nativeEvent.shiftKey)}})]}),(0,s.jsx)("p",{title:a.name,className:"truncate text-sm",style:{width:es},children:a.name}),a.isCorrupted&&(0,s.jsxs)(ep.fC,{delayDuration:0,children:[(0,s.jsx)(ep.xz,{children:(0,s.jsx)(eE.Z,{size:18,strokeWidth:2,className:"text-foreground-light"})}),(0,s.jsx)(ep.h_,{children:(0,s.jsxs)(ep.VY,{side:"bottom",children:[(0,s.jsx)(ep.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"File is corrupted, please delete and reupload again."})})]})})]})]}),i===b.De.LIST&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"w-[11%] min-w-[100px] truncate text-sm",children:$}),(0,s.jsx)("p",{className:"w-[14%] min-w-[100px] truncate text-sm",children:J}),(0,s.jsx)("p",{className:"w-[15%] min-w-[160px] truncate text-sm",children:ee}),(0,s.jsx)("p",{className:"w-[15%] min-w-[160px] truncate text-sm",children:et})]}),(0,s.jsx)("div",{className:"flex items-center justify-end ".concat(i===b.De.LIST?"flex-grow":"w-[10%]"),onClick:e=>e.stopPropagation(),children:a.status===b.R9.LOADING?(0,s.jsx)(ey.Z,{className:"animate-spin ".concat(i===b.De.LIST?"invisible":""),size:16,strokeWidth:2}):(0,s.jsxs)(eA.h_,{modal:!1,children:[(0,s.jsx)(eA.$F,{children:(0,s.jsx)("div",{className:"storage-row-menu opacity-0",children:(0,s.jsx)(eT.Z,{size:16,strokeWidth:2})})}),(0,s.jsx)(eA.AW,{side:"bottom",align:"end",children:Q.map(e=>{var t,n,a;return(null!==(t=null==e?void 0:e.children)&&void 0!==t?t:[]).length>0?(0,s.jsxs)(eA.Ph,{children:[(0,s.jsxs)(eA.kt,{className:"space-x-2",children:[e.icon||(0,s.jsx)(s.Fragment,{}),(0,s.jsx)("p",{children:e.name})]}),(0,s.jsx)(eA.cq,{children:(0,s.jsx)(eA.TG,{children:null===(n=null!==(a=null==e?void 0:e.children)&&void 0!==a?a:[])||void 0===n?void 0:n.map(e=>(0,s.jsx)(eA.Xi,{onClick:e.onClick,children:(0,s.jsx)("p",{children:e.name})},e.name))})})]},e.name):"Separator"===e.name?(0,s.jsx)(eA.VD,{},e.name):(0,s.jsxs)(eA.Xi,{className:"space-x-2",onClick:e.onClick,children:[e.icon||(0,s.jsx)(s.Fragment,{}),(0,s.jsx)("p",{children:e.name})]},e.name)})})]})})]})})};let eL=e=>{let{isOpen:t,onDragLeave:n,onDrop:a,folderIsEmpty:i}=e;return(0,s.jsx)(es.u,{show:t,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0",enterTo:"transform opacity-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100",leaveTo:"transform opacity-0",className:"h-full w-full absolute top-0",children:(0,s.jsx)("div",{onDragLeave:n,onDrop:a,className:"absolute top-0 flex h-full w-full items-center justify-center",style:{backgroundColor:i?"rgba(0,0,0,0.1)":"rgba(0,0,0,0.2)"},children:!i&&(0,s.jsxs)("div",{className:"w-3/4 h-32 border-2 border-dashed border-muted rounded-md flex flex-col items-center justify-center p-6 pointer-events-none",style:{backgroundColor:"rgba(0,0,0,0.4)"},children:[(0,s.jsx)(er.Z,{className:"text-white pointer-events-none",size:20,strokeWidth:2}),(0,s.jsx)("p",{className:"text-center text-sm  text-white mt-2 pointer-events-none",children:"Drop your files to upload to this folder"})]})})})};var eO=e=>{let{index:t=0,view:n=b.De.COLUMNS,column:a,fullWidth:i=!1,openedFolders:r=[],selectedItems:l=[],selectedFilePreview:c={},itemSearchString:d,onFilesUpload:u=w(),onSelectAllItemsInColumn:m=w(),onSelectColumnEmptySpace:h=w(),onColumnLoadMore:x=w(),onCopyUrl:f=w()}=e,[g,y]=(0,p.useState)(!1),N=(0,p.useRef)(null),_=eh();(0,p.useEffect)(()=>{if(N){let{scrollHeight:e,clientHeight:t}=N.current;e>t&&(N.current.scrollTop+=e-t)}},[a]);let C=l.length>0,S=a.items.map(e=>e.id),k=a.items.filter(e=>e.type===b.fh.FILE),E=l.filter(e=>S.includes(e.id)).filter(e=>e.type===b.fh.FILE),A=a.items,T=ei()(A.map(e=>o()(e,["metadata","size"],0))),I=0===a.items.filter(e=>e.status!==b.R9.LOADING).length,{show:Z}=(0,L.av)(),z=e=>{e&&(e.stopPropagation(),e.preventDefault(),"dragover"!==e.type||g||y(!0))},P=()=>(0,s.jsx)(el.Z,{label:"",className:"-mt-0.5",checked:0!==k.length&&E.length===k.length,disabled:0===k.length,onChange:()=>m(t)});return(0,s.jsxs)("div",{ref:N,className:"\n        ".concat(i?"w-full":"w-64 border-r border-overlay","\n        ").concat((b.De.COLUMNS,""),"\n        hide-scrollbar relative flex flex-shrink-0 flex-col overflow-auto\n      "),onContextMenu:e=>{Z(e,{id:b.l6.STORAGE_COLUMN,props:{index:t}})},onDragOver:z,onDrop:e=>{z(e),u(e,t)},onClick:e=>{let n=o()(e.target,["className"],"");"string"==typeof n&&n.includes("react-contexify")||h(t)},children:[n===b.De.COLUMNS&&(0,s.jsx)("div",{className:"sticky top-0 z-10 mb-0 flex items-center bg-table-header-light px-2.5 [[data-theme*=dark]_&]:bg-table-header-dark ".concat(C?"h-10 py-3 opacity-100":"h-0 py-0 opacity-0"," transition-all duration-200"),onClick:e=>e.stopPropagation(),children:k.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P,{}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["Select all ",k.length," files"]})]}):(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"No files available for selection"})}),n===b.De.LIST&&(0,s.jsxs)("div",{className:" sticky top-0 z-10 flex min-w-min items-center border-b border-overlay bg-surface-100 px-2.5 py-2 ",children:[(0,s.jsxs)("div",{className:"flex w-[40%] min-w-[250px] items-center",children:[(0,s.jsx)(P,{}),(0,s.jsx)("p",{className:"text-sm",children:"Name"})]}),(0,s.jsx)("p",{className:"w-[11%] min-w-[100px] text-sm",children:"Size"}),(0,s.jsx)("p",{className:"w-[14%] min-w-[100px] text-sm",children:"Type"}),(0,s.jsx)("p",{className:"w-[15%] min-w-[160px] text-sm",children:"Created at"}),(0,s.jsx)("p",{className:"w-[15%] min-w-[160px] text-sm",children:"Last modified at"})]}),a.status===b.R9.LOADING&&(0,s.jsxs)("div",{className:"\n            ".concat(i?"w-full":"w-64 border-r border-default","\n            px-2 py-1 my-1 flex flex-shrink-0 flex-col space-y-2 overflow-auto\n          "),children:[(0,s.jsx)(ec.Z,{}),(0,s.jsx)(ec.Z,{}),(0,s.jsx)(ec.Z,{})]}),(0,s.jsx)(eo.Z,{items:A,itemProps:{view:n,columnIndex:t,selectedItems:l,openedFolders:r,selectedFilePreview:c,onCopyUrl:f},ItemComponent:eR,getItemSize:e=>0!==e&&e===A.length?85:37,hasNextPage:a.status!==b.R9.LOADING&&a.hasMoreItems,isLoadingNextPage:a.isLoadingMoreItems,onLoadNextPage:()=>x(t,a)}),!(_.isSearching&&d.length>0)&&0===a.items.length&&a.status!==b.R9.LOADING&&(0,s.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center",children:[(0,s.jsx)("img",{alt:"storage-placeholder",src:"".concat(j.GW,"/img/storage-placeholder.svg"),className:"opacity-75 pointer-events-none"}),(0,s.jsx)("p",{className:"text-sm my-3 opacity-75",children:"Drop your files here"}),(0,s.jsx)("p",{className:"w-40 text-center text-xs text-foreground-light",children:'Or upload them via the "Upload file" button above'})]}),_.isSearching&&d.length>0&&I&&a.status!==b.R9.LOADING&&(0,s.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center",children:[(0,s.jsx)("p",{className:"text-sm my-3 text-foreground",children:"No results found in this folder"}),(0,s.jsxs)("p",{className:"w-40 text-center text-sm text-foreground-light",children:['Your search for "',d,'" did not return any results']})]}),(0,s.jsx)(eL,{isOpen:g,folderIsEmpty:I,onDragLeave:()=>y(!1),onDrop:()=>y(!1)}),n===b.De.LIST&&(0,s.jsx)("div",{className:" sticky bottom-0 z-10 flex min-w-min items-center bg-panel-footer-light px-2.5 py-2 [[data-theme*=dark]_&]:bg-panel-footer-dark ",children:(0,s.jsxs)("p",{className:"text-sm",children:[(0,v.td)(T)," for ",A.length," items"]})})]})},eD=(0,h.Pi)(e=>{let{view:t=b.De.COLUMNS,columns:n=[],openedFolders:a=[],selectedItems:i=[],selectedFilePreview:r={},itemSearchString:l,onFilesUpload:o=w(),onSelectAllItemsInColumn:c=w(),onSelectColumnEmptySpace:d=w(),onColumnLoadMore:u=w(),onCopyUrl:m=w()}=e,h=(0,p.useRef)(null);return(0,p.useEffect)(()=>{if(h){let{scrollWidth:e,clientWidth:t}=h.current;e>t&&(h.current.scrollLeft+=e-t)}},[n]),(0,s.jsxs)("div",{ref:h,className:"file-explorer flex flex-grow overflow-x-auto justify-between h-full w-full",children:[(0,s.jsx)(en,{id:b.l6.STORAGE_COLUMN}),(0,s.jsx)(Y,{id:b.l6.STORAGE_ITEM,onCopyUrl:m}),(0,s.jsx)(K,{id:b.l6.STORAGE_FOLDER}),t===b.De.COLUMNS?(0,s.jsx)("div",{className:"flex",children:n.map((e,n)=>(0,s.jsx)(eO,{index:n,view:t,column:e,openedFolders:a,selectedItems:i,selectedFilePreview:r,itemSearchString:l,onFilesUpload:o,onSelectAllItemsInColumn:c,onSelectColumnEmptySpace:d,onColumnLoadMore:u,onCopyUrl:m},"column-".concat(n)))}):t===b.De.LIST?(0,s.jsx)(s.Fragment,{children:n.length>0&&(0,s.jsx)(eO,{fullWidth:!0,index:n.length-1,view:t,column:n[n.length-1],selectedItems:i,selectedFilePreview:r,itemSearchString:l,onFilesUpload:o,onSelectAllItemsInColumn:c,onSelectColumnEmptySpace:d,onColumnLoadMore:u,onCopyUrl:m})}):(0,s.jsxs)("div",{children:["Unknown view: ",t]})]})}),eF=n(54073),eU=n.n(eF),eM=n(62795),eq=n(52253),eB=n(49893),eW=n(45856),eG=n(80650),eH=n(90488),eY=n(89682),eV=n(61373),eK=n(63910),eX=n(53449);let eQ=[{key:b.De.COLUMNS,name:"As columns"},{key:b.De.LIST,name:"As list"}],e$=[{key:b.Ye.NAME,name:"Name"},{key:b.Ye.CREATED_AT,name:"Time created"},{key:b.Ye.UPDATED_AT,name:"Time modified"},{key:b.Ye.LAST_ACCESSED_AT,name:"Time last accessed"}],eJ=[{key:b.sd.ASC,name:"Ascending"},{key:b.sd.DESC,name:"Descending"}],e0=e=>{let{loading:t,isSearching:n,breadcrumbs:a,togglePathEdit:i}=e;return(0,s.jsx)("div",{className:"group ".concat(t?"":"cursor-pointer"),onClick:()=>t.isLoading?{}:i(),children:t.isLoading?(0,s.jsxs)("div",{className:"ml-2 flex items-center",children:[(0,s.jsx)(ey.Z,{size:16,strokeWidth:2,className:"animate-spin"}),(0,s.jsx)("p",{className:"ml-3 text-sm",children:t.message})]}):(0,s.jsxs)("div",{className:"flex cursor-pointer items-center",children:[(0,s.jsx)("p",{className:"ml-3 text-sm truncate",children:a[a.length-1]||""}),!n&&(0,s.jsx)("div",{className:"ml-3 flex items-center space-x-2 opacity-0 transition group-hover:opacity-100",children:(0,s.jsx)(C.z,{type:"text",icon:(0,s.jsx)(eM.Z,{}),children:"Navigate"})})]})})},e1=e=>{let{loading:t,isSearching:n,breadcrumbs:a,selectBreadcrumb:i}=e,r=a.map((e,t)=>({name:e,index:t})),l=r.length<=5?r:r.slice(0,2).concat([{name:"...",index:-1}]).concat(r.slice(r.length-2,r.length));return t.isLoading?(0,s.jsxs)("div",{className:"ml-2 flex items-center",children:[(0,s.jsx)(ey.Z,{size:16,strokeWidth:2,className:"animate-spin"}),(0,s.jsx)("p",{className:"ml-3 text-sm",children:t.message})]}):(0,s.jsx)("div",{className:"ml-3 flex items-center ".concat(n&&"max-w-[140px] overflow-x-auto"),children:l.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center",children:[0!==t&&(0,s.jsx)(F.Z,{size:10,strokeWidth:2,className:"mx-3"}),(0,s.jsx)("p",{className:"truncate text-sm ".concat("..."!==e.name?"cursor-pointer":""),style:{maxWidth:"6rem"},onClick:()=>"..."!==e.name?i(e.index):{},children:e.name},e.name)]},e.name))})};var e2=e=>{let{itemSearchString:t="",setItemSearchString:n=w(),onFilesUpload:a=w()}=e,i=eh(),l=(0,eK.cg)(),[o,c]=(0,p.useState)(""),[d,u]=(0,p.useState)(""),[m,h]=(0,p.useState)({isLoading:!1,message:""}),[x,f]=(0,p.useState)(!1),[g,j]=(0,p.useState)(!1),v=(0,p.useRef)(null),N=(0,p.useRef)(null),{view:_,setView:S,columns:k,sortBy:E,setSortBy:A,sortByOrder:T,setSortByOrder:Z,popColumn:z,popColumnAtIndex:P,popOpenedFolders:L,popOpenedFoldersAtIndex:D,fetchFoldersByPath:F,refetchAllOpenedFolders:U,addNewFolderPlaceholder:M,clearOpenedFolders:q,closeFilePreview:B,selectedBucket:W}=(0,y.H)(),G=k.map(e=>e.name),H=k.length<=1,Y=(0,O.Xo)(R.KA.STORAGE_ADMIN_WRITE,"*");(0,p.useEffect)(()=>{t&&u(t)},[]),(0,p.useEffect)(()=>{ej()(N.current,G)||(f(!1),N.current=G)},[G]);let V=(0,p.useCallback)(eU()(n,300),[]),K=()=>{z(),L(),B()},X=async e=>{if(0===e.length)P(0),q(),B();else{let t=e.join("/");h({isLoading:!0,message:"Navigating to ".concat(t,"...")}),await F(e),h({isLoading:!1,message:""})}},$=()=>{u(""),i.setIsSearching(!1),n("")},J=async()=>{j(!0),await U(),j(!1)};return(0,s.jsxs)("div",{className:" flex h-[40px] pl-2 items-center justify-between rounded-t-md border-b border-overlay bg-surface-100",children:[(0,s.jsxs)("div",{className:"flex items-center ".concat(x?"w-1/2":""),children:[G.length>0&&(0,s.jsx)(C.z,{icon:(0,s.jsx)(eq.Z,{size:16,strokeWidth:2}),size:"tiny",type:"text",className:"".concat(G.length>1?"opacity-100":"opacity-25"," px-1"),disabled:H,onClick:()=>{f(!1),K()}}),x?(0,s.jsx)("form",{className:"ml-2 flex-grow",children:(0,s.jsx)(I.Z,{autoFocus:!0,type:"text",size:"small",value:o,onChange:e=>{c(e.target.value)},placeholder:"e.g Parent Folder/Child Folder",actions:[(0,s.jsx)(C.z,{type:"default",htmlType:"button",onClick:()=>{f(!1)},children:"Cancel"},"cancelPath"),(0,s.jsx)(C.z,{type:"primary",htmlType:"submit",onClick:e=>{e&&(e.preventDefault(),e.stopPropagation()),f(!1),X(r()(o.split("/")))},children:"Go to folder"},"setPath")]},"pathSet")}):_===b.De.COLUMNS?(0,s.jsx)(e0,{loading:m,isSearching:i.isSearching,breadcrumbs:G,togglePathEdit:()=>{f(!0),c(G.slice(1).join("/")),i.isSearching&&$()}}):(0,s.jsx)(e1,{loading:m,isSearching:i.isSearching,breadcrumbs:G,selectBreadcrumb:e=>{P(e),D(e-1)}})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1 px-2",children:[(0,s.jsx)(C.z,{size:"tiny",icon:(0,s.jsx)(eB.Z,{}),type:"text",loading:g,onClick:J,children:"Reload"}),(0,s.jsxs)(eA.h_,{children:[(0,s.jsx)(eA.$F,{asChild:!0,children:(0,s.jsx)(C.z,{type:"text",icon:"LIST"===_?(0,s.jsx)(eW.Z,{size:16,strokeWidth:2}):(0,s.jsx)(eG.Z,{size:16,strokeWidth:2}),children:"View"})}),(0,s.jsxs)(eA.AW,{align:"end",className:"w-40 min-w-0",children:[eQ.map(e=>(0,s.jsx)(eA.Xi,{onClick:()=>S(e.key),children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsx)("p",{children:e.name}),_===e.key&&(0,s.jsx)(eH.Z,{className:"text-brand",strokeWidth:2})]})},e.key)),(0,s.jsx)(eA.VD,{}),(0,s.jsxs)(eA.Ph,{children:[(0,s.jsx)(eA.kt,{children:"Sort by"}),(0,s.jsx)(eA.TG,{className:"w-44",children:e$.map(e=>(0,s.jsx)(eA.Xi,{onClick:()=>A(e.key),children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsx)("p",{children:e.name}),E===e.key&&(0,s.jsx)(eH.Z,{className:"text-brand",strokeWidth:2})]})},e.key))})]}),(0,s.jsxs)(eA.Ph,{children:[(0,s.jsx)(eA.kt,{children:"Sort order"}),(0,s.jsx)(eA.TG,{children:eJ.map(e=>(0,s.jsx)(eA.Xi,{onClick:()=>Z(e.key),children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsx)("p",{children:e.name}),T===e.key&&(0,s.jsx)(eH.Z,{className:"text-brand",strokeWidth:2})]})},e.key))})]})]})]})]}),(0,s.jsx)("div",{className:"h-6 border-r border-control"}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 px-2",children:[(0,s.jsx)("div",{className:"hidden",children:(0,s.jsx)("input",{ref:v,type:"file",multiple:!0,onChange:a})}),(0,s.jsxs)(ep.fC,{delayDuration:0,children:[(0,s.jsx)(ep.xz,{className:"w-full",children:(0,s.jsx)(C.z,{icon:(0,s.jsx)(er.Z,{size:16,strokeWidth:2}),type:"text",disabled:!Y||0===G.length,onClick:()=>{v.current&&v.current.click()},children:"Upload files"})}),!Y&&(0,s.jsx)(ep.h_,{children:(0,s.jsxs)(ep.VY,{side:"bottom",children:[(0,s.jsx)(ep.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to upload files"})})]})})]}),(0,s.jsxs)(ep.fC,{delayDuration:0,children:[(0,s.jsx)(ep.xz,{className:"w-full",children:(0,s.jsx)(C.z,{icon:(0,s.jsx)(Q,{size:16,strokeWidth:2}),type:"text",disabled:!Y||0===G.length,onClick:()=>M(-1),children:"Create folder"})}),!Y&&(0,s.jsx)(ep.h_,{children:(0,s.jsxs)(ep.VY,{side:"bottom",children:[(0,s.jsx)(ep.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to create folders"})})]})})]})]}),(0,s.jsx)("div",{className:"h-6 border-r border-control"}),(0,s.jsx)("div",{className:"flex items-center px-2",children:i.isSearching?(0,s.jsx)(I.Z,{size:"tiny",autoFocus:!0,className:"w-52",icon:(0,s.jsx)(eY.Z,{size:"tiny",strokeWidth:2}),actions:[(0,s.jsx)(eV.Z,{className:"mx-2 cursor-pointer text-foreground",size:"tiny",strokeWidth:2,onClick:$},"close")],placeholder:"Search for a file or folder",type:"text",value:d,onChange:e=>{u(e.target.value),V(e.target.value)}}):(0,s.jsx)(C.z,{icon:(0,s.jsx)(eY.Z,{size:16,strokeWidth:2}),size:"tiny",type:"text",className:"px-1",onClick:()=>{f(!1),i.setIsSearching(!0)}})}),l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-6 border-r border-control"}),(0,s.jsx)("div",{className:"mx-2",children:(0,s.jsx)(eX.Z,{section:["storage",W.name]})})]})]})]})},e4=()=>{let{selectedItems:e,downloadFile:t,downloadSelectedFiles:n,clearSelectedItems:a,setSelectedItemsToDelete:i,setSelectedItemsToMove:r}=(0,y.H)();return(0,s.jsxs)("div",{className:"z-10 flex h-[40px] items-center rounded-t-md bg-brand-400 px-2 py-1 shadow [[data-theme*=dark]_&]:bg-brand-500",children:[(0,s.jsx)(C.z,{icon:(0,s.jsx)(eV.Z,{size:16,strokeWidth:2}),type:"text",onClick:()=>a()}),(0,s.jsxs)("div",{className:"ml-1 flex items-center space-x-3",children:[(0,s.jsxs)("p",{className:"mb-0 text-sm text-foreground",children:[(0,s.jsx)("span",{style:{fontVariantNumeric:"tabular-nums"},children:e.length})," items selected"]}),(0,s.jsx)(C.z,{icon:(0,s.jsx)(W.Z,{size:16,strokeWidth:2}),type:"primary",onClick:async()=>{1===e.length?await t(e[0]):await n(e)},children:"Download"}),(0,s.jsx)("div",{className:"border-r border-green-900 py-3 opacity-50"}),(0,s.jsx)(C.z,{icon:(0,s.jsx)(H,{size:16,strokeWidth:2}),type:"primary",onClick:()=>i(e),children:"Delete"}),(0,s.jsx)(C.z,{icon:(0,s.jsx)(B,{size:16,strokeWidth:2}),type:"primary",onClick:()=>r(e),children:"Move"})]})]})},e3=e=>{var t;let{bucketName:n="",visible:a=!1,selectedItemsToMove:i=[],onSelectCancel:r=w(),onSelectMove:l=w()}=e,[o,c]=(0,p.useState)(!1),[d,u]=(0,p.useState)("");(0,p.useEffect)(()=>{c(!1),u("")},[a]);let m=i.length>1,h=m?"Moving ".concat(i.length," items within ").concat(n):1===i.length?"Moving ".concat(null===(t=i[0])||void 0===t?void 0:t.name," within ").concat(n):"",x=e=>{e&&e.preventDefault(),c(!0),l("/"===d[0]?d.slice(1):d)};return(0,s.jsx)(_.C,{visible:a,header:h,description:"Enter the path to where you'd like to move the file".concat(m?"s":""," to."),size:"medium",onCancel:r,customFooter:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(C.z,{type:"default",onClick:r,children:"Cancel"}),(0,s.jsx)(C.z,{type:"primary",loading:o,onClick:x,children:o?"Moving files":"Move files"})]}),children:(0,s.jsx)(_.C.Content,{children:(0,s.jsxs)("form",{className:"my-4",children:[(0,s.jsx)("div",{className:"relative flex items-center",children:(0,s.jsx)(I.Z,{autoFocus:!0,label:"Path to new directory in ".concat(n),type:"text",className:"w-full",placeholder:"e.g folder1/subfolder2",value:d,descriptionText:"Leave blank to move items to the root of the bucket",onChange:e=>u(e.target.value)})}),(0,s.jsx)("button",{className:"hidden",type:"submit",onClick:x})]})})})},e5=n(43687);let e8=e=>{let{mimeType:t,previewUrl:n}=e;return t&&n?"loading"===n?(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center text-foreground-lighter",children:(0,s.jsx)(ey.Z,{size:14,strokeWidth:2,className:"animate-spin"})}):"skipped"===n?(0,s.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center",children:[(0,s.jsx)(ev.Z,{src:"".concat(j.GW,"/img/file-filled.svg"),preProcessor:e=>e.replace(/svg/,'svg class="mx-auto w-32 h-32 text-color-inherit opacity-75"')}),(0,s.jsx)("p",{className:"mt-2 w-2/5 text-center text-sm",children:"File size is too large to preview in the explorer"})]}):t.includes("image")?(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-contain bg-center bg-no-repeat",style:{backgroundImage:"url('".concat(n,"')")}}):t.includes("audio")?(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center px-10",children:(0,s.jsxs)("audio",{controls:!0,style:{width:"inherit"},children:[(0,s.jsx)("source",{src:n,type:"audio/mpeg"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Your browser does not support the audio element."})]},n)}):t.includes("video")?(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,s.jsxs)("video",{controls:!0,style:{maxHeight:"100%"},children:[(0,s.jsx)("source",{src:n,type:"video/mp4"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Your browser does not support the video tag."})]},n)}):(0,s.jsx)(ev.Z,{src:"".concat(j.GW,"/img/file-filled.svg"),preProcessor:e=>e.replace(/svg/,'svg class="mx-auto w-32 h-32 text-color-inherit opacity-75"')}):(0,s.jsx)(ev.Z,{src:"".concat(j.GW,"/img/file-filled.svg"),preProcessor:e=>e.replace(/svg/,'svg class="mx-auto w-32 h-32 text-color-inherit opacity-75"')})};var e6=e=>{let{onCopyUrl:t}=e,{getFileUrl:n,downloadFile:a,selectedBucket:i,selectedFilePreview:r,closeFilePreview:l,setSelectedItemsToDelete:o,setSelectedFileCustomExpiry:c}=(0,y.H)(),u=!d()(r),m=r.metadata?(0,v.td)(r.metadata.size):null,h=r.metadata?r.metadata.mimetype:null,p=r.created_at?new Date(r.created_at).toLocaleString():"Unknown",x=r.updated_at?new Date(r.updated_at).toLocaleString():"Unknown",f=(0,O.Xo)(R.KA.STORAGE_ADMIN_WRITE,"*");return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(es.u,{show:u,enter:"transition ease-out duration-150",enterFrom:"transform opacity-0",enterTo:"transform opacity-100",leave:"transition ease-in duration-100",leaveFrom:"transform opacity-100",leaveTo:"transform opacity-0",children:(0,s.jsxs)("div",{className:" h-full border-l border-overlay bg-surface-100 p-4",style:{width:450},children:[(0,s.jsx)("div",{className:"flex w-full justify-end text-foreground-lighter transition-colors hover:text-foreground",children:(0,s.jsx)(eV.Z,{className:"cursor-pointer",size:14,strokeWidth:2,onClick:()=>l()})}),(0,s.jsx)("div",{className:"my-4 border border-overlay",children:(0,s.jsx)("div",{className:"flex h-56 w-full items-center 2xl:h-72",children:(0,s.jsx)(e8,{mimeType:h,previewUrl:r.previewUrl})})}),(0,s.jsxs)("div",{className:"w-full space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h5",{className:"break-words text-base text-foreground",children:r.name}),r.isCorrupted&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(eE.Z,{size:14,strokeWidth:2,className:"text-foreground-light"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"File is corrupted, please delete and reupload this file again"})]}),h&&(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:[h,m&&(0,s.jsxs)("span",{children:[" - ",m]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"mb-1 text-xs text-foreground-lighter",children:"Added on"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:p})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"mb-1 text-xs text-foreground-lighter",children:"Last modified"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:x})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2 border-b border-overlay pb-4",children:[(0,s.jsx)(C.z,{type:"default",icon:(0,s.jsx)(W.Z,{size:16,strokeWidth:2}),disabled:r.isCorrupted,onClick:async()=>await a(r),children:"Download"}),i.public?(0,s.jsx)(C.z,{type:"outline",icon:(0,s.jsx)(D.Z,{size:16,strokeWidth:2}),onClick:async()=>t(r.name,await n(r)),disabled:r.isCorrupted,children:"Get URL"}):(0,s.jsxs)(eA.h_,{children:[(0,s.jsx)(eA.$F,{asChild:!0,children:(0,s.jsx)(C.z,{type:"outline",icon:(0,s.jsx)(D.Z,{size:16,strokeWidth:2}),iconRight:(0,s.jsx)(e5.Z,{}),disabled:r.isCorrupted,children:"Get URL"})}),(0,s.jsxs)(eA.AW,{side:"bottom",align:"center",children:[(0,s.jsx)(eA.Xi,{onClick:async()=>t(r.name,await n(r,b.Qo.WEEK)),children:"Expire in 1 week"},"expires-one-week"),(0,s.jsx)(eA.Xi,{onClick:async()=>t(r.name,await n(r,b.Qo.MONTH)),children:"Expire in 1 month"},"expires-one-month"),(0,s.jsx)(eA.Xi,{onClick:async()=>t(r.name,await n(r,b.Qo.YEAR)),children:"Expire in 1 year"},"expires-one-year"),(0,s.jsx)(eA.Xi,{onClick:()=>c(r),children:"Custom expiry"},"custom-expiry")]})]})]}),(0,s.jsxs)(ep.fC,{delayDuration:0,children:[(0,s.jsx)(ep.xz,{asChild:!0,children:(0,s.jsx)(C.z,{type:"outline",disabled:!f,size:"tiny",icon:(0,s.jsx)(H,{size:16,strokeWidth:2}),onClick:()=>o([r]),children:"Delete file"})}),!f&&(0,s.jsx)(ep.h_,{children:(0,s.jsxs)(ep.VY,{side:"bottom",children:[(0,s.jsx)(ep.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to delete this file"})})]})})]})]})]})})})},e9=n(33259);let e7=e=>{var t,n,i;let{bucket:l}=e,{columns:c,selectedFilePreview:u,closeFilePreview:h,selectedItems:N,setSelectedItems:w,clearSelectedItems:_,selectedItemsToDelete:C,clearSelectedItemsToDelete:S,openedFolders:E,popColumnAtIndex:A,popOpenedFoldersAtIndex:T,selectedItemsToMove:I,clearSelectedItemsToMove:Z,view:z,currentBucketName:R,openBucket:L,loadExplorerPreferences:O,fetchFolderContents:D,fetchMoreFolderContents:F,fetchFoldersByPath:U,deleteFolder:M,uploadFiles:q,deleteFiles:B,moveFiles:W}=(0,y.H)(),G=(0,p.useRef)(null),{ref:H}=(0,a.UO)(),{data:Y}=(0,g.z)({projectRef:H}),{data:V}=(0,f.o)({projectRef:H});(0,e9.k)({projectRef:H},{enabled:j.Qy});let K=(null!==(t=null==V?void 0:V.services)&&void 0!==t?t:[]).find(e=>e.app.id==j.pG),X=null==K?void 0:K.app_config,Q="".concat(null!==(n=null==X?void 0:X.protocol)&&void 0!==n?n:"https","://").concat(null!==(i=null==X?void 0:X.endpoint)&&void 0!==i?i:"-"),[$,J]=(0,p.useState)(""),ee=window.innerHeight-122;(0,p.useEffect)(()=>{(async()=>{if(z===b.De.LIST){let e=E.length-1,t=E[e];$?t?await D(t.id,t.name,e,$):await D(l.id,l.name,-1,$):t?await D(t.id,t.name,e):await D(l.id,l.name,-1)}else z===b.De.COLUMNS&&U(E.map(e=>e.name),$,!0)})()},[$]),(0,p.useEffect)(()=>{O()},[]),(0,p.useEffect)(()=>{L(l)},[l]);let et=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;e.persist();let n=e.target.files||e.dataTransfer.items,s=!d()(o()(e,["dataTransfer","items"],[]));await q(n,t,s),e.target.value=""},en=async e=>{await W(e)},es=async()=>{if(1===C.length){let[e]=C;if(e)switch(e.type){case b.fh.FOLDER:await M(e);break;case b.fh.FILE:await B([e])}}else await B(C)},ea=(e,t)=>{var n;let s=(null==Y?void 0:null===(n=Y.customDomain)||void 0===n?void 0:n.status)==="active"?t.replace(Q,"https://".concat(Y.customDomain.hostname)):t;(0,v.vQ)(s,()=>{x.ZP.success("Copied URL for ".concat(e," to clipboard."))})};return(0,s.jsxs)("div",{ref:G,className:" bg-studio border-overlay flex h-full w-full flex-col rounded-md border",children:[0===N.length?(0,s.jsx)(e2,{itemSearchString:$,setItemSearchString:J,onFilesUpload:et}):(0,s.jsx)(e4,{}),(0,s.jsxs)("div",{className:"flex h-full",style:{height:ee},children:[(0,s.jsx)(eD,{view:z,columns:c,openedFolders:E,selectedItems:N,selectedFilePreview:u,itemSearchString:$,onFilesUpload:et,onSelectAllItemsInColumn:e=>{let t=c[e].items.filter(e=>e.type===b.fh.FILE).map(t=>({...t,columnIndex:e})),n=r()(t.map(e=>e.id));N.filter(e=>n.includes(e.id)).length===t.length?w(N.filter(e=>!n.includes(e.id))):w(m()(N.concat(t),"id"))},onSelectColumnEmptySpace:e=>{A(e),T(e-1),h(),_()},onColumnLoadMore:(e,t)=>F(e,t,$),onCopyUrl:ea}),(0,s.jsx)(e6,{onCopyUrl:ea})]}),(0,s.jsx)(k,{visible:C.length>0,selectedItemsToDelete:C,onSelectCancel:S,onSelectDelete:es}),(0,s.jsx)(e3,{bucketName:R,visible:I.length>0,selectedItemsToMove:I,onSelectCancel:Z,onSelectMove:en}),(0,s.jsx)(P,{onCopyUrl:ea})]})};e7.displayName="StorageExplorer";var te=(0,h.Pi)(e7),tt=n(90882),tn=n.n(tt),ts=n(34663),ta=n(27570),ti=n(49521),tr=n(85945),tl=n(48228),to=n(31696),tc=n(11596);async function td(e){let{projectRef:t,connectionString:n,payload:s}=e,a=new Headers;n&&a.set("x-connection-encrypted",n);let{data:i,error:r}=await (0,to.v_)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":n},path:{ref:t}},body:s,headers:a});return r&&(0,to.S3)(r),i}let tu=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,tr.NL)();return(0,tl.D)(e=>td(e),{async onSuccess(t,n,a){let{projectRef:i}=n;await s.invalidateQueries(tc.R.list(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?x.Am.error("Failed to create database policy: ".concat(e.message)):t(e,n,s)},...n})};var tm=n(6499),th=n(20560),tp=n(88787),tx=n(73831),tf=n(3440),tg=n.n(tf),tj=n(17335),tv=n.n(tj);let ty=e=>{let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return new Uint32Array([t])[0].toString(36)},tb=(e,t)=>0===t.length?t:t_(tN(e,t)),tN=(e,t)=>{let n=e.map(e=>e.name);return t.map(e=>{let{definition:t,check:s}=e,a=null!==t?tw(t):tw(s);return a&&n.includes(a)?{...e,bucket:a}:{...e,bucket:"Ungrouped"}})},tw=e=>{var t;let[n]=(null!==(t=null==e?void 0:e.split(" AND "))&&void 0!==t?t:[]).filter(e=>e.includes("bucket_id"));return n?n.split("'")[1]:null},t_=e=>{let t=tg()(e,"bucket");return Object.keys(t).map(e=>({name:e,policies:t[e]}))},tC=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{name:s,definition:a,allowedOperations:i,roles:r}=t,l=a?a.replace(/\s+/g," ").trim():"";return i.map((t,a)=>tS(a,e,s,l,t,r,n))},tS=(e,t,n,s,a,i,r)=>{let l=ty(t);return{name:r?"".concat(n," ").concat(l,"_").concat(e):n,definition:"INSERT"===a?void 0:"(".concat(s,")"),action:"PERMISSIVE",check:"INSERT"===a?"(".concat(s,")"):void 0,command:a,schema:"storage",table:"objects",roles:i.length>0?i:void 0}},tk=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object.keys(b.Eb).filter(t=>{let n=b.Eb[t];if(0===tv()(n,e).length)return t})},tE=(e,t,n,s,a,i,r)=>{let l=ty(t),o=r?"".concat(n," ").concat(l,"_").concat(e):n,c="Add policy for the ".concat(a,' operation under the policy "').concat(n,'"'),d=0===i.length?["public"]:i;return{description:c,statement:'\n    CREATE POLICY "'.concat(o,'"\n    ON storage.objects\n    FOR ').concat(a,"\n    TO ").concat(d.join(", "),"\n    ").concat("INSERT"===a?"WITH CHECK":"USING"," (").concat(s,");\n").replace(/\s+/g," ").trim()}},tA=function(e,t){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{name:s,definition:a,allowedOperations:i,roles:r}=t;return i.map((t,i)=>tE(i,e,s,a||"",t,r,n))},tT=(e,t)=>e.replace("{bucket_id}","'".concat(t,"'"));var tI=n(64306),tZ=n(62134),tz=n(96059),tP=n(81076);let tR=e=>{let{policy:t,table:n,bucketName:a,onSelectPolicyEdit:i=()=>{},onSelectPolicyDelete:r=()=>{}}=e,{name:l,command:o}=t;return(0,s.jsx)("div",{className:"group",children:(0,s.jsxs)(tI.Z.Content,{className:"flex justify-between gap-2 border-b border-overlay py-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center",children:[(0,s.jsx)("div",{className:"font-mono text-xs text-foreground-lighter",children:o}),(0,s.jsx)("div",{className:"flex flex-col gap-2 lg:flex-row",children:(0,s.jsx)("span",{className:"truncate text-sm text-foreground",children:l})})]}),(0,s.jsxs)(eA.h_,{children:[(0,s.jsx)(eA.$F,{children:(0,s.jsx)(C.z,{type:"default",style:{paddingLeft:4,paddingRight:4},icon:(0,s.jsx)(eT.Z,{})})}),(0,s.jsxs)(eA.AW,{side:"bottom",align:"end",children:[(0,s.jsxs)(eA.Xi,{className:"space-x-2",onClick:()=>i(t,a,n),children:[(0,s.jsx)(U.Z,{size:14}),(0,s.jsx)("p",{children:"Edit"})]}),(0,s.jsx)(eA.VD,{}),(0,s.jsxs)(eA.Xi,{className:"space-x-2",onClick:()=>r(t),children:[(0,s.jsx)(tZ.Z,{size:14}),(0,s.jsx)("p",{children:"Delete"})]})]})]})]})})};var tL=e=>{let{table:t="",label:n="",bucket:a={},policies:i=[],onSelectPolicyAdd:r=()=>{},onSelectPolicyEdit:l=()=>{},onSelectPolicyDelete:o=()=>{}}=e;return(0,s.jsx)(tI.Z,{title:[(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(tz.Z,{className:"text-foreground-light",size:"small"}),(0,s.jsx)("h4",{className:"m-0 text-lg",children:(0,s.jsx)("span",{children:n})}),a.public&&(0,s.jsx)(tP.C,{variant:"warning",children:"Public"})]}),(0,s.jsx)(C.z,{type:"outline",onClick:()=>r(a.name,t),children:"New policy"})]},n)],children:0===i.length?(0,s.jsx)("div",{className:"p-4 px-6",children:(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"No policies created yet"})}):(0,s.jsxs)("div",{className:"grid grid-cols-1 divide-y [[data-theme*=dark]_&]:divide-dark",children:[i.map(e=>(0,s.jsx)(tR,{policy:e,table:t,bucketName:a.name,onSelectPolicyEdit:l,onSelectPolicyDelete:o},e.name)),0!==i.length?(0,s.jsx)("div",{className:"px-6 py-2",children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:d()(a)?"objects"===t?"".concat(i.length," polic").concat(i.length>1?"ies":"y"," that are not tied to any buckets"):"".concat(i.length," polic").concat(i.length>1?"ies":"y"," that target your buckets"):"".concat(i.length," polic").concat(i.length>1?"ies":"y"," in ").concat(a.name)})}):null]})})},tO=n(2284),tD=n.n(tO),tF=n(32830);let tU=[{id:"policy-1",templateName:"Allow access to JPG images in a public folder to anonymous users",description:"This policy uses native postgres functions, functions from auth and storage schema",name:"Give anon users access to JPG images in folder",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n  -- restrict bucket\n  bucket_id = {bucket_name}\n  -- allow access to only jpg file\n  AND storage.\"extension\"(name) = 'jpg'\n  -- in the public folder\n  AND LOWER((storage.foldername(name))[1]) = 'public'\n  -- to anonymous users\n  AND auth.role() = 'anon'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND storage.\"extension\"(name) = 'jpg' AND LOWER((storage.foldername(name))[1]) = 'public' AND auth.role() = 'anon'",allowedOperations:[]},{id:"policy-2",templateName:"Give users access to only their own top level folder named as uid",description:"For example a user with id d7bed83c-44a0-4a4f-925f-efc384ea1e50 will be able to access anything under the folder d7bed83c-44a0-4a4f-925f-efc384ea1e50/",name:"Give users access to own folder",statement:'\nCREATE POLICY "policy_name"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n    -- restrict bucket\n    bucket_id = {bucket_name}\n    and (select auth.uid()::text) = (storage.foldername(name))[1]\n);\n    '.trim(),definition:"bucket_id = {bucket_id} AND (select auth.uid()::text) = (storage.foldername(name))[1]",allowedOperations:[]},{id:"policy-3",templateName:"Give users access to a folder only to authenticated users",description:"This policy gives users access to a folder (e.g private) only if they are authenticated",name:"Give users authenticated access to folder",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n    -- restrict bucket\n    bucket_id = {bucket_name}\n    AND (storage.foldername(name))[1] = 'private'\n    AND (select auth.role()) = 'authenticated'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND (storage.foldername(name))[1] = 'private' AND auth.role() = 'authenticated'",allowedOperations:[]},{id:"policy-4",templateName:"Give access to a nested folder called admin/assets only to a specific user",description:'This policy gives read access to all authenticated users for your project to the folder "public"',name:"Give access to a folder",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n	  -- restrict bucket\n    bucket_id = {bucket_name}\n    AND (storage.foldername(name))[1] = 'admin' AND (storage.foldername(name))[2] = 'assets'\n    AND (select auth.uid()::text) = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND (storage.foldername(name))[1] = 'admin' AND (storage.foldername(name))[2] = 'assets' AND (select auth.uid()::text) = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'",allowedOperations:[]},{id:"policy-5",templateName:"Give access to a file to a user",description:"This policy gives access to a specific file to a specific user",name:"Give access to a file to user",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n	  -- restrict bucket\n    bucket_id = {bucket_name}\n    AND name = 'admin/assets/Costa Rican Frog.jpg'\n    AND (select auth.uid()::text) = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND name = 'admin/assets/Costa Rican Frog.jpg' AND (select auth.uid()::text) = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'",allowedOperations:[]}];var tM=n(28019),tq=n(70458);let tB=e=>{let{definition:t="",onUpdatePolicyDefinition:n=()=>{}}=e;return(0,s.jsxs)("div",{className:"flex space-x-12",children:[(0,s.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,s.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"policy-name",children:"Policy definition"}),(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Provide a SQL conditional expression that returns a boolean."})]}),(0,s.jsx)("div",{className:"h-56 w-2/3",children:(0,s.jsx)(tq.Z,{defaultValue:t,onInputChange:n})})]})},tW=e=>{let{allowedOperations:t=[],onToggleOperation:n=()=>{}}=e,a=tk(t);return(0,s.jsxs)("div",{className:"flex justify-between space-x-12",children:[(0,s.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,s.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"allowed-operation",children:"Allowed operation"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["Based on the operations you have selected, you can use the highlighted functions in the"," ",(0,s.jsx)("a",{href:"https://supabase.com/docs/reference/javascript/storage-from-list",target:"_blank",rel:"noreferrer",className:"underline",children:"client library"}),"."]})]}),(0,s.jsxs)("div",{className:"w-2/3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,s.jsx)(el.Z,{label:"SELECT",onChange:()=>n("SELECT"),checked:t.includes("SELECT")}),(0,s.jsx)(el.Z,{label:"INSERT",onChange:()=>n("INSERT"),checked:t.includes("INSERT")}),(0,s.jsx)(el.Z,{label:"UPDATE",onChange:()=>n("UPDATE"),checked:t.includes("UPDATE")}),(0,s.jsx)(el.Z,{label:"DELETE",onChange:()=>n("DELETE"),checked:t.includes("DELETE")})]}),(0,s.jsx)("div",{className:"flex w-5/6 flex-wrap",children:Object.keys(b.Eb).map(e=>(0,s.jsx)("div",{className:"mr-2 mt-2 font-mono",children:(0,s.jsx)(tP.C,{variant:a.includes(e)?"brand":"default",children:e})},e))})]})]})},tG=e=>{let{onViewTemplates:t=()=>{},onReviewPolicy:n=()=>{}}=e;return(0,s.jsxs)("div",{className:"flex w-full items-center justify-end gap-x-2 border-t px-6 py-3 border-default",children:[(0,s.jsx)(C.z,{type:"default",onClick:t,children:"View templates"}),(0,s.jsx)(C.z,{type:"primary",onClick:n,children:"Review"})]})};var tH=e=>{let{policyFormFields:t={},onViewTemplates:n=w(),onUpdatePolicyName:a=w(),onUpdatePolicyDefinition:i=w(),onToggleOperation:r=w(),onUpdatePolicyRoles:l=w(),onReviewPolicy:o=w()}=e,c=t.definition,d=t.roles;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-8 space-y-8 py-6",children:[(0,s.jsx)(_.C.Content,{children:(0,s.jsx)(tM.CM,{name:t.name,limit:50,onUpdatePolicyName:a})}),(0,s.jsx)(_.C.Separator,{}),(0,s.jsx)(_.C.Content,{children:(0,s.jsx)(tW,{allowedOperations:t.allowedOperations,onToggleOperation:r})}),(0,s.jsx)(_.C.Separator,{}),(0,s.jsx)(_.C.Content,{children:(0,s.jsx)(tM.$L,{selectedRoles:d,onUpdateSelectedRoles:l})}),(0,s.jsx)(_.C.Separator,{}),(0,s.jsx)(_.C.Content,{children:(0,s.jsx)(tB,{definition:c,onUpdatePolicyDefinition:i})})]}),(0,s.jsx)(tG,{onViewTemplates:n,onReviewPolicy:o})]})};let tY=()=>(0,s.jsx)("div",{className:"my-10 flex items-center justify-center space-x-2 opacity-50",children:(0,s.jsx)("p",{children:"There are no changes made to this policy"})});var tV=e=>{let{policyStatements:t=[],onSelectBack:n=()=>{},onSelectSave:a=()=>{}}=e,[i,r]=(0,p.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.C.Content,{children:(0,s.jsxs)("div",{className:"space-y-6 py-8",children:[(0,s.jsx)("div",{className:"flex items-center justify-between space-y-8 space-x-4",children:(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["These are the SQL statements that will be used to create your policies. The suffix appended to the end of your policy name (",(0,s.jsx)("code",{children:"[hashString]_[number]"}),") just functions as a unique identifier for each of your policies."]})})}),(0,s.jsxs)("div",{className:"space-y-4 overflow-y-auto",style:{maxHeight:"25rem"},children:[0===t.length&&(0,s.jsx)(tY,{}),t.map((e,t)=>{let n=e.statement||"";return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("span",{children:e.description}),(0,s.jsx)("div",{className:"h-40",children:(0,s.jsx)(tq.Z,{readOnly:!0,defaultValue:n})})]},"policy_".concat(t))})]})]})}),(0,s.jsxs)("div",{className:"flex w-full items-center justify-end gap-2 border-t px-6 py-4 border-default",children:[(0,s.jsx)(C.z,{type:"default",onClick:n,children:"Back to edit"}),t.length>0&&(0,s.jsx)(C.z,{type:"primary",onClick:()=>{r(!0),a()},loading:i,children:"Save policy"})]})]})};let tK={name:"",roles:[],policyIds:[],definition:"",allowedOperations:[]};var tX=e=>{let{visible:t=!1,bucketName:n="",onSelectCancel:a=()=>{},onCreatePolicies:i=()=>{},onSaveSuccess:r=()=>{}}=e,[l,o]=(0,p.useState)(""),[c,d]=(0,p.useState)(""),[u,m]=(0,p.useState)(tK),[h,f]=(0,p.useState)([]);(0,p.useEffect)(()=>{t&&(g(),m(tK))},[t]);let g=()=>d(ts.$A.SELECTION),j=e=>{"new"===e&&m({...u,definition:"bucket_id = '".concat(n,"'")}),d(ts.$A.EDITOR)},v=()=>{o(c),d(ts.$A.TEMPLATES)},y=()=>d(ts.$A.REVIEW),b=async e=>{-1!==(await i(e)).indexOf(!0)?j():r()};return(0,s.jsx)(_.C,{hideFooter:!0,size:c===ts.$A.SELECTION?"medium":"xxlarge",visible:t,contentStyle:{padding:0},header:[(0,s.jsx)(e=>{let{view:t,bucketName:n,onSelectBackFromTemplates:a=w()}=e;return t===ts.$A.TEMPLATES?(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("span",{onClick:a,className:"cursor-pointer text-foreground-lighter transition-colors hover:text-foreground",children:(0,s.jsx)(eq.Z,{strokeWidth:2,size:14})}),(0,s.jsx)("h4",{className:"textlg m-0",children:"Select a template to use for your new policy"})]})}):(0,s.jsxs)("div",{className:"w-full flex items-center justify-between gap-x-2",children:[(0,s.jsx)("h4",{className:"m-0 truncate",children:t===ts.$A.EDITOR||t===ts.$A.SELECTION?"Adding new policy to ".concat(n):t===ts.$A.REVIEW?"Reviewing policies to be created for ".concat(n):void 0}),(0,s.jsx)(C.z,{asChild:!0,type:"default",icon:(0,s.jsx)(tF.Z,{size:14}),children:(0,s.jsxs)("a",{href:"https://supabase.com/docs/learn/auth-deep-dive/auth-policies",target:"_blank",rel:"noreferrer",children:[" ","Documentation"]})})]})},{view:c,bucketName:n,onSelectBackFromTemplates:()=>d(l)},"0")],onCancel:a,children:(0,s.jsx)("div",{className:"w-full",children:c===ts.$A.SELECTION?(0,s.jsx)(ts.pT,{description:"PostgreSQL policies control access to your files and folders",onViewTemplates:v,onViewEditor:()=>j("new"),showAssistantPreview:!1}):c===ts.$A.EDITOR?(0,s.jsx)(tH,{policyFormFields:u,onViewTemplates:v,onUpdatePolicyName:e=>{e.length<=50&&m({...u,name:e})},onUpdatePolicyDefinition:e=>{m({...u,definition:e})},onToggleOperation:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return m({...u,allowedOperations:[e]});let n=u.allowedOperations.includes(e)?tD()(u.allowedOperations.slice(),e):u.allowedOperations.concat([e]);return m({...u,allowedOperations:n})},onUpdatePolicyRoles:e=>{m({...u,roles:e})},onReviewPolicy:()=>{let{name:e,definition:t,allowedOperations:s}=u;return 0===e.length?x.ZP.error("Please provide a name for your policy"):0===t.length?x.ZP.error("Please provide a definition for your policy"):0===s.length?x.ZP.error("Please allow at least one operation in your policy"):void(f(tA(n,u)),y())}}):c===ts.$A.TEMPLATES?(0,s.jsx)(ts.jm,{templates:tU,onUseTemplate:e=>{let{id:t,...s}=e,a=tT(s.definition,n);m({...u,...s,definition:a}),j()},templatesNote:""}):c===ts.$A.REVIEW?(0,s.jsx)(tV,{policyStatements:h,onSelectBack:j,onSelectSave:()=>{b(tC(n,u))}}):(0,s.jsx)("div",{})})})},tQ=()=>(0,s.jsx)(tI.Z,{title:[(0,s.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(tz.Z,{size:"small"}),(0,s.jsx)("h4",{children:"Bucket policies"})]})},"storagePlaceholder")],children:(0,s.jsx)("div",{className:"p-4 px-6",children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Create a bucket first to start writing policies!"})})}),t$=()=>{let{project:e}=(0,ta.d2)(),{ref:t}=(0,a.UO)(),{data:n,isLoading:i}=(0,tp.K)({projectRef:t}),r=null!=n?n:[],[l,c]=(0,p.useState)({}),[u,m]=(0,p.useState)({}),[h,f]=(0,p.useState)({}),{data:g,refetch:j,isLoading:v}=(0,ti.r)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,schema:"storage"}),y=null!=g?g:[],{mutateAsync:b}=tu({onError:()=>{}}),{mutateAsync:N}=(0,th.k)(),{mutate:w}=(0,tm.l)({onSuccess:async()=>{await j(),x.ZP.success("Successfully deleted policy!"),m({})}}),_=d()(l)&&!d()(h)&&o()(h,["bucket"],"").length>0,C=!d()(h)&&!_,S=tb(r,tn()(y,{table:"objects"})),k=o()(ef()(S,{name:"Ungrouped"}),["policies"],[]),E=tn()(y,{table:"buckets"}),A=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";c({}),f({bucket:e,table:t})},T=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";f({bucket:t,table:n}),c(e)},I=()=>{f({})},Z=e=>m(e),z=async()=>{x.ZP.success("Successfully saved policy!"),await j(),I()},P=async t=>e?await Promise.all(t.map(async t=>{try{return await b({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,payload:t}),!1}catch(e){return x.ZP.error("Error adding policy: ".concat(e.message)),!0}})):(console.error("Project is required"),!0),R=async t=>{if(!e)return console.error("Project is required"),!0;try{return await b({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,payload:t}),!1}catch(e){return x.ZP.error("Error adding policy: ".concat(e.message)),!0}},L=async t=>{if(!e)return console.error("Project is required"),!0;try{return await N({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,id:t.id,payload:t}),!1}catch(e){return x.ZP.error("Error updating policy: ".concat(e.message)),!0}},O=async()=>{if(!e)return console.error("Project is required");w({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,id:u.id})};return(0,s.jsxs)("div",{className:"flex min-h-full w-full flex-col",children:[(0,s.jsx)("h3",{className:"text-xl",children:"Storage policies"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-foreground-light",children:"Safeguard your files with policies that define the operations allowed for your users at the bucket level."}),i||v?(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsx)(ey.Z,{className:"animate-spin",size:16})}):(0,s.jsxs)("div",{className:"mt-4 space-y-4",children:[0===r.length&&(0,s.jsx)(tQ,{}),r.map(e=>{let t=o()(ef()(S,{name:e.name}),["policies"],[]).sort((e,t)=>e.name.localeCompare(t.name));return(0,s.jsx)(tL,{table:"objects",label:e.name,bucket:e,policies:t,onSelectPolicyAdd:A,onSelectPolicyEdit:T,onSelectPolicyDelete:Z},e.name)}),(0,s.jsx)("div",{className:"!mb-4 w-full border-b border-muted"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"You may also write policies for the tables under the storage schema directly for greater control"}),(0,s.jsx)(tL,{table:"objects",label:"Other policies under storage.objects",policies:k,onSelectPolicyAdd:A,onSelectPolicyEdit:T,onSelectPolicyDelete:Z}),(0,s.jsx)(tL,{table:"buckets",label:"Policies under storage.buckets",policies:E,onSelectPolicyAdd:A,onSelectPolicyEdit:T,onSelectPolicyDelete:Z})]}),(0,s.jsx)(tX,{visible:_,bucketName:h.bucket,onSelectCancel:I,onCreatePolicies:P,onSaveSuccess:z}),(0,s.jsx)(ts.yV,{schema:"storage",visible:C,table:h.table,selectedPolicyToEdit:l,onSelectCancel:I,onCreatePolicy:R,onUpdatePolicy:L,onSaveSuccess:z}),(0,s.jsx)(tx.Z,{danger:!0,visible:!d()(u),title:"Confirm to delete policy",description:'This is permanent! Are you sure you want to delete the policy "'.concat(u.name,'"'),buttonLabel:"Delete",buttonLoadingLabel:"Deleting",onSelectCancel:()=>m({}),onSelectConfirm:O})]})},tJ=n(88883),t0=n(25309),t1=n(63955),t2=n(30195),t4=n(56006),t3=n(75716),t5=n(88354),t8=n(45101);async function t6(e){let{projectRef:t,fileSizeLimit:n}=e,s=await (0,t5.r$)("".concat(j.T5,"/projects/").concat(t,"/config/storage"),{fileSizeLimit:n});if(s.error)throw s.error;return s}let t9=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,tr.NL)();return(0,tl.D)(e=>t6(e),{async onSuccess(t,n,a){let{projectRef:i}=n;await s.invalidateQueries(t8.U.storage(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?x.ZP.error("Failed to update storage settings: ".concat(e.message)):t(e,n,s)},...n})};var t7=n(22574),ne=n(42070),nt=n(62949),nn=n(91547),ns=n(85642),na=()=>{let{ref:e}=(0,a.UO)(),t=(0,O.Xo)(R.KA.STORAGE_ADMIN_WRITE,"*"),{data:n,error:i,isLoading:r,isSuccess:l,isError:o}=(0,e9.k)({projectRef:e},{enabled:j.Qy}),{isFreeTier:c}=n||{},[d,u]=(0,p.useState)({fileSizeLimit:0,unit:nn.b.BYTES});(0,p.useEffect)(()=>{if(l&&n){let{fileSizeLimit:e}=n,{value:t,unit:s}=(0,ns.Ku)(null!=e?e:0);u({fileSizeLimit:t,unit:s}),f.reset({fileSizeLimit:t,unit:s})}},[l,n]);let m="".concat(new Intl.NumberFormat("en-US").format(nn.H)," bytes"),h=t2.Ry({fileSizeLimit:t2.oQ.number(),unit:t2.jb(nn.b)}).superRefine((e,t)=>{let{unit:n,fileSizeLimit:s}=e,{value:a}=(0,ns.Ku)(nn.H,n);s>a&&t.addIssue({code:t2.NL.custom,message:"Maximum limit is up to ".concat(a.toLocaleString()," ").concat(n,"."),path:["fileSizeLimit"]})}),f=(0,t1.cI)({resolver:(0,tJ.F)(h),defaultValues:d}),{fileSizeLimit:g,unit:v}=f.watch(),{mutate:y,isLoading:b}=t9({onSuccess:()=>{x.ZP.success("Successfully updated storage settings")}}),N=async t=>{if(!e)return console.error("Project ref is required");y({projectRef:e,fileSizeLimit:(0,ns.Fm)(t.fileSizeLimit,t.unit)})};return(0,s.jsx)("div",{children:(0,s.jsxs)(t7.l0,{...f,children:[r&&(0,s.jsx)(ec.A,{}),o&&(0,s.jsx)(t4.Z,{error:i,subject:"Failed to retrieve project's storage configuration"}),l&&(0,s.jsx)("form",{id:"storage-settings-form",className:"",onSubmit:f.handleSubmit(N),children:(0,s.jsxs)("div",{className:"bg-surface-100  overflow-hidden border-muted rounded-md border shadow",children:[(0,s.jsx)("div",{className:"flex flex-col gap-0 divide-y divide-border-muted",children:(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-6 px-8 py-8 lg:gap-12",children:[(0,s.jsx)("div",{className:"relative flex flex-col col-span-12 gap-6 lg:col-span-4",children:(0,s.jsx)("p",{className:"text-sm",children:"Upload file size limit"})}),(0,s.jsxs)("div",{className:"relative flex flex-col col-span-12 gap-x-6 gap-y-2 lg:col-span-8",children:[(0,s.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-2",children:[(0,s.jsx)("div",{className:"col-span-8",children:(0,s.jsx)(t7.Wi,{control:f.control,name:"fileSizeLimit",render:e=>{let{field:t}=e;return(0,s.jsxs)(t7.xJ,{children:[(0,s.jsx)(t7.lX,{className:"text-foreground-light hidden",children:"size"}),(0,s.jsx)(t7.NI,{className:"col-span-8",children:(0,s.jsx)(ne.I,{type:"number",...t,className:"w-full"})}),(0,s.jsx)(t7.zG,{className:"col-start-5 col-span-8"})]})}})}),(0,s.jsx)("div",{className:"col-span-4",children:(0,s.jsx)(t7.Wi,{control:f.control,name:"unit",render:e=>{let{field:t}=e;return(0,s.jsxs)(t7.xJ,{children:[(0,s.jsx)(t7.lX,{className:"hidden",children:"Unit"}),(0,s.jsx)(t7.NI,{className:"col-span-8",children:(0,s.jsxs)(nt.Ph,{disabled:c,value:t.value,onValueChange:t.onChange,children:[(0,s.jsx)(nt.i4,{className:"w-[180px]",children:(0,s.jsx)(nt.ki,{placeholder:"Choose a prefix",children:v})}),(0,s.jsx)(nt.Bw,{children:Object.values(nn.b).map(e=>(0,s.jsx)(nt.Ql,{disabled:c,value:e,children:e},e))})]})}),(0,s.jsx)(t7.zG,{})]})}})})]}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:[v!==nn.b.BYTES&&"Equivalent to ".concat((0,ns.Fm)(g,v).toLocaleString()," bytes. "),"Maximum size in bytes of a file that can be uploaded is 50 GB (",m,")."]})]})]})}),c&&(0,s.jsx)("div",{className:"px-6 pb-6",children:(0,s.jsx)(t3.Z,{icon:(0,s.jsx)(t0.Z,{size:16}),primaryText:"Free Plan has a fixed upload file size limit of 50 MB.",secondaryText:"Upgrade to the Pro plan for a configurable upload file size limit of up to 50 GB."})}),(0,s.jsx)("div",{className:"border-t border-overlay"}),(0,s.jsx)("div",{className:"flex justify-between px-8 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full gap-2",children:[t?(0,s.jsx)("div",{}):(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"You need additional permissions to update storage settings"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(C.z,{type:"default",htmlType:"reset",onClick:()=>f.reset(),disabled:b,children:"Cancel"}),(0,s.jsx)(C.z,{type:"primary",htmlType:"submit",loading:b,disabled:!t||b,children:"Save"})]})]})})]})})]})})},ni=n(5632),nr=n(34820),nl=n(42654);async function no(e){let{projectRef:t,id:n}=e;if(!t)throw Error("projectRef is required");if(!n)throw Error("Bucket name is requried");let s=await (0,t5.v_)("".concat(j.T5,"/storage/").concat(t,"/buckets/").concat(n,"/empty"),{});if(s.error)throw s.error;let a=await (0,t5.$v)("".concat(j.T5,"/storage/").concat(t,"/buckets/").concat(n));if(a.error)throw a.error;return a}let nc=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,tr.NL)();return(0,tl.D)(e=>no(e),{async onSuccess(t,n,a){let{projectRef:i}=n;await s.invalidateQueries(nl.m.buckets(i)),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?x.Am.error("Failed to delete bucket: ".concat(e.message)):t(e,n,s)},...n})};var nd=e=>{var t;let{visible:n=!1,bucket:i,onClose:r}=e,l=(0,ni.useRouter)(),{ref:c}=(0,a.UO)(),{project:d}=(0,ta.d2)(),{data:u}=(0,tp.K)({projectRef:c}),{data:m}=(0,ti.r)({projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString,schema:"storage"}),{mutateAsync:h}=(0,tm.l)(),{mutate:p,isLoading:f}=nc({onSuccess:async()=>{if(!d)return console.error("Project is required");let e=tb(g,(null!=m?m:[]).filter(e=>"objects"===e.table)),t=o()(ef()(e,{name:i.name}),["policies"],[]);await Promise.all(t.map(e=>h({projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString,id:e.id}))),x.ZP.success("Successfully deleted bucket ".concat(i.name)),l.push("/project/".concat(c,"/storage/buckets")),r()}}),g=null!=u?u:[],j=async()=>c?i?void p({projectRef:c,id:i.id}):console.error("No bucket is selected"):console.error("Project ref is required");return(0,s.jsx)(nr.Z,{variant:"destructive",visible:n,title:"Confirm deletion of ".concat(null==i?void 0:i.name),confirmPlaceholder:"Type in name of bucket",onConfirm:j,onCancel:r,confirmString:null!==(t=null==i?void 0:i.name)&&void 0!==t?t:"",loading:f,text:(0,s.jsxs)(s.Fragment,{children:["Your bucket ",(0,s.jsx)("span",{className:"font-bold text-foreground",children:null==i?void 0:i.name})," and all its contents will be permanently deleted."]}),alert:{title:"You cannot recover this bucket once deleted.",description:"All bucket data will be lost."},confirmLabel:"Delete bucket"})}},53449:function(e,t,n){"use strict";var s=n(52322),a=n(30339),i=n(16289),r=n(32079);t.Z=e=>{let{section:t}=e,n=(0,i.WZ)();return(0,s.jsx)(r.z,{size:"tiny",type:"default",onClick:()=>{t&&n.setActiveDocsSection(t),n.setShowProjectApiDocs(!0)},icon:(0,s.jsx)(a.Z,{strokeWidth:1.5,className:"text-foreground-muted"}),children:"API Docs"})}},43276:function(e,t,n){"use strict";var s=n(52322),a=n(39097),i=n.n(a);n(2784);var r=n(84447),l=n(52905),o=n(54383);t.Z=e=>{let t,{title:n,description:a,children:c,footer:d,url:u="",linkHref:m="",imgUrl:h,imgAlt:p,icon:x,className:f,loading:g=!1,fixedHeight:j=!0,hideChevron:v=!1,titleClass:y="",...b}=e,N=u||m||b.onClick,w={};b.onClick?(t="button",w=b):m?(t=i(),w={href:m,...b}):u?(t="a",w={href:u,...b}):(t="div",w=b);let _=["group relative text-left","bg-surface-100","border border-surface","rounded-md p-5 flex flex-row","transition ease-in-out duration-150"];N&&(_=[..._,"cursor-pointer","hover:bg-surface-200","hover:border-control"]),j&&(_=[..._,"h-32"]);let C=e=>{let{children:t}=e;return(0,s.jsx)("div",{className:"mr-4 flex flex-col",children:t})},S=(0,s.jsxs)(s.Fragment,{children:[h&&(0,s.jsx)(C,{children:(0,s.jsx)("img",{className:" transition-all group-hover:scale-110 ",src:"".concat(h),alt:"".concat(p),width:"26"})}),x&&(0,s.jsx)(C,{children:x}),(0,s.jsxs)("div",{className:"flex h-full w-full flex-col space-y-2",children:["string"==typeof n?(0,s.jsx)("h5",{className:"text-foreground pr-5 ".concat(y),children:n}):n,(c||a)&&(0,s.jsxs)("div",{className:"flex w-full flex-1 flex-col",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:a}),(0,s.jsx)("div",{className:"w-full",children:c&&c})]}),d&&(0,s.jsx)("div",{className:"w-full !mt-auto",children:d})]}),N&&(0,s.jsx)("div",{className:" absolute right-4 top-4 text-foreground-lighter transition-all duration-200 group-hover:right-3 group-hover:text-foreground ",children:g?(0,s.jsx)(r.Z,{className:"animate-spin"}):v?(0,s.jsx)(s.Fragment,{}):(0,s.jsx)(l.Z,{})})]});return(0,s.jsx)(t,{...w,className:(0,o.cn)(_,f),children:S})}},13252:function(e,t,n){"use strict";n.d(t,{M:function(){return w}});var s=n(52322),a=n(2784),i=n(37726),r=n.n(i),l=n(61786),o=n(32079),c=n(59629),d=n(37952),u=n(52253),m=n(52905),h=n(10012),p=n(29824),x=n(28879),f=n.n(x),g=n(59119),j=e=>{let{type:t,time:n,setTime:i,setStartTime:r,setEndTime:l,startTime:o,endTime:c,startDate:d,endDate:u}=e,[m,h]=(0,a.useState)(!1);function x(){1===n.HH.length&&(n.HH="0"+n.HH),1===n.mm.length&&(n.mm="0"+n.mm),1===n.ss.length&&(n.ss="0"+n.ss),n.HH||(n.HH="00"),n.mm||(n.mm="00"),n.ss||(n.ss="00");let e=!1,s=!1;(0,p.default)(new Date(d),"dd/mm/yyyy")==(0,p.default)(new Date(u),"dd/mm/yyyy")&&("start"===t&&(n.HH&&Number(n.HH)>Number(c.HH)&&(c.HH=n.HH,e=!0),n.HH&&Number(n.HH)>=Number(c.HH)&&n.mm&&Number(n.mm)>Number(c.mm)&&(c.mm=n.mm,e=!0),n.HH&&Number(n.HH)>=Number(c.HH)&&n.mm&&Number(n.mm)>=Number(c.mm)&&n.ss&&Number(n.ss)>Number(c.ss)&&(c.ss=n.ss,e=!0)),"end"===t&&(n.HH&&Number(n.HH)<Number(o.HH)&&(o.HH=n.HH,s=!0),n.HH&&Number(n.HH)<=Number(o.HH)&&n.mm&&Number(n.mm)<Number(o.mm)&&(o.mm=n.mm,s=!0),n.HH&&Number(n.HH)<=Number(o.HH)&&n.mm&&Number(n.mm)<=Number(o.mm)&&n.ss&&Number(n.ss)<Number(o.ss)&&(o.ss=n.ss,s=!0))),i({...n}),e&&l({...c}),s&&r({...o}),h(!1)}function f(e,t){let s={HH:n.HH,mm:n.mm,ss:n.ss};if(!(e.length>2)){switch(t){case"HH":if(e&&Number(e)>23)return;break;case"mm":case"ss":if(e&&Number(e)>59)return}s[t]=e,i({...s})}}let j=e=>{e.target.select(),h(!0)};return(0,a.useEffect)(()=>{x()},[d,u]),(0,s.jsxs)("div",{className:"\n        flex h-7 items-center justify-center\n        gap-0 rounded border border-strong bg-surface-100 text-xs text-foreground-light\n        ".concat(m&&" border-stronger outline outline-2 outline-border","\n    "),children:[(0,s.jsx)("div",{className:"mr-1 text-foreground-lighter",children:(0,s.jsx)(g.Z,{size:14,strokeWidth:1.5})}),(0,s.jsx)("input",{type:"text",onBlur:()=>x(),onFocus:j,pattern:"[0-23]*",placeholder:"00",onChange:e=>f(e.target.value,"HH"),"aria-label":"Hours",className:" ring-none w-4 border-none bg-transparent p-0 text-center text-xs text-foreground outline-none ring-0 focus:ring-0 ",value:n.HH}),(0,s.jsx)("span",{className:"text-foreground-lighter",children:":"}),(0,s.jsx)("input",{type:"text",onBlur:()=>x(),onFocus:j,pattern:"[0-12]*",placeholder:"00",onChange:e=>f(e.target.value,"mm"),"aria-label":"Minutes",className:" ring-none w-4 border-none bg-transparent p-0 text-center text-xs text-foreground outline-none ring-0 focus:ring-0 ",value:n.mm}),(0,s.jsx)("span",{className:"text-foreground-lighter",children:":"}),(0,s.jsx)("input",{type:"text",onBlur:()=>x(),onFocus:j,pattern:"[0-59]*",placeholder:"00",onChange:e=>f(e.target.value,"ss"),"aria-label":"Seconds",className:" ring-none w-4 border-none bg-transparent p-0 text-center text-xs text-foreground outline-none ring-0 focus:ring-0 ",value:n.ss})]})};let v=new Date,y=new Date,b={HH:"00",mm:"00",ss:"00"},N={HH:"23",mm:"59",ss:"59"};var w=function(e){let{to:t,from:n,onChange:i,triggerButtonType:x="default",triggerButtonClassName:g="",triggerButtonTitle:w,minDate:_,maxDate:C,hideTime:S=!1,hideClear:k=!1,selectsRange:E=!0,renderFooter:A=()=>null,children:T}=e,[I,Z]=(0,a.useState)(!1),[z,P]=(0,a.useState)(null),[R,L]=(0,a.useState)(null),[O,D]=(0,a.useState)(v),[F,U]=(0,a.useState)(y),[M,q]=(0,a.useState)(b),[B,W]=(0,a.useState)(N);return(0,a.useEffect)(()=>{if(n){if(n!==(null==z?void 0:z.toISOString())){let e=f()(n),t=e.toDate();P(t),D(t),q({HH:e.format("HH"),mm:e.format("mm"),ss:e.format("ss")})}}else P(null);if(t){if(t!==(null==R?void 0:R.toISOString())){let e=f()(t),n=e.toDate();L(n),U(n),W({HH:e.format("HH"),mm:e.format("mm"),ss:e.format("ss")})}}else L(null)},[t,n]),(0,s.jsxs)(l.J2,{open:I,onOpenChange:Z,children:[(0,s.jsx)(l.xo,{asChild:!0,children:(0,s.jsx)(o.z,{title:w,type:x,icon:(0,s.jsx)(c.Z,{}),className:g,children:void 0!==T?T:(0,s.jsx)(s.Fragment,{children:E&&z&&R&&z!==R?(0,s.jsxs)(s.Fragment,{children:[(0,p.default)(new Date(z),"dd MMM")," -"," ",(0,p.default)(new Date(R),"dd MMM")]}):z||R?(0,p.default)(new Date(z||R),"dd MMM"):"Custom"})})}),(0,s.jsx)(l.yk,{align:"center",side:"bottom",className:"p-0",children:(0,s.jsxs)(s.Fragment,{children:[S?null:(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex items-stretch justify-between py-2",children:[E?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex grow flex-col gap-1 pl-2",children:(0,s.jsx)(j,{type:"start",startTime:M,endTime:B,time:M,setTime:q,setStartTime:q,setEndTime:W,startDate:O,endDate:F})}),(0,s.jsx)("div",{className:"\n                      flex \n                      w-12 \n                      items-center \n                      justify-center\n                      text-foreground-lighter\n                    ",children:(0,s.jsx)(d.Z,{strokeWidth:1.5,size:14})})]}):null,(0,s.jsx)("div",{className:"flex grow flex-col gap-1 pr-2",children:(0,s.jsx)(j,{type:"end",startTime:M,endTime:B,time:B,setTime:W,setStartTime:q,setEndTime:W,startDate:O,endDate:F})})]})}),(0,s.jsx)("div",{className:"p-2",children:(0,s.jsx)(r(),{inline:!0,selectsRange:E,selected:O,onChange:e=>{!function(e){if(e){if(e instanceof Date)D(e),U(e);else{let[t,n]=e;D(t),U(n)}}else D(null),U(null)}(e)},dateFormat:"MMMM d, yyyy h:mm aa",startDate:O,endDate:F,minDate:_,maxDate:C,dayClassName:()=>"cursor-pointer",renderCustomHeader:e=>{let{date:t,decreaseMonth:n,increaseMonth:a,prevMonthButtonDisabled:i,nextMonthButtonDisabled:r}=e;return(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,s.jsx)("button",{onClick:n,disabled:i,type:"button",className:"\n                        ".concat(i&&"cursor-not-allowed opacity-50","\n                        text-foreground-light hover:text-foreground focus:outline-none p-2\n                    "),children:(0,s.jsx)(u.Z,{size:16,strokeWidth:2})}),(0,s.jsx)("span",{className:"text-sm text-foreground-light",children:(0,p.default)(t,"MMMM yyyy")}),(0,s.jsx)("button",{onClick:a,disabled:r,type:"button",className:"\n                        ".concat(r&&"cursor-not-allowed opacity-50","\n                        text-foreground-light p-2 hover:text-foreground focus:outline-none\n                    "),children:(0,s.jsx)(m.Z,{size:16,strokeWidth:2})})]})})}})}),A({from:(null==O?void 0:O.toISOString())||null,to:(null==F?void 0:F.toISOString())||null}),(0,s.jsx)(h.Z.Separator,{}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2 py-2 px-3 pb-4",children:[!k&&(0,s.jsx)(o.z,{type:"default",onClick:()=>void(Z(!1),D(v),U(y),q(b),W(N),P(null),L(null),i&&i({from:null,to:null})),children:"Clear"}),(0,s.jsx)(o.z,{onClick:()=>(function(){Z(!1),P(O),L(F);let e={from:f()(O).second(Number(M.ss)).minute(Number(M.mm)).hour(Number(M.HH)).toISOString(),to:f()(F||O).second(Number(B.ss)).minute(Number(B.mm)).hour(Number(B.HH)).toISOString()};i&&i(e)})(),children:"Apply"})]})]})})]})}},46666:function(e,t,n){"use strict";n.d(t,{E:function(){return c}});var s=n(52322),a=n(2784),i=n(10012),r=n(19869),l=n(12934),o=n(32079);let c=e=>{let{options:t=[],activeOptions:n=[],valueKey:c,labelKey:d,name:u="default",variant:m="rectangular",onSaveFilters:h,disabled:p}=e,[x,f]=(0,a.useState)(!1),[g,j]=(0,a.useState)([]),v=n.map(e=>{let n=t.find(t=>t[c]===e);return n&&n[d]?n[d]:""});return(0,s.jsx)(i.Z,{side:"bottom",align:"start",disabled:p,open:x,onOpenChange:()=>f(!x),header:(0,s.jsxs)("div",{className:"prose text-xs",children:["Select ",u.toLowerCase()]}),overlay:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"space-y-4 min-w-[170px]",children:(0,s.jsx)(r.x,{className:t.length>7?"h-[205px]":"",children:(0,s.jsx)(l.Z.Group,{className:"px-3 py-3",id:"projects",onChange:e=>{let t=e.target.value;g.includes(t)?j(g.filter(e=>e!==t)):j(g.concat(t))},options:t.map(e=>({value:e[c],label:e[d],defaultChecked:n.includes(e[c])}))})})}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-overlay bg-surface-200 py-2 px-3",children:[(0,s.jsx)(o.z,{size:"tiny",type:"default",onClick:()=>{h([]),f(!1)},children:"Clear"}),(0,s.jsx)(o.z,{type:"primary",onClick:()=>{h(g),f(!1)},children:"Save"})]})]}),children:(0,s.jsx)(o.z,{asChild:!0,type:n.length>0?"default":"dashed",onClick:()=>f(!1),className:"rounded"===m?"rounded-full":"",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{children:u}),n.length>0&&(0,s.jsx)("span",{className:"mr-1",children:":"}),n.length>=3?(0,s.jsxs)("span",{children:[v[0]," and ",n.length-1," others"]}):n.length>0?(0,s.jsx)("span",{children:v.join(", ")}):null]})})})}},14698:function(e,t,n){"use strict";n.d(t,{iN:function(){return j},ph:function(){return u},by:function(){return g},hj:function(){return h},B4:function(){return f},S0:function(){return p},ld:function(){return a}});var s=n(52322);function a(e){return(0,s.jsxs)("div",{className:"mx-auto max-w-4xl px-5 pt-12 pb-20",children:[e.header&&(0,s.jsx)("h1",{className:"text-foreground mb-8 text-3xl",children:e.header}),(0,s.jsx)("div",{className:"space-y-20",children:e.children})]})}var i=n(17172),r=n(39097),l=n.n(r),o=n(14048),c=n(80435),d=n(32079);let u=e=>{let{title:t,description:n,docsUrl:a,actions:r,className:u}=e;return(0,s.jsxs)("div",{className:"mb-6 flex items-center justify-between ".concat(u),children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"text-foreground text-xl",children:(0,s.jsx)(o.D,{unwrapDisallowed:!0,disallowedElements:["p"],children:t})}),n&&(0,s.jsx)(c.U,{content:n,className:"max-w-full"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[void 0!==a&&(0,s.jsx)(d.z,{asChild:!0,type:"default",icon:(0,s.jsx)(i.Z,{size:14}),children:(0,s.jsx)(l(),{href:a,target:"_blank",rel:"noreferrer",children:"Documentation"})}),r]})]})};var m=n(2784);let h=e=>{let{children:t,id:n,header:a,disabled:i,className:r}=e;return(0,s.jsxs)("div",{id:n,className:["grid grid-cols-12 gap-6 px-8 py-8","".concat(i?" opacity-30":" opacity-100"),"".concat(r)].join(" "),children:[a,t]})},p=e=>{let{children:t,className:n="",description:a}=e;return void 0!==a?(0,s.jsxs)("div",{className:"flex flex-col space-y-2 col-span-12 lg:col-span-5 ".concat(n),children:[(0,s.jsx)("label",{className:"text-foreground text-sm",children:t}),a]}):(0,s.jsx)("label",{className:"text-foreground col-span-12 text-sm lg:col-span-5 ".concat(n),children:t})},x=()=>(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,s.jsx)("div",{className:"shimmering-loader h-2 w-1/3 rounded"}),(0,s.jsx)("div",{className:"flex flex-col justify-between space-y-2",children:(0,s.jsx)("div",{className:"shimmering-loader h-[34px] w-2/3 rounded"})})]}),f=e=>{let{children:t,loading:n=!0,fullWidth:a,className:i}=e;return(0,s.jsx)("div",{className:"\n        relative col-span-12 flex flex-col gap-6 lg:col-span-7\n        ".concat(a&&"!col-span-12","\n        ").concat(i,"\n      "),children:n?m.Children.map(t,()=>(0,s.jsx)(x,{})):t})},g=e=>{let{children:t,header:n,footer:a}=e;return(0,s.jsxs)("div",{className:" bg-surface-100 border-default overflow-hidden  rounded-md border shadow",children:[n&&(0,s.jsx)("div",{className:"border-default border-b px-8 py-4",children:n}),(0,s.jsx)("div",{className:"divide-border flex flex-col gap-0 divide-y",children:t}),a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"border-default border-t"}),a]})]})},j=e=>{let{form:t,hasChanges:n,handleReset:a,helper:i,disabled:r=!1,isSubmitting:l,submitText:o="Save"}=e,c=l||r||!n&&void 0!==n;return(0,s.jsxs)("div",{className:["flex w-full items-center gap-2",i?"justify-between":"justify-end"].join(" "),children:[i&&(0,s.jsx)("span",{className:"text-sm text-foreground-lighter",children:i}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d.z,{disabled:c,type:"default",htmlType:"reset",onClick:()=>a(),children:"Cancel"}),(0,s.jsx)(d.z,{form:t,type:"primary",htmlType:"submit",disabled:c,loading:l,children:o})]})]})}},14782:function(e,t,n){"use strict";var s=n(52322),a=n(39459);t.Z=e=>{let{resourceText:t,isFullPage:n=!1}=e,i=()=>(0,s.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200",children:(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(a.Z,{size:"large"})}),(0,s.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or adminstrator for assistance."})})]})})]})});return n?(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsx)("div",{className:"w-[550px]",children:(0,s.jsx)(i,{})})}):(0,s.jsx)(i,{})}},34056:function(e,t,n){"use strict";n.d(t,{Q:function(){return d}});var s=n(52322),a=n(3085),i=n(81076),r=n(39097),l=n.n(r),o=n(32079),c=e=>{let{name:t="",isActive:n,isExternal:r,icon:c,rightIcon:d,url:u="",target:m="_self",onClick:h,textClassName:p="",hoverText:x="",label:f}=e,g=(0,s.jsx)(a.ZP.Item,{icon:c,rounded:!0,active:n,onClick:h,children:(0,s.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,s.jsxs)("div",{title:x||("string"==typeof t?t:""),className:"flex items-center gap-2 truncate w-full "+p,children:[(0,s.jsxs)("span",{className:"truncate",children:[t," "]}),void 0!==f&&(0,s.jsx)(i.C,{variant:"warning",children:f})]}),d&&(0,s.jsx)("div",{children:d})]})});return u?r?(0,s.jsx)(o.z,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:c,children:(0,s.jsx)(l(),{href:u,target:"_blank",rel:"noreferrer",children:t})}):(0,s.jsx)(l(),{href:u,className:"block",target:m,children:g}):g},d=e=>{let{page:t,menu:n}=e;return(0,s.jsx)("div",{className:"flex flex-col space-y-8 overflow-y-auto",children:(0,s.jsx)(a.ZP,{type:"pills",children:n.map((e,r)=>(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"my-6 space-y-8",children:(0,s.jsxs)("div",{className:"mx-3",children:[(0,s.jsx)(a.ZP.Group,{title:e.title?(0,s.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,s.jsx)("span",{children:e.title}),e.isPreview&&(0,s.jsx)(i.C,{variant:"warning",children:"Not production ready"})]}):null}),(0,s.jsx)("div",{children:e.items.map(e=>(0,s.jsx)(c,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:t===e.key,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key))})]})}),r!==n.length-1&&(0,s.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},92286:function(e,t,n){"use strict";var s=n(52322),a=n(90038),i=n(76141),r=n(89404),l=n(2784),o=n(27570),c=n(49650),d=n(32079),u=n(95492),m=n(61786),h=n(90504),p=n(19869);t.Z=e=>{let{className:t,disabled:n=!1,size:x="tiny",showError:f=!0,selectedSchemaName:g,supportSelectAll:j=!1,excludedSchemas:v=[],onSelectSchema:y,onSelectCreateSchema:b}=e,[N,w]=(0,l.useState)(!1),{project:_}=(0,o.d2)(),{data:C,isLoading:S,isSuccess:k,isError:E,error:A,refetch:T}=(0,c.Q)({projectRef:null==_?void 0:_.ref,connectionString:null==_?void 0:_.connectionString}),I=(C||[]).filter(e=>!v.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,s.jsxs)("div",{className:t,children:[S&&(0,s.jsx)(d.z,{type:"default",className:"justify-start",block:!0,size:x,loading:!0,children:"Loading schemas..."}),f&&E&&(0,s.jsxs)(u.bZ,{variant:"warning",className:"!px-3 !py-3",children:[(0,s.jsx)(u.Cd,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,s.jsxs)(u.X,{className:"text-xs mb-2 break-words",children:["Error: ",null==A?void 0:A.message]}),(0,s.jsx)(d.z,{type:"default",size:"tiny",onClick:()=>T(),children:"Reload schemas"})]}),k&&(0,s.jsxs)(m.J2,{open:N,onOpenChange:w,modal:!1,children:[(0,s.jsx)(m.xo,{asChild:!0,children:(0,s.jsx)(d.z,{size:x,disabled:n,type:"default",className:"w-full [&>span]:w-full",iconRight:(0,s.jsx)(a.Z,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:(0,s.jsxs)("div",{className:"w-full flex gap-1",children:[(0,s.jsx)("p",{className:"text-foreground-lighter",children:"schema:"}),(0,s.jsx)("p",{className:"text-foreground",children:"*"===g?"All schemas":g})]})})}),(0,s.jsx)(m.yk,{className:"p-0",side:"bottom",align:"start",sameWidthAsTrigger:!0,children:(0,s.jsxs)(h.mY,{children:[(0,s.jsx)(h.sZ,{placeholder:"Find schema..."}),(0,s.jsxs)(h.e8,{children:[(0,s.jsx)(h.rb,{children:"No schemas found"}),(0,s.jsx)(h.fu,{children:(0,s.jsxs)(p.x,{className:(I||[]).length>7?"h-[210px]":"",children:[j&&(0,s.jsxs)(h.di,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{y("*"),w(!1)},onClick:()=>{y("*"),w(!1)},children:[(0,s.jsx)("span",{children:"All schemas"}),"*"===g&&(0,s.jsx)(i.Z,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==I?void 0:I.map(e=>(0,s.jsxs)(h.di,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{y(e.name),w(!1)},onClick:()=>{y(e.name),w(!1)},children:[(0,s.jsx)("span",{children:e.name}),g===e.name&&(0,s.jsx)(i.Z,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==b&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.zz,{}),(0,s.jsx)(h.fu,{children:(0,s.jsxs)(h.di,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{b(),w(!1)},onClick:()=>{b(),w(!1)},children:[(0,s.jsx)(r.Z,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},48699:function(e,t,n){"use strict";var s=n(52322),a=n(6277);t.Z=e=>{let{max:t=100,value:n=0,barClass:i="bg-foreground",bgClass:r="",type:l="vertical",borderClass:o="",labelBottom:c="",labelBottomClass:d="tabular-nums",labelTop:u="",labelTopClass:m=""}=e;if("horizontal"===l){let e=Number(n/t*100),l=c||u;return(0,s.jsxs)("div",{className:"flex flex-col w-full",children:[l&&(0,s.jsxs)("div",{className:"flex align-baseline justify-between pb-1 space-x-8",children:[(0,s.jsx)("p",{className:(0,a.default)("text-foreground text-sm truncate capitalize-sentence",u.length>0&&"max-w-[75%]",d),children:c}),(0,s.jsx)("p",{className:(0,a.default)("text-foreground-light text-sm",m),children:u})]}),(0,s.jsx)("div",{className:"relative rounded h-1 overflow-hidden w-full border p-0 ".concat(r||"bg-surface-400"," ").concat(o||"border-none"),children:(0,s.jsx)("div",{className:"absolute rounded inset-x-0 bottom-0 h-1 ".concat(i," transition-all"),style:{width:"".concat(e,"%")}})})]})}{let e=Number(n/t*35);return e<2&&(e=2),(0,s.jsx)("div",{className:"relative rounded w-5 overflow-hidden border p-1 ".concat(r||"bg-gray-400"," ").concat(o||"border-none"),style:{height:35},children:(0,s.jsx)("div",{className:"absolute inset-x-0 bottom-0 w-5 ".concat(i),style:{height:e}})})}}},70458:function(e,t,n){"use strict";var s=n(52322),a=n(79534),i=n(34291),r=n.n(i),l=n(2784),o=n(27570),c=n(49574);t.Z=e=>{let{queryId:t,language:n="pgsql",defaultValue:i="",readOnly:d=!1,contextmenu:u=!0,onInputChange:m=r()}=e,h=(0,a.useMonaco)(),{project:p}=(0,o.d2)(),x=(0,l.useRef)();async function f(e){try{return await (0,c.x)({projectRef:null==p?void 0:p.ref,connectionString:null==p?void 0:p.connectionString,sql:e})}catch(t){return console.error("formatPgsql error:",t),e}}return(0,l.useEffect)(()=>{if(h){let e=h.languages.registerDocumentFormattingEditProvider("pgsql",{async provideDocumentFormattingEdits(e){let t=e.getValue(),n=await f(t);return[{range:e.getFullModelRange(),text:n}]}});return()=>{e.dispose()}}},[h]),(0,l.useEffect)(()=>{if(x.current){var e;null===(e=x.current)||void 0===e||e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})}},[t]),(0,s.jsx)(a.default,{className:"monaco-editor",theme:"supabase",defaultLanguage:n,defaultValue:i,path:t,loading:(0,s.jsx)(()=>(0,s.jsx)("h4",{className:"text-lg",children:"Loading"}),{}),options:{readOnly:d,tabSize:2,fontSize:13,minimap:{enabled:!1},wordWrap:"on",fixedOverflowWidgets:!0,contextmenu:u},onMount:(e,t)=>{x.current=e,e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})},onChange:m})}},52321:function(e,t,n){"use strict";n.d(t,{q:function(){return i}});var s=n(52322),a=n(48699);let i=e=>{let{progress:t,message:n,description:i}=e;return(0,s.jsxs)("div",{className:"flex flex-col space-y-2",style:{minWidth:"220px"},children:[(0,s.jsx)(a.Z,{value:t,max:100,type:"horizontal",barClass:"bg-brand",labelBottom:n,labelTop:"".concat(t.toFixed(2),"%"),labelTopClass:"tabular-nums"}),void 0!==i&&(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:i})]})}},38264:function(e,t,n){"use strict";var s=n(52322),a=n(6277);t.Z=e=>{let{options:t,width:n=50,activeOption:i,onClickOption:r,borderOverride:l="border-stronger"}=e,o=e=>"absolute top-0 z-1 text-xs inline-flex h-full items-center justify-center font-medium\n    ".concat(e?"hover:text-foreground-light hover:text-foreground":"hover:text-foreground"," hover:text-foreground focus:z-10 focus:outline-none focus:border-blue-300 focus:ring-blue\n    transition ease-in-out duration-150");return(0,s.jsxs)("div",{className:"relative border ".concat(l," rounded-md h-7"),style:{padding:1,width:(n+1)*2},children:[(0,s.jsx)("span",{style:{width:n,translate:i===t[1]?"0px":"".concat(n-2,"px")},"aria-hidden":"true",className:(0,a.default)("z-0 inline-block rounded h-full bg-overlay-hover shadow transform","transition-all ease-in-out border border-strong")}),t.map((e,t)=>(0,s.jsx)("span",{style:{width:n+1},className:"\n              ".concat(i===e?"text-foreground":"text-foreground-light","\n              ").concat(0===t?"right-0":"left-0","\n              ").concat(o(i===e),"\n              cursor-pointer\n            "),onClick:()=>r(e),children:(0,s.jsx)("span",{className:(0,a.default)("capitalize hover:text-foreground",i===e?"text-foreground":"text-foreground-light"),children:e})},"toggle_".concat(t)))]})}},75716:function(e,t,n){"use strict";var s=n(52322),a=n(24990),i=n(59491),r=n(39097),l=n.n(r),o=n(32079),c=n(14528),d=n(93463);t.Z=e=>{var t,n,r;let{icon:u,primaryText:m,secondaryText:h,addon:p,buttonText:x,disabled:f=!1}=e,g=(0,c.Vm)(),j=(0,c.lL)(),{data:v}=(0,d.G)({orgSlug:null==j?void 0:j.slug}),y=null==v?void 0:null===(t=v.plan)||void 0===t?void 0:t.id,b=(0,c.Xo)(i.KA.BILLING_WRITE,"stripe.subscriptions"),N=(0,c.P5)("disableProjectCreationAndUpdate");return(0,s.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200",children:(0,s.jsxs)("div",{className:"flex space-x-3",children:[u&&(0,s.jsx)("div",{className:"mt-1",children:u}),(0,s.jsxs)("div",{className:"flex w-full items-center justify-between space-x-32",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm",children:m}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:h})})]}),(0,s.jsxs)(a.fC,{delayDuration:0,children:[(0,s.jsx)(a.xz,{asChild:!0,children:(0,s.jsx)(o.z,{type:"primary",disabled:!b||N||f,asChild:!0,children:(0,s.jsx)(l(),{href:"free"===y?"/org/".concat(null!==(n=null==j?void 0:j.slug)&&void 0!==n?n:"_","/billing?panel=subscriptionPlan"):"/project/".concat(null!==(r=null==g?void 0:g.ref)&&void 0!==r?r:"_","/settings/addons?panel=").concat(p),children:x||("free"===y?"Upgrade to Pro":"Enable Addon")})})}),!b||N&&(0,s.jsx)(a.h_,{children:(0,s.jsxs)(a.VY,{side:"bottom",children:[(0,s.jsx)(a.Eh,{className:"radix-tooltip-arrow"}),(0,s.jsx)("div",{className:"border border-background text-center rounded bg-alternative py-1 px-2 leading-none shadow",children:(0,s.jsx)("span",{className:"text-xs text-foreground",children:N?(0,s.jsxs)(s.Fragment,{children:["Subscription changes are currently disabled.",(0,s.jsx)("br",{}),"Our engineers are working on a fix."]}):b?"":"You need additional permissions to amend subscriptions"})})]})})]})]})]})})}},99430:function(e,t,n){"use strict";n.d(t,{g:function(){return o}});var s=n(48228),a=n(62202),i=n(88354),r=n(99248);async function l(e){let{sql:t}=e,n=await (0,i.v_)(r.GW+"/api/ai/sql/title",{sql:t});if(!(0,i.d8)(n))throw n.error;return n}let o=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.D)(e=>l(e),{async onSuccess(t,n,s){await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?a.ZP.error("Failed to generate title: ".concat(e.message)):t(e,n,s)},...n})}},18799:function(e,t,n){"use strict";n.d(t,{$J:function(){return j},l$:function(){return c},BY:function(){return y},k9:function(){return u},vU:function(){return f},$Z:function(){return p},On:function(){return b.O},_T:function(){return N._}});var s=n(85945),a=n(48228),i=n(64883),r=n(31696),l=n(62202);async function o(e){let{ref:t,description:n}=e,{data:s,error:a}=await (0,r.v_)("/platform/projects/{ref}/analytics/warehouse/access-tokens",{params:{path:{ref:t}},body:{description:n}});return a&&(0,r.S3)(a),s}function c(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>o(e),{async onSuccess(t,n,s){await r.invalidateQueries(i.d.warehouseAccessTokens(n.ref)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?l.ZP.error("Failed to create token: ".concat(e.message)):t(e,n,s)},...n})}async function d(e){let{projectRef:t,token:n}=e,{data:s,error:a}=await (0,r.IV)("/platform/projects/{ref}/analytics/warehouse/access-tokens/{token}",{params:{path:{ref:t,token:n}}});return a&&(0,r.S3)(a),s}let u=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>d(e),{async onSuccess(t,n,s){let{projectRef:a}=n;await r.invalidateQueries(i.d.warehouseAccessTokens(a)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?l.ZP.error("Failed to delete access token: ".concat(e.message)):t(e,n,s)},...n})};var m=n(36492);async function h(e,t){let{projectRef:n}=e;if(!n)throw Error("projectRef is required");let s=await (0,r.U2)("/platform/projects/{ref}/analytics/warehouse/access-tokens",{params:{path:{ref:n}},signal:t});return s.error&&(0,r.S3)(s),s}let p=function(e){let{projectRef:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,m.a)(i.d.warehouseAccessTokens(t),e=>{let{signal:n}=e;return h({projectRef:t},n)},{enabled:n&&void 0!==t,...s})};async function x(e,t){let{projectRef:n,collectionToken:s}=e,{data:a,error:i}=await (0,r.r$)("/platform/projects/{ref}/analytics/warehouse/collections/{token}",{params:{path:{ref:n,token:s}},body:t});return i&&(0,r.S3)(i),a}let f=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>x({projectRef:e.projectRef,collectionToken:e.collectionToken},{name:e.name}),{async onSuccess(t,n,s){let{projectRef:a}=n;await r.invalidateQueries(i.d.warehouseCollections(a)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?l.ZP.error("Failed to update collection: ".concat(e.message)):t(e,n,s)},...n})};async function g(e){let{projectRef:t,name:n}=e,{data:s,error:a}=await (0,r.v_)("/platform/projects/{ref}/analytics/warehouse/collections",{params:{path:{ref:t}},body:{name:n}});return a&&(0,r.S3)(a),s}let j=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>{var t;let n=null===(t=r.getQueryData(i.d.warehouseCollections(e.projectRef)))||void 0===t?void 0:t.map(e=>e.name);if(null==n?void 0:n.includes(e.name))throw Error("Collection with the name ".concat(e.name," already exists"));return g(e)},{async onSuccess(t,n,s){let{projectRef:a}=n;await r.invalidateQueries(i.d.warehouseCollections(a)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?l.ZP.error("Failed to create collection: ".concat(e.message)):t(e,n,s)},...n})};async function v(e){let{projectRef:t,collectionToken:n}=e,{data:s,error:a}=await (0,r.IV)("/platform/projects/{ref}/analytics/warehouse/collections/{token}",{params:{path:{ref:t,token:n}}});return a&&(0,r.S3)(a),s}let y=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>v(e),{async onSuccess(t,n,s){let{projectRef:a}=n;await r.invalidateQueries(i.d.warehouseCollections(a)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?l.ZP.error("Failed to delete collection: ".concat(e.message)):t(e,n,s)},...n})};var b=n(75424),N=n(62112)},86418:function(e,t,n){"use strict";n.d(t,{Hz:function(){return o},Iw:function(){return r},L6:function(){return g},p5:function(){return x},tk:function(){return l}});var s,a,i,r,l,o,c=n(36492),d=n(28879),u=n.n(d),m=n(88354),h=n(99248),p=n(64883);(s=r||(r={})).DATABASE="egress_database",s.AUTH="egress_auth",s.STORAGE="egress_storage",s.REALTIME="egress_realtime",s.FUNCTIONS="egress_functions",s.SUPAVISOR="egress_supavisor",s.UNIFIED="egress",(a=l||(l={})).EGRESS="EGRESS",a.DATABASE_SIZE="DATABASE_SIZE",a.STORAGE_SIZE="STORAGE_SIZE",a.MONTHLY_ACTIVE_USERS="MONTHLY_ACTIVE_USERS",a.MONTHLY_ACTIVE_SSO_USERS="MONTHLY_ACTIVE_SSO_USERS",a.FUNCTION_INVOCATIONS="FUNCTION_INVOCATIONS",a.FUNCTION_COUNT="FUNCTION_COUNT",a.STORAGE_IMAGES_TRANSFORMED="STORAGE_IMAGES_TRANSFORMED",a.REALTIME_MESSAGE_COUNT="REALTIME_MESSAGE_COUNT",a.REALTIME_PEAK_CONNECTIONS="REALTIME_PEAK_CONNECTIONS",(i=o||(o={})).COMPUTE_HOURS_BRANCH="COMPUTE_HOURS_BRANCH",i.COMPUTE_HOURS_XS="COMPUTE_HOURS_XS",i.COMPUTE_HOURS_SM="COMPUTE_HOURS_SM",i.COMPUTE_HOURS_MD="COMPUTE_HOURS_MD",i.COMPUTE_HOURS_L="COMPUTE_HOURS_L",i.COMPUTE_HOURS_XL="COMPUTE_HOURS_XL",i.COMPUTE_HOURS_2XL="COMPUTE_HOURS_2XL",i.COMPUTE_HOURS_4XL="COMPUTE_HOURS_4XL",i.COMPUTE_HOURS_8XL="COMPUTE_HOURS_8XL",i.COMPUTE_HOURS_12XL="COMPUTE_HOURS_12XL",i.COMPUTE_HOURS_16XL="COMPUTE_HOURS_16XL";let x=e=>{switch(e){case"COMPUTE_HOURS_BRANCH":return"Branches";case"COMPUTE_HOURS_XS":return"Micro";case"COMPUTE_HOURS_SM":return"Small";case"COMPUTE_HOURS_MD":return"Medium";case"COMPUTE_HOURS_L":return"Large";case"COMPUTE_HOURS_XL":return"XL";case"COMPUTE_HOURS_2XL":return"2XL";case"COMPUTE_HOURS_4XL":return"4XL";case"COMPUTE_HOURS_8XL":return"8XL";case"COMPUTE_HOURS_12XL":return"12XL";case"COMPUTE_HOURS_16XL":return"16XL"}};async function f(e,t){let{orgSlug:n,metric:s,startDate:a,endDate:i,interval:r="1d",projectRef:l}=e;if(!n)throw Error("Org slug is required");if(!s)throw Error("Metric is required");if(!a||!i)throw Error("Start date is required");let o="".concat(h.T5,"/organizations/").concat(n,"/daily-stats?metric=").concat(s,"&startDate=").concat(encodeURIComponent(a),"&endDate=").concat(encodeURIComponent(i));r&&(o+="&interval=".concat(r)),l&&(o+="&projectRef=".concat(l));let c=await (0,m.U2)(o,{signal:t});if(c.error)throw c.error;return c}let g=function(e){let{orgSlug:t,metric:n,startDate:s,endDate:a,interval:i="1d",projectRef:r,dateFormat:l="DD MMM",modifier:o}=e,{enabled:d=!0,...m}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,c.a)(p.d.orgDailyStats(t,{metric:n,startDate:s,endDate:a,interval:i,projectRef:r}),e=>{let{signal:l}=e;return f({orgSlug:t,metric:n,startDate:s,endDate:a,interval:i,projectRef:r},l)},{enabled:d&&void 0!==t&&void 0!==n&&void 0!==s&&void 0!==a,select:e=>({...e,data:e.data.map(e=>({...e,[n]:void 0!==o?o(Number(e[n])):Number(e[n]),periodStartFormatted:u()(e.period_start).format(l)}))}),staleTime:36e5,...m})}},75424:function(e,t,n){"use strict";n.d(t,{O:function(){return l}});var s=n(36492),a=n(31696),i=n(64883);async function r(e,t){let{projectRef:n}=e;if(!n||"undefined"===n)throw Error("projectRef is required");let{data:s,error:i}=await (0,a.U2)("/platform/projects/{ref}/analytics/warehouse/collections",{params:{path:{ref:n}},signal:t});return i&&(0,a.S3)(i),s}let l=(e,t)=>{let{projectRef:n}=e,{enabled:a}=t;return(0,s.a)(i.d.warehouseCollections(n),e=>{let{signal:t}=e;return r({projectRef:n},t)},{enabled:!!n||a})}},33635:function(e,t,n){"use strict";n.d(t,{$E:function(){return c},h8:function(){return o},kM:function(){return d}});var s=n(36492),a=n(85945),i=n(31696),r=n(2784),l=n(7161);async function o(e,t){let{projectRef:n}=e;if(!n)throw Error("projectRef is required");let{data:s,error:a}=await (0,i.U2)("/platform/auth/{ref}/config",{params:{path:{ref:n}},signal:t});return a&&(0,i.S3)(a),s}let c=function(e){let{projectRef:t}=e,{enabled:n=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(l.o.authConfig(t),e=>{let{signal:n}=e;return o({projectRef:t},n)},{enabled:n&&void 0!==t,...a})},d=e=>{let{projectRef:t}=e,n=(0,a.NL)();return(0,r.useCallback)(()=>{t&&n.prefetchQuery(l.o.authConfig(t),e=>{let{signal:n}=e;return o({projectRef:t},n)})},[n,t])}},7161:function(e,t,n){"use strict";n.d(t,{o:function(){return s}});let s={users:(e,t)=>["auth",e,"users",...t?[t]:[]],authConfig:e=>["auth",e,"config"],accessToken:()=>["access-token"]}},33259:function(e,t,n){"use strict";n.d(t,{k:function(){return l}});var s=n(36492),a=n(31696),i=n(45101);async function r(e,t){let{projectRef:n}=e;if(!n)throw Error("projectRef is required");let{data:s,error:i}=await (0,a.U2)("/platform/projects/{ref}/config/storage",{params:{path:{ref:n}},signal:t});return i&&(0,a.S3)(i),s}let l=function(e){let{projectRef:t}=e,{enabled:n=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(i.U.storage(t),e=>{let{signal:n}=e;return r({projectRef:t},n)},{enabled:n&&void 0!==t,...a})}},79044:function(e,t,n){"use strict";n.d(t,{T:function(){return c}});var s=n(85945),a=n(48228),i=n(62202),r=n(31696),l=n(65467);async function o(e,t){let{projectRef:n,payload:s}=e,{data:a,error:i}=await (0,r.v_)("/platform/projects/{ref}/content",{params:{path:{ref:n}},body:{id:s.id,name:s.name,description:s.description,owner_id:s.owner_id,type:s.type,visibility:s.visibility,content:s.content},signal:t});return i&&(0,r.S3)(i),a}let c=function(){let{onError:e,onSuccess:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>o(e),{async onSuccess(e,n,s){let{projectRef:a}=n;await r.invalidateQueries(l.$.list(a)),await (null==t?void 0:t(e,n,s))},async onError(t,n,s){void 0===e?i.ZP.error("Failed to insert content: ".concat(t.message)):e(t,n,s)},...n})}},31442:function(e,t,n){"use strict";n.d(t,{I:function(){return o}});var s=n(36492),a=n(88354),i=n(99248),r=n(65467);async function l(e,t){if(void 0===e)throw Error("projectRef is required for getContent");let n=await (0,a.U2)("".concat(i.T5,"/projects/").concat(e,"/content"),{signal:t});if(n.error)throw n.error;if(!n)throw Error("Content not found");return{content:n.data}}let o=function(e){let{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(r.$.list(e),t=>{let{signal:n}=t;return l(e,n)},{enabled:t&&void 0!==e,...n})}},72081:function(e,t,n){"use strict";n.d(t,{H:function(){return l}});var s=n(36492),a=n(31696),i=n(24368);async function r(e,t){let{projectRef:n,connectionString:s}=e;if(!n)throw Error("projectRef is required");let i=new Headers;s&&i.set("x-connection-encrypted",s);let{data:r,error:l}=await (0,a.U2)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":s},path:{ref:n}},headers:i,signal:t});return l&&(0,a.S3)(l),r}let l=function(e){let{projectRef:t,connectionString:n}=e,{enabled:a=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(i.o.list(t),e=>{let{signal:s}=e;return r({projectRef:t,connectionString:n},s)},{enabled:a&&void 0!==t,...l})}},24368:function(e,t,n){"use strict";n.d(t,{o:function(){return s}});let s={list:e=>["projects",e,"database-extensions"]}},49521:function(e,t,n){"use strict";n.d(t,{r:function(){return l}});var s=n(36492),a=n(31696),i=n(11596);async function r(e,t){let{projectRef:n,connectionString:s,schema:i}=e;if(!n)throw Error("projectRef is required");let r=new Headers;s&&r.set("x-connection-encrypted",s);let{data:l,error:o}=await (0,a.U2)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":s},path:{ref:n},query:{included_schemas:i||"",excluded_schemas:""}},headers:r,signal:t});return o&&(0,a.S3)(o),l}let l=function(e){let{projectRef:t,connectionString:n,schema:a}=e,{enabled:l=!0,...o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(i.R.list(t,a),e=>{let{signal:s}=e;return r({projectRef:t,connectionString:n,schema:a},s)},{enabled:l&&void 0!==t,...o})}},6499:function(e,t,n){"use strict";n.d(t,{l:function(){return c}});var s=n(85945),a=n(48228),i=n(62202),r=n(31696),l=n(11596);async function o(e){let{projectRef:t,connectionString:n,id:s}=e,a=new Headers;n&&a.set("x-connection-encrypted",n);let{data:i,error:l}=await (0,r.IV)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":n},path:{ref:t},query:{id:s}},headers:a});return l&&(0,r.S3)(l),i}let c=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>o(e),{async onSuccess(t,n,s){let{projectRef:a}=n;await r.invalidateQueries(l.R.list(a)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?i.Am.error("Failed to delete database policy: ".concat(e.message)):t(e,n,s)},...n})}},20560:function(e,t,n){"use strict";n.d(t,{k:function(){return c}});var s=n(85945),a=n(48228),i=n(62202),r=n(31696),l=n(11596);async function o(e){let{projectRef:t,connectionString:n,id:s,payload:a}=e,i=new Headers;n&&i.set("x-connection-encrypted",n);let{data:l,error:o}=await (0,r.r$)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":n},path:{ref:t},query:{id:s}},body:a,headers:i});return o&&(0,r.S3)(o),l}let c=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>o(e),{async onSuccess(t,n,s){let{projectRef:a}=n;await r.invalidateQueries(l.R.list(a)),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?i.Am.error("Failed to update database policy: ".concat(e.message)):t(e,n,s)},...n})}},11596:function(e,t,n){"use strict";n.d(t,{R:function(){return s}});let s={list:(e,t)=>["projects",e,"database-policies",t]}},45997:function(e,t,n){"use strict";n.d(t,{f:function(){return o},x:function(){return l}});var s=n(4224),a=n(18592),i=n(18545);let r=s.Z.roles.list(),l=function(e){let{projectRef:t,connectionString:n}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.cp)({projectRef:t,connectionString:n,sql:r.sql,queryKey:["roles","list"]},{select:e=>e.result,...s})};function o(e,t){return e.invalidateQueries(i.M.query(t,["roles","list"]))}},75153:function(e,t,n){"use strict";n.d(t,{X:function(){return i}});var s=n(18592);let a=e=>{let{schema:t}=e;return"\nSELECT \n  con.oid as id, \n  con.conname as constraint_name, \n  con.confdeltype as deletion_action,\n  con.confupdtype as update_action,\n  rel.oid as source_id,\n  nsp.nspname as source_schema, \n  rel.relname as source_table, \n  (\n    SELECT \n      array_agg(\n        att.attname \n        ORDER BY \n          un.ord\n      ) \n    FROM \n      unnest(con.conkey) WITH ORDINALITY un (attnum, ord) \n      INNER JOIN pg_attribute att ON att.attnum = un.attnum \n    WHERE \n      att.attrelid = rel.oid\n  ) source_columns, \n  frel.oid as target_id,\n  fnsp.nspname as target_schema, \n  frel.relname as target_table, \n  (\n    SELECT \n      array_agg(\n        att.attname \n        ORDER BY \n          un.ord\n      ) \n    FROM \n      unnest(con.confkey) WITH ORDINALITY un (attnum, ord) \n      INNER JOIN pg_attribute att ON att.attnum = un.attnum \n    WHERE \n      att.attrelid = frel.oid\n  ) target_columns \nFROM \n  pg_constraint con \n  INNER JOIN pg_class rel ON rel.oid = con.conrelid \n  INNER JOIN pg_namespace nsp ON nsp.oid = rel.relnamespace \n  INNER JOIN pg_class frel ON frel.oid = con.confrelid \n  INNER JOIN pg_namespace fnsp ON fnsp.oid = frel.relnamespace \nWHERE \n  con.contype = 'f'\n  ".concat(void 0!==t?"AND nsp.nspname = '".concat(t,"'"):"",";\n").trim()},i=function(e){let{projectRef:t,connectionString:n,schema:i}=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.cp)({projectRef:t,connectionString:n,sql:a({schema:i}),queryKey:["foreign-key-constraints"]},{select(e){var t;return(null!==(t=null==e?void 0:e.result)&&void 0!==t?t:[]).map(e=>({...e,source_columns:e.source_columns.replace("{","").replace("}","").split(","),target_columns:e.target_columns.replace("{","").replace("}","").split(",")}))},...r})}},49650:function(e,t,n){"use strict";n.d(t,{Q:function(){return l},X:function(){return o}});var s=n(4224),a=n(18592),i=n(18545);let r=s.Z.schemas.list(),l=function(e){let{projectRef:t,connectionString:n}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.cp)({projectRef:t,connectionString:n,sql:r.sql,queryKey:["schemas","list"]},{select:e=>e.result,...s})};function o(e,t){return e.invalidateQueries(i.M.query(t,["schemas","list"]))}},37603:function(e,t,n){"use strict";var s,a;n.d(t,{l:function(){return s}}),(a=s||(s={})).TABLE="r",a.VIEW="v",a.MATERIALIZED_VIEW="m",a.FOREIGN_TABLE="f",a.PARTITIONED_TABLE="p"},94957:function(e,t,n){"use strict";n.d(t,{H:function(){return l}});var s=n(59403),a=n(18592),i=n(16623);async function r(e,t){let{projectRef:n,connectionString:s,schema:i="public",search:r,limit:l=100,page:o=0,sort:c="alphabetical"}=e,d="\n    with records as (\n      select\n        c.oid::int8 as \"id\",\n        nc.nspname as \"schema\",\n        c.relname as \"name\",\n        c.relkind as \"type\",\n        case c.relkind\n          when 'r' then 1\n          when 'v' then 2\n          when 'm' then 3\n          when 'f' then 4\n          when 'p' then 5\n        end as \"type_sort\",\n        obj_description(c.oid) as \"comment\",\n        count(*) over() as \"count\",\n        c.relrowsecurity as \"rls_enabled\"\n      from\n        pg_namespace nc\n        join pg_class c on nc.oid = c.relnamespace\n      where\n        c.relkind in ('r', 'v', 'm', 'f', 'p')\n        and not pg_is_other_temp_schema(nc.oid)\n        and (\n          pg_has_role(c.relowner, 'USAGE')\n          or has_table_privilege(\n            c.oid,\n            'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n          )\n          or has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n        )\n        and nc.nspname = '".concat(i,"'\n        ").concat(r?"and c.relname ilike '%".concat(r,"%'"):"","\n      order by ").concat("alphabetical"===c?"c.relname asc":'"type_sort" asc, c.relname asc',"\n      limit ").concat(l,"\n      offset ").concat(o*l,"\n    )\n    select\n      jsonb_build_object(\n        'entities', coalesce(jsonb_agg(\n          jsonb_build_object(\n            'id', r.id,\n            'schema', r.schema,\n            'name', r.name,\n            'type', r.type,\n            'comment', r.comment,\n            'rls_enabled', r.rls_enabled\n          )\n          order by ").concat("alphabetical"===c?"r.name asc":"r.type_sort asc, r.name asc","\n        ), '[]'::jsonb),\n        'count', coalesce(min(r.count), 0)\n      ) \"data\"\n    from records r;\n  "),{result:u}=await (0,a.Rj)({projectRef:n,connectionString:s,sql:d,queryKey:["public","entity-types"]},t);return u[0]}let l=function(e){let{projectRef:t,connectionString:n,schema:a="public",search:l,limit:o=100,sort:c}=e,{enabled:d=!0,...u}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.N)(i.C.list(t,{schema:a,search:l,sort:c,limit:o}),e=>{let{signal:s,pageParam:i}=e;return r({projectRef:t,connectionString:n,schema:a,search:l,limit:o,page:i,sort:c},s)},{enabled:d&&void 0!==t,staleTime:0,getNextPageParam(e,t){let n=t.length;if(!(n*o>=e.data.count))return n},...u})}},16623:function(e,t,n){"use strict";n.d(t,{C:function(){return s}});let s={list:(e,t)=>["projects",e,"entity-types",...t?[t]:[]]}},29887:function(e,t,n){"use strict";n.d(t,{S:function(){return o}});var s=n(48228),a=n(62202),i=n(88354),r=n(99248);async function l(e){let{projectRef:t,orgSlug:n,reasons:s,message:a,exitAction:l}=e,o=await (0,i.v_)("".concat(r.T5,"/feedback/downgrade"),{...void 0!==t&&{projectRef:t},...void 0!==n&&{orgSlug:n},reasons:s,additionalFeedback:a,exitAction:l});if(o.error)throw o.error;return o}let o=function(){let{onError:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.D)(e=>l(e),{async onError(t,n,s){void 0===e?a.ZP.error("Failed to submit exit survey: ".concat(t.message)):e(t,n,s)},...t})}},17436:function(e,t,n){"use strict";n.d(t,{Y:function(){return s}});let s={overdueInvoices:()=>["invoices","overdue"],invoice:e=>["invoice",e],list:(e,t)=>["invoices",e,t],count:e=>["invoices",e,"count"],projectInvoices:(e,t)=>["invoices",e,t],projectInvoicesCount:e=>["invoices",e,"count"],orgUpcomingPreview:e=>["invoices",e,"upcoming-preview"]}},93276:function(e,t,n){"use strict";n.d(t,{X:function(){return s}});let s={lint:e=>["projects",e,"lint"]}},52903:function(e,t,n){"use strict";n.d(t,{U:function(){return l}});var s=n(36492),a=n(31696),i=n(93276);async function r(e,t){let{projectRef:n}=e;if(!n)throw Error("Project ref is required");let{data:s,error:i}=await (0,a.U2)("/platform/projects/{ref}/run-lints",{params:{path:{ref:n}},signal:t});return i&&(0,a.S3)(i),s}let l=function(e){let{projectRef:t}=e,{enabled:n=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(i.X.lint(t),e=>{let{signal:n}=e;return r({projectRef:t},n)},{enabled:n&&void 0!==t,...a})}},78388:function(e,t,n){"use strict";n.d(t,{T:function(){return d}});var s=n(85945),a=n(48228),i=n(62202),r=n(31696),l=n(28414),o=n(91160);async function c(e){let{name:t,kind:n,size:s,tier:a,payment_method:i}=e,{data:l,error:o}=await (0,r.v_)("/platform/organizations",{body:{name:t,kind:n,size:s,tier:a,payment_method:i}});return o&&(0,r.S3)(o),l}let d=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>c(e),{async onSuccess(t,n,s){await Promise.all([r.invalidateQueries(o.O.list()),r.invalidateQueries(l.F.list())]),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?i.Am.error("Failed to create organization: ".concat(e.message)):t(e,n,s)},...n})}},49574:function(e,t,n){"use strict";n.d(t,{X:function(){return l},x:function(){return r}});var s=n(48228),a=n(88354),i=n(99248);async function r(e,t){let{projectRef:n,connectionString:s,sql:r}=e,l=new Headers;s&&l.set("x-connection-encrypted",s);let o=await (0,a.v_)("".concat(i.T5,"/pg-meta/").concat(n,"/query/format"),{query:r},{headers:Object.fromEntries(l),signal:t});if(o.error)throw o.error;return{result:o}}let l=function(){let{onSuccess:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.D)(e=>r(e),{async onSuccess(t,n,s){await (null==e?void 0:e(t,n,s))},...t})}},20746:function(e,t,n){"use strict";n.d(t,{rp:function(){return o}});var s=n(48228),a=n(62202),i=n(69960),r=n(18592);async function l(e){let{projectRef:t,connectionString:n,table:s,column:a,pkMatch:l}=e,o=function(e){var t;let{table:n,column:s,pkMatch:a}=e;return new i.AE().from(n.name,null!==(t=n.schema)&&void 0!==t?t:void 0).select(s).match(a).toSql()}({table:s,column:a,pkMatch:l}),{result:c}=await (0,r.Rj)({projectRef:t,connectionString:n,sql:o});return null==c?void 0:c[0][a]}let o=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.D)(e=>l(e),{async onSuccess(t,n,s){let{projectRef:a,table:i}=n;await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?a.Am.error(e.message):t(e,n,s)},...n})}},86305:function(e,t,n){"use strict";n.d(t,{H:function(){return c}});var s=n(69960),a=n(35432),i=n(83537),r=n(18592),l=n(22320);let o=e=>{var t;let{table:n,filters:a=[]}=e,i=new s.AE;if(!n)return"";let r=i.from(n.name,null!==(t=n.schema)&&void 0!==t?t:void 0).count();return a.filter(e=>e.value&&""!=e.value).forEach(e=>{let t=(0,l.q)(n,e);r=r.filter(e.column,e.operator,t)}),r.toSql()},c=function(e){let{projectRef:t,connectionString:n,queryKey:s,table:l,impersonatedRole:c,...d}=e,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=(0,i.Zp)();return(0,r.cp)({projectRef:t,connectionString:n,sql:(0,a.Jh)(o({table:l,...d}),{projectRef:null!=t?t:"ref",role:c}),queryKey:[...null!=s?s:[],{table:{name:null==l?void 0:l.name,schema:null==l?void 0:l.schema},impersonatedRole:c,...d}],isRoleImpersonationEnabled:m},{select:e=>({count:e.result[0].count}),enabled:void 0!==t&&void 0!==l,...u})}},57142:function(e,t,n){"use strict";n.d(t,{no:function(){return u},wF:function(){return m},KK:function(){return p}});var s=n(99959),a=n(69960),i=n(55274),r=n(99248),l=n(35432),o=n(83537),c=n(18592),d=n(22320);let u=10*r.KB,m=async e=>{var t;let{projectRef:n,connectionString:i,table:r,filters:o=[],sorts:u=[],impersonatedRole:m}=e;if(s.Qy&&!i)return console.error("Connection string is required"),[];let h=[],p=new a.AE().from(r.name,null!==(t=r.schema)&&void 0!==t?t:void 0).select();o.filter(e=>e.value&&""!==e.value).forEach(e=>{let t=(0,d.q)(r,e);p=p.filter(e.column,e.operator,t)}),u.forEach(e=>{p=p.order(e.table,e.column,e.ascending,e.nullsFirst)});let x=-1,f=0,g=0,j=[];return await (async()=>{do{x+=1,f=500*x,g=(x+1)*500-1;let e=(0,l.Jh)(p.range(f,g).toSql(),{projectRef:n,role:m});try{let{result:t}=await (0,c.Rj)({projectRef:n,connectionString:i,sql:e});h.push(...t),j=t}catch(e){return{data:{rows:[]}}}}while(500===j.length)})(),h.filter(e=>1!==e[l.$y])},h=e=>{var t;let{table:n,filters:s=[],sorts:r=[],page:l,limit:o}=e,c=new a.AE;if(!n)return"";let m=n.columns.filter(e=>{var t;return(null!==(t=null==e?void 0:e.enum)&&void 0!==t?t:[]).length>0&&"array"===e.dataType.toLowerCase()||i.BB.includes(e.format)||i.YF.includes(e.format)}).map(e=>{var t;return(null!==(t=null==e?void 0:e.enum)&&void 0!==t?t:[]).length>0&&"array"===e.dataType.toLowerCase()?'"'.concat(e.name,'"::text[]'):'case when length("'.concat(e.name,'"::text) > ').concat(u,' then concat(left("').concat(e.name,'"::text, ').concat(u,"), '...') else \"").concat(e.name,'"::text end "').concat(e.name,'"')}),h=c.from(n.name,null!==(t=n.schema)&&void 0!==t?t:void 0).select(m.length>0?"*,".concat(m.join(",")):"*");s.filter(e=>e.value&&""!=e.value).forEach(e=>{let t=(0,d.q)(n,e);h=h.filter(e.column,e.operator,t)}),r.forEach(e=>{h=h.order(e.table,e.column,e.ascending,e.nullsFirst)});let{from:p,to:x}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=e?e*t:0;return{from:n,to:e?n+t-1:t-1}}((null!=l?l:1)-1,o);return h.range(p,x).toSql()},p=function(e){let{projectRef:t,connectionString:n,queryKey:s,table:a,impersonatedRole:i,...r}=e,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=(0,o.Zp)();return(0,c.cp)({projectRef:t,connectionString:n,sql:(0,l.Jh)(h({table:a,...r}),{projectRef:null!=t?t:"ref",role:i}),queryKey:[...null!=s?s:[],{table:{name:null==a?void 0:a.name,schema:null==a?void 0:a.schema,columns:null==a?void 0:a.columns.map(e=>e.name)},impersonatedRole:i,...r}],isRoleImpersonationEnabled:u},{select:e=>({rows:e.result.map((e,t)=>({idx:t,...e}))}),enabled:void 0!==t&&void 0!==a,...d})}},22320:function(e,t,n){"use strict";n.d(t,{h:function(){return r},q:function(){return i}});var s=n(87115),a=n(52673);function i(e,t){let n=e.columns.find(e=>e.name==t.column);if(n&&(0,a.v3)(n.format)){let e=Number(t.value);if(!Number.isNaN(e)&&!(e>Number.MAX_SAFE_INTEGER))return Number(t.value)}return t.value}function r(e){let{table:t}=e,n=t.primary_keys;return n&&0!=n.length?{primaryKeys:n.map(e=>e.name)}:{error:{message:s.jg}}}},29573:function(e,t,n){"use strict";n.d(t,{W:function(){return s}});let s={list:(e,t,n)=>["projects",e,"tables",{schema:t,includeColumns:!!n}],table:(e,t)=>["projects",e,"tables",t]}},6564:function(e,t,n){"use strict";n.d(t,{hC:function(){return r},yp:function(){return l}});var s=n(36492);n(2784);var a=n(31696),i=n(29573);async function r(e,t){let{id:n,projectRef:s,connectionString:i}=e;if(!s)throw Error("projectRef is required");if(!n)throw Error("id is required");let r=new Headers;i&&r.set("x-connection-encrypted",i);let{data:l,error:o}=await (0,a.U2)("/platform/pg-meta/{ref}/tables",{params:{header:{"x-connection-encrypted":i},path:{ref:s},query:{id:n.toString()}},headers:r,signal:t});return o&&(0,a.S3)(o),l}let l=function(e){let{projectRef:t,connectionString:n,id:a}=e,{enabled:l=!0,...o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(i.W.table(t,a),e=>{let{signal:s}=e;return r({projectRef:t,connectionString:n,id:a},s)},{enabled:l&&void 0!==t&&void 0!==a,staleTime:0,...o})}},92270:function(e,t,n){"use strict";n.d(t,{T:function(){return c},V:function(){return d}});var s=n(85945),a=n(48228),i=n(62202),r=n(31696),l=n(29573),o=n(93276);async function c(e){let{projectRef:t,connectionString:n,id:s,payload:a}=e,i=new Headers;n&&i.set("x-connection-encrypted",n);let{data:l,error:o}=await (0,r.r$)("/platform/pg-meta/{ref}/tables",{params:{header:{"x-connection-encrypted":n},path:{ref:t},query:{id:s}},body:a,headers:i});return o&&(0,r.S3)(o),l}let d=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,a.D)(e=>c(e),{async onSuccess(t,n,s){let{projectRef:a,schema:i,id:c}=n;await Promise.all([r.invalidateQueries(l.W.list(a,i)),r.invalidateQueries(l.W.table(a,c)),r.invalidateQueries(o.X.lint(a))]),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?i.Am.error("Failed to update database table: ".concat(e.message)):t(e,n,s)},...n})}},57924:function(e,t,n){"use strict";n.d(t,{AF:function(){return m},Bj:function(){return u},Lk:function(){return d}});var s=n(36492),a=n(85945),i=n(829),r=n.n(i),l=n(2784),o=n(31696),c=n(29573);async function d(e,t){let{projectRef:n,connectionString:s,schema:a,includeColumns:i=!1,sortByProperty:l="name"}=e;if(!n)throw Error("projectRef is required");let c=new Headers;s&&c.set("x-connection-encrypted",s);let d={include_columns:"".concat(i)};a&&(d.included_schemas=a);let{data:u,error:m}=await (0,o.U2)("/platform/pg-meta/{ref}/tables",{params:{header:{"x-connection-encrypted":s},path:{ref:n},query:d},headers:c,signal:t});return(!Array.isArray(u)&&m&&(0,o.S3)(m),Array.isArray(u)&&l)?r()(u,e=>e[l]):u}let u=function(e){let{projectRef:t,connectionString:n,schema:a,includeColumns:i}=e,{enabled:r=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(c.W.list(t,a,i),e=>{let{signal:s}=e;return d({projectRef:t,connectionString:n,schema:a,includeColumns:i},s)},{enabled:r&&void 0!==t,staleTime:0,...l})};function m(e){let{projectRef:t,connectionString:n}=e,s=(0,a.NL)();return(0,l.useCallback)((e,a)=>s.fetchQuery({queryKey:c.W.list(t,e,a),queryFn:s=>{let{signal:i}=s;return d({projectRef:t,connectionString:n,schema:e,includeColumns:a},i)}}),[n,t,s])}},56706:function(e,t,n){"use strict";n.d(t,{N:function(){return s}});let s={list:e=>["projects",e,"views"],listBySchema:(e,t)=>[...s.list(e),t],view:(e,t)=>[...s.list(e),t]}},65802:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var s=n(85945),a=n(27570),i=n(18592);let r=e=>{let{id:t}=e;return"\n    select\n      c.oid::int8 as \"id\",\n      nc.nspname as \"schema\",\n      c.relname as \"name\",\n      c.relkind as \"type\",\n      obj_description(c.oid) as \"comment\",\n      count(*) over() as \"count\"\n    from\n      pg_namespace nc\n      join pg_class c on nc.oid = c.relnamespace\n    where\n      c.relkind in ('r', 'v', 'm', 'f', 'p')\n      and not pg_is_other_temp_schema(nc.oid)\n      and (\n        pg_has_role(c.relowner, 'USAGE')\n        or has_table_privilege(\n          c.oid,\n          'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n        )\n        or has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n      )\n      and c.oid = '".concat(t,"'\n    limit 1;\n  ")},l=function(e){let{projectRef:t,connectionString:n,id:s,...a}=e,{enabled:l,...o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.cp)({projectRef:t,connectionString:n,sql:r({id:s,...a}),queryKey:["entity-type",s]},{select(e){var t;return null!==(t=e.result[0])&&void 0!==t?t:null},enabled:l&&void 0!==t&&void 0!==s&&!isNaN(s),...o})};var o=n(16623),c=n(2784),d=function(e,t){let n=(0,s.NL)(),{project:i}=(0,a.d2)(),r=(0,c.useMemo)(()=>{var t,s,a,r;return null===(r=n.getQueryCache().find(o.C.list(null==i?void 0:i.ref)))||void 0===r?void 0:null===(a=r.state.data)||void 0===a?void 0:null===(s=a.pages)||void 0===s?void 0:null===(t=s.flatMap(e=>e.data.entities))||void 0===t?void 0:t.find(t=>t.id===e)},[null==i?void 0:i.ref,e]),{data:d}=l({projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString,id:e},{enabled:!r,onSettled(n){n||void 0===e||null==t||t(e)}});return null!=r?r:d}},26541:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var s=n(27570),a=n(37603),i=n(36492),r=n(88354),l=n(99248);let o=(e,t)=>["projects",e,"foreignTables",t];async function c(e,t){let{id:n,projectRef:s,connectionString:a}=e;if(!s)throw Error("projectRef is required");if(!n)throw Error("id is required");let i=new Headers;a&&i.set("x-connection-encrypted",a);let o=await (0,r.U2)("".concat(l.T5,"/pg-meta/").concat(s,"/foreign-tables?id=").concat(n),{headers:Object.fromEntries(i),signal:t});if("error"in o)throw o.error;return o}let d=function(e){let{projectRef:t,connectionString:n,id:s}=e,{enabled:a=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.a)(o(t,s),e=>{let{signal:a}=e;return c({projectRef:t,connectionString:n,id:s},a)},{enabled:a&&void 0!==t&&void 0!==s,staleTime:0,...r})},u=(e,t)=>["projects",e,"materializedViews",t];async function m(e,t){let{id:n,projectRef:s,connectionString:a}=e;if(!s)throw Error("projectRef is required");if(!n)throw Error("id is required");let i=new Headers;a&&i.set("x-connection-encrypted",a);let o=await (0,r.U2)("".concat(l.T5,"/pg-meta/").concat(s,"/materialized-views?id=").concat(n),{headers:Object.fromEntries(i),signal:t});if("error"in o)throw o.error;return o}let h=function(e){let{projectRef:t,connectionString:n,id:s}=e,{enabled:a=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.a)(u(t,s),e=>{let{signal:a}=e;return m({projectRef:t,connectionString:n,id:s},a)},{enabled:a&&void 0!==t&&void 0!==s,staleTime:0,...r})};var p=n(6564),x=n(31696),f=n(56706);async function g(e,t){let{id:n,projectRef:s,connectionString:a}=e;if(!s)throw Error("projectRef is required");if(!n)throw Error("id is required");let i=new Headers;a&&i.set("x-connection-encrypted",a);let{data:r,error:l}=await (0,x.U2)("/platform/pg-meta/{ref}/views",{params:{header:{"x-connection-encrypted":a},path:{ref:s},query:{id:"".concat(n)}},headers:i,signal:t});return l&&(0,x.S3)(l),r}let j=function(e){let{projectRef:t,connectionString:n,id:s}=e,{enabled:a=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.a)(f.N.view(t,s),e=>{let{signal:a}=e;return g({projectRef:t,connectionString:n,id:s},a)},{enabled:a&&void 0!==t&&void 0!==s,staleTime:0,...r})};var v=n(65802),y=function(e){let{project:t}=(0,s.d2)(),n=(0,v.Z)(e),i=(0,p.yp)({projectRef:null==t?void 0:t.ref,connectionString:null==t?void 0:t.connectionString,id:null==n?void 0:n.id},{enabled:(null==n?void 0:n.type)===a.l.TABLE}),r=(0,p.yp)({projectRef:null==t?void 0:t.ref,connectionString:null==t?void 0:t.connectionString,id:null==n?void 0:n.id},{enabled:(null==n?void 0:n.type)===a.l.PARTITIONED_TABLE}),l=j({projectRef:null==t?void 0:t.ref,connectionString:null==t?void 0:t.connectionString,id:null==n?void 0:n.id},{enabled:(null==n?void 0:n.type)===a.l.VIEW}),o=h({projectRef:null==t?void 0:t.ref,connectionString:null==t?void 0:t.connectionString,id:null==n?void 0:n.id},{enabled:(null==n?void 0:n.type)===a.l.MATERIALIZED_VIEW}),c=d({projectRef:null==t?void 0:t.ref,connectionString:null==t?void 0:t.connectionString,id:null==n?void 0:n.id},{enabled:(null==n?void 0:n.type)===a.l.FOREIGN_TABLE});switch(null==n?void 0:n.type){case a.l.TABLE:return i;case a.l.PARTITIONED_TABLE:return r;case a.l.VIEW:return l;case a.l.MATERIALIZED_VIEW:return o;case a.l.FOREIGN_TABLE:return c;default:return i}}},58995:function(e,t,n){"use strict";n.d(t,{Rv:function(){return h},_T:function(){return m},bP:function(){return c},eB:function(){return u},j8:function(){return d}});var s=n(52322),a=n(18094),i=n(28883),r=n(9548),l=n(76541),o=n(16483);let c={API:{label:"All API usage",icon:(0,s.jsx)(i.Z,{size:16}),key:"api"},API_DATABASE:{label:"Database API",icon:(0,s.jsx)(r.Z,{size:16}),key:"api_database"},API_AUTH:{label:"Auth API",icon:(0,s.jsx)(a.gx,{size:16}),key:"api_auth"},API_STORAGE:{label:"Storage API",icon:(0,s.jsx)(a.Ke,{size:16}),key:"api_storage"},API_REALTIME:{label:"Realtime API",icon:(0,s.jsx)(a.Z7,{size:16}),key:"api_realtime"},INSTANCE:{label:"Instance health",icon:(0,s.jsx)(l.Z,{size:16}),key:"instance"},SUPAVISOR:{label:"Supavisor",icon:(0,s.jsx)(o.Z,{size:16}),key:"supavisor"}},d=[{key:"avg_cpu_usage",label:"Average CPU % usage",provider:"infra-monitoring",category:c.INSTANCE},{key:"max_cpu_usage",label:"Max CPU % usage",provider:"infra-monitoring",category:c.INSTANCE},{key:"disk_io_consumption",label:"Disk IO % Consumed",provider:"infra-monitoring",category:c.INSTANCE},{key:"disk_io_budget",label:"Disk IO % Remaining",provider:"infra-monitoring",category:c.INSTANCE},{key:"ram_usage",label:"Memory % usage",provider:"infra-monitoring",category:c.INSTANCE},{key:"swap_usage",label:"Swap % usage",provider:"infra-monitoring",category:c.INSTANCE},{key:"total_realtime_egress",label:"Realtime Connection Egress",provider:"daily-stats",category:c.API},{key:"total_realtime_requests",label:"Realtime Connection Requests",provider:"daily-stats",category:c.API_REALTIME},{key:"total_realtime_ingress",label:"Realtime Connection Ingress",provider:"daily-stats",category:c.API_REALTIME},{key:"total_rest_ingress",label:"API Ingress",provider:"daily-stats",category:c.API_DATABASE},{key:"total_rest_egress",label:"API Egress",provider:"daily-stats",category:c.API_DATABASE},{key:"total_rest_requests",label:"API Requests",provider:"daily-stats",category:c.API_DATABASE},{key:"total_rest_get_requests",label:"API GET Requests",provider:"daily-stats",category:c.API_DATABASE},{key:"total_rest_post_requests",label:"API POST Requests",provider:"daily-stats",category:c.API_DATABASE},{key:"total_rest_patch_requests",label:"API PATCH Requests",provider:"daily-stats",category:c.API_DATABASE},{key:"total_rest_delete_requests",label:"API DELETE Requests",provider:"daily-stats",category:c.API_DATABASE},{key:"total_rest_options_requests",label:"API OPTIONS Requests",provider:"daily-stats",category:c.API_DATABASE},{key:"total_auth_billing_period_mau",label:"Auth Monthly Active User",provider:"daily-stats",category:c.API_AUTH},{key:"total_auth_billing_period_sso_mau",label:"Auth Monthly Active SSO User",provider:"daily-stats",category:c.API_AUTH},{key:"total_auth_ingress",label:"Auth Ingress",provider:"daily-stats",category:c.API_AUTH},{key:"total_auth_egress",label:"Auth Egress",provider:"daily-stats",category:c.API_AUTH},{key:"total_auth_requests",label:"Auth Requests",provider:"daily-stats",category:c.API_AUTH},{key:"total_auth_get_requests",label:"Auth GET Requests",provider:"daily-stats",category:c.API_AUTH},{key:"total_auth_post_requests",label:"Auth POST Requests",provider:"daily-stats",category:c.API_AUTH},{key:"total_auth_patch_requests",label:"Auth PATCH requests",provider:"daily-stats",category:c.API_AUTH},{key:"total_auth_options_requests",label:"Auth OPTIONS requests",provider:"daily-stats",category:c.API_AUTH},{key:"total_storage_ingress",label:"Storage Ingress",provider:"daily-stats",category:c.API_STORAGE},{key:"total_storage_egress",label:"Storage Egress",provider:"daily-stats",category:c.API_STORAGE},{key:"total_storage_image_render_count",label:"Storage Image Transformations",provider:"daily-stats",category:c.API_STORAGE},{key:"total_storage_requests",label:"Storage Requests",provider:"daily-stats",category:c.API_STORAGE},{key:"total_storage_get_requests",label:"Storage GET Requests",provider:"daily-stats",category:c.API_STORAGE},{key:"total_storage_post_requests",label:"Storage POST Requests",provider:"daily-stats",category:c.API_STORAGE},{key:"total_storage_delete_requests",label:"Storage DELETE Requests",provider:"daily-stats",category:c.API_STORAGE},{key:"total_storage_options_requests",label:"Storage OPTIONS Requests",provider:"daily-stats",category:c.API_STORAGE},{key:"total_auth_delete_requests",label:"Auth DELETE Requests",provider:"daily-stats",category:c.API_AUTH},{key:"total_egress",label:"All Egress",provider:"daily-stats",category:c.API},{key:"total_get_requests",label:"All GET Requests",provider:"daily-stats",category:c.API},{key:"total_storage_patch_requests",label:"Storage PATCH Requests",provider:"daily-stats",category:c.API_STORAGE},{key:"total_requests",label:"All Requests",provider:"daily-stats",category:c.API},{key:"total_patch_requests",label:"All PATCH Requests",provider:"daily-stats",category:c.API},{key:"total_post_requests",label:"All POST Requests",provider:"daily-stats",category:c.API},{key:"total_ingress",label:"All Ingress",provider:"daily-stats",category:c.API},{key:"total_delete_requests",label:"All DELETE Requests",provider:"daily-stats",category:c.API},{key:"total_options_requests",label:"All OPTIONS Requests",provider:"daily-stats",category:c.API},{key:"total_supavisor_egress_bytes",label:"Supavisor Egress",provider:"daily-stats",category:c.SUPAVISOR}],u=[{key:"currentBillingCycle",label:"Current billing cycle",interval:"1d"},{key:"previousBillingCycle",label:"Previous billing cycle",interval:"1d"}],m=[{key:"7d",label:"Last 7 days",interval:"1d"},{key:"30d",label:"Last 30 days",interval:"1d"},{key:"startMonth",label:"This month",interval:"1d"}],h=[{key:"1h",label:"Last hour"},{key:"3h",label:"Last 3 hours"},{key:"1d",label:"Last 24 hours"},{key:"7d",label:"Last 7 days"}]},11354:function(e,t,n){"use strict";n.d(t,{F:function(){return s},U:function(){return a}});let s=["auth","cron","extensions","information_schema","net","pgsodium","pgsodium_masks","pgbouncer","pgtle","realtime","storage","supabase_functions","supabase_migrations","vault","graphql","graphql_public"],a=s.filter(e=>"extensions"!==e)},84255:function(e,t,n){"use strict";n.d(t,{H:function(){return F}});var s=n(87612),a=n(52322),i=n(20364),r=n(62419),l=n(93586),o=n.n(l),c=n(60417),d=n.n(c),u=n(55281),m=n.n(u),h=n(12982),p=n.n(h),x=n(93352),f=n.n(x),g=n(18149),j=n.n(g),v=n(51525),y=n.n(v),b=n(75652),N=n.n(b),w=n(84636),_=n.n(w),C=n(80075),S=n(62202),k=n(82435),E=n(67875),A=n(85642),T=n(52321),I=n(45101),Z=n(83136),z=n(88354),P=n(99248),R=n(34406);let L=new URL(R.env.SUPABASE_PUBLIC_URL||"http://localhost:8000");R.env.LOGFLARE_URL,L.origin,L.host;let O=L.protocol.replace(":","");R.env.DEFAULT_PROJECT_NAME;let D=null;function F(){return null===D&&(D=new q(null)),D}let U=".emptyFolderPlaceholder",M="Please do not close the browser until it's completed";class q{initStore(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:O;this.projectRef=e,this.endpoint="".concat(P.T5,"/storage/").concat(e),void 0!==n&&this.initializeSupabaseClient(n,t,s)}get currentBucketName(){return this.selectedBucket.name}constructor(e){var t=this;(0,s._)(this,"projectRef",""),(0,s._)(this,"loaded",!1),(0,s._)(this,"view",E.De.COLUMNS),(0,s._)(this,"sortBy",E.Ye.NAME),(0,s._)(this,"sortByOrder","asc"),(0,s._)(this,"buckets",[]),(0,s._)(this,"selectedBucket",{}),(0,s._)(this,"columns",[]),(0,s._)(this,"openedFolders",[]),(0,s._)(this,"selectedItems",[]),(0,s._)(this,"selectedItemsToDelete",[]),(0,s._)(this,"selectedItemsToMove",[]),(0,s._)(this,"selectedFilePreview",{}),(0,s._)(this,"selectedFileCustomExpiry",void 0),(0,s._)(this,"DEFAULT_OPTIONS",{limit:200,offset:0,sortBy:{column:this.sortBy,order:this.sortByOrder}}),(0,s._)(this,"supabaseClient",null),(0,s._)(this,"endpoint",""),(0,s._)(this,"filePreviewCache",[]),(0,s._)(this,"uploadProgress",0),(0,s._)(this,"abortController",null),(0,s._)(this,"initializeSupabaseClient",(e,t,n)=>{this.supabaseClient=(0,i.eI)("".concat(P.Qy?"https":n,"://").concat(t),e,{auth:{persistSession:!1,autoRefreshToken:!1,multiTab:!1,detectSessionInUrl:!1,localStorage:{getItem:e=>{},setItem:(e,t)=>{},removeItem:e=>{}}}})}),(0,s._)(this,"updateFileInPreviewCache",e=>{let t=this.filePreviewCache.map(t=>t.id===e.id?e:t);this.filePreviewCache=t}),(0,s._)(this,"addFileToPreviewCache",e=>{let t=this.filePreviewCache.concat([e]);this.filePreviewCache=t}),(0,s._)(this,"clearFilePreviewCache",()=>{this.filePreviewCache=[]}),(0,s._)(this,"getLocalStorageKey",()=>"supabase-storage-".concat(this.projectRef)),(0,s._)(this,"getLatestColumnIndex",()=>this.columns.length-1),(0,s._)(this,"getCurrentlySelectedBucket",()=>this.columns.length>1?this.columns[1]:null),(0,s._)(this,"getPathAlongOpenedFolders",function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return e?t.openedFolders.length>0?"".concat(t.selectedBucket.name,"/").concat(t.openedFolders.map(e=>e.name).join("/")):t.selectedBucket.name:t.openedFolders.map(e=>e.name).join("/")}),(0,s._)(this,"abortApiCalls",()=>{this.abortController.abort(),this.abortController=new AbortController}),(0,s._)(this,"setLoaded",e=>{this.loaded=e}),(0,s._)(this,"setSelectedBucket",e=>{this.selectedBucket=e,this.clearOpenedFolders(),this.closeFilePreview(),this.clearSelectedItems()}),(0,s._)(this,"setView",e=>{this.view=e,this.closeFilePreview(),this.updateExplorerPreferences()}),(0,s._)(this,"setSortBy",async e=>{this.sortBy=e,this.closeFilePreview(),this.updateExplorerPreferences(),await this.refetchAllOpenedFolders()}),(0,s._)(this,"setSortByOrder",async e=>{this.sortByOrder=e,this.closeFilePreview(),this.updateExplorerPreferences(),await this.refetchAllOpenedFolders()}),(0,s._)(this,"clearColumns",()=>{this.columns=[]}),(0,s._)(this,"pushColumnAtIndex",(e,t)=>{this.columns=this.columns.slice(0,t+1).concat([e])}),(0,s._)(this,"popColumn",()=>{this.abortApiCalls(),this.columns=this.columns.slice(0,this.getLatestColumnIndex())}),(0,s._)(this,"popColumnAtIndex",e=>{this.columns=this.columns.slice(0,e+1)}),(0,s._)(this,"setColumnIsLoadingMore",function(e){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];t.columns=t.columns.map((t,s)=>s===e?{...t,isLoadingMoreItems:n}:t)}),(0,s._)(this,"pushOpenedFolderAtIndex",(e,t)=>{this.openedFolders=this.openedFolders.slice(0,t).concat(e)}),(0,s._)(this,"popOpenedFolders",()=>{this.openedFolders=this.openedFolders.slice(0,this.openedFolders.length-1)}),(0,s._)(this,"popOpenedFoldersAtIndex",e=>{this.openedFolders=this.openedFolders.slice(0,e+1)}),(0,s._)(this,"clearOpenedFolders",()=>{this.openedFolders=[]}),(0,s._)(this,"setSelectedItems",e=>{this.selectedItems=e}),(0,s._)(this,"clearSelectedItems",e=>{void 0!==e?this.selectedItems=this.selectedItems.filter(t=>t.columnIndex!==e):this.selectedItems=[]}),(0,s._)(this,"setSelectedItemsToDelete",e=>{this.selectedItemsToDelete=e}),(0,s._)(this,"clearSelectedItemsToDelete",()=>{this.selectedItemsToDelete=[]}),(0,s._)(this,"setSelectedItemsToMove",e=>{this.selectedItemsToMove=e}),(0,s._)(this,"clearSelectedItemsToMove",()=>{this.selectedItemsToMove=[]}),(0,s._)(this,"setSelectedFileCustomExpiry",e=>{this.selectedFileCustomExpiry=e}),(0,s._)(this,"addNewFolderPlaceholder",e=>{let t=E.fh.FOLDER,n=-1===e?this.getLatestColumnIndex():e;this.addTempRow(t,"Untitled folder",E.R9.EDITING,n,{},!0)}),(0,s._)(this,"addNewFolder",async(e,t)=>{let n=this.sanitizeNameForDuplicateInColumn(e,!1,t);if(null===n)return;if(!/^[a-zA-Z0-9_-\s]*$/.test(n))return(0,k.Am)({variant:"destructive",description:"Folder name contains invalid special characters",duration:6e3});if(0===n.length)return this.removeTempRows(t);this.updateFolderAfterEdit(n,t);let s="".concat(n,"/").concat(U),a=this.openedFolders.slice(0,t).map(e=>e.name).join("/"),i=a.length>0?"".concat(a,"/").concat(s):s;await this.supabaseClient.storage.from(this.selectedBucket.name).upload(i,new File([],U)),a.length>0&&await (0,z.$v)("".concat(this.endpoint,"/buckets/").concat(this.selectedBucket.id,"/objects"),{paths:["".concat(a,"/").concat(U)]})}),(0,s._)(this,"setFilePreview",async e=>{var t,n,s,a;let i=null===(t=e.metadata)||void 0===t?void 0:t.size;if((null===(n=e.metadata)||void 0===n?void 0:n.mimetype)&&i){if(i>1e7){this.selectedFilePreview={...e,previewUrl:"skipped"};return}this.selectedFilePreview={...e,previewUrl:"loading"};let t=m()(this.filePreviewCache,{id:e.id}),n=null!==(s=null==t?void 0:t.fetchedAt)&&void 0!==s?s:null,r=null!==(a=null==t?void 0:t.expiresIn)&&void 0!==a?a:null,l=null!==n&&null!==r;if(!l||n+1e3*r<Date.now()){let t=await this.fetchFilePreview(e.name),n=this.selectedBucket.public?"".concat(t,"?t=").concat(new Date().toISOString()):t;this.selectedFilePreview={...e,previewUrl:n};let s={id:e.id,url:t,expiresIn:31536e4,fetchedAt:Date.now()};l?this.updateFileInPreviewCache(s):this.addFileToPreviewCache(s)}else this.selectedFilePreview={...e,previewUrl:t.url}}else this.selectedFilePreview={...e,previewUrl:null}}),(0,s._)(this,"closeFilePreview",()=>{this.selectedFilePreview={}}),(0,s._)(this,"getFileUrl",async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=m()(t.filePreviewCache,{id:e.id});if(void 0!==s&&0===n)return s.url;{let s=await t.fetchFilePreview(e.name,n);try{let n=new URL(s);n.searchParams.set("t",new Date().toISOString());let a=n.toString(),i={id:e.id,url:a,expiresIn:31536e4,fetchedAt:Date.now()};return t.addFileToPreviewCache(i),a}catch(e){return console.error("Failed to get file URL",e),""}}}),(0,s._)(this,"openBucket",async e=>{let{id:t,name:n}=e;j()(this.selectedBucket,e)||(this.setSelectedBucket(e),await this.fetchFolderContents(t,n,-1))}),(0,s._)(this,"getFile",async e=>{try{return await new Promise((t,n)=>e.file(t,n))}catch(e){console.error("getFile error:",e);return}}),(0,s._)(this,"getFilesDataTransferItems",async e=>{let{dismiss:t}=(0,k.Am)({description:"Retrieving items to upload..."}),n=[],s=[];for(let t of e)s.push(t.webkitGetAsEntry());for(;s.length>0;){let e=s.shift()||{};if(e.isFile){let t=await this.getFile(e);void 0!==t&&(t.path=e.fullPath.slice(1),n.push(t))}else e.isDirectory&&s.push(...await this.readAllDirectoryEntries(e.createReader()))}return t(),n}),(0,s._)(this,"readAllDirectoryEntries",async e=>{let t=[],n=await this.readEntriesPromise(e);for(;n.length>0;)t.push(...n),n=await this.readEntriesPromise(e);return t}),(0,s._)(this,"readEntriesPromise",async e=>{try{return await new Promise((t,n)=>{e.readEntries(t,n)})}catch(e){console.error("readEntriesPromise error:",e)}}),(0,s._)(this,"uploadFiles",async function(e,n){var s,i,r,l;let c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=null===(s=(0,Z.g)().getQueryCache().find(I.U.storage(t.projectRef)))||void 0===s?void 0:s.state.data,u=null==d?void 0:d.fileSizeLimit,m=new Date,h=c?(await t.getFilesDataTransferItems(e)).filter(e=>!e.path.includes("#/")):Array.from(e),p=-1===n?t.getLatestColumnIndex():n,x=void 0!==u?h.filter(e=>e.size<=u):h;if(x.length<h.length){let e=h.length-x.length,{value:t,unit:n}=(0,A.Ku)(u);if(S.ZP.error((0,a.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,a.jsxs)("p",{className:"text-foreground",children:["Failed to upload ",e," file",e>1?"s":""," as"," ",e>1?"their":"its"," size",e>1?"s are":" is"," beyond the upload limit of ",t,n,"."]}),(0,a.jsx)("p",{className:"text-foreground-light",children:"You may change the file size upload limit under Storage in Project Settings."})]}),{duration:8e3}),e===h.length)return}let g=(null!==(l=null===(r=t.columns)||void 0===r?void 0:null===(i=r[p])||void 0===i?void 0:i.items)&&void 0!==l?l:[]).filter(e=>!e.id).map(e=>e.name),j=x.map(e=>{if(!e.path)return e;let s=e.path.split("/"),a=s.length>1?s[0]:null;if(g.includes(a)){let i=t.sanitizeNameForDuplicateInColumn(a,!0,n);s[0]=i,e.path=s.join("/")}return e});t.uploadProgress=0;let v=[],y=j.length,b=0,N=0,w=t.openedFolders.slice(0,p).map(e=>e.name).join("/"),_=S.ZP.loading((0,a.jsx)(T.q,{progress:0,message:"Uploading ".concat(j.length," file").concat(j.length>1?"s":"","..."),description:M})),C=j.map(e=>{var n;let s={cacheControl:"3600"},a={mimetype:e.type,size:e.size},i=(null!==(n=null==e?void 0:e.path)&&void 0!==n?n:"").split("/").length>1,r=i?e.name:t.sanitizeNameForDuplicateInColumn(e.name,!0),l=(f()(e,["path"])&&i?e.path:r).replace(/[^\w.-]/g,"_"),o=w.length>0?"".concat(w,"/").concat(l):l;if(i){let n=e.path.split("/")[0];v.includes(n)||(t.addTempRow(E.fh.FOLDER,n,E.R9.LOADING,p,a),v.push(n))}else t.addTempRow(E.fh.FILE,r,E.R9.LOADING,p,a);return()=>new Promise(async n=>{let{error:a}=await t.supabaseClient.storage.from(t.selectedBucket.name).upload(o,e,s);t.uploadProgress=t.uploadProgress+1/j.length,a?(N+=1,S.ZP.error("Failed to upload ".concat(e.name,": ").concat(a.message))):b+=1,n()})}),k=o()(C,10);try{await k.reduce(async(e,n)=>{await e,await Promise.allSettled(n.map(e=>e())),S.ZP.loading((0,a.jsx)(T.q,{progress:100*t.uploadProgress,message:"Uploading ".concat(j.length," file").concat(j.length>1?"s":"","..."),description:M}),{id:_})},Promise.resolve()),b>0&&await (0,z.$v)("".concat(t.endpoint,"/buckets/").concat(t.selectedBucket.id,"/objects"),{paths:["".concat(w,"/").concat(U)]}),await t.refetchAllOpenedFolders(),0===y?S.ZP.dismiss(_):N===y?S.ZP.error("Failed to upload ".concat(y," file").concat(y>1?"s":"","!"),{id:_}):b===y?S.ZP.success("Successfully uploaded ".concat(y," file").concat(y>1?"s":"","!"),{id:_}):S.ZP.success("Successfully uploaded ".concat(b," out of ").concat(y," file").concat(y>1?"s":"","!"),{id:_})}catch(e){S.ZP.error("Failed to upload files",{id:_})}let P=new Date;console.log("Total time taken for ".concat(j.length," files: ").concat((P-m)/1e3," seconds"))}),(0,s._)(this,"moveFiles",async e=>{let t=d()(e.split("/")).join("/"),n=0;this.clearSelectedItems();let{dismiss:s}=(0,k.Am)({description:"Please do not close the browser until the move is completed",duration:1/0});await Promise.all(this.selectedItemsToMove.map(async s=>{let a=this.openedFolders.slice(0,s.columnIndex).map(e=>e.name).join("/"),i=a.length>0?"".concat(a,"/").concat(s.name):s.name,r=e.length>0?"".concat(t,"/").concat(s.name):s.name,l=await (0,z.v_)("".concat(this.endpoint,"/buckets/").concat(this.selectedBucket.id,"/objects/move"),{from:i,to:r});l.error&&(n+=1,S.ZP.error(l.error.message))})),n===this.selectedItemsToMove.length?(0,k.Am)({variant:"destructive",description:"Failed to move files"}):(0,k.Am)({description:"Successfully moved ".concat(this.selectedItemsToMove.length-n," files to ").concat(t.length>0?t:"the root of your bucket")}),s();let a=this.selectedItemsToMove.map(e=>e.id),i=this.filePreviewCache.filter(e=>!a.includes(e.id));this.filePreviewCache=i,await this.refetchAllOpenedFolders(),this.clearSelectedItemsToMove()}),(0,s._)(this,"fetchFilePreview",async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=t.getPathAlongOpenedFolders(!1),a=s.length>0?"".concat(s,"/").concat(e):e;if(t.selectedBucket.public){let e=await (0,z.v_)("".concat(t.endpoint,"/buckets/").concat(t.selectedBucket.id,"/objects/public-url"),{path:a});if(!e.error)return e.publicUrl;S.ZP.error("Failed to fetch public file preview: ".concat(e.error.message))}else{let e=await (0,z.v_)("".concat(t.endpoint,"/buckets/").concat(t.selectedBucket.id,"/objects/sign"),{path:a,expiresIn:n||31536e4});if(!e.error)return e.signedUrl;S.ZP.error("Failed to fetch signed url preview: ".concat(e.error.message))}return null}),(0,s._)(this,"deleteFiles",async function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.closeFilePreview();let s=0,i=y()(e,"prefix")?e.map(e=>"".concat(e.prefix,"/").concat(e.name)):e.map(e=>{let{name:n,columnIndex:s}=e,a=t.openedFolders.slice(0,s).map(e=>e.name).join("/");return t.updateRowStatus(n,E.R9.LOADING,s),a.length>0?"".concat(a,"/").concat(n):n});t.clearSelectedItems();let r=S.ZP.loading((0,a.jsx)(T.q,{progress:0,message:"Deleting ".concat(i.length," file(s)..."),description:M})),l=o()(i,2).map(e=>()=>(s+=e.length/i.length,(0,z.$v)("".concat(t.endpoint,"/buckets/").concat(t.selectedBucket.name,"/objects"),{paths:e})));await o()(l,2).reduce(async(e,t)=>{await e,await Promise.all(t.map(e=>e())),S.ZP.loading((0,a.jsx)(T.q,{progress:100*s,message:"Deleting ".concat(i.length," file(s)..."),description:M}),{id:r})},Promise.resolve());let c=e.map(e=>e.id),d=t.filePreviewCache.filter(e=>!c.includes(e.id));if(t.filePreviewCache=d,n)S.ZP.dismiss(r);else{let e=N()(i.map(e=>{let t=e.split("/");return t.slice(0,t.length-1).join("/")}));await Promise.all(e.map(e=>t.validateParentFolderEmpty(e))),S.ZP.success("Successfully deleted ".concat(i.length," file(s)"),{id:r}),await t.refetchAllOpenedFolders(),t.clearSelectedItemsToDelete()}}),(0,s._)(this,"downloadFolder",async e=>{let t=0,n=S.ZP.loading("Retrieving files from folder..."),s=await this.getAllItemsAlongFolder(e);S.ZP.loading((0,a.jsx)(T.q,{progress:0,message:"Downloading ".concat(s.length," file").concat(s.length>1?"s":"","..."),desription:M}),{id:n});let i=s.map(e=>{var n,a;let i=null!==(a=null===(n=e.metadata)||void 0===n?void 0:n.mimetype)&&void 0!==a?a:null;return()=>new Promise(async n=>{let a=await (0,z.v_)("".concat(this.endpoint,"/buckets/").concat(this.selectedBucket.id,"/objects/download"),{path:"".concat(e.prefix,"/").concat(e.name)});if(t+=1/s.length,a.error)console.error("Failed to download file","".concat(e.prefix,"/").concat(e.name)),n(!1);else{let t=await a.blob();n({name:e.name,prefix:e.prefix,blob:new Blob([t],{type:i})})}})}),l=o()(i,10),c=await l.reduce(async(e,i)=>{let r=await e,l=await Promise.allSettled(i.map(e=>e()));return S.ZP.loading((0,a.jsx)(T.q,{progress:100*t,message:"Downloading ".concat(s.length," file").concat(s.length>1?"s":"","..."),desription:M}),{id:n}),(null!=r?r:[]).concat(l.map(e=>e.value).filter(Boolean))},Promise.resolve()),d=new r.U5("application/zip"),u=new r._Q(d,{bufferedWrite:!0});0===c.length&&S.ZP.error('Failed to download files from "'.concat(e.name,'"'),{id:n}),c.forEach(e=>{e.blob&&u.add("".concat(e.prefix,"/").concat(e.name),new r.Nt(e.blob))});let m=URL.createObjectURL(await u.close()),h=document.createElement("a");h.href=m,h.setAttribute("download","".concat(e.name,".zip")),document.body.appendChild(h),h.click(),h.parentNode.removeChild(h),S.ZP.success(c.length===s.length?'Successfully downloaded folder "'.concat(e.name,'"'):'Downloaded folder "'.concat(e.name,'". However, ').concat(s.length-c.length," files did not download successfully."),{id:n})}),(0,s._)(this,"downloadSelectedFiles",async e=>{let t=Math.min(...e.map(e=>e.columnIndex)),n=e.map(e=>{let{name:n,columnIndex:s}=e,a=this.openedFolders.slice(t,s).map(e=>e.name).join("/"),i=a.length>0?"".concat(a,"/").concat(n):n;return{...e,formattedPathToFile:i}}),s=0,i=S.ZP.loading("Downloading ".concat(e.length," file").concat(e.length>1?"s":"","...")),l=n.map(e=>()=>new Promise(async t=>{let a=await this.downloadFile(e,!1,!0);s+=1/n.length,t({...a,name:e.formattedPathToFile})})),c=o()(l,10),d=await c.reduce(async(t,n)=>{let r=await t,l=await Promise.allSettled(n.map(e=>e()));return S.ZP.loading((0,a.jsx)(T.q,{progress:100*s,message:"Downloading ".concat(e.length," file").concat(e.length>1?"s":"","..."),description:M}),{id:i}),(null!=r?r:[]).concat(l.map(e=>e.value).filter(Boolean))},Promise.resolve()),u=new r.U5("application/zip"),m=new r._Q(u,{bufferedWrite:!0});d.forEach(e=>{m.add(e.name,new r.Nt(e.blob))});let h=URL.createObjectURL(await m.close()),p=document.createElement("a");p.href=h,p.setAttribute("download","supabase-files.zip"),document.body.appendChild(p),p.click(),p.parentNode.removeChild(p),S.ZP.success("Successfully downloaded ".concat(d.length," files"),{id:i})}),(0,s._)(this,"downloadFile",async function(e){var n,s;let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.name,l=null!==(s=null==e?void 0:null===(n=e.metadata)||void 0===n?void 0:n.mimetype)&&void 0!==s?s:null,o=a?S.ZP.loading("Retrieving ".concat(r,"...")):void 0,c=t.openedFolders.slice(0,e.columnIndex).map(e=>e.name).join("/"),d=c.length>0?"".concat(c,"/").concat(r):r,u=await (0,z.v_)("".concat(t.endpoint,"/buckets/").concat(t.selectedBucket.id,"/objects/download"),{path:d});if(u.error)return o&&S.ZP.error("Failed to download ".concat(r),{id:o}),!1;{let e=await u.blob(),t=new Blob([e],{type:l});if(i)return{name:r,blob:t};let n=window.URL.createObjectURL(t),s=document.createElement("a");return s.href=n,s.setAttribute("download","".concat(r)),document.body.appendChild(s),s.click(),s.parentNode.removeChild(s),window.URL.revokeObjectURL(e),o&&S.ZP.success("Downloading ".concat(r),{id:o}),!0}}),(0,s._)(this,"renameFile",async(e,t,n)=>{let s=e.name;if(s===t||0===t.length)this.updateRowStatus(s,E.R9.READY,n);else{this.updateRowStatus(s,E.R9.LOADING,n,t);let a=this.getPathAlongOpenedFolders(!1),i=a.length>0?"".concat(a,"/").concat(s):s,r=a.length>0?"".concat(a,"/").concat(t):t,l=await (0,z.v_)("".concat(this.endpoint,"/buckets/").concat(this.selectedBucket.id,"/objects/move"),{from:i,to:r});if(l.error)S.ZP.error("Failed to rename file: ".concat(l.error.message));else{S.ZP.success('Successfully renamed "'.concat(s,'" to "').concat(t,'"'));let n=this.filePreviewCache.filter(t=>t.id!==e.id);if(this.filePreviewCache=n,this.selectedFilePreview.name===s){let{previewUrl:n,...s}=e;this.setFilePreview({...s,name:t})}await this.refetchAllOpenedFolders()}}}),(0,s._)(this,"fetchFolderContents",async function(e,n,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(void 0===t.selectedBucket.id)return;t.abortApiCalls(),t.updateRowStatus(n,E.R9.LOADING,s),t.pushColumnAtIndex({id:e,name:n,status:E.R9.LOADING,items:[]},s);let i=t.openedFolders.slice(0,s+1).map(e=>e.name).join("/"),r={limit:200,offset:0,search:a,sortBy:{column:t.sortBy,order:t.sortByOrder}},l=await (0,z.v_)("".concat(t.endpoint,"/buckets/").concat(t.selectedBucket.id,"/objects/list"),{path:i,options:r},{abortSignal:t.abortController.signal});if(t.updateRowStatus(n,E.R9.READY,s),l.error)l.error.message.includes("aborted")||S.ZP.error('Failed to retrieve folder contents from "'.concat(n,'": ').concat(l.error.message));else{let a=t.formatFolderItems(l);t.pushColumnAtIndex({id:e||n,name:n,items:a,hasMoreItems:200===a.length,isLoadingMoreItems:!1},s)}}),(0,s._)(this,"fetchMoreFolderContents",async function(e,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";t.setColumnIsLoadingMore(e);let a=t.openedFolders.map(e=>e.name).join("/"),i={limit:200,offset:n.items.length,search:s,sortBy:{column:t.sortBy,order:t.sortByOrder}},r=await (0,z.v_)("".concat(t.endpoint,"/buckets/").concat(t.selectedBucket.id,"/objects/list"),{path:a,options:i},{abortSignal:t.abortController.signal});if(r.error)r.error.message.includes("aborted")||S.ZP.error("Failed to retrieve more folder contents: ".concat(r.error.message));else{let n=t.formatFolderItems(r);t.columns=t.columns.map((t,s)=>s===e?{...t,items:t.items.concat(n),isLoadingMoreItems:!1,hasMoreItems:200===r.length}:t)}}),(0,s._)(this,"refetchAllOpenedFolders",async()=>{let e=this.openedFolders.map(e=>e.name);await this.fetchFoldersByPath(e)}),(0,s._)(this,"fetchFoldersByPath",async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===t.selectedBucket.id)return;let a=[""].concat(e);s&&(t.columns=[t.selectedBucket.name].concat(e).map(e=>({id:e,name:e,status:E.R9.LOADING,items:[]})));let i=(await Promise.all(a.map(async(s,a)=>{let i=e.slice(0,a).join("/"),r={limit:200,offset:0,search:n,sortBy:{column:t.sortBy,order:t.sortByOrder}},l=await (0,z.v_)("".concat(t.endpoint,"/buckets/").concat(t.selectedBucket.id,"/objects/list"),{path:i,options:r});return l.error?(S.ZP.error("Failed to fetch folders: ".concat(l.error.message)),[]):l}))).map((e,n)=>{let s=t.formatFolderItems(e);return{id:null,name:0===n?t.selectedBucket.name:a[n],items:s,hasMoreItems:200===s.length,isLoadingMoreItems:!1}});t.columns=i;let r=e.map((e,t)=>m()(i[t].items,{name:e})||{id:null,name:e,type:E.fh.FOLDER,status:E.R9.READY});t.openedFolders=r}),(0,s._)(this,"validateParentFolderEmpty",async e=>{let t=await (0,z.v_)("".concat(this.endpoint,"/buckets/").concat(this.selectedBucket.id,"/objects/list"),{path:e,options:this.DEFAULT_OPTIONS});if(!t.error&&0===t.length){let t="".concat(e,"/").concat(U);await this.supabaseClient.storage.from(this.selectedBucket.name).upload(t,new File([],U))}}),(0,s._)(this,"deleteFolder",async e=>{let t=await this.getAllItemsAlongFolder(e);if(await this.deleteFiles(t,!0),this.popColumnAtIndex(e.columnIndex),this.popOpenedFoldersAtIndex(e.columnIndex-1),e.columnIndex>0){let t=this.openedFolders.slice(0,e.columnIndex).map(e=>e.name).join("/");t.length>0&&await this.validateParentFolderEmpty(t)}await this.refetchAllOpenedFolders(),this.clearSelectedItemsToDelete(),S.ZP.success("Successfully deleted ".concat(e.name))}),(0,s._)(this,"renameFolder",async(e,t,n)=>{let s=e.name;if(s===t)return this.updateRowStatus(s,E.R9.READY,n);let i=S.ZP.loading((0,a.jsx)(T.q,{progress:0,message:"Renaming folder to ".concat(t),description:M}));if(t.includes("/")||t.includes("\\"))return S.ZP.error("Folder name cannot contain forward or back slashes.");this.updateRowStatus(s,E.R9.LOADING,n,t);let r=await this.getAllItemsAlongFolder(e),l=0,c=!1,d=r.map(e=>{let s="".concat(e.prefix,"/").concat(e.name),a=s.split("/"),i=a.slice(0,n).concat(t).concat(a.slice(n+1)).join("/");return()=>new Promise(async e=>{l+=1/r.length,(await (0,z.v_)("".concat(this.endpoint,"/buckets/").concat(this.selectedBucket.name,"/objects/move"),{from:s,to:i})).error&&(c=!0,S.ZP.error("Failed to move ".concat(s," to the new folder"))),e()})}),u=o()(d,2);try{await u.reduce(async(e,n)=>{await e,await Promise.all(n.map(e=>e())),S.ZP.loader((0,a.jsx)(T.q,{progress:100*l,message:"Renaming folder to ".concat(t),description:M}),{id:i})},Promise.resolve()),c?S.ZP.error("Renamed folder to ".concat(t," with some errors"),{id:i}):S.ZP.success("Successfully renamed folder to ".concat(t),{id:i}),await this.refetchAllOpenedFolders();let e=r.map(e=>e.id),n=this.filePreviewCache.filter(t=>!e.includes(t.id));this.filePreviewCache=n}catch(e){S.ZP.error("Failed to rename folder to ".concat(t),{id:i})}}),(0,s._)(this,"getAllItemsAlongFolder",async e=>{var t,n;let s=[],a="",{name:i,columnIndex:r,prefix:l}=e;if(void 0===l){let e=this.openedFolders.slice(0,r).map(e=>e.name).join("/");a=e.length>0?"".concat(e,"/").concat(i):i}else a="".concat(l,"/").concat(i);let o={limit:1e4,offset:0,sortBy:{column:this.sortBy,order:this.sortByOrder}},c=[];for(;;){let e=await (0,z.v_)("".concat(this.endpoint,"/buckets/").concat(this.selectedBucket.name,"/objects/list"),{path:a,options:o});if(c=c.concat(e),o.offset+=o.limit,(e||[]).length<o.limit)break}let d=null!==(t=null==c?void 0:c.filter(e=>null===e.id))&&void 0!==t?t:[];return(null!==(n=null==c?void 0:c.filter(e=>null!==e.id))&&void 0!==n?n:[]).forEach(e=>s.push({...e,prefix:a})),(await Promise.all(d.map(e=>this.getAllItemsAlongFolder({...e,prefix:a})))).map(e=>{e.map(e=>s.push(e))}),s}),(0,s._)(this,"sanitizeNameForDuplicateInColumn",function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.getLatestColumnIndex(),a=t.columns[s].items.filter(e=>e.status!==E.R9.EDITING);if(a.filter(t=>t.name===e).length>0){if(!n)return S.ZP.error("The name ".concat(e," already exists in the current directory. Please use a different name.")),null;{let[t,n]=e.split("."),s=new RegExp("".concat(t," \\([-0-9]+\\)").concat(n?"."+n:"","$")),i=a.filter(e=>e.name.match(s)),r=t+" (".concat(i.length+1,")");return n?"".concat(r,".").concat(n):r}}return e}),(0,s._)(this,"formatFolderItems",function(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return null!==(t=null===(e=null!=n?n:[])||void 0===e?void 0:e.filter(e=>e.name!==U).map(e=>{let t=e.id?E.fh.FILE:E.fh.FOLDER,n=Number(new Date)-Number(new Date(e.created_at)),s=t===E.fh.FILE&&!e.metadata&&n>=9e5,a=t===E.fh.FILE&&!e.metadata&&n<=9e5?E.R9.LOADING:E.R9.READY;return{...e,type:t,status:a,isCorrupted:s}}))&&void 0!==t?t:[]}),(0,s._)(this,"addTempRow",function(e,n,s,a){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=t.columns.map((t,l)=>{if(l===a){let a={type:e,name:n,status:s,metadata:i},l=r?[a].concat(t.items):t.items.concat([a]);return{...t,items:l}}return t});t.columns=l}),(0,s._)(this,"removeTempRows",e=>{let t=this.columns.map((t,n)=>{if(n===e){let e=t.items.filter(e=>f()(e,"id"));return{...t,items:e}}return t});this.columns=t}),(0,s._)(this,"setSelectedItemToRename",e=>{this.updateRowStatus(e.name,E.R9.EDITING,e.columnIndex)}),(0,s._)(this,"updateRowStatus",function(e,n){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.getLatestColumnIndex(),a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.columns.map((t,i)=>{if(i===s){let s=t.items.map(t=>t.name===e?{...t,status:n,...a&&{name:a}}:t);return{...t,items:s}}return t});t.columns=i}),(0,s._)(this,"updateFolderAfterEdit",function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.getLatestColumnIndex(),s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E.R9.READY,a=t.columns.map((t,a)=>{if(a===n){let n=t.items.map(t=>{if(t.status===E.R9.EDITING){let n=new Date().toISOString();return{...t,status:s,name:e,createdAt:n,lastAccessedAt:n,updatedAt:n,metadata:null,id:null}}return t});return{...t,items:n}}return t});t.columns=a}),(0,s._)(this,"updateExplorerPreferences",()=>{let e=this.getLocalStorageKey(),t={view:this.view,sortBy:this.sortBy,sortByOrder:this.sortByOrder};return localStorage.setItem(e,JSON.stringify(t)),t}),(0,s._)(this,"loadExplorerPreferences",()=>{var e,t;let n=this.getLocalStorageKey(),s=null!==(t=null===(e=localStorage)||void 0===e?void 0:e.getItem(n))&&void 0!==t?t:void 0;if(void 0!==s){let{view:e,sortBy:t,sortByOrder:n}=JSON.parse(s);this.view=e,this.sortBy=t,this.sortByOrder=n}else{let{view:e,sortBy:t,sortByOrder:n}=this.updateExplorerPreferences();this.view=e,this.sortBy=t,this.sortByOrder=n}}),(0,s._)(this,"selectRangeItems",(e,t)=>{let n=this.columns[e].items,s=n[t],a=this.selectedItems.map(e=>e.id),i=a[a.length-1],r=p()(n,{id:i}),l=n.slice(Math.min(t,r),Math.max(t,r)+1).map(t=>({...t,columnIndex:e}));if(t<r&&l.reverse(),a.includes(s.id)){let e=l.map(e=>e.id);this.setSelectedItems(this.selectedItems.filter(t=>t.id===s.id||!e.includes(t.id)))}else this.setSelectedItems(_()(this.selectedItems.concat(l),"id"))}),(0,C.ky)(this,{supabaseClient:!1}),this.projectRef=e,this.abortController=new AbortController}}},79329:function(e,t,n){"use strict";n.r(t);var s=n(52322),a=n(95837),i=n(7929),r=n(25733),l=n(96551),o=n(14528);let c=()=>{let{isLoading:e}=(0,l.j)(),t=(0,o.lL)();return(0,s.jsx)(s.Fragment,{children:void 0===t&&e?(0,s.jsx)(r.Z,{}):(0,s.jsx)(a.q$,{})})};c.getLayout=e=>(0,s.jsx)(i.Ix,{children:e}),t.default=c},11774:function(e,t,n){"use strict";n.d(t,{Wu:function(){return r}});var s=n(9162),a=n(4741);let i=(0,s.sj)({panelKey:void 0,setPanelKey:e=>{i.panelKey=e}}),r=e=>(0,a.R)(i,e)},4224:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var s=n(35538);let a='\n-- Can\'t use pg_authid here since some managed Postgres providers don\'t expose it\n-- https://github.com/supabase/postgres-meta/issues/212\n\nselect\n  r.oid :: int8 as id,\n  rolname as name,\n  rolsuper as "isSuperuser",\n  rolcreatedb as "canCreateDb",\n  rolcreaterole as "canCreateRole",\n  rolinherit as "inheritRole",\n  rolcanlogin as "canLogin",\n  rolreplication as "isReplicationRole",\n  rolbypassrls as "canBypassRls",\n  (\n    select\n      count(*)\n    from\n      pg_stat_activity\n    where\n      r.rolname = pg_stat_activity.usename\n  ) as "activeConnections",\n  case when rolconnlimit = -1 then current_setting(\'max_connections\') :: int8\n       else rolconnlimit\n  end as "connectionLimit",\n  rolvaliduntil as "validUntil",\n  coalesce(r_config.role_configs, \'{}\') as config\nfrom\n  pg_roles r\n  left join (\n    select\n      oid,\n      jsonb_object_agg(param, value) filter (where param is not null) as role_configs\n    from\n      (\n        select\n          oid,\n          (string_to_array(unnest(rolconfig), \'=\'))[1] as param,\n          (string_to_array(unnest(rolconfig), \'=\'))[2] as value\n        from\n          pg_roles\n      ) as _\n    group by\n      oid\n  ) r_config on r_config.oid = r.oid\n';var i=n(30195);let r=i.z.object({id:i.z.number(),name:i.z.string(),isSuperuser:i.z.boolean(),canCreateDb:i.z.boolean(),canCreateRole:i.z.boolean(),inheritRole:i.z.boolean(),canLogin:i.z.boolean(),isReplicationRole:i.z.boolean(),canBypassRls:i.z.boolean(),activeConnections:i.z.number(),connectionLimit:i.z.number(),validUntil:i.z.union([i.z.string(),i.z.null()]),config:i.z.record(i.z.string(),i.z.string())}),l=i.z.array(r),o=i.z.optional(r),c=["information_schema","pg_catalog","pg_toast"],d="\n-- Adapted from information_schema.schemata\n\nselect\n  n.oid::int8 as id,\n  n.nspname as name,\n  u.rolname as owner\nfrom\n  pg_namespace n,\n  pg_roles u\nwhere\n  n.nspowner = u.oid\n  and (\n    pg_has_role(n.nspowner, 'USAGE')\n    or has_schema_privilege(n.oid, 'CREATE, USAGE')\n  )\n  and not pg_catalog.starts_with(n.nspname, 'pg_temp_')\n  and not pg_catalog.starts_with(n.nspname, 'pg_toast_temp_')\n",u=i.z.object({id:i.z.number(),name:i.z.string(),owner:i.z.string()}),m=i.z.array(u),h=i.z.optional(u);var p={roles:{list:function(){let{includeDefaultRoles:e=!1,limit:t,offset:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s="\nwith\n  roles as (".concat(a,")\nselect\n  *\nfrom\n  roles\nwhere\n  true\n");return e||(s+=" and not pg_catalog.starts_with(name, 'pg_')"),t&&(s+=" limit ".concat(t)),n&&(s+=" offset ".concat(n)),{sql:s,zod:l}},retrieve:function(e){let{id:t,name:n}=e;return t?{sql:"".concat(a," where r.oid = ").concat((0,s.literal)(t),";"),zod:o}:{sql:"".concat(a," where rolname = ").concat((0,s.literal)(n),";"),zod:o}},create:function(e){let{name:t,isSuperuser:n=!1,canCreateDb:a=!1,canCreateRole:i=!1,inheritRole:r=!0,canLogin:l=!1,isReplicationRole:o=!1,canBypassRls:c=!1,connectionLimit:d=-1,password:u,validUntil:m,memberOf:h=[],members:p=[],admins:x=[],config:f={}}=e;return{sql:"\ncreate role ".concat((0,s.ident)(t),"\n  ").concat(n?"superuser":"","\n  ").concat(a?"createdb":"","\n  ").concat(i?"createrole":"","\n  ").concat(r?"":"noinherit","\n  ").concat(l?"login":"","\n  ").concat(o?"replication":"","\n  ").concat(c?"bypassrls":"","\n  connection limit ").concat(d,"\n  ").concat(void 0===u?"":"password ".concat((0,s.literal)(u)),"\n  ").concat(void 0===m?"":"valid until ".concat((0,s.literal)(m)),"\n  ").concat(0===h.length?"":"in role ".concat(h.map(s.ident).join(",")),"\n  ").concat(0===p.length?"":"role ".concat(p.map(s.ident).join(",")),"\n  ").concat(0===x.length?"":"admin ".concat(x.map(s.ident).join(",")),"\n  ;\n").concat(Object.entries(f).map(e=>{let[n,a]=e;return"alter role ".concat((0,s.ident)(t)," set ").concat((0,s.ident)(n)," = ").concat((0,s.literal)(a),";")}).join("\n"),"\n")}},update:function(e,t){let{id:n,name:a}=e,{name:i,isSuperuser:r,canCreateDb:l,canCreateRole:o,inheritRole:c,canLogin:d,isReplicationRole:u,canBypassRls:m,connectionLimit:h,password:p,validUntil:x}=t;return{sql:"\ndo $$\ndeclare\n  id oid := ".concat(void 0===n?"".concat((0,s.literal)(a),"::regrole"):(0,s.literal)(n),";\n  old record;\nbegin\n  select * into old from pg_roles where oid = id;\n  if old is null then\n    raise exception 'Cannot find role with id %', id;\n  end if;\n\n  execute(format('alter role %I\n    ").concat(void 0===r?"":r?"superuser":"nosuperuser","\n    ").concat(void 0===l?"":l?"createdb":"nocreatedb","\n    ").concat(void 0===o?"":o?"createrole":"nocreaterole","\n    ").concat(void 0===c?"":c?"inherit":"noinherit","\n    ").concat(void 0===d?"":d?"login":"nologin","\n    ").concat(void 0===u?"":u?"replication":"noreplication","\n    ").concat(void 0===m?"":m?"bypassrls":"nobypassrls","\n    ").concat(void 0===h?"":"connection limit ".concat((0,s.literal)(h)),"\n    ").concat(void 0===p?"":"password ".concat((0,s.literal)(p)),"\n    ").concat(void 0===x?"":"valid until ".concat((0,s.literal)(x)),"\n  ', old.rolname));\n\n  ").concat(void 0===i?"":"\n  -- Using the same name in the rename clause gives an error, so only do it if the new name is different.\n  if new_name != old.nspname then\n    execute(format('alter role %I rename to ".concat((0,s.ident)(i),";', old.nspname));\n  end if;\n  "),"\nend\n$$;\n")}},remove:function(e){let{id:t,name:n}=e,{ifExists:a=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{sql:"\ndo $$\ndeclare\n  id oid := ".concat(void 0===t?"".concat((0,s.literal)(n),"::regrole"):(0,s.literal)(t),";\n  old record;\nbegin\n  select * into old from pg_roles where oid = id;\n  if old is null then\n    raise exception 'Cannot find role with id %', id;\n  end if;\n\n  execute(format('drop role ").concat(a?"if exists":""," %I;', old.rolname));\nend\n$$;\n")}},zod:r},schemas:{list:function(){let{includeSystemSchemas:e=!1,limit:t,offset:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=d;return e||(a="".concat(a," and not (n.nspname in (").concat(c.map(s.literal).join(","),"))")),t&&(a="".concat(a," limit ").concat(t)),n&&(a="".concat(a," offset ").concat(n)),{sql:a,zod:m}},retrieve:function(e){let{id:t,name:n}=e;return t?{sql:"".concat(d," and n.oid = ").concat((0,s.literal)(t),";"),zod:h}:{sql:"".concat(d," and n.nspname = ").concat((0,s.literal)(n),";"),zod:h}},create:function(e){let{name:t,owner:n}=e;return{sql:"create schema ".concat((0,s.ident)(t),"\n  ").concat(void 0===n?"":"authorization ".concat((0,s.ident)(n)),";\n")}},update:function(e,t){let{id:n,name:a}=e,{name:i,owner:r}=t;return{sql:"\ndo $$\ndeclare\n  id oid := ".concat(void 0===n?"".concat((0,s.literal)(a),"::regnamespace"):(0,s.literal)(n),";\n  old record;\n  new_name text := ").concat(void 0===i?null:(0,s.literal)(i),";\n  new_owner text := ").concat(void 0===r?null:(0,s.literal)(r),";\nbegin\n  select * into old from pg_namespace where oid = id;\n  if old is null then\n    raise exception 'Cannot find schema with id %', id;\n  end if;\n\n  if new_owner is not null then\n    execute(format('alter schema %I owner to %I;', old.nspname, new_owner));\n  end if;\n\n  -- Using the same name in the rename clause gives an error, so only do it if the new name is different.\n  if new_name is not null and new_name != old.nspname then\n    execute(format('alter schema %I rename to %I;', old.nspname, new_name));\n  end if;\nend\n$$;\n")}},remove:function(e){let{id:t,name:n}=e,{cascade:a=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{sql:"\ndo $$\ndeclare\n  id oid := ".concat(void 0===t?"".concat((0,s.literal)(n),"::regnamespace"):(0,s.literal)(t),";\n  old record;\n  cascade bool := ").concat((0,s.literal)(a),";\nbegin\n  select * into old from pg_namespace where oid = id;\n  if old is null then\n    raise exception 'Cannot find schema with id %', id;\n  end if;\n\n  execute(format('drop schema %I %s;', old.nspname, case when cascade then 'cascade' else 'restrict' end));\nend\n$$;\n")}},zod:u}}},34820:function(e,t,n){"use strict";var s=n(52322),a=n(88883),i=n(2784),r=n(63955),l=n(41909),o=n(54383),c=n(22574),d=n(42070),u=n(32079),m=n(71550),h=n(30195);let p=(0,i.forwardRef)((e,t)=>{let{title:n,size:p="small",onConfirm:x,visible:f,onCancel:g,loading:j,cancelLabel:v="Cancel",confirmLabel:y="Submit",confirmPlaceholder:b,confirmString:N,alert:w,input:_,label:C,description:S,formMessage:k,text:E,children:A,blockDeleteButton:T=!0,variant:I="default",...Z}=e,z=h.z.object({confirmValue:h.z.literal(N,{required_error:"Value entered does not match."})}),P=(0,r.cI)({resolver:(0,a.F)(z),defaultValues:{confirmValue:""}});return(0,i.useEffect)(()=>{N&&P.reset()},[N]),(0,s.jsx)(l.Vq,{open:f,...Z,onOpenChange:()=>{f&&g()},children:(0,s.jsxs)(l.cZ,{ref:t,className:"p-0 gap-0 pb-5 !block",size:p,children:[(0,s.jsx)(l.fK,{className:(0,o.cn)("border-b"),padding:"small",children:(0,s.jsx)(l.$N,{className:"",children:n})}),w&&(0,s.jsx)(m.J,{type:I,label:w.title,description:w.description,className:"border-r-0 border-l-0 rounded-none -mt-px [&_svg]:ml-0.5 mb-0",...null==w?void 0:w.base}),A&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.VO,{padding:"small",children:A}),(0,s.jsx)(l.P3,{})]}),void 0!==E&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.VO,{className:"p-5",padding:"small",children:(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:E})}),(0,s.jsx)(l.P3,{})]}),(0,s.jsx)(c.l0,{...P,children:(0,s.jsxs)("form",{onSubmit:P.handleSubmit(function(e){x()}),className:"px-5 flex flex-col gap-2 pt-3",children:[(0,s.jsx)(c.Wi,{control:P.control,name:"confirmValue",render:e=>{let{field:t}=e;return(0,s.jsxs)(c.xJ,{children:[(0,s.jsxs)(c.lX,{...C,children:["Type ",(0,s.jsx)("span",{className:"text-foreground break-all",children:N})," to confirm."]}),(0,s.jsx)(c.NI,{children:(0,s.jsx)(d.I,{placeholder:b,..._,...t})}),(0,s.jsx)(c.pf,{...S}),(0,s.jsx)(c.zG,{...k})]})}}),(0,s.jsxs)("div",{className:"flex gap-2",children:[!T&&(0,s.jsx)(u.z,{size:"medium",block:!0,type:"default",disabled:j,onClick:g,children:v}),(0,s.jsx)(u.z,{block:!0,size:"medium",type:"destructive"===I?"danger":"warning"===I?"warning":"primary",htmlType:"submit",loading:j,disabled:j,className:"truncate",children:y})]})]})})]})})});p.displayName="TextConfirmModal",t.Z=p},56937:function(e,t,n){"use strict";n.d(t,{H:function(){return i},a:function(){return r}});var s=n(52322),a=n(61373);let i=e=>{let{name:t}=e;return(0,s.jsx)("div",{className:"text-typography-body-light [[data-theme*=dark]_&]:text-typography-body-dark flex cursor-not-allowed items-center space-x-2 rounded bg-gray-600 py-0.5 px-2 text-sm",children:(0,s.jsx)("span",{className:"opacity-50",children:t})})},r=e=>{let{name:t,handleRemove:n}=e;return(0,s.jsxs)("div",{className:"text-typography-body-light [[data-theme*=dark]_&]:text-typography-body-dark flex items-center space-x-2 rounded bg-surface-300 py-0.5 px-2 text-sm",onClick:e=>e.preventDefault(),children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)(a.Z,{size:12,className:"cursor-pointer opacity-50 transition hover:opacity-100",onClick:e=>{e.preventDefault(),e.stopPropagation(),n()}})]})}},18954:function(e,t,n){"use strict";n.d(t,{Z:function(){return b}});var s=n(52322),a=n(6277),i=n(90882),r=n.n(i),l=n(34498),o=n.n(l),c=n(67304),d=n.n(c),u=n(2784),m=n(61786),h=n(43687),p=n(750),x=n(89682),f=n(19869),g=n(90488),j=n(31654),v=n(39459),y=n(56937);function b(e){let{options:t,value:n,label:i,error:l,descriptionText:c,placeholder:b,searchPlaceholder:N="Search for option",emptyMessage:w,disabled:_,allowDuplicateSelection:C=!1,onChange:S=()=>{}}=e,k=(0,u.useRef)(null),[E,A]=(0,u.useState)(!1),[T,I]=(0,u.useState)(n||[]),[Z,z]=(0,u.useState)(""),[P,R]=(0,u.useState)(128),L=n||T;(0,u.useEffect)(()=>{R(k.current?k.current.offsetWidth:P)},[k.current]),(0,u.useEffect)(()=>{E||z("")},[E]);let O="".concat(P,"px"),D=o()(t,["disabled"],["desc"]),F=Z.length>0?r()(D,e=>!e.disabled&&e.name.includes(Z)):r()(D,{disabled:!1}),U=e=>void 0!==(L||[]).find(t=>t===e.value),M=e=>{let t=T.filter((t,n)=>n!==e);I(t),S(t)},q=e=>{let n=U(e),s=C?[...L.concat([e.value])]:n?[...d()(L,e.value)]:[...L.concat([e.value])],a=t.filter(e=>e.disabled).map(e=>e.name),i=C?s.concat(a):[...new Set(s.concat(a))];I(i),S(i)};return(0,s.jsxs)("div",{className:"form-group ".concat(_?"pointer-events-none opacity-50":""),children:[i&&(0,s.jsx)("label",{className:"!w-full",children:i}),(0,s.jsx)("div",{className:["form-control form-control--multi-select","border border-strong bg-control","multi-select relative block w-full space-x-1 overflow-auto rounded","".concat(void 0!==l?"border-red-800 bg-red-100":"")].join(" "),ref:k,children:(0,s.jsxs)(m.J2,{open:E,onOpenChange:A,modal:!1,children:[(0,s.jsx)(m.xo,{asChild:!0,children:(0,s.jsxs)("div",{className:["flex w-full flex-wrap items-start gap-1.5 p-1.5 cursor-pointer","".concat(0===L.length?"h-9":"")].join(" "),onClick:()=>A(!0),children:[0===L.length&&b&&(0,s.jsx)("div",{className:"px-2 text-sm text-foreground-light h-full flex items-center",children:b}),L.map((e,t)=>{var n;let a="".concat(e,"-").concat(t),i=D.find(t=>t.value===e),r=null!==(n=null==i?void 0:i.disabled)&&void 0!==n&&n;return i?r?(0,s.jsx)(y.H,{name:e},a):(0,s.jsx)(y.a,{name:e,handleRemove:()=>C?M(t):q(i)},a):(0,s.jsx)(s.Fragment,{})}),(0,s.jsx)("div",{className:"absolute inset-y-0 right-0 pl-3 pr-2 flex space-x-1 items-center cursor-pointer ",children:(0,s.jsx)(h.Z,{size:16,strokeWidth:2,className:"text-foreground-lighter"})})]})}),(0,s.jsxs)(m.yk,{className:"p-0",side:"bottom",align:"start",style:{width:O,marginLeft:"-5px"},children:[(0,s.jsx)(p.Z,{className:"[&>div>div>div>input]:!rounded-b-none [&>div>div>div>input]:!pl-9",icon:(0,s.jsx)(x.Z,{size:16}),placeholder:N,value:Z,onChange:e=>z(e.target.value)}),(0,s.jsx)(f.x,{className:(0,a.default)("p-1",F.length>5?"h-[225px]":""),children:F.length>=1?F.map(e=>{let t=!!(!C&&L&&L.find(t=>t===e.value));return(0,s.jsxs)("div",{onClick:()=>q(e),className:["text-typography-body-light [[data-theme*=dark]_&]:text-typography-body-dark","group flex cursor-pointer items-center justify-between transition","space-x-1 rounded bg-transparent p-2 px-4 text-sm hover:bg-overlay-hover","".concat(t?" [[data-theme*=dark]_&]:bg-green-600 [[data-theme*=dark]_&]:bg-opacity-25":"")].join(" "),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{children:e.name}),void 0!==e.description&&(0,s.jsx)("p",{className:"opacity-50",children:e.description})]}),t&&(0,s.jsx)(g.Z,{size:16,strokeWidth:3,className:"cursor-pointer transition ".concat(t?"text-brand":"")}),C&&(0,s.jsxs)("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition space-x-1",children:[(0,s.jsx)(j.Z,{size:14}),(0,s.jsx)("p",{className:"text-sm",children:"Add value"})]})]},"multiselect-option-".concat(e.id))}):0===t.length?(0,s.jsx)("div",{className:"flex h-full w-full flex-col border-default items-center justify-center border border-dashed p-3",children:w||(0,s.jsxs)("div",{className:"flex w-full items-center space-x-2",children:[(0,s.jsx)(v.Z,{strokeWidth:1.5,size:18,className:"text-foreground-light"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"No options available"})]})}):(0,s.jsx)("div",{className:"flex h-full w-full flex-col border-default items-center justify-center border border-dashed p-3",children:w||(0,s.jsx)("div",{className:"flex w-full items-center space-x-2",children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"No options found"})})})})]})]})}),c&&(0,s.jsx)("span",{className:"form-text text-muted mt-2 text-sm",children:c}),l&&(0,s.jsx)("span",{className:"text-red-900 text-sm mt-2",children:l})]})}},81384:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});var s=n(52322),a=n(54383);let i=e=>{let{className:t,delayIndex:n=0,animationDelay:i=150}=e;return(0,s.jsx)("div",{className:(0,a.cn)("shimmering-loader rounded py-3",t),style:{animationFillMode:"backwards",animationDelay:"".concat(n*i,"ms")}})},r=()=>(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i,{}),(0,s.jsx)(i,{className:"w-3/4"}),(0,s.jsx)(i,{className:"w-1/2"})]});t.Z=i},87668:function(e,t,n){"use strict";n.d(t,{E:function(){return y}});var s=n(52322),a=n(2784),i=n(22574),r=n(10929),l=n(54383),o=n(6112),c=n(75109);let d=(0,r.j)("grid gap-2",{variants:{size:{tiny:"text-xs",small:"text-sm leading-4",medium:"text-sm",large:"text-base",xlarge:"text-base"},align:{left:"",right:""},responsive:{true:"",false:""},layout:{horizontal:"grid grid-cols-12",vertical:"flex flex-col gap-3",flex:"flex flex-row gap-3"},flex:{true:"",false:""}},compoundVariants:[{layout:"flex",align:"right",className:"justify-between"}],defaultVariants:{}}),u=(0,r.j)("",{variants:{flex:{true:"",false:""},align:{left:"",right:""},layout:{horizontal:"flex flex-col gap-2 col-span-4",vertical:"flex flex-row gap-2 justify-between",flex:"flex flex-col gap-0"},labelLayout:{horizontal:"",vertical:"","":""}},compoundVariants:[{flex:!0,align:"left",className:"order-2"},{flex:!0,align:"right",className:"order-1"},{layout:"vertical",labelLayout:void 0,flex:!1,className:"flex flex-row gap-2 justify-between"},{layout:"horizontal",className:"flex flex-col gap-2"}],defaultVariants:{}}),m=(0,r.j)("",{variants:{flex:{true:"",false:""},align:{left:"order-1",right:"order-2"},layout:{horizontal:"",vertical:"",flex:""}},compoundVariants:[{flex:!0,align:"left",className:"order-1"},{flex:!0,align:"right",className:"order-2"},{layout:"vertical",className:"col-span-12"},{layout:"horizontal",align:"left",className:"col-span-8"},{layout:"horizontal",align:"right",className:"text-right"}],defaultVariants:{}}),h=(0,r.j)("text-foreground-lighter leading-normal",{variants:{size:{...c.NO.text},layout:{vertical:"mt-2",horizontal:"mt-2",flex:""}},defaultVariants:{}}),p=(0,r.j)("text-foreground-muted",{variants:{size:{...c.NO.text}},defaultVariants:{}}),x=(0,r.j)("text-foreground-muted",{variants:{size:{...c.NO.text}},defaultVariants:{}}),f=(0,r.j)("text-foreground-muted",{variants:{size:{...c.NO.text}},defaultVariants:{}}),g=(0,r.j)("",{variants:{flex:{true:"",false:""},align:{left:"",right:""}},compoundVariants:[{flex:!0,align:"left",className:""},{flex:!0,align:"right",className:"order-last"}]}),j=(0,r.j)("",{variants:{nonBoxInput:{true:"",false:""},label:{true:"",false:""},layout:{vertical:"",horizontal:""}},compoundVariants:[{nonBoxInput:!0,label:!0,layout:"vertical",className:"my-3"},{nonBoxInput:!0,label:!0,layout:"horizontal",className:"my-3 md:mt-0 mb-3"}],defaultVariants:{}}),v=a.forwardRef((e,t)=>{let{align:n="left",className:a,description:r,id:c,label:v,labelOptional:y,layout:b="vertical",style:N,labelLayout:w,size:_="medium",beforeLabel:C,afterLabel:S,nonBoxInput:k=!v,hideMessage:E=!1,isReactForm:A,...T}=e,I="flex"===b,Z=!!(v||C||S),z=A&&!E&&(0,s.jsx)(i.zG,{className:"mt-2","data-formlayout-id":"message"}),P=r&&A?(0,s.jsx)(i.pf,{className:(0,l.cn)(h({size:_,layout:b})),"data-formlayout-id":"description",id:c+"-description",children:r}):(0,s.jsx)("p",{className:(0,l.cn)(h({size:_,layout:b}),"text-sm text-foreground-light"),"data-formlayout-id":"description",children:r}),R=()=>(0,s.jsxs)(s.Fragment,{children:[C&&(0,s.jsx)("span",{className:(0,l.cn)(p({size:_})),id:c+"-before","data-formlayout-id":"beforeLabel",children:(0,s.jsx)("span",{children:C})}),(0,s.jsx)("span",{children:v}),S&&(0,s.jsx)("span",{className:(0,l.cn)(x({size:_})),id:c+"-after","data-formlayout-id":"afterLabel",children:S})]});return(0,s.jsxs)("div",{ref:t,...T,className:(0,l.cn)(d({size:_,flex:I,align:n,layout:b}),a),children:[I&&(0,s.jsx)("div",{className:(0,l.cn)(g({flex:I,align:n})),children:T.children}),Z||y||"horizontal"===b?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:(0,l.cn)(u({align:n,labelLayout:w,flex:I,layout:b})),"data-formlayout-id":"labelContainer",children:[Z&&A?(0,s.jsx)(i.lX,{className:"flex gap-2 items-center","data-formlayout-id":"formLabel",children:(0,s.jsx)(R,{})}):(0,s.jsx)(o._,{htmlFor:T.name,"data-formlayout-id":"label",className:"flex gap-2 items-center",children:(0,s.jsx)(R,{})}),y&&(0,s.jsx)("span",{className:(0,l.cn)(f({size:_})),id:c+"-optional","data-formlayout-id":"labelOptional",children:y}),I&&(0,s.jsxs)(s.Fragment,{children:[P,z]})]})}):null,!I&&(0,s.jsx)("div",{className:(0,l.cn)(m({align:n,layout:b})),style:N,"data-formlayout-id":"dataContainer",children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:(0,l.cn)(j({nonBoxInput:k,label:v,layout:b})),"data-formlayout-id":"nonBoxInputContainer",children:T.children}),z,P]})})]})}),y=(0,a.forwardRef)((e,t)=>{let{...n}=e;return(0,s.jsx)(i.xJ,{children:(0,s.jsx)(v,{ref:t,isReactForm:!0,...n,children:n.children})})});y.displayName="FormItemLayout"},12934:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var s=n(52322),a=n(2784),i=n(25001),r=n(46318),l=n(70780);let o=(0,a.createContext)({parentCallback:e=>{},parentSize:""});function c(e){let{className:t,id:n="",name:a="",label:i,afterLabel:c,beforeLabel:d,description:u,checked:m,value:h,onChange:p,onBlur:x,size:f="medium",disabled:g=!1,...j}=e,{formContextOnChange:v,values:y,handleBlur:b}=(0,l.G)(),N=(0,r.Z)("checkbox");return(0,s.jsx)(o.Consumer,{children:e=>{let{parentCallback:r,parentSize:l}=e,o=n||a||(i?i.toLowerCase().replace(/^[^A-Z0-9]+/gi,"").replace(/ /g,"-"):void 0);f=l||f;let w=a||o,_=null!=m?m:void 0,C=[N.container];return t&&C.push(t),y&&void 0===m&&(_=y[n||a]),(0,s.jsxs)("div",{className:C.join(" "),children:[(0,s.jsx)("input",{id:o,name:w,type:"checkbox",className:[N.base,N.size[f]].join(" "),onChange:function(e){r&&r(e),p&&p(e),v&&v(e)},onBlur:function(e){b&&setTimeout(()=>{b(e)},100),x&&x(e)},checked:_,value:h||o,disabled:g,...j}),(0,s.jsxs)("label",{className:[N.label.base,N.label[f]].join(" "),htmlFor:o,children:[(0,s.jsxs)("span",{children:[d&&(0,s.jsx)("span",{className:[N.label_before.base,N.label_before[f]].join(" "),children:d}),i,c&&(0,s.jsx)("span",{className:[N.label_after.base,N.label_after[f]].join(" "),children:c})]}),u&&(0,s.jsx)("p",{className:[N.description.base,N.description[f]].join(" "),children:u})]})]})}})}c.Group=function(e){let{id:t,layout:n="vertical",error:a,descriptionText:l,label:d,afterLabel:u,beforeLabel:m,labelOptional:h,children:p,className:x,options:f,onChange:g,size:j="medium"}=e,v=(0,r.Z)("checkbox");return(0,s.jsx)(i.l,{label:d,afterLabel:u,beforeLabel:m,labelOptional:h,layout:n,id:t,error:a,descriptionText:l,className:x,size:j,children:(0,s.jsx)(o.Provider,{value:{parentCallback:e=>{g&&g(e)},parentSize:j},children:(0,s.jsx)("div",{className:v.group,children:f?f.map(e=>(0,s.jsx)(c,{id:e.id,value:e.value,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,checked:e.checked,name:e.name,description:e.description,defaultChecked:e.defaultChecked},e.id)):p})})})};var d=c},11992:function(e,t,n){"use strict";var s=n(52322),a=n(69557);n(2784);var i=n(46318);let r=e=>{let{open:t,children:n,className:i,...r}=e;return(0,s.jsx)(a.fC,{asChild:r.asChild,defaultOpen:r.defaultOpen,open:t,onOpenChange:r.onOpenChange,disabled:r.disabled,className:i,children:n})};r.Trigger=function(e){let{children:t,asChild:n}=e;return(0,s.jsx)(a.xz,{asChild:n,children:t})},r.Content=function(e){let{asChild:t,children:n,className:r}=e,l=(0,i.Z)("collapsible");return(0,s.jsx)(a.VY,{asChild:t,className:[l.content,r].join(" "),children:n})},t.ZP=r},20229:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(91826),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},8504:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(27320),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},63913:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(21079),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},20758:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(7342),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},59629:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(78046),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},10304:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(29),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},59119:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(10341),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},80650:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(83371),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},62795:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(70177),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},94044:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(72681),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},45856:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(72227),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},89689:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(5152),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},82:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(13667),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},49893:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(88951),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},89682:function(e,t,n){"use strict";var s=n(52322);n(2784);var a=n(32465),i=n(2515);t.Z=function(e){return(0,s.jsx)(i.Z,{icon:a.Z,...e})}},4419:function(e,t,n){"use strict";var s=n(52322),a=n(2784),i=n(25001),r=n(71653),l=n(67440),o=n(46318),c=n(70780);t.Z=function(e){let{defaultValue:t,descriptionText:n,error:d,icon:u,inputRef:m,label:h,afterLabel:p,beforeLabel:x,labelOptional:f,layout:g,value:j,actions:v,size:y="medium",validation:b,id:N="",name:w="",..._}=e,C=(0,o.Z)("inputNumber"),{formContextOnChange:S,values:k,errors:E,handleBlur:A,touched:T,fieldLevelValidation:I}=(0,c.G)();k&&!j&&(j=k[N||w]),d||(E&&!d&&(d=E[N||w]),d=T&&T[N||w]?d:void 0),(0,a.useEffect)(()=>{b&&I(N,b(j))},[]);let Z=[C.base];return d&&Z.push(C.variants.error),d||Z.push(C.variants.standard),u&&Z.push(C.with_icon),y&&Z.push(C.size[y]),_.disabled&&Z.push(C.disabled),(0,s.jsx)("div",{className:_.className,children:(0,s.jsx)(i.l,{label:h,afterLabel:p,beforeLabel:x,labelOptional:f,layout:g,id:N,error:d,descriptionText:n,style:_.style,size:y,children:(0,s.jsxs)("div",{className:C.container,children:[(0,s.jsx)("input",{"data-size":y,id:N,name:w,onChange:function(e){_.onChange&&_.onChange(e),S&&S(e),b&&I(N,b(e.target.value))},onBlur:function(e){A&&A(e),_.onBlur&&_.onBlur(e)},type:"number",ref:m,value:j,className:Z.join(" "),..._}),u&&(0,s.jsx)(l.Z,{size:y,icon:u}),d||v?(0,s.jsxs)("div",{className:C.actions_container,children:[d&&(0,s.jsx)(r.Z,{size:y}),v&&v]}):null]})})})}},62284:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var s=n(52322),a=n(46653),i=n(35676),r=n.n(i),l=n(2784),o=n(25001),c=n(71653),d=n(67440),u=n(46318),m=n(54383),h=n(70780),p=n(90488);let x=(0,l.createContext)({onChange:e=>{},selected:void 0});function f(e){let{children:t,className:n,buttonClassName:i,descriptionText:p,error:f,icon:g,id:j="",name:v="",label:y,labelOptional:b,layout:N,value:w,onChange:_,onFocus:C,onBlur:S,style:k,size:E="medium",defaultValue:A,validation:T,disabled:I,optionsWidth:Z}=e,[z,P]=(0,l.useState)(void 0),[R,L]=(0,l.useState)({}),O=(0,u.Z)("listbox"),D=(0,l.useRef)(null),{formContextOnChange:F,values:U,errors:M,handleBlur:q,touched:B,fieldLevelValidation:W}=(0,h.G)();U&&!w&&(w=U[j||v],A=U[j||v]),f||(M&&!f&&(f=M[j||v]),f=B&&B[j||v]?f:void 0),(0,l.useEffect)(()=>{void 0!==w&&P(w)},[w]),(0,l.useEffect)(()=>{function e(){var e;document.documentElement.style.setProperty("--width-listbox","".concat(Z||(null===(e=D.current)||void 0===e?void 0:e.offsetWidth),"px"))}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,l.useEffect)(()=>{var e;let n=r()(t);function s(e){return n.find(t=>t.props.value===e)}if(w){P(w);let e=s(w);L((null==e?void 0:e.props)?e.props:void 0);return}if(z){let e=s(z);L((null==e?void 0:e.props)?e.props:void 0);return}if(A){P(A);let e=s(z);L((null==e?void 0:e.props)?e.props:void 0);return}L(null===(e=n[0])||void 0===e?void 0:e.props)},[z]);let G=[O.container,O.base,i],H=[O.addOnBefore];return f&&G.push(O.variants.error),f||G.push(O.variants.standard),g&&H.push(O.with_icon),E&&G.push(O.size[E]),I&&G.push(O.disabled),(0,s.jsx)(o.l,{label:y,labelOptional:b,layout:N,id:j,error:f,descriptionText:p,className:n,style:k,size:E,children:(0,s.jsxs)(a.fC,{children:[(0,s.jsx)(a.xz,{asChild:!0,disabled:I,children:(0,s.jsxs)("button",{"data-size":E,ref:D,className:(0,m.cn)(G),onBlur:function(e){q&&q(e),S&&S(e)},onFocus:C,name:v,id:j,children:[(0,s.jsxs)("span",{className:(0,m.cn)(H),children:[g&&(0,s.jsx)(d.Z,{size:E,icon:g}),(null==R?void 0:R.addOnBefore)&&(0,s.jsx)(R.addOnBefore,{}),(0,s.jsx)("span",{className:O.label,children:null==R?void 0:R.label})]}),(0,s.jsx)("span",{className:O.chevron_container,children:(0,s.jsx)("svg",{className:O.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})}),f&&(0,s.jsx)("div",{className:O.actions_container,children:f&&(0,s.jsx)(c.Z,{size:E})})]})}),(0,s.jsx)(a.VY,{sideOffset:6,loop:!0,side:"bottom",align:"center",className:O.options_container,children:(0,s.jsx)("div",{children:(0,s.jsx)(x.Provider,{value:{onChange:function(e){_&&_(e),P(e);let t={};t.target={type:"select",name:v,id:j,value:e,checked:void 0},F&&F(t),T&&W(j,T(e))},selected:z},children:t})})})]})})}f.Option=function(e){let{id:t,value:n,label:i,disabled:r=!1,children:l,className:o="",addOnBefore:c}=e,d=(0,u.Z)("listbox");return(0,s.jsx)(x.Consumer,{children:e=>{let{onChange:i,selected:u}=e,h=u===n;return(0,s.jsxs)(a.ck,{className:(0,m.cn)(d.option,h?d.option_active:" ",r?d.option_disabled:" ",o),onSelect:()=>r?{}:i(n),children:[(0,s.jsxs)("div",{className:d.option_inner,children:[c&&c({active:h,selected:u}),(0,s.jsx)("span",{children:"function"==typeof l?l({active:h,selected:u}):l})]}),h?(0,s.jsx)("span",{className:(0,m.cn)(d.option_check,h?d.option_check_active:""),children:(0,s.jsx)(p.Z,{className:d.option_check_icon,"aria-hidden":"true"})}):null]},t)}})};var g=f},3085:function(e,t,n){"use strict";n.d(t,{ZP:function(){return m}});var s=n(52322),a=n(2784),i=n(46318),r=n(54383);function l(e){let{children:t,className:n,tag:a="div",style:i}=e;return(0,s.jsx)("".concat(a),{style:i,children:t})}l.Title=function(e){let{className:t,level:n=1,children:a,style:i}=e;return(0,s.jsx)("h".concat(n),{style:i,children:a})},l.Text=function(e){let{className:t,children:n,style:a,type:i,disabled:r,mark:l,code:o,keyboard:c,underline:d,strikethrough:u,strong:m,small:h}=e;return o?(0,s.jsx)("code",{style:a,children:n}):l?(0,s.jsx)("mark",{style:a,children:n}):c?(0,s.jsx)("kbd",{style:a,children:n}):m?(0,s.jsx)("strong",{style:a,children:n}):(0,s.jsx)("span",{style:a,children:n})},l.Link=function(e){let{children:t,target:n="_blank",href:a,className:i,onClick:r,style:l}=e;return(0,s.jsx)("a",{onClick:r,href:a,target:n,rel:"noopener noreferrer",style:l,children:t})};let o=(0,a.createContext)({type:"text"}),c=e=>{let{type:t}=e;return(0,s.jsx)(o.Provider,{value:{type:t},children:e.children})},d=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function u(e){let{children:t,className:n,ulClassName:a,style:i,type:r="text"}=e;return(0,s.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:n,style:i,children:(0,s.jsx)(c,{type:r,children:(0,s.jsx)("ul",{className:a,children:t})})})}u.Item=function(e){let{children:t,icon:n,active:a,rounded:l,onClick:o,doNotCloseOverlay:c=!1,showActiveBar:u=!1,style:m}=e,h=(0,i.Z)("menu"),{type:p}=d(),x=[h.item.base];x.push(h.item.variants[p].base),a?x.push(h.item.variants[p].active):x.push(h.item.variants[p].normal);let f=[h.item.content.base];a?f.push(h.item.content.active):f.push(h.item.content.normal);let g=[h.item.icon.base];return a?g.push(h.item.icon.active):g.push(h.item.icon.normal),(0,s.jsxs)("li",{role:"menuitem",className:(0,r.cn)("outline-none",x),style:m,onClick:o,"aria-current":a?"page":void 0,children:[n&&(0,s.jsx)("div",{className:"".concat(g.join(" ")," min-w-fit"),children:n}),(0,s.jsx)("span",{className:f.join(" "),children:t})]})},u.Group=function(e){let{children:t,icon:n,title:a}=e,r=(0,i.Z)("menu"),{type:l}=d();return(0,s.jsxs)("div",{className:[r.group.base,r.group.variants[l]].join(" "),children:[n&&(0,s.jsx)("span",{className:r.group.icon,children:n}),(0,s.jsx)("span",{className:r.group.content,children:a}),t]})},u.Misc=function(e){let{children:t}=e;return(0,s.jsx)("div",{children:(0,s.jsx)(l.Text,{children:(0,s.jsx)("span",{children:t})})})};var m=u},53004:function(e,t,n){"use strict";n.d(t,{M:function(){return r},_:function(){return l}});var s=n(52322),a=n(2784),i=n(54383);let r=(0,a.forwardRef)((e,t)=>(0,s.jsx)("nav",{ref:t,dir:"ltr",...e,className:(0,i.cn)("border-b",e.className),children:(0,s.jsx)("ul",{role:"menu",className:"flex gap-5",children:e.children})})),l=(0,a.forwardRef)(e=>{let{children:t,className:n,active:a,...r}=e;return(0,s.jsx)("li",{"aria-selected":a?"true":"false","data-state":a?"active":"inactive",className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap text-sm ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground text-foreground-lighter hover:text-foreground data-[state=active]:border-foreground border-b-2 border-transparent *:py-1.5",n),...r,children:t})})},1309:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var s=n(52322),a=n(2784),i=n(25001),r=n(46318),l=n(70780);let o=(0,a.createContext)({parentCallback:e=>{},type:"",name:"",activeId:"",parentSize:""});function c(e){let{id:t=("00000"+(46656*Math.random()|0).toString(36)).slice(-3)+("00000"+(46656*Math.random()|0).toString(36)).slice(-3),disabled:n,value:a,label:i,afterLabel:c,beforeLabel:d,description:u,name:m,checked:h,className:p,onChange:x,onBlur:f,hidden:g=!1,size:j="medium",align:v="vertical",optionalLabel:y,addOnBefore:b,children:N}=e,w=(0,r.Z)("radio"),{handleBlur:_}=(0,l.G)();function C(e){_&&_(e),f&&f(e)}return(0,s.jsx)(o.Consumer,{children:e=>{let{parentCallback:r,type:l,name:o,activeId:f,parentSize:_}=e;j=_||j;let S=f===t||!!h||!1!==h&&void 0,k=[p,w.variants[l].container.base,"list"===l&&!g&&w.variants[l].container.size[j]];return k.push(w.variants[l].base),k.push(w.variants[l].size[j]),S?k.push(w.variants[l].active):k.push(w.variants[l].inactive),n&&k.push(w.disabled),"list"!==l&&(g=!0),(0,s.jsxs)("label",{htmlFor:t,className:k.join(" "),children:[(0,s.jsx)("input",{id:t,name:o||m,type:"radio",className:[w.base,w.size[j],g&&w.hidden,w.variants[l].radio_offset,""].join(" "),checked:S,disabled:n,value:a||t,onChange:e=>{r&&r(e),x&&x(e)},onBlur:C}),b,N||(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:[w.label.base,w.label[j],w.variants[l].container.align[v]].join(" "),children:[d&&(0,s.jsx)("div",{className:[w.label_before.base,w.label_before[j]].join(" "),children:d}),(0,s.jsx)("div",{children:i}),c&&(0,s.jsx)("div",{className:[w.label_after.base,w.label_after[j]].join(" "),children:c}),u&&(0,s.jsx)("div",{className:[w.description.base,w.description[j]].join(" "),children:u})]}),y&&(0,s.jsx)("div",{className:[w.optionalLabel.base,w.optionalLabel[j]].join(" "),children:y})]})]})}})}c.Group=function(e){let{id:t,layout:n,error:d,descriptionText:u,label:m,afterLabel:h,beforeLabel:p,labelOptional:x,children:f,className:g,type:j="list",options:v,value:y,name:b,onChange:N,size:w="medium",validation:_,groupClassName:C,labelsLayout:S="vertical"}=e,[k,E]=(0,a.useState)(""),A=(0,r.Z)("radio"),{formContextOnChange:T,values:I,errors:Z,touched:z,fieldLevelValidation:P}=(0,l.G)();return I&&!y&&(y=I[t||b]),d||(Z&&!d&&(d=Z[t||b]),d=z&&z[t||b]?d:void 0),(0,a.useEffect)(()=>{_&&P(t,_(y))},[]),(0,a.useEffect)(()=>{E(y)},[y]),(0,s.jsx)("fieldset",{name:b,className:g,children:(0,s.jsx)(i.l,{nonBoxInput:!0,label:m,afterLabel:h,beforeLabel:p,labelOptional:x,layout:n,id:t,error:d,descriptionText:u,size:w,labelLayout:S,children:(0,s.jsx)("div",{className:C||A.variants[j].group,children:(0,s.jsx)(o.Provider,{value:{parentCallback:function(e){N&&N(e),T&&T(e),_&&P(t,_(e.target.value)),E(e.target.id)},type:j,name:b,activeId:k,parentSize:w},children:v?v.map(e=>(0,s.jsx)(c,{id:e.id,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,value:e.value,description:e.description})):f})})})})};var d=c},71294:function(e,t,n){"use strict";var s=n(52322),a=n(2784),i=n(25001),r=n(71653),l=n(67440),o=n(46318),c=n(70780);function d(e){let{autoComplete:t,autofocus:n,children:d,className:u,descriptionText:m,disabled:h,error:p,icon:x,id:f="",inputRef:g,label:j,afterLabel:v,beforeLabel:y,labelOptional:b,layout:N,name:w="",onChange:_,onBlur:C,placeholder:S,required:k,value:E,defaultValue:A,style:T,size:I="medium",borderless:Z=!1,validation:z,...P}=e,{formContextOnChange:R,values:L,errors:O,handleBlur:D,touched:F,fieldLevelValidation:U}=(0,c.G)();L&&!E&&(E=L[f]),p||(O&&!p&&(p=O[f||w]),p=F&&F[f||w]?p:void 0),(0,a.useEffect)(()=>{z&&U(f,z(E))},[]);let M=(0,o.Z)("select"),q=[M.container];u&&q.push(u);let B=[M.base];return p&&B.push(M.variants.error),p||B.push(M.variants.standard),x&&B.push(M.with_icon),I&&B.push(M.size[I]),h&&B.push(M.disabled),(0,s.jsx)(i.l,{label:j,afterLabel:v,beforeLabel:y,labelOptional:b,layout:N,id:f,error:p,descriptionText:m,className:u,style:T,size:I,children:(0,s.jsxs)("div",{className:M.container,children:[(0,s.jsx)("select",{id:f,name:w,"data-size":I,defaultValue:A,autoComplete:t,autoFocus:n,className:B.join(" "),onChange:function(e){_&&_(e),R&&R(e),z&&U(f,z(e.target.value))},onBlur:function(e){D&&D(e),C&&C(e)},ref:g,value:E,disabled:h,required:k,placeholder:S,...P,children:d}),x&&(0,s.jsx)(l.Z,{size:I,icon:x}),p&&(0,s.jsx)("div",{className:M.actions_container,children:p&&(0,s.jsx)(r.Z,{size:I})}),(0,s.jsx)("span",{className:M.chevron_container,children:(0,s.jsx)("svg",{className:M.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})}d.Option=function(e){let{value:t,children:n,selected:a}=e;return(0,s.jsx)("option",{value:t,selected:a,children:n})},d.OptGroup=function(e){let{label:t,children:n}=e;return(0,s.jsx)("optgroup",{label:t,children:n})},t.ZP=d},59769:function(e,t,n){"use strict";n.d(t,{Yi:function(){return o},bZ:function(){return c},zs:function(){return l}});var s=n(52322),a=n(83997),i=n(2784),r=n(54383);let l=a.fC,o=a.xz,c=i.forwardRef((e,t)=>{let{className:n,align:i="center",animate:l="zoom-in",sideOffset:o=4,...c}=e;return(0,s.jsx)(a.VY,{ref:t,align:i,sideOffset:o,className:(0,r.cn)("z-50 w-64 rounded-md border bg-overlay p-4 text-popover-foreground shadow-md outline-none","zoom-in"===l?"animate-in zoom-in-[99%]":"animate-in fade-in-50 data-[side=bottom]:slide-in-from-top-1 data-[side=left]:slide-in-from-right-1 data-[side=right]:slide-in-from-left-1 data-[side=top]:slide-in-from-bottom-1",n),...c})});c.displayName=a.VY.displayName},62949:function(e,t,n){"use strict";n.d(t,{Bw:function(){return f},DI:function(){return m},Ph:function(){return u},Ql:function(){return g},U$:function(){return j},i4:function(){return x},ki:function(){return h}});var s=n(52322),a=n(38947),i=n(78232),r=n(76141),l=n(2784),o=n(54383),c=n(10929),d=n(75109);let u=a.fC,m=a.ZA,h=a.B4,p=(0,c.j)("",{variants:{size:{...d.Ld}},defaultVariants:{size:d.Rc}}),x=l.forwardRef((e,t)=>{let{className:n,children:r,size:l,...c}=e;return(0,s.jsxs)(a.xz,{ref:t,className:(0,o.cn)("flex w-full items-center justify-between rounded-md border border-button bg-button text-xs ring-offset-background-control placeholder:text-foreground-muted focus:outline-none ring-border-control focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",p({size:l}),n),...c,children:[r,(0,s.jsx)(a.JO,{asChild:!0,children:(0,s.jsx)(i.Z,{className:"h-4 w-4 text-foreground-muted"})})]})});x.displayName=a.xz.displayName;let f=l.forwardRef((e,t)=>{let{className:n,children:i,position:r="popper",...l}=e;return(0,s.jsx)(a.h_,{children:(0,s.jsx)(a.VY,{ref:t,className:(0,o.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-overlay text-popover-foreground shadow-md animate-in fade-in-80","popper"===r&&"translate-y-1",n),position:r,...l,children:(0,s.jsx)(a.l_,{className:(0,o.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i})})})});f.displayName=a.VY.displayName,l.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,s.jsx)(a.__,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-xs text-foreground-lighter",n),...i})}).displayName=a.__.displayName;let g=l.forwardRef((e,t)=>{let{className:n,children:i,...l}=e;return(0,s.jsxs)(a.ck,{ref:t,className:(0,o.cn)("group","relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-xs outline-none focus:bg-overlay-hover text-foreground-lighter focus:text-foreground data-[state=checked]:text-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(a.wU,{className:"h-3.5 w-3.5 bg-foreground rounded-full flex justify-center items-center",children:(0,s.jsx)(r.Z,{className:"h-2 w-2 text-background-overlay",strokeWidth:6})})}),(0,s.jsx)(a.eT,{children:i})]})});g.displayName=a.ck.displayName;let j=l.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,s.jsx)(a.Z0,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-border-overlay",n),...i})});j.displayName=a.Z0.displayName},54849:function(e,t,n){"use strict";n.d(t,{c:function(){return o}});var s=n(52322),a=n(2784),i=n(84792),r=n.n(i),l=n(54383);let o=e=>{let{loading:t=!1,className:n,allowHoverEffect:i=!1}=e,[o,c]=(0,a.useState)(1),[d,u]=(0,a.useState)(1),[m,h]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=setInterval(()=>{t&&(h(!0),c(e=>e%5+1),u(e=>e%5+1))},500);return()=>clearInterval(e)},[t]),(0,a.useEffect)(()=>{!1===t&&(setTimeout(()=>{h(!1)},500),c(1))},[t]),(0,s.jsx)("div",{className:(0,l.cn)(r()["ai-icon__container"],i&&r()["ai-icon__container--allow-hover-effect"],t&&m&&r()["spin-ai-icon-container"],n),children:(0,s.jsxs)("div",{className:(0,l.cn)(r()["ai-icon__grid"]),children:[(0,s.jsx)("div",{className:(0,l.cn)(r()["ai-icon__grid__square"],t?r()["ai-icon__grid__square--step-".concat(o)]:m?r()["ai-icon__grid__square--exiting--step-".concat(d)]:r()["ai-icon__grid__square--static"])}),(0,s.jsx)("div",{className:(0,l.cn)(r()["ai-icon__grid__square"],t?r()["ai-icon__grid__square--step-".concat(o)]:m?r()["ai-icon__grid__square--exiting--step-".concat(d)]:r()["ai-icon__grid__square--static"])}),(0,s.jsx)("div",{className:(0,l.cn)(r()["ai-icon__grid__square"],t?r()["ai-icon__grid__square--step-".concat(o)]:m?r()["ai-icon__grid__square--exiting--step-".concat(d)]:r()["ai-icon__grid__square--static"])}),(0,s.jsx)("div",{className:(0,l.cn)(r()["ai-icon__grid__square"],t?r()["ai-icon__grid__square--step-".concat(o)]:m?r()["ai-icon__grid__square--exiting--step-".concat(d)]:r()["ai-icon__grid__square--static"])})]})})}},84792:function(e){e.exports={"spin-ai-icon-container":"ai-icon-animation-style_spin-ai-icon-container__7sgAA",spinAiIconContainer:"ai-icon-animation-style_spinAiIconContainer__rBP6P","ai-icon__container":"ai-icon-animation-style_ai-icon__container__2aXBS","ai-icon__grid":"ai-icon-animation-style_ai-icon__grid__Qrwxf","ai-icon__grid__square":"ai-icon-animation-style_ai-icon__grid__square__YU8EZ","ai-icon__grid__square--static":"ai-icon-animation-style_ai-icon__grid__square--static__1tOM_","ai-icon__container--allow-hover-effect":"ai-icon-animation-style_ai-icon__container--allow-hover-effect__HrB86","ai-icon__grid__square--step-1":"ai-icon-animation-style_ai-icon__grid__square--step-1__KATlI",step1_square1:"ai-icon-animation-style_step1_square1__BIjL3",step1_square2:"ai-icon-animation-style_step1_square2__QzsE7",step1_square3:"ai-icon-animation-style_step1_square3__ls1SO",step1_square4:"ai-icon-animation-style_step1_square4__Kk8zi","ai-icon__grid__square--step-2":"ai-icon-animation-style_ai-icon__grid__square--step-2__9OoIG",step2_square1:"ai-icon-animation-style_step2_square1__o_hcu",step2_square2:"ai-icon-animation-style_step2_square2__HBZt7",step2_square3:"ai-icon-animation-style_step2_square3__K6E2K",step2_square4:"ai-icon-animation-style_step2_square4__oDGDL","ai-icon__grid__square--step-3":"ai-icon-animation-style_ai-icon__grid__square--step-3__RldL4",step3_square1:"ai-icon-animation-style_step3_square1__Oo6vT",step3_square2:"ai-icon-animation-style_step3_square2__36Os9",step3_square3:"ai-icon-animation-style_step3_square3__Nj5rc",step3_square4:"ai-icon-animation-style_step3_square4__OFVFh","ai-icon__grid__square--step-4":"ai-icon-animation-style_ai-icon__grid__square--step-4__7o69c",step4_square1:"ai-icon-animation-style_step4_square1__G_8pn",step4_square2:"ai-icon-animation-style_step4_square2__KHYf3",step4_square3:"ai-icon-animation-style_step4_square3__XON12",step4_square4:"ai-icon-animation-style_step4_square4__Aq8dV","ai-icon__grid__square--step-5":"ai-icon-animation-style_ai-icon__grid__square--step-5__cF2Rx",step5_square1:"ai-icon-animation-style_step5_square1__me9Ru",step5_square2:"ai-icon-animation-style_step5_square2__0Ydfw",step5_square3:"ai-icon-animation-style_step5_square3__bOHqW",step5_square4:"ai-icon-animation-style_step5_square4__m2l32","ai-icon__grid__square--exiting--step-1":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-1__JYREY",exit_step1_square1:"ai-icon-animation-style_exit_step1_square1__C_GBC",exit_step1_square2:"ai-icon-animation-style_exit_step1_square2__TID0l",exit_step1_square3:"ai-icon-animation-style_exit_step1_square3__ADmUT",exit_step1_square4:"ai-icon-animation-style_exit_step1_square4__kilu_","ai-icon__grid__square--exiting--step-2":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-2__kDUVt",exit_step2_square1:"ai-icon-animation-style_exit_step2_square1__vmYa5",exit_step2_square2:"ai-icon-animation-style_exit_step2_square2__zxv0q",exit_step2_square3:"ai-icon-animation-style_exit_step2_square3__Dhey5",exit_step2_square4:"ai-icon-animation-style_exit_step2_square4__P1UKx","ai-icon__grid__square--exiting--step-3":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-3__h48Ts",exit_step3_square1:"ai-icon-animation-style_exit_step3_square1__l1FKu",exit_step3_square2:"ai-icon-animation-style_exit_step3_square2__4RPQL",exit_step3_square3:"ai-icon-animation-style_exit_step3_square3__s2vMz",exit_step3_square4:"ai-icon-animation-style_exit_step3_square4__Zros9","ai-icon__grid__square--exiting--step-4":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-4__VEmk_",exit_step4_square1:"ai-icon-animation-style_exit_step4_square1__bG99O",exit_step4_square2:"ai-icon-animation-style_exit_step4_square2__1Fxvf",exit_step4_square3:"ai-icon-animation-style_exit_step4_square3__EWeB7",exit_step4_square4:"ai-icon-animation-style_exit_step4_square4__HC5ov","ai-icon__grid__square--exiting--step-5":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-5___9jFB",exit_step5_square1:"ai-icon-animation-style_exit_step5_square1__w4ctB",exit_step5_square2:"ai-icon-animation-style_exit_step5_square2__UZdas",exit_step5_square3:"ai-icon-animation-style_exit_step5_square3__O_mvc",exit_step5_square4:"ai-icon-animation-style_exit_step5_square4__SKL7Z"}}},function(e){e.O(0,[667,9678,8183,8421,3844,9785,7263,9818,9595,5191,7127,9104,6917,7990,4018,8601,6130,9643,6043,913,7309,9229,3832,8475,626,496,6681,9774,2888,179],function(){return e(e.s=90373)}),_N_E=e.O()}]);