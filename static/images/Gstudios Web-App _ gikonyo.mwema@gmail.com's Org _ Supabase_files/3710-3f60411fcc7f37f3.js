"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3710],{69076:function(e,t,s){var r=s(52322),n=s(13252),a=s(28879),l=s.n(a),o=s(2784),i=s(34503),c=s(32079),d=s(59119),u=s(48869),m=s(13710);t.Z=e=>{let{to:t,from:s,onChange:a,helpers:h}=e,x=(0,m.PJ)(h),[p,g]=(0,o.useState)(t||s?"":x.text),f=h.find(e=>t===e.calcTo()&&s===e.calcFrom());return(0,o.useEffect)(()=>{f&&p!==f.text?g(f.text):!f&&(t||s)&&g("")},[f,t,s]),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)(i.h_,{children:[(0,r.jsx)(i.$F,{asChild:!0,children:(0,r.jsx)(c.z,{type:p?"secondary":"default",icon:(0,r.jsx)(d.Z,{size:12}),className:"rounded-r-none",children:(0,r.jsx)("span",{children:(null==f?void 0:f.text)||x.text})})}),(0,r.jsx)(i.AW,{side:"bottom",align:"start",children:(0,r.jsx)(i._x,{onValueChange:e=>{let t=h.find(t=>t.text===e);a&&t&&a({to:t.calcTo(),from:t.calcFrom()})},value:(null==f?void 0:f.text)||"",children:h.map(e=>(0,r.jsx)(i.qB,{value:e.text,disabled:e.disabled,children:(0,r.jsx)("span",{className:[e.disabled?"text-foreground-light cursor-not-allowed":""].join(" "),children:e.text})},e.text))})})]}),(0,r.jsx)(n.M,{triggerButtonClassName:"rounded-l-none",triggerButtonType:f?"default":"secondary",triggerButtonTitle:"Custom",onChange:e=>{g(""),a&&a(e)},to:p?void 0:t,from:p?void 0:s,renderFooter:e=>{let{to:t,from:s}=e;if(t&&s&&Math.abs(l()(s).diff(l()(t),"day"))>m.$K)return(0,r.jsx)(u.b,{title:"",variant:"warning",className:"mx-3 pl-2 pr-2 pt-1 pb-2",children:"Large ranges may result in memory errors for big projects."})}})]})}},36833:function(e,t,s){var r=s(52322);t.Z=e=>{let{children:t}=e;return(0,r.jsx)("pre",{className:"text-foreground text-sm break-words py-4 px-3 w-full",children:t})}},62197:function(e,t,s){s.d(t,{$K:function(){return i},Eh:function(){return u},GT:function(){return x},PJ:function(){return j},U_:function(){return n},W:function(){return g},ae:function(){return m},bj:function(){return f},dl:function(){return p},fg:function(){return b},jp:function(){return y},n7:function(){return o},tZ:function(){return h},up:function(){return v},xN:function(){return c}});var r,n,a=s(28879),l=s.n(a);let o="https://supabase.com/docs/guides/platform/logs#querying-with-the-logs-explorer",i=4,c=[{label:"Recent Errors",mode:"simple",searchString:"[Ee]rror|\\s[45][0-9][0-9]\\s",for:["api"]},{label:"Commits",mode:"simple",searchString:"COMMIT",for:["database"]},{label:"Commits By User",description:"Count of commits made by users on the database",mode:"custom",searchString:"select\n  p.user_name,\n  count(*) as count\nfrom postgres_logs\n  left join unnest(metadata) as m on true\n  left join unnest(m.parsed) as p on true\nwhere\n  regexp_contains(event_message, 'COMMIT')\ngroup by\n  p.user_name\n  ",for:["database"]},{label:"Metadata IP",description:"List all IP addresses that used the Supabase API",mode:"custom",searchString:"select\n  cast(timestamp as datetime) as timestamp,\n  h.x_real_ip\nfrom edge_logs\n  left join unnest(metadata) as m on true\n  left join unnest(m.request) as r on true\n  left join unnest(r.headers) as h on true\nwhere h.x_real_ip is not null\n",for:["api"]},{label:"Requests by Country",description:"List all ISO 3166-1 alpha-2 country codes that used the Supabase API",mode:"custom",searchString:"select\n  cf.country,\n  count(*) as count\nfrom edge_logs\n  left join unnest(metadata) as m on true\n  left join unnest(m.request) as r on true\n  left join unnest(r.cf) as cf on true\ngroup by\n  cf.country\norder by\n  count desc\n",for:["api"]},{label:"Slow Response Time",mode:"custom",description:"List all Supabase API requests that are slow",searchString:"select\n  cast(timestamp as datetime) as timestamp,\n  event_message,\n  r.origin_time\nfrom edge_logs\n  cross join unnest(metadata) as m\n  cross join unnest(m.response) as r\nwhere\n  r.origin_time > 1000\norder by\n  timestamp desc\nlimit 100\n",for:["api"]},{label:"500 Request Codes",description:"List all Supabase API requests that responded witha 5XX status code",mode:"custom",searchString:"select\n  cast(timestamp as datetime) as timestamp,\n  event_message,\n  r.status_code\nfrom edge_logs\n  cross join unnest(metadata) as m\n  cross join unnest(m.response) as r\nwhere\n  r.status_code >= 500\norder by\n  timestamp desc\nlimit 100\n",for:["api"]},{label:"Top Paths",description:"List the most requested Supabase API paths",mode:"custom",searchString:"select\n  r.path as path,\n  r.search as params,\n  count(timestamp) as c\nfrom edge_logs\n  cross join unnest(metadata) as m\n  cross join unnest(m.request) as r\ngroup by\n  path,\n  params\norder by\n  c desc\nlimit 100\n",for:["api"]},{label:"REST Requests",description:"List all PostgREST requests",mode:"custom",searchString:"select\n  cast(timestamp as datetime) as timestamp,\n  event_message\nfrom edge_logs\n  cross join unnest(metadata) as m\n  cross join unnest(m.request) as r\nwhere\n  path like '%rest/v1%'\norder by\n  timestamp desc\nlimit 100\n",for:["api"]},{label:"Errors",description:"List all Postgres error messages with ERROR, FATAL, or PANIC severity",mode:"custom",searchString:"select\n  cast(t.timestamp as datetime) as timestamp,\n  p.error_severity,\n  event_message\nfrom postgres_logs as t\n  cross join unnest(metadata) as m\n  cross join unnest(m.parsed) as p\nwhere\n  p.error_severity in ('ERROR', 'FATAL', 'PANIC')\norder by\n  timestamp desc\nlimit 100\n",for:["database"]},{label:"Error Count by User",description:"Count of errors by users",mode:"custom",searchString:"select\n  count(t.timestamp) as count,\n  p.user_name,\n  p.error_severity\nfrom postgres_logs as t\n  cross join unnest(metadata) as m\n  cross join unnest(m.parsed) as p\nwhere\n  p.error_severity in ('ERROR', 'FATAL', 'PANIC')\ngroup by\n  p.user_name,\n  p.error_severity\norder by\n  count desc\nlimit 100\n",for:["database"]},{label:"Auth Endpoint Events",description:"Endpoint events filtered by path",mode:"custom",searchString:'select\n  t.timestamp,\n  event_message\nfrom auth_logs as t\nwhere\n  regexp_contains(event_message,"level.{3}(info|warning||error|fatal)")\n  -- and regexp_contains(event_message,"path.{3}(/token|/recover|/signup|/otp)")\nlimit 100\n',for:["database"]},{label:"Storage Object Requests",description:"Number of requests done on Storage Objects",mode:"custom",searchString:"select\n  r.method as http_verb,\n  r.path as filepath,\n  count(*) as num_requests\nfrom edge_logs\n  cross join unnest(metadata) as m\n  cross join unnest(m.request) AS r\n  cross join unnest(r.headers) AS h\nwhere\n  path like '%storage/v1/object/%'\ngroup by\n  r.path, r.method\norder by\n  num_requests desc\nlimit 100\n",for:["api"]},{label:"Storage Egress Requests",description:"Check the number of requests done on Storage Affecting Egress",mode:"custom",searchString:"select\n    r.method as http_verb,\n    r.path as filepath,\n    count(*) as num_requests,\n  from edge_logs\n    cross join unnest(metadata) as m\n    cross join unnest(m.request) AS r\n    cross join unnest(r.headers) AS h\n  where\n    (path like '%storage/v1/object/%' or path like '%storage/v1/render/%')\n    and r.method = 'GET'\n  group by\n    r.path, r.method\n  order by\n    num_requests desc\n  limit 100\n",for:["api"]},{label:"Storage Top Cache Misses",description:"The top Storage requests that miss caching",mode:"custom",searchString:"select\n  r.path as path,\n  r.search as search,\n  count(id) as count\nfrom edge_logs f\n  cross join unnest(f.metadata) as m\n  cross join unnest(m.request) as r\n  cross join unnest(m.response) as res\n  cross join unnest(res.headers) as h\nwhere starts_with(r.path, '/storage/v1/object') \n  and r.method = 'GET'\n  and h.cf_cache_status in ('MISS', 'NONE/UNKNOWN', 'EXPIRED', 'BYPASS', 'DYNAMIC')\ngroup by path, search\norder by count desc\nlimit 100\n",for:["api"]}],d={search_query:e=>"regexp_contains(event_message, '".concat(e,"')")},u={postgres_logs:{...d,database:e=>"identifier = '".concat(e,"'"),"severity.error":"parsed.error_severity in ('ERROR', 'FATAL', 'PANIC')","severity.noError":"parsed.error_severity not in ('ERROR', 'FATAL', 'PANIC')","severity.log":"parsed.error_severity = 'LOG'"},edge_logs:{...d,database:e=>"identifier = '".concat(e,"'"),"status_code.error":"response.status_code between 500 and 599","status_code.success":"response.status_code between 200 and 299","status_code.warning":"response.status_code between 400 and 499","product.database":"request.path like '/rest/%' or request.path like '/graphql/%'","product.storage":"request.path like '/storage/%'","product.auth":"request.path like '/auth/%'","product.realtime":"request.path like '/realtime/%'","method.get":"request.method = 'GET'","method.post":"request.method = 'POST'","method.put":"request.method = 'PUT'","method.patch":"request.method = 'PATCH'","method.delete":"request.method = 'DELETE'","method.options":"request.method = 'OPTIONS'"},function_edge_logs:{...d,"status_code.error":"response.status_code between 500 and 599","status_code.success":"response.status_code between 200 and 299","status_code.warning":"response.status_code between 400 and 499"},function_logs:{...d,"severity.error":"metadata.level = 'error'","severity.notError":"metadata.level != 'error'","severity.log":"metadata.level = 'log'","severity.info":"metadata.level = 'info'","severity.debug":"metadata.level = 'debug'","severity.warn":"metadata.level = 'warn'"},auth_logs:{...d,"severity.error":"metadata.level = 'error' or metadata.level = 'fatal'","severity.warning":"metadata.level = 'warning'","severity.info":"metadata.level = 'info'","status_code.server_error":"cast(metadata.status as int64) between 500 and 599","status_code.client_error":"cast(metadata.status as int64) between 400 and 499","status_code.redirection":"cast(metadata.status as int64) between 300 and 399","status_code.success":"cast(metadata.status as int64) between 200 and 299","endpoints.admin":'REGEXP_CONTAINS(metadata.path, "/admin")',"endpoints.signup":'REGEXP_CONTAINS(metadata.path, "/signup|/invite|/verify")',"endpoints.authentication":'REGEXP_CONTAINS(metadata.path, "/token|/authorize|/callback|/otp|/magiclink")',"endpoints.recover":'REGEXP_CONTAINS(metadata.path, "/recover")',"endpoints.user":'REGEXP_CONTAINS(metadata.path, "/user")',"endpoints.logout":'REGEXP_CONTAINS(metadata.path, "/logout")'},realtime_logs:{...d},storage_logs:{...d},postgrest_logs:{...d,database:e=>"identifier = '".concat(e,"'")},pgbouncer_logs:{...d},supavisor_logs:{...d,database:e=>"m.project like '".concat(e,"%'")}};(r=n||(n={})).EDGE="edge_logs",r.POSTGRES="postgres_logs",r.FUNCTIONS="function_logs",r.FN_EDGE="function_edge_logs",r.AUTH="auth_logs",r.REALTIME="realtime_logs",r.STORAGE="storage_logs",r.POSTGREST="postgrest_logs",r.SUPAVISOR="supavisor_logs",r.WAREHOUSE="warehouse_logs";let m={api:"edge_logs",database:"postgres_logs",functions:"function_logs",fn_edge:"function_edge_logs",auth:"auth_logs",realtime:"realtime_logs",storage:"storage_logs",postgrest:"postgrest_logs",supavisor:"supavisor_logs",warehouse:"warehouse_logs"},h={edge_logs:"Logs obtained from the network edge, containing all API requests",postgres_logs:"Database logs obtained directly from Postgres",function_logs:"Function logs generated from runtime execution",function_edge_logs:"Function call logs, containing the request and response",auth_logs:"Authentication logs from GoTrue",realtime_logs:"Realtime server for Postgres logical replication broadcasting",storage_logs:"Object storage logs",postgrest_logs:"RESTful API web server logs",supavisor_logs:"Cloud-native Postgres connection pooler logs",warehouse_logs:"Logs obtained from a data warehouse collection"},x=e=>{for(let t in e){let s=e[t];(null===s||""===s||void 0===s)&&delete e[t]}return new URLSearchParams(e).toString()},p={postgres_logs:{severity:{label:"Severity",key:"severity",options:[{key:"error",label:"Error",description:"Show all events with ERROR, PANIC, or FATAL"},{key:"noError",label:"No Error",description:"Show all non-error events"},{key:"log",label:"Log",description:"Show all events that are log severity"}]}},edge_logs:{status_code:{label:"Status",key:"status_code",options:[{key:"error",label:"Error",description:"500 error codes"},{key:"success",label:"Success",description:"200 codes"},{key:"warning",label:"Warning",description:"400 codes"}]},product:{label:"Product",key:"product",options:[{key:"database",label:"Database",description:""},{key:"auth",label:"Auth",description:""},{key:"storage",label:"Storage",description:""},{key:"realtime",label:"Realtime",description:""}]},method:{label:"Method",key:"method",options:[{key:"get",label:"GET",description:""},{key:"options",label:"OPTIONS",description:""},{key:"put",label:"PUT",description:""},{key:"post",label:"POST",description:""},{key:"patch",label:"PATCH",description:""},{key:"delete",label:"DELETE",description:""}]}},function_edge_logs:{status_code:{label:"Status",key:"status_code",options:[{key:"error",label:"Error",description:"500 error codes"},{key:"success",label:"Success",description:"200 codes"},{key:"warning",label:"Warning",description:"400 codes"}]}},function_logs:{severity:{label:"Severity",key:"severity",options:[{key:"error",label:"Error",description:'Show all events that are "error" severity'},{key:"warn",label:"Warning",description:'Show all events that are "warn" severity'},{key:"info",label:"Info",description:'Show all events that are "info" severity'},{key:"debug",label:"Debug",description:'Show all events that are "debug" severity'},{key:"log",label:"Log",description:'Show all events that are "log" severity'}]}},auth_logs:{severity:{label:"Severity",key:"severity",options:[{key:"error",label:"Error",description:"Show all events that have error or fatal severity"},{key:"warning",label:"Warning",description:"Show all events that have warning severity"},{key:"info",label:"Info",description:"Show all events that have info severity"}]},status_code:{label:"Status Code",key:"status_code",options:[{key:"server_error",label:"Server Error",description:"Show all requests with 5XX status code"},{key:"client_error",label:"Client Error",description:"Show all requests with 4XX status code"},{key:"redirection",label:"Redirection",description:"Show all requests that have 3XX status code"},{key:"success",label:"Success",description:"Show all requests that have 2XX status code"}]},endpoints:{label:"Endpoints",key:"endpoints",options:[{key:"admin",label:"Admin",description:"Show all admin requests"},{key:"signup",label:"Sign up",description:"Show all signup and authorization requests"},{key:"recover",label:"Password Recovery",description:"Show all password recovery requests"},{key:"authentication",label:"Authentication",description:"Show all authentication flow requests (login, otp, and Oauth2)"},{key:"user",label:"User",description:"Show all user data requests"},{key:"logout",label:"Logout",description:"Show all logout requests"}]}}},g={log_selection_x_padding:"px-8",space_y:"px-6"},f=[{text:"Last hour",calcFrom:()=>l()().subtract(1,"hour").startOf("hour").toISOString(),calcTo:()=>"",default:!0},{text:"Last 3 hours",calcFrom:()=>l()().subtract(3,"hour").startOf("hour").toISOString(),calcTo:()=>""},{text:"Last 24 hours",calcFrom:()=>l()().subtract(1,"day").startOf("day").toISOString(),calcTo:()=>""}],v=[{text:"Last hour",calcFrom:()=>l()().subtract(1,"hour").startOf("hour").toISOString(),calcTo:()=>"",default:!0},{text:"Last 24 hours",calcFrom:()=>l()().subtract(1,"day").startOf("day").toISOString(),calcTo:()=>""},{text:"Last 3 days",calcFrom:()=>l()().subtract(3,"day").startOf("day").toISOString(),calcTo:()=>""},{text:"Last 7 days",calcFrom:()=>l()().subtract(7,"day").startOf("day").toISOString(),calcTo:()=>""}],j=e=>e.find(e=>e.default)||e[0],b={FREE:{text:"1 day",value:1,unit:"day",promptUpgrade:!0},PRO:{text:"7 days",value:7,unit:"day",promptUpgrade:!0},PAYG:{text:"7 days",value:7,unit:"day",promptUpgrade:!0},TEAM:{text:"28 days",value:28,unit:"day",promptUpgrade:!0},ENTERPRISE:{text:"90 days",value:90,unit:"day",promptUpgrade:!1}},y=["/project/[ref]/logs/edge-logs","/project/[ref]/logs/pooler-logs","/project/[ref]/logs/postgres-logs","/project/[ref]/logs/postgrest-logs"]},71023:function(e,t,s){s.d(t,{TK:function(){return p},VG:function(){return h},VK:function(){return d},XA:function(){return x},Yj:function(){return m},io:function(){return g},tS:function(){return u},wi:function(){return f},wv:function(){return v}});var r=s(52322),n=s(15998),a=s(28879),l=s.n(a);s(2784);var o=s(39459),i=s(84605),c=s(13710);let d=e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"flex h-full w-full items-center gap-4",children:t})},u=e=>{let{value:t}=e;return(0,r.jsx)(m,{label:"Timestamp",value:(0,c.Sj)(t)?(0,c.tI)(t):String(t)})},m=e=>{let{label:t,value:s,valueRender:a}=e;return(0,r.jsxs)("div",{className:"grid grid-cols-12 group items-center",children:[(0,r.jsx)("span",{className:"text-foreground-lighter text-sm col-span-3 whitespace-pre-wrap",children:t}),(0,r.jsx)("span",{title:s,className:"truncate font-mono text-foreground text-sm col-span-8 whitespace-pre-wrap break-all",children:null!=a?a:s}),(0,r.jsx)(n.Z,{iconOnly:!0,text:s,className:"group-hover:opacity-100 opacity-0 p-0 h-6 w-6 col-span-1",type:"text",title:"Copy to clipboard"})]})},h=e=>{let{value:t,className:s}=e;return(0,r.jsx)("span",{className:"font-mono text-xs truncate "+s,children:t})},x=e=>{let{value:t}=e;if(!t)return(0,r.jsx)("div",{children:(0,r.jsx)("label",{className:"text-xs text-border-stronger",children:"No data"})});switch(t.toString().split("")[0]){case"1":case"2":return(0,r.jsx)("div",{className:"flex h-full items-center",children:(0,r.jsx)("div",{className:"relative flex h-6 items-center justify-center rounded border bg-surface-200 px-2 py-1 text-center",children:(0,r.jsx)("label",{className:"block font-mono text-sm text-foreground-lighter",children:t})})});case"5":return(0,r.jsx)("div",{className:"flex h-full items-center",children:(0,r.jsx)("div",{className:"relative flex h-6 items-center justify-center rounded bg-red-400 px-2 py-1 text-center  ",children:(0,r.jsx)("label",{className:"block font-mono text-sm text-red-1100",children:t})})});case"4":case"3":return(0,r.jsx)("div",{className:"flex h-full items-center",children:(0,r.jsx)("div",{className:"relative flex h-6 items-center justify-center rounded bg-amber-400 px-2 py-1 text-center  ",children:(0,r.jsx)("label",{className:"block font-mono text-sm text-amber-1100",children:t})})});default:return(0,r.jsx)("div",{className:"flex h-full items-center",children:(0,r.jsx)("div",{className:"relative flex h-6 items-center justify-center rounded bg-surface-100 px-2 py-1 text-center  ",children:(0,r.jsx)("label",{className:"block font-mono text-sm text-foreground-lighter",children:t})})})}},p=e=>{let{value:t,uppercase:s=!0}=e;if(!t)return(0,r.jsx)("div",{children:(0,r.jsx)("label",{className:"text-xs text-border-stronger",children:"No data"})});let n=t.toUpperCase(),a=s?n:t,l=e=>{let{className:t,children:s}=e;return(0,r.jsx)("div",{className:"w-24 flex items-center h-full ".concat(t),children:s})};switch(n){case"UNCAUGHTEXCEPTION":case"PANIC":case"FATAL":case"ERROR":return(0,r.jsxs)(l,{className:"gap-1",children:[(0,r.jsx)("div",{className:" p-0.5 rounded !text-red-900",children:(0,r.jsx)(o.Z,{size:14,strokeWidth:2})}),(0,r.jsx)("span",{className:"!text-red-900 !block titlecase",children:a})]});case"INFO":case"DEBUG":return(0,r.jsxs)(l,{className:"gap-1",children:[(0,r.jsx)("div",{className:" p-0.5 rounded !text-blue-900",children:(0,r.jsx)(o.Z,{size:14,strokeWidth:2})}),(0,r.jsx)("span",{className:"!text-blue-900 !block titlecase",children:a})]});case"LOG":return(0,r.jsxs)(l,{className:"gap-1",children:[(0,r.jsx)("div",{className:" p-0.5 rounded !text-blue-900",children:(0,r.jsx)(i.Z,{size:14,strokeWidth:2})}),(0,r.jsx)("span",{className:"!text-blue-900 !block titlecase",children:a})]});case"WARNING":return(0,r.jsxs)(l,{className:"gap-1",children:[(0,r.jsx)("div",{className:" p-0.5 rounded !text-amber-900",children:(0,r.jsx)(o.Z,{size:14,strokeWidth:2})}),(0,r.jsx)("span",{className:"!text-amber-900 !block titlecase",children:a})]});default:return(0,r.jsx)(l,{children:(0,r.jsx)("div",{className:"relative rounded px-2 py-1 text-center h-6 flex justify-center items-center bg-surface-100",children:(0,r.jsx)("label",{className:"block font-mono text-sm text-foreground-lighter",children:a})})})}},g=e=>{let{value:t,className:s}=e;return(0,r.jsx)("span",{className:"text-xs ".concat(s),children:f(t)})},f=e=>{let t=(0,c.Sj)(e)?(0,c.tI)(e):e;return l()(t).format("DD MMM  HH:mm:ss")};function v(e){let t=JSON.stringify(e,null,2);return(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var t="number text-tomato-900";return/^"/.test(e)?t=/:$/.test(e)?"key text-foreground":"string text-brand-600":/true|false/.test(e)?t="boolean text-blue-900":/null/.test(e)&&(t="null text-amber-1100"),'<span class="'+t+'">'+e+"</span>"}).split("\n").map(e=>'<span class="line text-xs">'.concat(e,"</span>")).join("\n")}},13710:function(e,t,s){s.d(t,{up:function(){return n.up},n7:function(){return n.n7},$K:function(){return n.$K},tZ:function(){return n.tZ},ae:function(){return n.ae},_4:function(){return tt},ol:function(){return e6},dL:function(){return eb},D8:function(){return ee},U_:function(){return n.U_},bj:function(){return n.bj},Eh:function(){return n.Eh},xN:function(){return n.xN},fg:function(){return n.fg},AJ:function(){return E},h6:function(){return O},g8:function(){return C},My:function(){return S},UR:function(){return y},GT:function(){return n.GT},ue:function(){return _},PJ:function(){return n.PJ},Oy:function(){return v},Sj:function(){return f},dP:function(){return w},tI:function(){return g},Q9:function(){return T}});var r=s(2784),n=s(62197),a=s(79534),l=s(28879),o=s.n(l),i=s(72579),c=s.n(i),d=s(18149),u=s.n(d),m=s(84636),h=s.n(m),x=s(70772),p=s(57663);let g=e=>o().unix(Number(e)/1e3/1e3).toISOString(),f=e=>{let t=16===String(e).length;return!Number.isNaN(Number(e))&&t},v=e=>e&&e.timestamp&&e.event_message&&e.id,j=(e,t)=>Object.keys(e).filter(t=>e[t]).flatMap(s=>{let r=t?"".concat(t,".").concat(s):s;return"object"==typeof e[s]?j(e[s],r):[r]}),b=(e,t)=>{let s=Object.keys(t),r=n.Eh[e],a=e=>{let s=r[e],n=c()(t,e);return void 0!==n&&"function"==typeof s?s(n):void 0===s?"string"==typeof n?"".concat(e," = '").concat(n,"'"):"".concat(e," = ").concat(n):void 0===n&&"function"==typeof s?null:s&&!1===n?null:s},l=s.map(e=>{if(void 0===t[e]||"string"==typeof t[e]&&0===t[e].length)return null;if("object"==typeof t[e]){let s=j(t[e],e).map(a).filter(Boolean);return s.length>0?"(".concat(s.join(" or "),")"):null}{let t=a(e);return null===t?null:"(".concat(t,")")}}).filter(Boolean).join(" and ");return l?"where "+l:""},y=(e,t)=>{let s=b(e,t),r=N(e),n="order by timestamp desc";switch(e){case"edge_logs":return"select id, identifier, timestamp, event_message, request.method, request.path, response.status_code\n  from ".concat(e,"\n  ").concat(r,"\n  ").concat(s,"\n  ").concat(n,"\n  limit 100\n  ");case"postgres_logs":return"select identifier, postgres_logs.timestamp, id, event_message, parsed.error_severity from ".concat(e,"\n  ").concat(r,"\n  ").concat(s,"\n  ").concat(n,"\n  limit 100\n  ");case"function_logs":return"select id, ".concat(e,".timestamp, event_message, metadata.event_type, metadata.function_id, metadata.level from ").concat(e,"\n  ").concat(r,"\n  ").concat(s,"\n  ").concat(n,"\n  limit 100\n    ");case"auth_logs":return"select id, ".concat(e,".timestamp, event_message, metadata.level, metadata.status, metadata.path, metadata.msg as msg, metadata.error from ").concat(e,"\n  ").concat(r,"\n  ").concat(s,"\n  ").concat(n,"\n  limit 100\n    ");case"function_edge_logs":return"select id, ".concat(e,".timestamp, event_message, response.status_code, request.method, m.function_id, m.execution_time_ms, m.deployment_id, m.version from ").concat(e,"\n  ").concat(r,"\n  ").concat(s,"\n  ").concat(n,"\n  limit 100\n  ");case"supavisor_logs":return"select id, ".concat(e,".timestamp, event_message from ").concat(e," ").concat(r," ").concat(s," ").concat(n," limit 100");default:return"select id, ".concat(e,".timestamp, event_message from ").concat(e,"\n  ").concat(s,"\n  ").concat(n,"\n  limit 100\n  ")}},N=e=>{switch(e){case"edge_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.request) as request\n  cross join unnest(m.response) as response";case"postgres_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.parsed) as parsed";case"function_logs":case"auth_logs":return"cross join unnest(metadata) as metadata";case"function_edge_logs":return"cross join unnest(metadata) as m\n  cross join unnest(m.response) as response\n  cross join unnest(m.request) as request";case"supavisor_logs":return"cross join unnest(metadata) as m";default:return""}},_=(e,t)=>"select id, timestamp, event_message, metadata from ".concat(e," where id = '").concat(t,"' limit 1"),w=(e,t)=>{let s=Math.abs(o()().diff(o()(e),"day"));return s>1&&"free"===t||s>7&&"pro"===t||s>28&&"team"===t||s>90&&"enterprise"===t},S=(e,t)=>{let s=b(e,t),r=N(e);return"SELECT count(*) as count FROM ".concat(e," ").concat(r," ").concat(s)},k=e=>{let t=e.iso_timestamp_end?o()(e.iso_timestamp_end):o()(),s=e.iso_timestamp_start?o()(e.iso_timestamp_start):o()(),r="minute",n=360,a=t.diff(s,"minute"),l=t.diff(s,"hour");return a>720?(r="hour",n=120):l>72&&(r="day",n=7),[s.add(-n,r),r]},C=(e,t,s)=>{let[r,n]=k(t),a=b(e,s),l=N(e);return"\nSELECT\n-- log-event-chart\n  timestamp_trunc(t.timestamp, ".concat(n,") as timestamp,\n  count(t.timestamp) as count\nFROM\n  ").concat(e," t\n  ").concat(l,"\n  ").concat(a?a+" and t.timestamp > '".concat(r.toISOString(),"'"):"where t.timestamp > '".concat(r.toISOString(),"'"),"\nGROUP BY\ntimestamp\nORDER BY\n  timestamp ASC\n  ")},E=(e,t)=>{let[s,r]=e,[n,a]=t;if(s&&r&&a&&!n){let e=o()(a).diff(o()(s)),t=o()(s);if(e<=0){let e=Math.abs(o()(r).diff(t,"minute"));t=o()(a).subtract(e,"minute")}return[t.toISOString(),a]}return!a&&n?[n,r]:[n,a]},T=()=>{let e=(0,a.useMonaco)();(0,r.useEffect)(()=>{if(e){let t=e.languages.registerCompletionItemProvider("pgsql",{triggerCharacters:["`"," ","."],provideCompletionItems:function(t,s,r){let n=new p.Z(t,s.column-2,s.lineNumber-1);if(n.isNextDQuote())return{suggestions:[]};let a=[],l=x.Z.schemas.filter(e=>n._text.includes(e.reference));if(0===l.length&&(l=x.Z.schemas),n.isNextPeriod()){let t=l.flatMap(e=>e.fields).flatMap(e=>{let[t,...s]=e.path.split(".");return s}).map(t=>({label:t,kind:e.languages.CompletionItemKind.Property,insertText:t}));a=a.concat(t)}if("`"===r.triggerCharacter||" "===r.triggerCharacter){let t=x.Z.schemas.map(t=>({label:t.reference,kind:e.languages.CompletionItemKind.Class,insertText:t.reference})),s=l.flatMap(e=>e.fields).flatMap(e=>e.path.split(".").slice(0,-1)).map(t=>({label:t,kind:e.languages.CompletionItemKind.Property,insertText:t}));a=(a=a.concat(s)).concat(t)}return{suggestions:h()(a,"label")}}});return()=>{t.dispose()}}},[e])},O=(e,t,s,r,n,a)=>{if(e.length<=1&&!(n||a))return e;let l=e.map(e=>o().utc(e[t])),i=a?o().utc(a):o().utc(Math.max.apply(null,l)),c=n?o().utc(n):o().utc(Math.min.apply(null,l)),d=R(e.length>0?l:[c,i]),m=e.map(e=>{let s=o().utc(e[t]).toISOString();return e[t]=s,e}),h=i.diff(c,d);if(h>1e4)throw Error("Data error, filling timeseries dynamically with more than 10k data points degrades performance.");for(let e=0;e<=h;e++){let n=c.add(e,d),a=("string"==typeof s?[s]:s).reduce((e,t)=>({...e,[t]:r}),{});l.find(e=>u()(e,n))||m.push({[t]:n.toISOString(),...a})}return m},R=e=>{let t=e.reduce((e,t)=>{let s=H(t);return e[s]+=1,e},{second:0,minute:0,hour:0,day:0});return Object.keys(t).reduce((e,s)=>t[e]>t[s]?e:s)},H=e=>({0:"second",1:"minute",2:"hour",3:"day"})[["second","minute","hour"].map(t=>e.get(t)).reduce((e,t)=>(0===t&&(e+=1),e),0)];var Z=s(52322),I=s(5632),A=s(62202),M=s(99959),q=s(15735),P=s(2160),L=s(13800),D=s(52905),F=s(32079),z=s(25501),W=s(34503),Y=s(23056),G=s(74559),U=s(62134),V=s(74138),X=s(36833),K=s(47852),J=s(62277),B=s(750);let $=e=>{let{visible:t,onCancel:s,onSubmit:r,initialValues:n}=e;return(0,Z.jsx)(K.C,{visible:t,onCancel:s,hideFooter:!0,header:"Update saved query",size:"small",children:(0,Z.jsx)(J.Z,{onReset:s,validateOnBlur:!0,initialValues:n,validate:function(e){let t={};return e.name||(t.name="Required"),t},onSubmit:r,children:e=>{let{isSubmitting:t}=e;return(0,Z.jsxs)("div",{className:"space-y-4 py-4",children:[(0,Z.jsx)(K.C.Content,{children:(0,Z.jsx)(B.Z,{label:"Name",id:"name",name:"name"})}),(0,Z.jsx)(K.C.Content,{children:(0,Z.jsx)(B.Z.TextArea,{label:"Description",id:"description",placeholder:"Describe query",size:"medium",textAreaClassName:"resize-none"})}),(0,Z.jsx)(K.C.Separator,{}),(0,Z.jsx)(K.C.Content,{children:(0,Z.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,Z.jsx)(F.z,{htmlType:"reset",type:"default",onClick:s,disabled:t,children:"Cancel"}),(0,Z.jsx)(F.z,{htmlType:"submit",loading:t,disabled:t,children:"Save query"})]})})]})}})})};var Q=s(71023),ee=e=>{let{item:t}=e,s=(0,I.useRouter)(),{ref:n}=(0,M.UO)(),[a,l]=(0,r.useState)(!1),[o,i]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),{mutate:u}=(0,P.z)({onSuccess:()=>{i(!1),A.ZP.success("Successfully deleted query")},onError:e=>{A.ZP.error("Failed to delete saved query: ".concat(e.message))}}),{mutate:m}=(0,L.R)({onSuccess:()=>{d(!1),A.ZP.success("Successfully updated query")},onError:e=>{A.ZP.error("Failed to update query: ".concat(e.message))}}),h=async()=>{if(!n||"string"!=typeof n)return console.error("Invalid project reference");u({projectRef:n,ids:[t.id]})},x=async e=>{let{name:s,description:r}=e;if(!n||"string"!=typeof n)return console.error("Invalid project reference");m({projectRef:n,payload:{...t,name:s,description:r}})};return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(q.Z.tr,{className:"expandable-tr [&>*]:flex [&>*]:items-center [&>*]:truncate [&>*]:overflow-hidden",children:[(0,Z.jsx)(q.Z.td,{className:"whitespace-nowrap",children:(0,Z.jsx)("div",{className:"flex items-center gap-2",children:(0,Z.jsxs)("button",{onClick:()=>l(!a),className:"flex items-center gap-2",children:[(0,Z.jsx)("div",{className:"transition "+(a?"rotate-90":"rotate-0"),children:(0,Z.jsx)(D.Z,{strokeWidth:2,size:14})}),(0,Z.jsx)("span",{className:"text-sm text-foreground",children:t.name})]})})}),(0,Z.jsx)(q.Z.td,{children:(0,Z.jsx)("span",{className:"text-foreground-light",children:t.description})}),(0,Z.jsx)(q.Z.td,{children:(0,Z.jsx)("span",{className:"text-foreground-light",children:(0,Q.wi)(t.inserted_at)})}),(0,Z.jsx)(q.Z.td,{children:(0,Z.jsx)("span",{className:"text-foreground-light",children:(0,Q.wi)(t.updated_at)})}),(0,Z.jsxs)(q.Z.td,{className:"flex items-center gap-2 justify-end",children:[(0,Z.jsx)(F.z,{type:"alternative",iconRight:(0,Z.jsx)(z.Z,{size:10}),onClick:()=>s.push("/project/".concat(n,"/logs/explorer?q=").concat(encodeURIComponent(t.content.sql))),children:"Run"}),(0,Z.jsxs)("div",{children:[(0,Z.jsxs)(W.h_,{children:[(0,Z.jsx)(W.$F,{children:(0,Z.jsx)(F.z,{type:"text",title:"Actions",className:"space-x-0 h-7 px-1.5",icon:(0,Z.jsx)(Y.Z,{}),children:(0,Z.jsx)("div",{className:"sr-only",children:"Actions"})})}),(0,Z.jsxs)(W.AW,{className:"max-w-[144px]",children:[(0,Z.jsxs)(W.Xi,{onClick:()=>d(!0),children:[(0,Z.jsx)(G.Z,{size:10,className:"mr-2"}),"Edit"]}),(0,Z.jsxs)(W.Xi,{onClick:()=>{i(!0)},children:[(0,Z.jsx)(U.Z,{size:10,className:"mr-2"}),"Delete"]})]})]}),(0,Z.jsx)(V.Z,{variant:"destructive",visible:o,confirmLabel:"Delete query",title:"Confirm to delete saved query",onCancel:()=>{i(!1)},onConfirm:h,children:(0,Z.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to delete ",t.name,"?"]})}),(0,Z.jsx)($,{visible:c,initialValues:{name:t.name,description:t.description},onCancel:()=>{d(!1)},onSubmit:e=>{x(e)}})]})]})]},t.id),(0,Z.jsx)(q.Z.td,{className:"".concat(a?" h-auto opacity-100":"h-0 opacity-0"," expanded-row-content border-l border-r bg-alternative !pt-0 !pb-0 transition-all"),colSpan:5,children:a&&(0,Z.jsx)(X.Z,{children:t.content.sql})})]})},et=s(24990),es=s(43687),er=s(10012),en=s(48869),ea=s(81076),el=s(49251),eo=s(61373),ei=s(31036),ec=s(32830),ed=s(9015),eu=s(90488),em=s(54506),eh=s(14528),ex=s(39097),ep=s.n(ex),eg=s(69076),ef=s(20085),ev=s(82667);let ej=e=>{let{field:t}=e,[s,n]=(0,r.useState)(!1);return(0,Z.jsxs)(q.Z.tr,{children:[(0,Z.jsxs)(q.Z.td,{className:"font-mono text-xs !p-2 cursor-pointer hover:text-foreground transition flex items-center space-x-2",onClick:()=>(0,ev.vQ)(t.path,()=>{n(!0),setTimeout(()=>n(!1),3e3)}),children:[(0,Z.jsx)("span",{children:t.path}),s?(0,Z.jsxs)(et.fC,{delayDuration:0,children:[(0,Z.jsx)(et.xz,{children:(0,Z.jsx)(eu.Z,{size:14,strokeWidth:3,className:"text-brand"})}),(0,Z.jsx)(et.h_,{children:(0,Z.jsxs)(et.VY,{side:"bottom",children:[(0,Z.jsx)(et.Eh,{className:"radix-tooltip-arrow"}),(0,Z.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,Z.jsx)("span",{className:"text-xs text-foreground",children:"Copied"})})]})})]}):(0,Z.jsxs)(et.fC,{delayDuration:0,children:[(0,Z.jsx)(et.xz,{children:(0,Z.jsx)(em.Z,{size:"tiny",strokeWidth:1.5})}),(0,Z.jsx)(et.h_,{children:(0,Z.jsxs)(et.VY,{side:"bottom",children:[(0,Z.jsx)(et.Eh,{className:"radix-tooltip-arrow"}),(0,Z.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,Z.jsx)("span",{className:"text-xs text-foreground",children:"Copy value"})})]})})]})]}),(0,Z.jsx)(q.Z.td,{className:"font-mono text-xs !p-2",children:t.type})]})};var eb=e=>{let{templates:t=[],onSelectTemplate:s,onSelectSource:a,defaultFrom:l,defaultTo:o,onDateChange:i,warnings:c}=e,[d,u]=r.useState(!1),{projectAuthAll:m,projectStorageAll:h,projectEdgeFunctionAll:x}=(0,eh.N3)(["project_auth:all","project_storage:all","project_edge_function:all"]),p=Object.entries(n.U_).filter(e=>{let[t]=e;return"AUTH"===t?m:"STORAGE"===t?h:"FN_EDGE"!==t||x}).map(e=>{let[,t]=e;return t});return(0,Z.jsx)("div",{className:"rounded rounded-bl-none rounded-br-none border border-overlay bg-surface-100",children:(0,Z.jsx)("div",{className:"flex w-full items-center justify-between px-5 py-2",children:(0,Z.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-x-4",children:[(0,Z.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Z.jsxs)(W.h_,{children:[(0,Z.jsx)(W.$F,{asChild:!0,children:(0,Z.jsx)(F.z,{type:"default",iconRight:(0,Z.jsx)(es.Z,{}),children:"Insert source"})}),(0,Z.jsx)(W.AW,{side:"bottom",align:"start",children:p.sort((e,t)=>e.localeCompare(t)).map(e=>(0,Z.jsx)(W.Xi,{onClick:()=>a(e),children:(0,Z.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,Z.jsx)("span",{className:"font-mono font-bold",children:e}),(0,Z.jsx)("span",{className:"text-foreground-light",children:n.tZ[e]})]})},e))})]}),(0,Z.jsxs)(W.h_,{children:[(0,Z.jsx)(W.$F,{asChild:!0,children:(0,Z.jsx)(F.z,{type:"default",iconRight:(0,Z.jsx)(es.Z,{}),children:"Templates"})}),(0,Z.jsx)(W.AW,{side:"bottom",align:"start",children:t.sort((e,t)=>e.label.localeCompare(t.label)).map(e=>(0,Z.jsx)(W.Xi,{onClick:()=>s(e),children:(0,Z.jsx)("p",{children:e.label})},e.label))})]}),(0,Z.jsx)(eg.Z,{to:o,from:l,onChange:i,helpers:n.up}),(0,Z.jsx)("div",{className:"overflow-hidden",children:(0,Z.jsx)("div",{className:" transition-all duration-300 ".concat(c.length>0?"opacity-100":"invisible h-0 w-0 opacity-0"),children:(0,Z.jsx)(er.Z,{overlay:(0,Z.jsx)(en.b,{variant:"warning",title:"",children:(0,Z.jsx)("div",{className:"flex flex-col gap-3",children:c.map((e,t)=>(0,Z.jsxs)("p",{children:[e.text," ",e.link&&(0,Z.jsx)(ep(),{href:e.link,children:e.linkText||"View"})]},t))})}),children:(0,Z.jsxs)(ea.C,{variant:"warning",children:[c.length," ",c.length>1?"warnings":"warning"]})})})})]}),(0,Z.jsx)("div",{children:(0,Z.jsx)("div",{className:"flex items-center gap-4",children:(0,Z.jsx)("div",{className:"flex items-center gap-2",children:(0,Z.jsxs)(el.ZP,{size:"large",header:(0,Z.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,Z.jsx)("h3",{children:"Field Reference"}),(0,Z.jsx)(F.z,{type:"text",className:"px-1",onClick:()=>u(!1),icon:(0,Z.jsx)(eo.Z,{size:18,strokeWidth:1.5})})]}),visible:d,cancelText:"Close",onCancel:()=>u(!1),hideFooter:!0,triggerElement:(0,Z.jsx)(F.z,{asChild:!0,type:"default",onClick:()=>u(!0),icon:(0,Z.jsx)(ei.Z,{strokeWidth:1.5}),children:(0,Z.jsx)("span",{children:"Field Reference"})}),children:[(0,Z.jsx)(el.ZP.Content,{children:(0,Z.jsx)("div",{className:"pt-4 pb-2 space-y-1",children:(0,Z.jsxs)("p",{className:"text-sm",children:["The following table shows all the available paths that can be queried from each respective source. Do note that to access nested keys, you would need to perform the necessary"," ",(0,Z.jsxs)(ep(),{href:"https://supabase.com/docs/guides/platform/logs#unnesting-arrays",target:"_blank",rel:"noreferrer",className:"text-brand",children:["unnesting joins",(0,Z.jsx)(ec.Z,{size:"tiny",className:"ml-1 inline -translate-y-[2px]",strokeWidth:1.5})]})]})})}),(0,Z.jsx)(el.ZP.Separator,{}),(0,Z.jsx)(ed.Z,{scrollable:!0,size:"small",type:"underlined",defaultActiveId:"edge_logs",listClassNames:"px-2",children:ef._S.schemas.map(e=>(0,Z.jsx)(ed.Z.Panel,{id:e.reference,label:e.name,className:"px-4 pb-4",children:(0,Z.jsx)(q.Z,{head:[(0,Z.jsx)(q.Z.th,{className:"text-xs !p-2",children:"Path"},"path"),(0,Z.jsx)(q.Z.th,{className:"text-xs !p-2",children:"Type"},"type")],body:e.fields.sort((e,t)=>e.path-t.path).map(e=>(0,Z.jsx)(ej,{field:e},e.path))})},e.reference))})]})})})})]})})})},ey=s(59491),eN=s(47370),e_=s(54383),ew=s(23418),eS=s(26815),ek=s(57394),eC=s(10621),eE=s(74067),eT=s(79394);let eO=e=>(0,Z.jsxs)(Q.VK,{children:[(0,Z.jsx)(Q.io,{value:e.row.timestamp}),(0,Z.jsx)(Q.VG,{className:"w-full",value:e.row.event_message})]});var eR=[{name:"default-preview-first-column",key:"default-preview-first-column",renderCell:eO}];let eH=[{name:"auth-first-column",key:"auth-first-column",renderCell:e=>{var t;return e.row.level?(0,Z.jsxs)(Q.VK,{children:[(0,Z.jsx)(Q.io,{value:e.row.timestamp}),e.row.level&&(0,Z.jsx)(Q.TK,{value:e.row.level}),(0,Z.jsx)(Q.VG,{className:"w-full",value:"".concat(e.row.path?e.row.path+" | ":"").concat((null===(t=e.row.msg)||void 0===t?void 0:t.trim())||e.row.event_message)})]}):eO(e)}}],eZ=[{name:"database-api-first-column",key:"database-api-first-column",renderCell:e=>e.row.status_code||e.row.method||e.row.path?(0,Z.jsxs)(Q.VK,{children:[(0,Z.jsx)(Q.io,{value:e.row.timestamp}),(0,Z.jsx)(Q.XA,{row:e,value:e.row.status_code}),(0,Z.jsx)(Q.VG,{className:"w-20",value:e.row.method}),(0,Z.jsx)(Q.VG,{className:"w-full",value:e.row.path})]}):eO(e)}],eI=[{name:"database-postgres-first-column",key:"database-postgres-first-column",renderCell:e=>e.row.error_severity?(0,Z.jsxs)(Q.VK,{children:[(0,Z.jsx)(Q.io,{value:e.row.timestamp}),(0,Z.jsx)(Q.TK,{value:e.row.error_severity}),(0,Z.jsx)(Q.VG,{className:"w-full",value:e.row.event_message})]}):eO(e)}],eA=[{name:"functions-edge-first-column",key:"functions-edge-first-column",renderCell:e=>e.row.status_code||e.row.method?(0,Z.jsxs)(Q.VK,{children:[(0,Z.jsx)(Q.io,{value:e.row.timestamp}),(0,Z.jsx)(Q.XA,{row:e,value:e.row.status_code}),(0,Z.jsx)(Q.VG,{value:e.row.method}),(0,Z.jsx)(Q.VG,{value:e.row.id})]}):eO(e)}],eM=[{name:"functions-logs-first-column",key:"functions-logs-first-column",renderCell:e=>e.row.event_type||e.row.level?(0,Z.jsxs)(Q.VK,{children:[(0,Z.jsx)(Q.io,{value:e.row.timestamp}),"uncaughtException"===e.row.event_type?(0,Z.jsx)(Q.TK,{value:e.row.event_type,uppercase:!1}):(0,Z.jsx)(Q.TK,{value:e.row.level}),(0,Z.jsx)(Q.VG,{className:"w-full",value:e.row.event_message})]}):eO(e)}];var eq=s(89828),eP=s(58898),eL=s(25733),eD=s(99248),eF=s(88354),ez=s(36492),eW=function(e,t,s,r){let a=t?n.ae[t]:void 0,l=r&&a?_(a,r):"",o={...s,project:e,sql:l},i="".concat(eD.T5,"/projects/").concat(e,"/analytics/endpoints/logs.all?").concat((0,n.GT)(o)),c=!!(r&&a&&"warehouse"!==t),{data:d,error:u,isLoading:m,isRefetching:h,refetch:x}=(0,ez.a)(["projects",e,"log",r],e=>{let{signal:t}=e;return(0,eF.U2)(i,{signal:t})},{enabled:c,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}),p=u?u.message:null;return{logData:(null==d?void 0:d.result)?d.result[0]:void 0,isLoading:c&&m||h,error:p,refresh:()=>x()}},eY=e=>{var t,s,r,a,l,o,i,c,d,u,m;let{log:h}=e;return(0,Z.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding," space-y-6"),children:[(0,Z.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,Z.jsx)("h3",{className:"text-foreground-lighter text-sm",children:"Event Message"}),(0,Z.jsx)("div",{className:"text-xs text-wrap font-mono text-foreground whitespace-pre-wrap overflow-x-auto",children:(null===(t=h.metadata)||void 0===t?void 0:t.msg)||h.event_message})]}),(0,Z.jsx)(Q.tS,{value:h.timestamp}),(null===(s=h.metadata)||void 0===s?void 0:s.status)&&(0,Z.jsx)(Q.Yj,{label:"Status",value:String(null===(r=h.metadata)||void 0===r?void 0:r.status),valueRender:(0,Z.jsx)(Q.XA,{value:null===(a=h.metadata)||void 0===a?void 0:a.status})}),(null===(l=h.metadata)||void 0===l?void 0:l.level)&&(0,Z.jsx)(Q.Yj,{label:"Severity",value:null===(o=h.metadata)||void 0===o?void 0:o.level,valueRender:(0,Z.jsx)(Q.TK,{value:null===(i=h.metadata)||void 0===i?void 0:i.level})}),(null===(c=h.metadata)||void 0===c?void 0:c.path)&&(0,Z.jsx)(Q.Yj,{label:"Request Path",value:null===(d=h.metadata)||void 0===d?void 0:d.path}),(null===(u=h.metadata)||void 0===u?void 0:u.error)&&(0,Z.jsx)(Q.Yj,{label:"Error Message",value:null===(m=h.metadata)||void 0===m?void 0:m.error}),(0,Z.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,Z.jsx)("h3",{className:"text-foreground-lighter text-sm",children:"Metadata"}),(0,Z.jsx)("pre",{className:" className={`text-foreground text-sm col-span-8 overflow-x-auto text-xs font-mono`}",dangerouslySetInnerHTML:{__html:(0,Q.wv)(h.metadata)}})]})]})},eG=()=>(0,Z.jsx)("div",{className:"h-px w-full bg-panel-border-interior-light [[data-theme*=dark]_&]:bg-panel-border-interior-dark"}),eU=e=>{var t,s,r,a,l,o,i,c,d,u,m,h,x;let{log:p}=e,g=null==p?void 0:null===(s=p.metadata[0])||void 0===s?void 0:null===(t=s.request)||void 0===t?void 0:t[0],f=null==p?void 0:null===(a=p.metadata[0])||void 0===a?void 0:null===(r=a.response)||void 0===r?void 0:r[0],v=null==g?void 0:g.method,j=null==f?void 0:f.status_code,b=null==g?void 0:null===(o=g.headers)||void 0===o?void 0:null===(l=o[0])||void 0===l?void 0:l.cf_connecting_ip,y=null==g?void 0:null===(c=g.headers)||void 0===c?void 0:null===(i=c[0])||void 0===i?void 0:i.cf_ipcountry,N=null==g?void 0:null===(u=g.headers)||void 0===u?void 0:null===(d=u[0])||void 0===d?void 0:d.x_client_info,_=null==g?void 0:null===(h=g.headers)||void 0===h?void 0:null===(m=h[0])||void 0===m?void 0:m.referer,w=null==p?void 0:null===(x=p.metadata[0])||void 0===x?void 0:x.load_balancer_redirect_identifier;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding," space-y-2"),children:[(0,Z.jsx)(Q.Yj,{label:"Status",value:j,valueRender:(0,Z.jsx)(Q.XA,{value:j})}),(0,Z.jsx)(Q.Yj,{label:"Method",value:v}),(0,Z.jsx)(Q.tS,{value:p.timestamp}),(0,Z.jsx)(Q.Yj,{label:"IP Address",value:b}),(0,Z.jsx)(Q.Yj,{label:"Origin Country",value:y}),N&&(0,Z.jsx)(Q.Yj,{label:"Client",value:N}),_&&(0,Z.jsx)(Q.Yj,{label:"Referer",value:_}),w&&(0,Z.jsx)(Q.Yj,{label:"Redirect Identifier",value:w})]}),(0,Z.jsx)(eG,{}),(0,Z.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding),children:[(0,Z.jsx)("h3",{className:"text-lg text-foreground mb-4",children:"Request Metadata"}),(0,Z.jsx)("pre",{className:"text-sm syntax-highlight overflow-x-auto",children:(0,Z.jsx)("div",{className:"text-wrap",dangerouslySetInnerHTML:{__html:g?(0,Q.wv)(p.metadata[0].request[0]):""}})})]}),(0,Z.jsx)(eG,{}),(0,Z.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding),children:[(0,Z.jsx)("h3",{className:"text-lg text-foreground mb-4",children:"Response Metadata"}),(0,Z.jsx)("pre",{className:"text-sm syntax-highlight overflow-x-auto",children:(0,Z.jsx)("div",{dangerouslySetInnerHTML:{__html:f?(0,Q.wv)(p.metadata[0].response[0]):""}})})]})]})},eV=e=>{var t,s,r,a,l,o,i,c;let{log:d}=e,u=null==d?void 0:null===(s=d.metadata[0])||void 0===s?void 0:null===(t=s.parsed[0])||void 0===t?void 0:t.user_name,m=null==d?void 0:null===(a=d.metadata[0])||void 0===a?void 0:null===(r=a.parsed[0])||void 0===r?void 0:r.session_id,h=null==d?void 0:null===(o=d.metadata[0])||void 0===o?void 0:null===(l=o.parsed[0])||void 0===l?void 0:l.hint,x=null==d?void 0:null===(c=d.metadata[0])||void 0===c?void 0:null===(i=c.parsed[0])||void 0===i?void 0:i.error_severity;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:n.W.log_selection_x_padding,children:[(0,Z.jsx)("span",{className:"col-span-4 text-sm text-foreground-lighter",children:"Event message"}),(0,Z.jsx)("div",{className:"text-wrap mt-2 overflow-x-auto whitespace-pre-wrap font-mono  text-xs text-foreground",children:d.event_message})]}),(0,Z.jsx)(eG,{}),(0,Z.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding," space-y-2"),children:[(0,Z.jsx)(Q.Yj,{label:"Severity",value:x,valueRender:(0,Z.jsx)(Q.TK,{value:x})}),(0,Z.jsx)(Q.tS,{value:d.timestamp}),(0,Z.jsx)(Q.Yj,{label:"Postgres Username",value:u}),(0,Z.jsx)(Q.Yj,{label:"Session ID",value:m})]}),h&&(0,Z.jsx)("div",{className:"mt-4 ".concat(n.W.log_selection_x_padding),children:(0,Z.jsx)(en.b,{variant:"warning",withIcon:!0,title:h})}),(0,Z.jsx)(eG,{}),(0,Z.jsxs)("div",{className:n.W.log_selection_x_padding,children:[(0,Z.jsx)("h3",{className:"mb-4 text-lg text-foreground",children:"Metadata"}),(0,Z.jsx)("pre",{className:"syntax-highlight overflow-x-auto text-sm",children:(0,Z.jsx)("div",{className:"text-wrap",dangerouslySetInnerHTML:{__html:d.metadata?(0,Q.wv)(d.metadata[0]):""}})})]})]})},eX=e=>{let{log:t}=e,s=e=>{let{label:t,value:s,code:r}=e;return(0,Z.jsxs)("div",{className:"grid grid-cols-12",children:[(0,Z.jsx)("span",{className:"text-foreground-lighter text-sm col-span-3",children:t}),(0,Z.jsx)("span",{className:"text-foreground text-sm col-span-9 overflow-x-auto ".concat(r&&"text-xs font-mono"),children:(0,Z.jsx)("pre",{dangerouslySetInnerHTML:{__html:(0,Q.wv)(s)}})})]})};return(0,Z.jsx)("div",{className:"overflow-hidden overflow-x-auto space-y-6",children:Object.entries(t).map((e,t)=>{let[r,a]=e;return(0,Z.jsx)("div",{className:"".concat(n.W.log_selection_x_padding),children:a&&"object"==typeof a?(0,Z.jsx)(s,{label:r,value:a}):(0,Z.jsx)(Q.Yj,{label:r,value:null===a?"NULL ":String(a)})},"".concat(r,"-").concat(t))})})},eK=e=>{let{log:t}=e;return(0,Z.jsxs)("div",{className:"space-y-6 py-4 px-5",children:[(null==t?void 0:t.timestamp)&&(0,Z.jsx)(Q.tS,{value:t.timestamp}),(0,Z.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,Z.jsx)("h3",{className:"text-foreground-lighter text-sm",children:"Event Message"}),(null==t?void 0:t.event_message)&&(0,Z.jsx)(eP.d,{className:"prose dark:prose-dark max-w-full",hideLineNumbers:!0,value:JSON.stringify(null==t?void 0:t.event_message)})]}),(0,Z.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,Z.jsx)("h3",{className:"text-foreground-lighter text-sm",children:"Metadata"}),(0,Z.jsx)(eP.d,{hideLineNumbers:!0,value:JSON.stringify(null==t?void 0:t.metadata,null,2)||"",language:"json",className:(0,e_.cn)("max-w-full","!py-3 !px-3.5 prose dark:prose-dark transition","[&>code]:m-0 [&>code>span]:flex [&>code>span]:flex-wrap")})]})]})};function eJ(e){return Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return!["host","url"].includes(t)}).map(e=>{let[t,s]=e;return"headers"===t?[t,s.map(e=>Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return!t.startsWith("_")})))]:[t,s]}))}var eB=e=>{var t,s,r;let{log:a}=e,l=null===(t=a.metadata)||void 0===t?void 0:t[0],o=null==l?void 0:null===(s=l.request)||void 0===s?void 0:s[0],i=null==l?void 0:null===(r=l.response)||void 0===r?void 0:r[0],c=null==o?void 0:o.method,d=null==i?void 0:i.status_code,u=(null==o?void 0:o.url)!==void 0?new URL(null==o?void 0:o.url):void 0,m=l.execution_time_ms,h=l.deployment_id;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding," space-y-2"),children:[(0,Z.jsx)(Q.Yj,{label:"Status",value:d,valueRender:(0,Z.jsx)(Q.XA,{value:d})}),(0,Z.jsx)(Q.Yj,{label:"Method",value:c}),(0,Z.jsx)(Q.tS,{value:a.timestamp}),(0,Z.jsx)(Q.Yj,{label:"Execution Time",value:"".concat(m,"ms")}),(0,Z.jsx)(Q.Yj,{label:"Deployment ID",value:h}),(0,Z.jsx)(Q.Yj,{label:"Log ID",value:a.id}),void 0!==u&&(0,Z.jsx)(Q.Yj,{label:"Request Path",value:u.pathname+u.search})]}),(0,Z.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding),children:[(0,Z.jsx)("h3",{className:"text-lg text-foreground mb-4",children:"Request Metadata"}),(0,Z.jsx)("pre",{className:"text-sm syntax-highlight overflow-x-auto",children:(0,Z.jsx)("div",{className:"text-wrap",dangerouslySetInnerHTML:{__html:o?(0,Q.wv)(eJ(o)):""}})})]}),(0,Z.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding),children:[(0,Z.jsx)("h3",{className:"text-lg text-foreground mb-4",children:"Response Metadata"}),(0,Z.jsx)("pre",{className:"text-sm syntax-highlight overflow-x-auto",children:(0,Z.jsx)("div",{dangerouslySetInnerHTML:{__html:i?(0,Q.wv)(eJ(i)):""}})})]})]})},e$=e=>{let{log:t}=e,s=t.metadata[0];return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding),children:[(0,Z.jsx)("span",{className:"text-foreground-lighter text-sm col-span-4",children:"Event message"}),(0,Z.jsx)("div",{className:"text-xs text-wrap font-mono text-foreground mt-2 whitespace-pre-wrap overflow-x-auto",children:t.event_message})]}),(0,Z.jsx)("div",{className:"h-px w-full bg-panel-border-interior-light [[data-theme*=dark]_&]:bg-panel-border-interior-dark"}),(0,Z.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding," space-y-2"),children:[(0,Z.jsx)(Q.Yj,{label:"Severity",value:s.level,valueRender:(0,Z.jsx)(Q.TK,{value:s.level})}),(0,Z.jsx)(Q.Yj,{label:"Deployment version",value:s.version}),(0,Z.jsx)(Q.tS,{value:t.timestamp}),(0,Z.jsx)(Q.Yj,{label:"Execution ID",value:s.execution_id}),(0,Z.jsx)(Q.Yj,{label:"Deployment ID",value:s.deployment_id})]}),(0,Z.jsxs)("div",{className:"".concat(n.W.log_selection_x_padding),children:[(0,Z.jsx)("h3",{className:"text-lg text-foreground mb-4",children:"Metadata"}),(0,Z.jsx)("pre",{className:"text-sm syntax-highlight overflow-x-auto",children:(0,Z.jsx)("div",{className:"text-wrap",dangerouslySetInnerHTML:{__html:s?(0,Q.wv)(s):""}})})]})]})},eQ=s(60795),e0=s(8609),e2=s(62112),e1=e=>{let{projectRef:t,log:s,onClose:n,queryType:a,params:l={},collectionName:o}=e,{logData:i,isLoading:c}=eW(t,a,l,null==s?void 0:s.id),[d,u]=(0,r.useState)(""),{refetch:m,data:h,isFetching:x}=(0,e2._)({ref:t,sql:d},{enabled:"warehouse"===a,onError:e=>{A.ZP.error(e.message)}});return(0,r.useEffect)(()=>{u("select id, timestamp, event_message, metadata from `".concat(o,"`\n    where id = '").concat(null==s?void 0:s.id,"' and timestamp > '2024-01-01' limit 1"))},[o,null==s?void 0:s.id]),(0,r.useEffect)(()=>{"warehouse"===a&&m()},[h,o,t,null==s?void 0:s.id,m,a]),(0,r.useMemo)(()=>i&&a?"Log ID\n  ".concat(i.id,"\n\n  Log Timestamp (UTC)\n  ").concat(f(i.timestamp)?g(i.timestamp):i.timestamp,"\n\n  Log Event Message\n  ").concat(i.event_message,"\n\n  Log Metadata\n  ").concat(JSON.stringify(i.metadata,null,2),"\n  "):JSON.stringify(i||s,null,2),[i,s,a]),(0,Z.jsxs)("div",{className:(0,e_.cn)("relative flex h-full flex-grow flex-col border border-l border-overlay","overflow-y-scroll bg-studio"),children:[(0,Z.jsx)("div",{className:(0,e_.cn)("absolute flex h-full w-full flex-col items-center justify-center gap-2 overflow-y-scroll bg-studio text-center opacity-0 transition-all",{"z-0 opacity-0":s,"z-10 opacity-100":!s}),children:(0,Z.jsxs)("div",{className:"flex\n          w-full\n          max-w-sm\n          scale-95\n          flex-col\n          items-center\n          justify-center\n          gap-6\n          text-center\n          opacity-0\n          transition-all delay-300 duration-500 "+(s||c?"mt-0 scale-95 opacity-0":"mt-8 scale-100 opacity-100"),children:[(0,Z.jsxs)("div",{className:"relative flex h-4 w-32 items-center rounded border border-control px-2",children:[(0,Z.jsx)("div",{className:"h-0.5 w-2/3 rounded-full bg-surface-300"}),(0,Z.jsx)("div",{className:"absolute right-1 -bottom-4",children:(0,Z.jsx)(eQ.Z,{size:"24",strokeWidth:1})})]}),(0,Z.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,Z.jsx)("h3",{className:"text-sm text-foreground",children:"Select an Event"}),(0,Z.jsx)("p",{className:"text-xs text-foreground-lighter",children:"warehouse"===a?"Select an Event to view the complete JSON payload":"Select an Event to view the code snippet (pretty view) or complete JSON payload (raw view)."})]})]})}),(0,Z.jsx)("div",{className:"relative flex-grow flex flex-col bg-surface-100",children:(0,Z.jsxs)(eq.mQ,{defaultValue:"details",className:"flex flex-col",children:[(0,Z.jsxs)(eq.dr,{className:"px-2 pt-2",children:[(0,Z.jsx)(eq.SP,{className:"px-3",value:"details",children:"Details"}),(0,Z.jsx)(eq.SP,{className:"px-3",value:"raw",children:"Raw"}),(0,Z.jsx)(F.z,{type:"text",className:"ml-auto absolute top-2 right-2 cursor-pointer transition hover:text-foreground h-6 w-6 px-0 py-0 flex items-center justify-center",onClick:n,children:(0,Z.jsx)(e0.Z,{size:14,strokeWidth:2,className:"text-foreground-lighter"})})]}),(0,Z.jsx)("div",{className:"flex-grow",children:c||x?(0,Z.jsx)("div",{className:"py-44",children:(0,Z.jsx)(eL.Z,{})}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(eq.nU,{className:"bg-surface-100 space-y-6",value:"details",children:(0,Z.jsx)(()=>{switch(a){case"warehouse":if(!h)return null;return(0,Z.jsx)(eK,{log:h.result[0]});case"api":if(!i)return null;if(!i.metadata)return(0,Z.jsx)(eK,{log:i});return(0,Z.jsx)(eU,{log:i});case"database":if(!i)return null;if(!i.metadata)return(0,Z.jsx)(eK,{log:i});return(0,Z.jsx)(eV,{log:i});case"fn_edge":if(!i)return null;if(!i.metadata)return(0,Z.jsx)(eK,{log:i});return(0,Z.jsx)(eB,{log:i});case"functions":if(!i)return null;if(!i.metadata)return(0,Z.jsx)(eK,{log:i});return(0,Z.jsx)(e$,{log:i});case"auth":if(!i)return null;if(!i.metadata)return(0,Z.jsx)(eK,{log:i});return(0,Z.jsx)(eY,{log:i});default:if(a&&i&&v(i))return(0,Z.jsx)(eK,{log:i});if(a&&!i||!s)return null;return(0,Z.jsx)(eX,{log:s})}},{})}),(0,Z.jsx)(eq.nU,{value:"raw",className:"px-4",children:(0,Z.jsx)(eP.d,{language:"json",className:"prose w-full max-w-full",children:JSON.stringify(i||s,null,2)})})]})})]})})]})},e4=e=>{let{error:t}=e;return(0,Z.jsx)(B.Z.TextArea,{size:"tiny",value:"string"==typeof t?t:JSON.stringify(t,null,2),borderless:!0,className:"mt-4 w-full font-mono",copy:!0,rows:7})},e3=s(99176),e5=s(46318);let e9=(0,r.createContext)({chevronAlign:"left",justified:!0,type:"default"});function e7(e){let{children:t,className:s,onChange:r,openBehaviour:n="multiple",type:a="default",defaultValue:l,justified:o=!1,chevronAlign:i="left"}=e,c=[(0,e5.Z)("accordion").variants[a].base];return s&&c.push(s),(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(e3.fC,{type:n,onValueChange:function(e){r&&r(e),e==typeof String&&e.split(" ")},defaultValue:l,className:c.join(" "),children:(0,Z.jsx)(e9.Provider,{value:{chevronAlign:i,justified:o,type:a,defaultValue:l},children:(0,Z.jsx)("div",{children:t})})})})}e7.Item=function(e){let{children:t,className:s,header:n,id:a,disabled:l}=e,o=(0,e5.Z)("accordion"),[i,c]=(0,r.useState)(!1),{type:d,justified:u,chevronAlign:m}=(0,r.useContext)(e9),h=[o.variants[d].trigger];u&&h.push(o.justified),s&&h.push(s);let x=[o.chevron.base,o.chevron.align[m]];return i&&!l&&x.unshift("!rotate-180"),(0,Z.jsxs)(e3.ck,{value:a,className:o.variants[d].container,disabled:l,onClick:()=>{c(!i)},children:[(0,Z.jsxs)(e3.xz,{className:h.join(" "),children:[n,!l&&(0,Z.jsx)(es.Z,{"aria-hidden":!0,className:x.join(" "),strokeWidth:2})]}),(0,Z.jsx)(e3.VY,{className:o.variants[d].content,children:(0,Z.jsx)("div",{className:o.variants[d].panel,children:t})})]})};var e8=e=>{let{error:t,isCustomQuery:s}=e;return(0,Z.jsxs)("div",{className:"flex flex-col gap-2 text-foreground-light",children:[(0,Z.jsxs)("div",{className:"flex flex-col gap-1 text-sm",children:[(0,Z.jsx)("p",{children:"This query requires too much memory to be executed."}),(0,Z.jsx)("p",{children:s?"Avoid selecting entire objects and instead select specific keys using dot notation.":"Avoid querying across a large datetime range."}),!s&&(0,Z.jsx)("p",{children:"Please contact support if this error persists."})]}),(0,Z.jsx)(e7,{className:"text-sm",justified:!1,openBehaviour:"multiple",type:"default",chevronAlign:"left",size:"small",iconPosition:"left",children:(0,Z.jsx)(e7.Item,{id:"1",header:"Full error message",children:(0,Z.jsx)(B.Z.TextArea,{size:"tiny",value:JSON.stringify(t,null,2),borderless:!0,className:"mt-4 w-full font-mono",copy:!0,rows:5})})})]})},e6=e=>{let{data:t=[],queryType:s,onHistogramToggle:n,isHistogramShowing:a,isLoading:l,error:o,projectRef:i,params:c,onRun:d,onSave:m,hasEditorValue:h,maxHeight:x,className:p,hideHeader:g=!1,collectionName:f,emptyState:j}=e,[b,y]=(0,r.useState)(null),N=null==t?void 0:t[0],{profile:_}=(0,eE.Un)(),w=(0,eh.Xo)(ey.KA.CREATE,"user_content",{resource:{type:"log_sql",owner_id:null==_?void 0:_.id},subject:{id:null==_?void 0:_.id}}),S=Object.keys(function(){if(!N)return{};let{timestamp:e,...t}=N||{};return e?{timestamp:e,...t}:N}()||{}),k=S.includes("id"),C=S.includes("timestamp"),E=S.map((e,t)=>({key:"logs-column-".concat(t),name:e,resizable:!0,renderCell:t=>{var s;let r=null===(s=t.row)||void 0===s?void 0:s[e];return r&&"object"==typeof r?JSON.stringify(r):null===r?"NULL":String(r)},renderHeaderCell:t=>(0,Z.jsx)("div",{className:"flex items-center",children:e}),minWidth:128,maxWidth:"timestamp"===e?240:2400})),T=E;if(s)switch(s){case"warehouse":T=E;break;case"api":T=eZ;break;case"database":T=eI;break;case"fn_edge":T=eA;break;case"functions":T=eM;break;case"auth":T=eH;break;default:T=N&&v(N)?eR:E}let O=JSON.stringify(t),[R,H]=(0,r.useMemo)(()=>{let e=[...new Set(t)];if(!k)return[e,{}];let s=e.reduce((e,t)=>(e[t.id]=t,e),{});return[e,s]},[t,k]);(0,r.useEffect)(()=>{t&&(t.find(e=>u()(e,b))||y(null))},[t,b,O]);let I=(0,r.useMemo)(()=>k&&C?Object.values(H).sort((e,t)=>t.timestamp-e.timestamp):R,[R,k,C,H]),q=(0,r.useCallback)((e,t)=>(0,Z.jsx)(eN.X2,{...t,isRowSelected:!1,selectedCellIdx:void 0},e),[]),P=()=>{(0,ev.vQ)(O,()=>{A.ZP.success("Results copied to clipboard")})},L=(0,r.useRef)(null);function D(){var e;null===(e=L.current)||void 0===e||e.click()}return t?(0,Z.jsxs)("section",{className:"flex flex-grow w-full max-h-screen flex-col h-full",style:{maxHeight:x},children:[!s&&(0,Z.jsx)(()=>(0,Z.jsxs)("div",{className:(0,e_.cn)("flex w-full items-center justify-between border-t  bg-surface-100 px-5 py-2",p,{hidden:g}),children:[(0,Z.jsx)("div",{className:"flex items-center gap-2",children:(0,Z.jsxs)(W.h_,{children:[(0,Z.jsx)(W.$F,{asChild:!0,children:(0,Z.jsxs)(F.z,{type:"text",iconRight:(0,Z.jsx)(es.Z,{}),children:["Results ",t&&t.length?"(".concat(t.length,")"):""]})}),(0,Z.jsxs)(W.AW,{align:"start",children:[(0,Z.jsxs)(W.Xi,{onClick:D,className:"space-x-2",children:[(0,Z.jsx)(ew.Z,{size:"tiny"}),(0,Z.jsx)("div",{children:"Download CSV"})]}),(0,Z.jsxs)(W.Xi,{onClick:P,className:"space-x-2",children:[(0,Z.jsx)(em.Z,{size:"tiny"}),(0,Z.jsx)("div",{children:"Copy to clipboard"})]})]})]})}),(0,Z.jsx)("div",{className:"hidden",children:(0,Z.jsx)(eC.Z,{buttonType:"text",data:t,children:(0,Z.jsx)("div",{ref:L,children:"Download CSV"})})}),(0,Z.jsx)("div",{className:"flex items-center gap-2",children:(0,Z.jsx)(F.z,{type:"default",icon:a?(0,Z.jsx)(eS.Z,{}):(0,Z.jsx)(ek.Z,{}),onClick:n,children:"Histogram"})}),(0,Z.jsxs)("div",{className:"space-x-2",children:[M.Qy&&(0,Z.jsxs)(et.fC,{delayDuration:0,children:[(0,Z.jsx)(et.xz,{asChild:!0,children:(0,Z.jsx)(F.z,{type:"default",onClick:m,disabled:!w||!h,children:"Save query"})}),!w&&(0,Z.jsx)(et.h_,{children:(0,Z.jsxs)(et.VY,{side:"bottom",children:[(0,Z.jsx)(et.Eh,{className:"radix-tooltip-arrow"}),(0,Z.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,Z.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to save your query"})})]})})]}),(0,Z.jsx)(F.z,{title:"run-logs-query",type:h?"primary":"alternative",disabled:!h,onClick:d,iconRight:(0,Z.jsx)(eT.Z,{size:12}),loading:l,children:"Run"})]})]}),{}),(0,Z.jsxs)("div",{className:"flex h-full flex-row ".concat(s?"":"border-x"),children:[(0,Z.jsx)(eN.ZP,{role:"table",style:{height:"100%"},className:"\n            flex-1 flex-grow h-full\n            ".concat(s?" data-grid--simple-logs":"data-grid--logs-explorer","\n          "),rowHeight:40,headerRowHeight:s?0:28,onSelectedCellChange:e=>{let{rowIdx:s}=e;k&&y(t[s])},selectedRows:new Set([]),columns:T,rowClass:e=>["font-mono tracking-tight",u()(e,b)?"!bg-border-stronger rdg-row--focused":" !bg-studio hover:!bg-surface-100 cursor-pointer"].join(" "),rows:I,rowKeyGetter:e=>k?e.id:JSON.stringify(e),renderers:{renderRow:q,noRowsFallback:l?null:(0,Z.jsxs)("div",{className:"mx-auto flex h-full w-full items-center justify-center space-y-12 py-4 transition-all delay-200 duration-500",children:[!o&&(j||(0,Z.jsxs)("div",{className:"flex scale-100 flex-col items-center justify-center gap-6 text-center opacity-100",children:[(0,Z.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,Z.jsx)("div",{className:"relative flex h-4 w-32 items-center rounded border border-dashed border-stronger px-2"}),(0,Z.jsx)("div",{className:"relative flex h-4 w-32 items-center rounded border border-dashed border-stronger px-2"})]}),(0,Z.jsxs)("div",{className:"flex flex-col gap-1 px-5",children:[(0,Z.jsx)("h3",{className:"text-lg text-foreground",children:"No results found"}),(0,Z.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Try another search or adjust the filters"})]})]})),o&&(()=>{var e;if(!o)return null;let t=e4;return"object"==typeof o&&(null===(e=o.error)||void 0===e?void 0:e.errors.find(e=>"resourcesExceeded"===e.reason))&&(t=e8),(0,Z.jsx)("div",{className:"flex w-1/2 justify-center px-5",children:(0,Z.jsx)(en.b,{variant:"danger",title:"Sorry! An error occurred when fetching data.",withIcon:!0,children:(0,Z.jsx)(t,{isCustomQuery:!s,error:o})})})})()]})}}),I.length>0?(0,Z.jsx)("div",{className:s?"flex w-1/2 flex-col":b?"flex w-1/2 flex-col":"hidden w-0",children:(0,Z.jsx)(e1,{projectRef:i,onClose:()=>y(null),log:b,queryType:s,params:c,collectionName:f})}):null]})]}):null},te=s(79735),tt=e=>{let{data:t,onBarClick:s}=e;return(0,Z.jsx)(te.Z,{minimalHeader:!0,size:"tiny",yAxisKey:"count",xAxisKey:"timestamp",data:t,title:"Logs / Time",onBarClick:e=>{e.timestamp&&s(e.timestamp)},customDateFormat:"MMM D, HH:mm:s"})}},10621:function(e,t,s){var r=s(52322),n=s(2784),a=s(83606),l=s(2322),o=s(32079),i=s(23418);t.Z=e=>{let{onClick:t,buttonType:s="default",icon:c,children:d,disabled:u,data:m,title:h}=e,x=(0,n.useRef)(null),p=()=>{var e;null===(e=x.current)||void 0===e||e.link.click()},g=(0,n.useMemo)(()=>{let e=null==m?void 0:m[0];if(!e||!m)return;let t=Object.keys(e);return m.map(e=>t.reduce((t,s)=>("object"==typeof e[s]?t[s]=JSON.stringify(e[s]):t[s]=String(e[s]),t),{}))},[JSON.stringify(m)]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.CSVLink,{ref:x,className:"hidden",data:g||[],filename:"supabase_logs.csv",title:h}),(0,r.jsxs)(l.u,{delayDuration:100,children:[(0,r.jsx)(l.aJ,{asChild:!0,children:(0,r.jsx)(o.z,{type:s,icon:c||(0,r.jsx)(i.Z,{}),disabled:u,className:"px-1.5",onClick:e=>{t&&t(e),p()},children:d})}),(0,r.jsx)(l._v,{side:"bottom",className:"text-xs",children:"Download logs as CSV"})]})]})}},79735:function(e,t,s){var r=s(52322),n=s(28879),a=s.n(n),l=s(2784),o=s(17699),i=s(52576),c=s(27118),d=s(52406),u=s(8159),m=s(98578),h=s(32854),x=s(51428),p=s(74244),g=s(27029);t.Z=e=>{var t,s,n;let{data:f,yAxisKey:v,xAxisKey:j,format:b,customDateFormat:y=h.EE.FULL,title:N,highlightedValue:_,highlightedLabel:w,displayDateInUtc:S,minimalHeader:k,valuePrecision:C,className:E="",size:T="normal",emptyStateMessage:O,onBarClick:R,showLegend:H=!1,xAxisIsDate:Z=!0}=e,{Container:I}=(0,p.D3)(T),[A,M]=(0,l.useState)(null),q=e=>S?a()(e).utc():a()(e),P=function(){if(!Z){var e;return A?null===(e=f[A])||void 0===e?void 0:e[j]:w}return null!==A&&f&&void 0!==f[A]&&q(f[A][j]).format(y)||w}(),L=null!==A?null===(t=f[A])||void 0===t?void 0:t[v]:_;return 0===f.length?(0,r.jsx)(g.Z,{message:O,description:"It may take up to 24 hours for data to show",size:T,className:E,attribute:N,format:b}):(0,r.jsxs)("div",{className:["flex flex-col gap-3",E].join(" "),children:[(0,r.jsx)(x.Z,{title:N,format:b,customDateFormat:y,highlightedValue:"number"==typeof L?(0,p.V2)(L,C):L,highlightedLabel:P,minimalHeader:k}),(0,r.jsx)(I,{children:(0,r.jsxs)(o.v,{data:f,margin:{top:0,right:0,left:0,bottom:0},className:"overflow-visible",onMouseMove:e=>{e.activeTooltipIndex!==A&&M(e.activeTooltipIndex)},onMouseLeave:()=>M(null),onClick:e=>{var t,s;let r=null==e?void 0:null===(s=e.activePayload)||void 0===s?void 0:null===(t=s[0])||void 0===t?void 0:t.payload;R&&R(r,e)},children:[H&&(0,r.jsx)(i.D,{}),(0,r.jsx)(c.K,{dataKey:j,interval:f.length-2,angle:0,tick:!1,axisLine:{stroke:h.ZE.AXIS},tickLine:{stroke:h.ZE.AXIS}}),(0,r.jsx)(d.u,{content:()=>null}),(0,r.jsx)(u.$,{dataKey:v,fill:h.ZE.GREEN_1,animationDuration:300,maxBarSize:48,children:null==f?void 0:f.map((e,t)=>(0,r.jsx)(m.b,{className:"transition-all duration-300 ".concat(R?"cursor-pointer":""),fill:A===t||null===A?h.ZE.GREEN_1:h.ZE.GREEN_2,enableBackground:12},"cell-".concat(t)))})]})}),f&&(0,r.jsxs)("div",{className:"text-foreground-lighter -mt-9 flex items-center justify-between text-xs",children:[(0,r.jsx)("span",{children:Z?q(f[0][j]).format(y):f[0][j]}),(0,r.jsx)("span",{children:Z?q(null===(s=f[(null==f?void 0:f.length)-1])||void 0===s?void 0:s[j]).format(y):null===(n=f[(null==f?void 0:f.length)-1])||void 0===n?void 0:n[j]})]})]})}},51428:function(e,t,s){var r=s(52322);t.Z=e=>{let{format:t,highlightedValue:s,highlightedLabel:n,title:a,minimalHeader:l=!1}=e,o=(0,r.jsx)("h3",{className:"text-foreground-lighter "+(l?"text-xs":"text-sm"),children:a}),i=(0,r.jsxs)("h5",{className:"text-foreground text-xl font-normal ".concat(l?"text-base":"text-2xl"),children:[void 0!==s&&String(s),"seconds"===t?" ":"",(0,r.jsx)("span",{className:"text-lg",children:"function"==typeof t?t(s):t})]}),c=(0,r.jsx)("h5",{className:"text-foreground-lighter text-xs",children:n});return l?(0,r.jsxs)("div",{className:"flex flex-row items-center gap-x-4",style:{minHeight:"1.8rem"},children:[a&&o,(0,r.jsxs)("div",{className:"flex flex-row items-baseline gap-x-2",children:[void 0!==s&&i,c]})]}):(0,r.jsxs)("div",{className:"h-16",children:[a&&o,void 0!==s&&i,c]})}},32854:function(e,t,s){var r,n;s.d(t,{EE:function(){return r},FK:function(){return l},Ki:function(){return o},ZE:function(){return a}});let a={TICK:"hsl(var(--background-overlay-hover))",AXIS:"hsl(var(--background-overlay-hover))",GREEN_1:"hsl(var(--brand-default))",GREEN_2:"hsl(var(--brand-500))"},l=e=>e.map(e=>{var t;let s=null!==(t=({slate:11})[e])&&void 0!==t?t:9;return{lighter:"var(--colors-".concat(e).concat(s-1,")"),base:"var(--colors-".concat(e).concat(s,")"),darker:"var(--colors-".concat(e).concat(s+1,")")}}),o=["brand","slate","blue","yellow","indigo"];(n=r||(r={})).FULL="MMM D, YYYY, hh:mma",n.DATE_ONLY="MMM D, YYYY"},74244:function(e,t,s){s.d(t,{Bh:function(){return h},D3:function(){return p},Hx:function(){return x},V2:function(){return u},ww:function(){return g}});var r=s(52322),n=s(28879),a=s.n(n),l=s(2784),o=s(80604),i=s(32854),c=s(10264),d=s.n(c);a().extend(d());let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return m(e)?h(e,t):e.toLocaleString()},m=e=>String(e).includes("."),h=(e,t)=>{if(!m(e))return e.toLocaleString()+"."+"0".repeat(t);{let[s,r]=String(e).split(".");return Number(s).toLocaleString()+"."+r.slice(0,t)}},x=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.EE.FULL,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s?a().utc(e).format(t):a()(e).format(t)},p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{tiny:76,small:96,normal:160,large:280},s=t[e];return{Container:(0,l.useMemo)(()=>e=>{let{children:t}=e;return(0,r.jsx)(o.h,{height:s,minHeight:s,width:"100%",children:t})},[e]),minHeight:s}},g=e=>{let{data:t,xAxisKey:s,yAxisKey:r,stackKey:n,variant:a="values"}=e,o=(0,l.useMemo)(()=>t?Object.entries(t.reduce((e,t)=>{let a=t[s],l=t[r],o=t[n];return e[a]||(e[a]={}),e[a][o]=l,e},{})).map(e=>{let[t,r]=e;return{...r,[s]:Number.isNaN(Number(t))?t:Number(t)}}):[],[JSON.stringify(t)]),i=(0,l.useMemo)(()=>Object.keys(o[0]||{}).filter(e=>e!==s&&e!==r).sort(),[JSON.stringify(o[0]||{})]),c=(0,l.useMemo)(()=>{if("percentages"===a)return o.map(e=>{let t=Object.entries(e),s=t.filter(e=>{let[t,s]=e;return i.includes(t)}).reduce((e,t)=>{let[s,r]=t;return e+r},0);return t.reduce((e,t)=>{let[r,n]=t;return i.includes(r)?{...e,[r]:0!==n?n/s:0}:{...e,[r]:n}},{})})},[JSON.stringify(o)]);return{dataKeys:i,stackedData:o,percentagesStackedData:c}}},27029:function(e,t,s){var r=s(52322),n=s(59647),a=s(74244),l=s(51428);t.Z=e=>{let{attribute:t,message:s="No data to show",description:o,format:i,className:c="",size:d}=e,{minHeight:u}=(0,a.D3)(d);return(0,r.jsxs)("div",{children:[void 0!==t&&(0,r.jsx)(l.Z,{title:t,format:i,highlightedValue:0}),(0,r.jsxs)("div",{className:"border-control flex flex-grow w-full flex-col items-center justify-center space-y-2 border border-dashed text-center "+c,style:{minHeight:u+20},children:[(0,r.jsx)(n.Z,{size:20,className:"text-border-stronger"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-foreground-light text-xs",children:s}),o&&(0,r.jsx)("p",{className:"text-foreground-lighter text-xs",children:o})]})]})]})}},57663:function(e,t,s){var r=s(87612);class n{hasNext(){return this.lineNumber>=0||this.offset>=0}isFowardDQuote(){return!!this.hasForward()&&34===this.peekForward()}isNextDQuote(){return!!this.hasNext()&&34===this.peekNext()}isNextPeriod(){return!!this.hasNext()&&46===this.peekNext()}peekNext(){return this.offset<0?this.lineNumber>0?10:0:this._line.charCodeAt(this.offset)}hasForward(){return this.lineNumber<this._lines.length||this.offset<this._line.length}peekForward(){return this.offset===this._line.length?this.lineNumber===this._lines.length?0:10:this._line.charCodeAt(this.offset+1)}next(){if(this.offset<0)return this.lineNumber>0?(this.lineNumber--,this._line=this._lines[this.lineNumber],this.offset=this._line.length-1,10):(this.lineNumber=-1,0);let e=this._line.charCodeAt(this.offset);return this.offset--,e}readArguments(){let e=0,t=0,s=0,r=0;for(;this.hasNext();){let n=this.next();switch(n){case 40:if(--e<0)return r;break;case 41:e++;break;case 123:s--;break;case 125:s++;break;case 91:t--;break;case 93:t++;break;case 34:case 39:for(;this.hasNext()&&n!==this.next(););break;case 44:!e&&!t&&!s&&r++}}return -1}readIdent(){let e=!1,t=!1,s="";for(;this.hasNext();){let r=this.peekNext();if(e&&!t&&!this._isIdentPart(r))break;if(r=this.next(),!e&&t&&34===r){e=!0;continue}if(e||32!==r&&9!==r&&10!=r){if(!e&&(34===r||this._isIdentPart(r)))e=!0,t=34===r,s=String.fromCharCode(r)+s;else if(e){if(t){if(0===r||(s=String.fromCharCode(r)+s,34===r))break}else s=String.fromCharCode(r)+s}}}return s}readIdents(e){let t=[];for(;e>0;){e--;let s=this.readIdent();if(!s||(t.push(s),!this.isNextPeriod()))break}return t.reverse()}_isIdentPart(e){return 95===e||e>=97&&e<=122||e>=65&&e<=90||e>=48&&e<=57}constructor(e,t,s){(0,r._)(this,"_line",void 0),(0,r._)(this,"_text",void 0),(0,r._)(this,"_lines",void 0),(0,r._)(this,"model",void 0),(0,r._)(this,"offset",void 0),(0,r._)(this,"lineNumber",void 0),this.model=e,this.offset=t,this.lineNumber=s,this._text=e.getValue(),this._lines=this._text.split(/\r?\n/g),this._line=this._lines[s]}}t.Z=n},13252:function(e,t,s){s.d(t,{M:function(){return _}});var r=s(52322),n=s(2784),a=s(37726),l=s.n(a),o=s(61786),i=s(32079),c=s(59629),d=s(37952),u=s(52253),m=s(52905),h=s(10012),x=s(29824),p=s(28879),g=s.n(p),f=s(59119),v=e=>{let{type:t,time:s,setTime:a,setStartTime:l,setEndTime:o,startTime:i,endTime:c,startDate:d,endDate:u}=e,[m,h]=(0,n.useState)(!1);function p(){1===s.HH.length&&(s.HH="0"+s.HH),1===s.mm.length&&(s.mm="0"+s.mm),1===s.ss.length&&(s.ss="0"+s.ss),s.HH||(s.HH="00"),s.mm||(s.mm="00"),s.ss||(s.ss="00");let e=!1,r=!1;(0,x.default)(new Date(d),"dd/mm/yyyy")==(0,x.default)(new Date(u),"dd/mm/yyyy")&&("start"===t&&(s.HH&&Number(s.HH)>Number(c.HH)&&(c.HH=s.HH,e=!0),s.HH&&Number(s.HH)>=Number(c.HH)&&s.mm&&Number(s.mm)>Number(c.mm)&&(c.mm=s.mm,e=!0),s.HH&&Number(s.HH)>=Number(c.HH)&&s.mm&&Number(s.mm)>=Number(c.mm)&&s.ss&&Number(s.ss)>Number(c.ss)&&(c.ss=s.ss,e=!0)),"end"===t&&(s.HH&&Number(s.HH)<Number(i.HH)&&(i.HH=s.HH,r=!0),s.HH&&Number(s.HH)<=Number(i.HH)&&s.mm&&Number(s.mm)<Number(i.mm)&&(i.mm=s.mm,r=!0),s.HH&&Number(s.HH)<=Number(i.HH)&&s.mm&&Number(s.mm)<=Number(i.mm)&&s.ss&&Number(s.ss)<Number(i.ss)&&(i.ss=s.ss,r=!0))),a({...s}),e&&o({...c}),r&&l({...i}),h(!1)}function g(e,t){let r={HH:s.HH,mm:s.mm,ss:s.ss};if(!(e.length>2)){switch(t){case"HH":if(e&&Number(e)>23)return;break;case"mm":case"ss":if(e&&Number(e)>59)return}r[t]=e,a({...r})}}let v=e=>{e.target.select(),h(!0)};return(0,n.useEffect)(()=>{p()},[d,u]),(0,r.jsxs)("div",{className:"\n        flex h-7 items-center justify-center\n        gap-0 rounded border border-strong bg-surface-100 text-xs text-foreground-light\n        ".concat(m&&" border-stronger outline outline-2 outline-border","\n    "),children:[(0,r.jsx)("div",{className:"mr-1 text-foreground-lighter",children:(0,r.jsx)(f.Z,{size:14,strokeWidth:1.5})}),(0,r.jsx)("input",{type:"text",onBlur:()=>p(),onFocus:v,pattern:"[0-23]*",placeholder:"00",onChange:e=>g(e.target.value,"HH"),"aria-label":"Hours",className:" ring-none w-4 border-none bg-transparent p-0 text-center text-xs text-foreground outline-none ring-0 focus:ring-0 ",value:s.HH}),(0,r.jsx)("span",{className:"text-foreground-lighter",children:":"}),(0,r.jsx)("input",{type:"text",onBlur:()=>p(),onFocus:v,pattern:"[0-12]*",placeholder:"00",onChange:e=>g(e.target.value,"mm"),"aria-label":"Minutes",className:" ring-none w-4 border-none bg-transparent p-0 text-center text-xs text-foreground outline-none ring-0 focus:ring-0 ",value:s.mm}),(0,r.jsx)("span",{className:"text-foreground-lighter",children:":"}),(0,r.jsx)("input",{type:"text",onBlur:()=>p(),onFocus:v,pattern:"[0-59]*",placeholder:"00",onChange:e=>g(e.target.value,"ss"),"aria-label":"Seconds",className:" ring-none w-4 border-none bg-transparent p-0 text-center text-xs text-foreground outline-none ring-0 focus:ring-0 ",value:s.ss})]})};let j=new Date,b=new Date,y={HH:"00",mm:"00",ss:"00"},N={HH:"23",mm:"59",ss:"59"};var _=function(e){let{to:t,from:s,onChange:a,triggerButtonType:p="default",triggerButtonClassName:f="",triggerButtonTitle:_,minDate:w,maxDate:S,hideTime:k=!1,hideClear:C=!1,selectsRange:E=!0,renderFooter:T=()=>null,children:O}=e,[R,H]=(0,n.useState)(!1),[Z,I]=(0,n.useState)(null),[A,M]=(0,n.useState)(null),[q,P]=(0,n.useState)(j),[L,D]=(0,n.useState)(b),[F,z]=(0,n.useState)(y),[W,Y]=(0,n.useState)(N);return(0,n.useEffect)(()=>{if(s){if(s!==(null==Z?void 0:Z.toISOString())){let e=g()(s),t=e.toDate();I(t),P(t),z({HH:e.format("HH"),mm:e.format("mm"),ss:e.format("ss")})}}else I(null);if(t){if(t!==(null==A?void 0:A.toISOString())){let e=g()(t),s=e.toDate();M(s),D(s),Y({HH:e.format("HH"),mm:e.format("mm"),ss:e.format("ss")})}}else M(null)},[t,s]),(0,r.jsxs)(o.J2,{open:R,onOpenChange:H,children:[(0,r.jsx)(o.xo,{asChild:!0,children:(0,r.jsx)(i.z,{title:_,type:p,icon:(0,r.jsx)(c.Z,{}),className:f,children:void 0!==O?O:(0,r.jsx)(r.Fragment,{children:E&&Z&&A&&Z!==A?(0,r.jsxs)(r.Fragment,{children:[(0,x.default)(new Date(Z),"dd MMM")," -"," ",(0,x.default)(new Date(A),"dd MMM")]}):Z||A?(0,x.default)(new Date(Z||A),"dd MMM"):"Custom"})})}),(0,r.jsx)(o.yk,{align:"center",side:"bottom",className:"p-0",children:(0,r.jsxs)(r.Fragment,{children:[k?null:(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex items-stretch justify-between py-2",children:[E?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex grow flex-col gap-1 pl-2",children:(0,r.jsx)(v,{type:"start",startTime:F,endTime:W,time:F,setTime:z,setStartTime:z,setEndTime:Y,startDate:q,endDate:L})}),(0,r.jsx)("div",{className:"\n                      flex \n                      w-12 \n                      items-center \n                      justify-center\n                      text-foreground-lighter\n                    ",children:(0,r.jsx)(d.Z,{strokeWidth:1.5,size:14})})]}):null,(0,r.jsx)("div",{className:"flex grow flex-col gap-1 pr-2",children:(0,r.jsx)(v,{type:"end",startTime:F,endTime:W,time:W,setTime:Y,setStartTime:z,setEndTime:Y,startDate:q,endDate:L})})]})}),(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(l(),{inline:!0,selectsRange:E,selected:q,onChange:e=>{!function(e){if(e){if(e instanceof Date)P(e),D(e);else{let[t,s]=e;P(t),D(s)}}else P(null),D(null)}(e)},dateFormat:"MMMM d, yyyy h:mm aa",startDate:q,endDate:L,minDate:w,maxDate:S,dayClassName:()=>"cursor-pointer",renderCustomHeader:e=>{let{date:t,decreaseMonth:s,increaseMonth:n,prevMonthButtonDisabled:a,nextMonthButtonDisabled:l}=e;return(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)("button",{onClick:s,disabled:a,type:"button",className:"\n                        ".concat(a&&"cursor-not-allowed opacity-50","\n                        text-foreground-light hover:text-foreground focus:outline-none p-2\n                    "),children:(0,r.jsx)(u.Z,{size:16,strokeWidth:2})}),(0,r.jsx)("span",{className:"text-sm text-foreground-light",children:(0,x.default)(t,"MMMM yyyy")}),(0,r.jsx)("button",{onClick:n,disabled:l,type:"button",className:"\n                        ".concat(l&&"cursor-not-allowed opacity-50","\n                        text-foreground-light p-2 hover:text-foreground focus:outline-none\n                    "),children:(0,r.jsx)(m.Z,{size:16,strokeWidth:2})})]})})}})}),T({from:(null==q?void 0:q.toISOString())||null,to:(null==L?void 0:L.toISOString())||null}),(0,r.jsx)(h.Z.Separator,{}),(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2 py-2 px-3 pb-4",children:[!C&&(0,r.jsx)(i.z,{type:"default",onClick:()=>void(H(!1),P(j),D(b),z(y),Y(N),I(null),M(null),a&&a({from:null,to:null})),children:"Clear"}),(0,r.jsx)(i.z,{onClick:()=>(function(){H(!1),I(q),M(L);let e={from:g()(q).second(Number(F.ss)).minute(Number(F.mm)).hour(Number(F.HH)).toISOString(),to:g()(L||q).second(Number(W.ss)).minute(Number(W.mm)).hour(Number(W.HH)).toISOString()};a&&a(e)})(),children:"Apply"})]})]})})]})}},59629:function(e,t,s){var r=s(52322);s(2784);var n=s(78046),a=s(2515);t.Z=function(e){return(0,r.jsx)(a.Z,{icon:n.Z,...e})}},59119:function(e,t,s){var r=s(52322);s(2784);var n=s(10341),a=s(2515);t.Z=function(e){return(0,r.jsx)(a.Z,{icon:n.Z,...e})}},25501:function(e,t,s){var r=s(52322);s(2784);var n=s(99792),a=s(2515);t.Z=function(e){return(0,r.jsx)(a.Z,{icon:n.Z,...e})}}}]);